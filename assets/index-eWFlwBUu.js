import{T as f,w as b,a as g,c as d,b as O,t as B,r as y}from"./index-3v7c5XRZ.js";import{m as p,U as m,e as k,a2 as C,x as a,q as $,n,O as j,J as h,j as S,l as w,f as D}from"./vendor-tqqTBR6w.js";import{s as V,p as W}from"./charts-cate-Gk4Rrh95.js";import{h as L}from"./async-replace-k4T3-9i6.js";var A=Object.defineProperty,T=Object.getOwnPropertyDescriptor,u=(e,t,i,r)=>{for(var s=r>1?void 0:r?T(t,i):t,o=e.length-1,l;o>=0;o--)(l=e[o])&&(s=(r?l(t,i,s):l(s))||s);return r&&s&&A(t,i,s),s};let c=class extends f(V){constructor(){super(...arguments),this.bindScreen=new p(this,m),this.bindWallet=new p(this,b),this.bindWeekly=new p(this,g),this.bindCharts=new p(this,d),this.paging=!1,this.brief=!0,this.moreSubjects=[],this.morePending=!1,this.err="",this.ts=0,this.pagination=W({pageNum:2}),this.hasMore=!0,this.fetch=async(e=!1)=>{if(!(this.morePending&&!e)&&!(this.paging&&!this.hasMore)){this.err="",this.morePending=!0;try{const i={week:await g.getLatest()};if(this.pagination){const{pageSize:s,pageNum:o}=this.pagination;Object.assign(i,{first:s,skip:(o-1)*s})}const{weeklySubjects:r}=await O(i);this.paging?(this.moreSubjects=[...this.moreSubjects,...r],this.hasMore=r.length>=this.pagination.pageSize,this.pagination.pageNum++):this.moreSubjects=[...r]}catch(t){let i=t.message||t.code||t;this.err=t.message||t.msg||t,console.error(i)}finally{this.morePending=!1,this.ts++}}},this.loadmore=()=>{this.fetch()},this.go2=(e,t)=>{var i;e.preventDefault(),e.stopPropagation(),this.disabled?k.emit("connect-wallet"):((i=e.target)==null?void 0:i.tagName)=="I"?window.open(t.uri,"_blank"):C(`/track/${t.id}`)}}get disabled(){return!b.account}get isMobi(){return m.isMobi}get scrollMode(){return this.isMobi?"click":"scroll"}get loading(){return d.pending&&!d.weeklySubjects.length}get empty(){return d.inited&&!d.weeklySubjects.length}get subjects(){return d.weeklySubjects.concat(this.moreSubjects)}render(){return a`<div role="list" class="ui-list gap-2 ${$(this.$c([this.morePending?"loading":"hover"]))}"><div class="flex header border-bottom">${n(!this.isMobi,()=>a`<div class="w-8">Rank</div>`)}<div class="flex-shrink">Collection</div><div class="flex-auto"></div><div class="num flex-auto w-32">Volume</div></div>${n(this.loading,()=>a`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>a`${j(this.subjects,(e,t)=>a`<div class="item flex items-center" @click="${i=>this.go2(i,e)}">${n(!this.isMobi,()=>a`<div class="flex-none w-8 text-center text-sm font-light opacity-70">${t+1}</div>`)}<div class="subject-img flex-shrink flex justify-center"><img-loader .src="${e.cooked.src}" class="w-14 rounded-lg"></img-loader></div><div class="subject-lines flex-auto overflow-hidden"><div class="subject-line1"><p class="subject-name ${$({limit:this.brief})}">${e.name}</p><a href="${e.uri}" class="flex-none ml-1.5" target="_blank"><i class="subject-play mdi mdi-play-circle-outline"></i></a></div>${n(this.brief,()=>a`<div class="text-xs text-gray-400/80"><span class="mr-1 text-gray-400/60">Price:</span>${e.cooked.price}</div>`)}</div><div class="subject-lines num flex-initial !w-18 text-sm items-end"><span class="subject-line1">${e.cooked.total}</span> <span class="text-xs"><chg-stat .chg="${e.cooked.chg}"></chg-stat></span></div></div>`)}`)}</div>${n(this.empty,()=>a`<p class="p-2 opacity-60">No votes yet.</p>`)} ${n(this.paging,()=>a`<ui-pagination .nomore="${this.err}" mode="${this.scrollMode}" .firstLoad="${!1}" .pending="${this.morePending}" @loadmore="${this.loadmore}"></ui-pagination>`)}`}};u([S({type:Boolean})],c.prototype,"paging",2);u([S({type:Boolean})],c.prototype,"brief",2);u([h()],c.prototype,"moreSubjects",2);u([h()],c.prototype,"morePending",2);u([h()],c.prototype,"err",2);u([h()],c.prototype,"ts",2);u([h()],c.prototype,"pagination",2);u([h()],c.prototype,"hasMore",2);c=u([w("weekly-top")],c);var H=Object.defineProperty,N=Object.getOwnPropertyDescriptor,M=(e,t,i,r)=>{for(var s=r>1?void 0:r?N(t,i):t,o=e.length-1,l;o>=0;o--)(l=e[o])&&(s=(r?l(t,i,s):l(s))||s);return r&&s&&H(t,i,s),s};let P=class extends f(""){constructor(){super(...arguments),this.bindWallet=new p(this,b),this.dialog=!1,this.open=()=>{this.disabled?k.emit("connect-wallet"):this.dialog=!0},this.close=()=>this.dialog=!1}get disabled(){return!b.account}render(){return a`<ui-button icon @click="${this.open}" title="Bind Social"><i class="i mdi mdi-twitter"></i></ui-button>${n(this.dialog,()=>a`<reward-dialog scene="social" @close="${()=>this.dialog=!1}"></reward-dialog>`)}`}};M([h()],P.prototype,"dialog",2);P=M([w("bind-social-btn")],P);const q="svg{display:inline-flex;align-items:center;overflow:hidden;border-radius:9999px;background:#c81444}svg svg{height:100%;width:100%}.ui-list.bidders{margin-top:.5rem;display:grid;grid-template-columns:repeat(5,minmax(0,1fr));align-items:end;justify-items:end;place-items:end;grid-gap:1rem;gap:1rem}@media (min-width: 768px){.ui-list.bidders{min-height:20rem;grid-template-columns:repeat(1,minmax(0,1fr))}}@media (min-width: 1024px){.ui-list.bidders{row-gap:0px}}.ui-list.bidders>*:not(.header){padding-top:.75rem;padding-bottom:.75rem}.ui-list.bidders.loading{grid-template-columns:repeat(1,minmax(0,1fr))!important}.ui-list.bidders .header{grid-column:span 3 / span 3}@media (min-width: 768px){.ui-list.bidders .header{grid-column:span 1 / span 1}}.ui-list .item{--tw-shadow: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -2px rgba(0, 0, 0, .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:0 0 #0000,0 0 #0000,0 4px 6px -1px #0000001a,0 2px 4px -2px #0000001a;box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)),var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)),var(--tw-shadow)}@media (min-width: 768px){.ui-list .item{--tw-shadow: 0 0 rgba(0,0,0,0);--tw-shadow-colored: 0 0 rgba(0,0,0,0);box-shadow:0 0 #0000,0 0 #0000,0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)),var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)),var(--tw-shadow)}}";var z=Object.defineProperty,R=Object.getOwnPropertyDescriptor,x=(e,t,i,r)=>{for(var s=r>1?void 0:r?R(t,i):t,o=e.length-1,l;o>=0;o--)(l=e[o])&&(s=(r?l(t,i,s):l(s))||s);return r&&s&&z(t,i,s),s};let v=class extends f(q){constructor(){super(...arguments),this.bindCharts=new p(this,d),this.albumToVote={id:"",voter:0,time:0,value:0},this.moreVotes=[],this.morePending=!1,this.itemMobi=e=>a`<ui-link class="flex justify-center items-center" href="${`/user/${e.voter.address}`}"><ui-address class="relative -top-1 text-xl" .address="${e.voter.address}" avatar hideAddr></ui-address></ui-link>`,this.timeAgo=async function*(e){for(;;)yield B(e),await new Promise(t=>setTimeout(t,1e3))}}get isMobi(){return m.screen.isMobi}get skeletonLen(){return this.isMobi?2:3}get loading(){return d.pending&&!d.votes.length}get empty(){return d.inited&&!d.votes.length}get votes(){return d.votes.concat(this.moreVotes)}render(){return a`<div class="w-full p-2 text-sm text-neutral-400 border-b" style="border-color:#2e3349"><div class="w-full">Bidders</div></div><div role="list" class="ui-list bidders ${$(this.$c([this.morePending?"loading":"hover"]))}">${n(this.loading,()=>a`<div name="Loading" class="doc-intro"><div class="w-full flex flex-col gap-8">${j([...Array(this.skeletonLen).keys()],()=>a`<loading-skeleton num="3" class="${this.isMobi?"":"sm"}"></loading-skeleton>`)}</div></div>`,()=>a`${j(this.votes,(e,t)=>a`${n(!this.isMobi,()=>a`<div class="item flex items-center pr-0.5"><div class="w-full flex items-center justify-between gap-2"><ui-link href="${`/user/${e.voter.address}`}"><ui-address class="relative -top-1 text-xl" .address="${e.voter.address}" avatar hideAddr></ui-address></ui-link><div class="flex flex-col justify-center items-end text-right"><p class="opacity-95 text-base">${D(e.value)}</p><p class="relative text-right text-xs leading-none text-neutral-400 whitespace-nowrap h-3"><span class="absolute right-0">${L(this.timeAgo(e.time))}</span></p></div></div></div>`,()=>a`${n(t<5,()=>a`${this.itemMobi(e)}`)}`)}`)}`)}</div>`}};x([h()],v.prototype,"albumToVote",2);x([h()],v.prototype,"moreVotes",2);x([h()],v.prototype,"morePending",2);v=x([w("latest-votes")],v);const U=":host{--homeBoardWidth: 8rem;--homeBoardHalf: calc((100% - var(--homeBoardWidth)) / 2 - 3rem)}.ui-board{width:100%}@media (min-width: 1024px){.ui-board{width:30rem;flex:0 1 auto}}.ui-board:nth-of-type(1){flex-grow:1}@media (min-width: 1024px){.ui-board:nth-of-type(1){width:100%}}.ui-board:nth-of-type(1){width:var(--homeBoardHalf)}.ui-board:nth-of-type(2){flex-grow:1;width:var(--homeBoardHalf)}.ui-board:nth-of-type(3){flex-shrink:1;flex-grow:0}@media (min-width: 1024px){.ui-board:nth-of-type(3){width:7rem}}@media (max-width: 1024px){.ui-board:nth-of-type(1),.ui-board:nth-of-type(2){width:auto}}";var E=Object.defineProperty,I=Object.getOwnPropertyDescriptor,J=(e,t,i,r)=>{for(var s=r>1?void 0:r?I(t,i):t,o=e.length-1,l;o>=0;o--)(l=e[o])&&(s=(r?l(t,i,s):l(s))||s);return r&&s&&E(t,i,s),s};let _=class extends f(U){constructor(){super(...arguments),this.bindScreen=new p(this,m),this.bindStore=new p(this,y),this.bindWeekly=new p(this,g)}get isMobi(){return m.screen.isMobi}async connectedCallback(){super.connectedCallback()}render(){return a`<div class="ui-pageview ui-container flex-col lg_flex-row place-content-center"><div class="ui-board"><div class="ui-board-header"><div class="ui-board-lead"><h5>Weekly Chart</h5><div class="ui-board-subtitle">${n(g.latest,()=>a`${g.latestRange}, <span class="text-green-500">${g.latestLeft}</span> left`)}</div></div><div class="ui-board-lead">${n(y.inited,()=>a`<h5><span class="text-sm text-gray-300">Pool: </span><span class="ui-em text-xl">${y.weeklyPoolHumanized||"-"}</span></h5>`,()=>a`<i class="mdi mdi-loading"></i>`)}</div></div><weekly-top></weekly-top></div>${n(!0,()=>a`<div class="ui-board"><div class="ui-board-header"><div class="ui-board-lead"><h5><charts-cate></charts-cate></h5></div></div><top-charts></top-charts></div><div class="ui-board"><div class="ui-board-header"><div class="text-xl">Votes</div></div><latest-votes></latest-votes></div>`)}</div>`}};_=J([w("view-home")],_);export{_ as ViewHome};
