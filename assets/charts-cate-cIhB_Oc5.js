import{T as $,s as P,c as o,p as S,d as w,C as _}from"./index-JmImYdbB.js";import{m,U as v,x as a,q as d,n as c,O as y,J as g,j as u,l as j}from"./vendor-AsFy8gcr.js";var C=Object.defineProperty,M=Object.getOwnPropertyDescriptor,h=(t,e,i,r)=>{for(var s=r>1?void 0:r?M(e,i):e,l=t.length-1,p;l>=0;l--)(p=t[l])&&(s=(r?p(e,i,s):p(s))||s);return r&&s&&C(e,i,s),s};let n=class extends $(P){constructor(){super(...arguments),this.bindScreen=new m(this,v),this.bindCharts=new m(this,o),this.paging=!1,this.brief=!0,this.pageSize=10,this.moreSubjects=[],this.morePending=!1,this.ts=0,this.err="",this.pagination=S({pageNum:2,pageSize:this.pageSize}),this.hasMore=!0,this.fetch=async(t=!1)=>{if(!(this.morePending&&!t)&&!(this.paging&&!this.hasMore)){this.err="",this.morePending=!0;try{const e={cate:o.cate};if(this.pagination){const{pageSize:r,pageNum:s}=this.pagination;Object.assign(e,{first:r,skip:(s-1)*r})}const{subjects:i}=await w(e);this.paging?(this.moreSubjects=[...this.moreSubjects,...i],this.hasMore=i.length>=this.pagination.pageSize,this.pagination.pageNum++):this.moreSubjects=[...i]}catch(e){this.err=e.message||e.msg||e}finally{this.morePending=!1,this.ts++}}},this.loadmore=()=>{this.fetch()}}get isMobi(){return v.isMobi}get scrollMode(){return"scroll"}get page1Len(){return o.subjects.length}get empty(){return o.inited&&!this.page1Len}get loading(){return o.chartPending&&!this.page1Len}get subjects(){return this.empty?[]:o.subjects.concat(this.moreSubjects)}get showRank(){return!this.isMobi&&["top","trending"].includes(o.cate)}render(){const t=!this.isMobi&&!this.brief;return a`<div role="list" class="ui-list gap-2 ${d(this.$c([this.morePending?"loading":"hover"]))}"><div class="flex header border-bottom"><div class="${d(this.$c([this.brief?"w-8":"w-12"]))}">${this.showRank?"Rank":"Index"}</div><div class="subject-intro">Collection</div>${c(t,()=>a`<div class="num date">Uploaded</div>`)} ${c(t,()=>a`<div class="num">Price</div>`)}<div class="num">Volume</div>${c(t,()=>a`<div class="num per">24H</div>`)}</div>${c(this.loading,()=>a`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>a`${y(this.subjects,(e,i)=>a`<subject-brief .subject="${e}" ?lite="${this.brief}"><div slot="left" class="subject-rank ${d({hot:!this.brief})}">${i+1} ${c(this.showRank&&!this.brief&&this.page1Len>3&&i<3,()=>a`<i class="mdi mdi-fire text-red-400"></i>`)}</div></subject-brief>`)} ${c(this.paging,()=>a`<ui-pagination .nomore="${this.err}" mode="${this.scrollMode}" .firstLoad="${!1}" .pending="${this.morePending}" @loadmore="${this.loadmore}"></ui-pagination>`,()=>a`<ui-link dense class="w-full justify-center" href="/charts">More</ui-link>`)}`)}</div>`}};h([u({type:Boolean})],n.prototype,"paging",2);h([u({type:Boolean})],n.prototype,"brief",2);h([u({type:Number})],n.prototype,"pageSize",2);h([g()],n.prototype,"moreSubjects",2);h([g()],n.prototype,"morePending",2);h([g()],n.prototype,"ts",2);h([g()],n.prototype,"err",2);h([g()],n.prototype,"pagination",2);h([g()],n.prototype,"hasMore",2);n=h([j("top-charts")],n);const O=":host{display:inline-flex;gap:2rem}";var x=Object.defineProperty,k=Object.getOwnPropertyDescriptor,b=(t,e,i,r)=>{for(var s=r>1?void 0:r?k(e,i):e,l=t.length-1,p;l>=0;l--)(p=t[l])&&(s=(r?p(e,i,s):p(s))||s);return r&&s&&x(e,i,s),s};let f=class extends $(O){constructor(){super(...arguments),this.bindChart=new m(this,o),this.cate="top",this.route=!1,this.goto=(t,e)=>{this.route||(t.stopImmediatePropagation(),t.preventDefault(),o.cate=e)}}render(){return a`${y(_,t=>a`<ui-link href="/charts/${t.key}" @click="${e=>this.goto(e,t.key)}" nav dense exact class="${d({"exact-active":o.cate===t.key})}">${t.title}</ui-link>`)}`}};b([u({type:String})],f.prototype,"cate",2);b([u({type:Boolean})],f.prototype,"route",2);f=b([j("charts-cate")],f);
