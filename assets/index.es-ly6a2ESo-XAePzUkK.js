import{_ as pw}from"./index-aJ1IhnCu.js";import{a9 as dw}from"./vendor-KMCe_Sr5.js";import{c as Mf,s as Ur,C as me,u as Rr,b as gw,d as bi,w as Ei,S as qf,k as Gt,v as vw,e as Uf,h as zf,q as Wc,f as Qi,i as yw,Z as bo,m as $f,$ as ac,p as Bf,r as vi,t as Mt,x as Mr,y as mw,z as _w,D as ww,_ as bw,E as Hf,F as _i,G as Sn,V as co,O as fr,H as de,I as xn,J as Ew,P as Iw,X as cc,K as il,L as yi,R as Sw,Q as xw,N as Pw,T as sl,Y as Ow,a0 as Cw,a1 as Rw,a2 as Tw,a3 as Aw,a4 as Nw,a5 as Vf,a6 as Lw,a7 as Dw,a8 as kw,a9 as jw,aa as Gc,ab as Mw,ac as Mc,ad as qw,ae as Uw,af as zw,ag as ol,ah as $w,ai as Bw,aj as Hw,ak as al,al as Vw,am as Co,an as Kw,ao as Fw,ap as es,aq as cl,ar as Ww,as as Gw,at as Yw,au as ul,av as Qw,aw as Jw,ax as Xw,ay as Zw,az as e0,aA as Yc,aB as t0,aC as Kf,aD as Ff,aE as qc,aF as Eo}from"./index-eqUXHyhQ.js";var uo={exports:{}},hl;function Wf(){if(hl)return uo.exports;hl=1;var a=typeof Reflect=="object"?Reflect:null,r=a&&typeof a.apply=="function"?a.apply:function(C,S,N){return Function.prototype.apply.call(C,S,N)},n;a&&typeof a.ownKeys=="function"?n=a.ownKeys:Object.getOwnPropertySymbols?n=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:n=function(C){return Object.getOwnPropertyNames(C)};function i(I){console&&console.warn&&console.warn(I)}var o=Number.isNaN||function(C){return C!==C};function u(){u.init.call(this)}uo.exports=u,uo.exports.once=B,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var l=10;function p(I){if(typeof I!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof I)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(I){if(typeof I!="number"||I<0||o(I))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+I+".");l=I}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||o(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function _(I){return I._maxListeners===void 0?u.defaultMaxListeners:I._maxListeners}u.prototype.getMaxListeners=function(){return _(this)},u.prototype.emit=function(C){for(var S=[],N=1;N<arguments.length;N++)S.push(arguments[N]);var U=C==="error",ae=this._events;if(ae!==void 0)U=U&&ae.error===void 0;else if(!U)return!1;if(U){var Z;if(S.length>0&&(Z=S[0]),Z instanceof Error)throw Z;var he=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw he.context=Z,he}var W=ae[C];if(W===void 0)return!1;if(typeof W=="function")r(W,this,S);else for(var le=W.length,y=O(W,le),N=0;N<le;++N)r(y[N],this,S);return!0};function g(I,C,S,N){var U,ae,Z;if(p(S),ae=I._events,ae===void 0?(ae=I._events=Object.create(null),I._eventsCount=0):(ae.newListener!==void 0&&(I.emit("newListener",C,S.listener?S.listener:S),ae=I._events),Z=ae[C]),Z===void 0)Z=ae[C]=S,++I._eventsCount;else if(typeof Z=="function"?Z=ae[C]=N?[S,Z]:[Z,S]:N?Z.unshift(S):Z.push(S),U=_(I),U>0&&Z.length>U&&!Z.warned){Z.warned=!0;var he=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");he.name="MaxListenersExceededWarning",he.emitter=I,he.type=C,he.count=Z.length,i(he)}return I}u.prototype.addListener=function(C,S){return g(this,C,S,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(C,S){return g(this,C,S,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(I,C,S){var N={fired:!1,wrapFn:void 0,target:I,type:C,listener:S},U=m.bind(N);return U.listener=S,N.wrapFn=U,U}u.prototype.once=function(C,S){return p(S),this.on(C,E(this,C,S)),this},u.prototype.prependOnceListener=function(C,S){return p(S),this.prependListener(C,E(this,C,S)),this},u.prototype.removeListener=function(C,S){var N,U,ae,Z,he;if(p(S),U=this._events,U===void 0)return this;if(N=U[C],N===void 0)return this;if(N===S||N.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete U[C],U.removeListener&&this.emit("removeListener",C,N.listener||S));else if(typeof N!="function"){for(ae=-1,Z=N.length-1;Z>=0;Z--)if(N[Z]===S||N[Z].listener===S){he=N[Z].listener,ae=Z;break}if(ae<0)return this;ae===0?N.shift():L(N,ae),N.length===1&&(U[C]=N[0]),U.removeListener!==void 0&&this.emit("removeListener",C,he||S)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(C){var S,N,U;if(N=this._events,N===void 0)return this;if(N.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):N[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete N[C]),this;if(arguments.length===0){var ae=Object.keys(N),Z;for(U=0;U<ae.length;++U)Z=ae[U],Z!=="removeListener"&&this.removeAllListeners(Z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=N[C],typeof S=="function")this.removeListener(C,S);else if(S!==void 0)for(U=S.length-1;U>=0;U--)this.removeListener(C,S[U]);return this};function P(I,C,S){var N=I._events;if(N===void 0)return[];var U=N[C];return U===void 0?[]:typeof U=="function"?S?[U.listener||U]:[U]:S?H(U):O(U,U.length)}u.prototype.listeners=function(C){return P(this,C,!0)},u.prototype.rawListeners=function(C){return P(this,C,!1)},u.listenerCount=function(I,C){return typeof I.listenerCount=="function"?I.listenerCount(C):A.call(I,C)},u.prototype.listenerCount=A;function A(I){var C=this._events;if(C!==void 0){var S=C[I];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function O(I,C){for(var S=new Array(C),N=0;N<C;++N)S[N]=I[N];return S}function L(I,C){for(;C+1<I.length;C++)I[C]=I[C+1];I.pop()}function H(I){for(var C=new Array(I.length),S=0;S<C.length;++S)C[S]=I[S].listener||I[S];return C}function B(I,C){return new Promise(function(S,N){function U(Z){I.removeListener(C,ae),N(Z)}function ae(){typeof I.removeListener=="function"&&I.removeListener("error",U),S([].slice.call(arguments))}q(I,C,ae,{once:!0}),C!=="error"&&z(I,U,{once:!0})})}function z(I,C,S){typeof I.on=="function"&&q(I,"error",C,S)}function q(I,C,S,N){if(typeof I.on=="function")N.once?I.once(C,S):I.on(C,S);else if(typeof I.addEventListener=="function")I.addEventListener(C,function U(ae){N.once&&I.removeEventListener(C,U),S(ae)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof I)}return uo.exports}const r0={},n0=Object.freeze(Object.defineProperty({__proto__:null,default:r0},Symbol.toStringTag,{value:"Module"})),rr=dw(n0);var ho={exports:{}},uc,ll;function Kn(){return ll||(ll=1,uc={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}),uc}var lo={exports:{}},fo={exports:{}},hc,fl;function i0(){if(fl)return hc;fl=1;var a={},r=rr,n=rr,i=rr,o=typeof __webpack_require__=="function"?__non_webpack_require__:Mf,u=process.config&&process.config.variables||{},l=!!a.PREBUILDS_ONLY,p=process.versions.modules,_=Z()?"electron":ae()?"node-webkit":"node",g=a.npm_config_arch||i.arch(),m=a.npm_config_platform||i.platform(),E=a.LIBC||(he(m)?"musl":"glibc"),P=a.ARM_VERSION||(g==="arm64"?"8":u.arm_version)||"",A=(process.versions.uv||"").split(".")[0];hc=O;function O(W){return o(O.resolve(W))}O.resolve=O.path=function(W){W=n.resolve(W||".");try{var le=o(n.join(W,"package.json")).name.toUpperCase().replace(/-/g,"_");a[le+"_PREBUILD"]&&(W=a[le+"_PREBUILD"])}catch{}if(!l){var y=H(n.join(W,"build/Release"),B);if(y)return y;var T=H(n.join(W,"build/Debug"),B);if(T)return T}var ce=J(W);if(ce)return ce;var ue=J(n.dirname(process.execPath));if(ue)return ue;var ne=["platform="+m,"arch="+g,"runtime="+_,"abi="+p,"uv="+A,P?"armv="+P:"","libc="+E,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+ne+`
    loaded from: `+W+`
`);function J(ee){var se=L(n.join(ee,"prebuilds")).map(z),$e=se.filter(q(m,g)).sort(I)[0];if($e){var Be=n.join(ee,"prebuilds",$e.name),nr=L(Be).map(C),xe=nr.filter(S(_,p)),nt=xe.sort(U(_))[0];if(nt)return n.join(Be,nt.file)}}};function L(W){try{return r.readdirSync(W)}catch{return[]}}function H(W,le){var y=L(W).filter(le);return y[0]&&n.join(W,y[0])}function B(W){return/\.node$/.test(W)}function z(W){var le=W.split("-");if(le.length===2){var y=le[0],T=le[1].split("+");if(y&&T.length&&T.every(Boolean))return{name:W,platform:y,architectures:T}}}function q(W,le){return function(y){return y==null||y.platform!==W?!1:y.architectures.includes(le)}}function I(W,le){return W.architectures.length-le.architectures.length}function C(W){var le=W.split("."),y=le.pop(),T={file:W,specificity:0};if(y==="node"){for(var ce=0;ce<le.length;ce++){var ue=le[ce];if(ue==="node"||ue==="electron"||ue==="node-webkit")T.runtime=ue;else if(ue==="napi")T.napi=!0;else if(ue.slice(0,3)==="abi")T.abi=ue.slice(3);else if(ue.slice(0,2)==="uv")T.uv=ue.slice(2);else if(ue.slice(0,4)==="armv")T.armv=ue.slice(4);else if(ue==="glibc"||ue==="musl")T.libc=ue;else continue;T.specificity++}return T}}function S(W,le){return function(y){return!(y==null||y.runtime!==W&&!N(y)||y.abi!==le&&!y.napi||y.uv&&y.uv!==A||y.armv&&y.armv!==P||y.libc&&y.libc!==E)}}function N(W){return W.runtime==="node"&&W.napi}function U(W){return function(le,y){return le.runtime!==y.runtime?le.runtime===W?-1:1:le.abi!==y.abi?le.abi?-1:1:le.specificity!==y.specificity?le.specificity>y.specificity?-1:1:0}}function ae(){return!!(process.versions&&process.versions.nw)}function Z(){return process.versions&&process.versions.electron||a.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function he(W){return W==="linux"&&r.existsSync("/etc/alpine-release")}return O.parseTags=C,O.matchTags=S,O.compareTags=U,O.parseTuple=z,O.matchTuple=q,O.compareTuples=I,hc}var pl;function Gf(){if(pl)return fo.exports;pl=1;const a=typeof __webpack_require__=="function"?__non_webpack_require__:Mf;return typeof a.addon=="function"?fo.exports=a.addon.bind(a):fo.exports=i0(),fo.exports}var lc,dl;function s0(){return dl||(dl=1,lc={mask:(n,i,o,u,l)=>{for(var p=0;p<l;p++)o[u+p]=n[p]^i[p&3]},unmask:(n,i)=>{const o=n.length;for(var u=0;u<o;u++)n[u]^=i[u&3]}}),lc}var gl;function o0(){if(gl)return lo.exports;gl=1;try{lo.exports=Gf()(__dirname)}catch{lo.exports=s0()}return lo.exports}var vl;function Ro(){if(vl)return ho.exports;vl=1;const{EMPTY_BUFFER:a}=Kn();function r(l,p){if(l.length===0)return a;if(l.length===1)return l[0];const _=Buffer.allocUnsafe(p);let g=0;for(let m=0;m<l.length;m++){const E=l[m];_.set(E,g),g+=E.length}return g<p?_.slice(0,g):_}function n(l,p,_,g,m){for(let E=0;E<m;E++)_[g+E]=l[E]^p[E&3]}function i(l,p){for(let _=0;_<l.length;_++)l[_]^=p[_&3]}function o(l){return l.byteLength===l.buffer.byteLength?l.buffer:l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)}function u(l){if(u.readOnly=!0,Buffer.isBuffer(l))return l;let p;return l instanceof ArrayBuffer?p=Buffer.from(l):ArrayBuffer.isView(l)?p=Buffer.from(l.buffer,l.byteOffset,l.byteLength):(p=Buffer.from(l),u.readOnly=!1),p}try{const l=o0();ho.exports={concat:r,mask(p,_,g,m,E){E<48?n(p,_,g,m,E):l.mask(p,_,g,m,E)},toArrayBuffer:o,toBuffer:u,unmask(p,_){p.length<32?i(p,_):l.unmask(p,_)}}}catch{ho.exports={concat:r,mask:n,toArrayBuffer:o,toBuffer:u,unmask:i}}return ho.exports}var fc,yl;function a0(){if(yl)return fc;yl=1;const a=Symbol("kDone"),r=Symbol("kRun");class n{constructor(o){this[a]=()=>{this.pending--,this[r]()},this.concurrency=o||1/0,this.jobs=[],this.pending=0}add(o){this.jobs.push(o),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){const o=this.jobs.shift();this.pending++,o(this[a])}}}return fc=n,fc}var pc,ml;function To(){if(ml)return pc;ml=1;const a=rr,r=Ro(),n=a0(),{kStatusCode:i}=Kn(),o=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),l=Symbol("total-length"),p=Symbol("callback"),_=Symbol("buffers"),g=Symbol("error");let m;class E{constructor(H,B,z){if(this._maxPayload=z|0,this._options=H||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!B,this._deflate=null,this._inflate=null,this.params=null,!m){const q=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;m=new n(q)}}static get extensionName(){return"permessage-deflate"}offer(){const H={};return this._options.serverNoContextTakeover&&(H.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(H.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(H.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?H.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(H.client_max_window_bits=!0),H}accept(H){return H=this.normalizeParams(H),this.params=this._isServer?this.acceptAsServer(H):this.acceptAsClient(H),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const H=this._deflate[p];this._deflate.close(),this._deflate=null,H&&H(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(H){const B=this._options,z=H.find(q=>!(B.serverNoContextTakeover===!1&&q.server_no_context_takeover||q.server_max_window_bits&&(B.serverMaxWindowBits===!1||typeof B.serverMaxWindowBits=="number"&&B.serverMaxWindowBits>q.server_max_window_bits)||typeof B.clientMaxWindowBits=="number"&&!q.client_max_window_bits));if(!z)throw new Error("None of the extension offers can be accepted");return B.serverNoContextTakeover&&(z.server_no_context_takeover=!0),B.clientNoContextTakeover&&(z.client_no_context_takeover=!0),typeof B.serverMaxWindowBits=="number"&&(z.server_max_window_bits=B.serverMaxWindowBits),typeof B.clientMaxWindowBits=="number"?z.client_max_window_bits=B.clientMaxWindowBits:(z.client_max_window_bits===!0||B.clientMaxWindowBits===!1)&&delete z.client_max_window_bits,z}acceptAsClient(H){const B=H[0];if(this._options.clientNoContextTakeover===!1&&B.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!B.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(B.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&B.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return B}normalizeParams(H){return H.forEach(B=>{Object.keys(B).forEach(z=>{let q=B[z];if(q.length>1)throw new Error(`Parameter "${z}" must have only a single value`);if(q=q[0],z==="client_max_window_bits"){if(q!==!0){const I=+q;if(!Number.isInteger(I)||I<8||I>15)throw new TypeError(`Invalid value for parameter "${z}": ${q}`);q=I}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${z}": ${q}`)}else if(z==="server_max_window_bits"){const I=+q;if(!Number.isInteger(I)||I<8||I>15)throw new TypeError(`Invalid value for parameter "${z}": ${q}`);q=I}else if(z==="client_no_context_takeover"||z==="server_no_context_takeover"){if(q!==!0)throw new TypeError(`Invalid value for parameter "${z}": ${q}`)}else throw new Error(`Unknown parameter "${z}"`);B[z]=q})}),H}decompress(H,B,z){m.add(q=>{this._decompress(H,B,(I,C)=>{q(),z(I,C)})})}compress(H,B,z){m.add(q=>{this._compress(H,B,(I,C)=>{q(),z(I,C)})})}_decompress(H,B,z){const q=this._isServer?"client":"server";if(!this._inflate){const I=`${q}_max_window_bits`,C=typeof this.params[I]!="number"?a.Z_DEFAULT_WINDOWBITS:this.params[I];this._inflate=a.createInflateRaw({...this._options.zlibInflateOptions,windowBits:C}),this._inflate[u]=this,this._inflate[l]=0,this._inflate[_]=[],this._inflate.on("error",O),this._inflate.on("data",A)}this._inflate[p]=z,this._inflate.write(H),B&&this._inflate.write(o),this._inflate.flush(()=>{const I=this._inflate[g];if(I){this._inflate.close(),this._inflate=null,z(I);return}const C=r.concat(this._inflate[_],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[_]=[],B&&this.params[`${q}_no_context_takeover`]&&this._inflate.reset()),z(null,C)})}_compress(H,B,z){const q=this._isServer?"server":"client";if(!this._deflate){const I=`${q}_max_window_bits`,C=typeof this.params[I]!="number"?a.Z_DEFAULT_WINDOWBITS:this.params[I];this._deflate=a.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:C}),this._deflate[l]=0,this._deflate[_]=[],this._deflate.on("data",P)}this._deflate[p]=z,this._deflate.write(H),this._deflate.flush(a.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let I=r.concat(this._deflate[_],this._deflate[l]);B&&(I=I.slice(0,I.length-4)),this._deflate[p]=null,this._deflate[l]=0,this._deflate[_]=[],B&&this.params[`${q}_no_context_takeover`]&&this._deflate.reset(),z(null,I)})}}pc=E;function P(L){this[_].push(L),this[l]+=L.length}function A(L){if(this[l]+=L.length,this[u]._maxPayload<1||this[l]<=this[u]._maxPayload){this[_].push(L);return}this[g]=new RangeError("Max payload size exceeded"),this[g].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[g][i]=1009,this.removeListener("data",A),this.reset()}function O(L){this[u]._inflate=null,L[i]=1007,this[p](L)}return pc}var po={exports:{}},go={exports:{}},dc,_l;function c0(){if(_l)return dc;_l=1;function a(r){const n=r.length;let i=0;for(;i<n;)if(!(r[i]&128))i++;else if((r[i]&224)===192){if(i+1===n||(r[i+1]&192)!==128||(r[i]&254)===192)return!1;i+=2}else if((r[i]&240)===224){if(i+2>=n||(r[i+1]&192)!==128||(r[i+2]&192)!==128||r[i]===224&&(r[i+1]&224)===128||r[i]===237&&(r[i+1]&224)===160)return!1;i+=3}else if((r[i]&248)===240){if(i+3>=n||(r[i+1]&192)!==128||(r[i+2]&192)!==128||(r[i+3]&192)!==128||r[i]===240&&(r[i+1]&240)===128||r[i]===244&&r[i+1]>143||r[i]>244)return!1;i+=4}else return!1;return!0}return dc=a,dc}var wl;function u0(){if(wl)return go.exports;wl=1;try{go.exports=Gf()(__dirname)}catch{go.exports=c0()}return go.exports}var bl;function Ao(){if(bl)return po.exports;bl=1;const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function r(i){return i>=1e3&&i<=1014&&i!==1004&&i!==1005&&i!==1006||i>=3e3&&i<=4999}function n(i){const o=i.length;let u=0;for(;u<o;)if(!(i[u]&128))u++;else if((i[u]&224)===192){if(u+1===o||(i[u+1]&192)!==128||(i[u]&254)===192)return!1;u+=2}else if((i[u]&240)===224){if(u+2>=o||(i[u+1]&192)!==128||(i[u+2]&192)!==128||i[u]===224&&(i[u+1]&224)===128||i[u]===237&&(i[u+1]&224)===160)return!1;u+=3}else if((i[u]&248)===240){if(u+3>=o||(i[u+1]&192)!==128||(i[u+2]&192)!==128||(i[u+3]&192)!==128||i[u]===240&&(i[u+1]&240)===128||i[u]===244&&i[u+1]>143||i[u]>244)return!1;u+=4}else return!1;return!0}try{const i=u0();po.exports={isValidStatusCode:r,isValidUTF8(o){return o.length<150?n(o):i(o)},tokenChars:a}}catch{po.exports={isValidStatusCode:r,isValidUTF8:n,tokenChars:a}}return po.exports}var gc,El;function Yf(){if(El)return gc;El=1;const{Writable:a}=rr,r=To(),{BINARY_TYPES:n,EMPTY_BUFFER:i,kStatusCode:o,kWebSocket:u}=Kn(),{concat:l,toArrayBuffer:p,unmask:_}=Ro(),{isValidStatusCode:g,isValidUTF8:m}=Ao(),E=0,P=1,A=2,O=3,L=4,H=5;class B extends a{constructor(I={}){super(),this._binaryType=I.binaryType||n[0],this._extensions=I.extensions||{},this._isServer=!!I.isServer,this._maxPayload=I.maxPayload|0,this._skipUTF8Validation=!!I.skipUTF8Validation,this[u]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=E,this._loop=!1}_write(I,C,S){if(this._opcode===8&&this._state==E)return S();this._bufferedBytes+=I.length,this._buffers.push(I),this.startLoop(S)}consume(I){if(this._bufferedBytes-=I,I===this._buffers[0].length)return this._buffers.shift();if(I<this._buffers[0].length){const S=this._buffers[0];return this._buffers[0]=S.slice(I),S.slice(0,I)}const C=Buffer.allocUnsafe(I);do{const S=this._buffers[0],N=C.length-I;I>=S.length?C.set(this._buffers.shift(),N):(C.set(new Uint8Array(S.buffer,S.byteOffset,I),N),this._buffers[0]=S.slice(I)),I-=S.length}while(I>0);return C}startLoop(I){let C;this._loop=!0;do switch(this._state){case E:C=this.getInfo();break;case P:C=this.getPayloadLength16();break;case A:C=this.getPayloadLength64();break;case O:this.getMask();break;case L:C=this.getData(I);break;default:this._loop=!1;return}while(this._loop);I(C)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}const I=this.consume(2);if(I[0]&48)return this._loop=!1,z(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const C=(I[0]&64)===64;if(C&&!this._extensions[r.extensionName])return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(I[0]&128)===128,this._opcode=I[0]&15,this._payloadLength=I[1]&127,this._opcode===0){if(C)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,z(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=C}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,z(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(C)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,z(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(I[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,z(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,z(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=P;else if(this._payloadLength===127)this._state=A;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}const I=this.consume(8),C=I.readUInt32BE(0);return C>Math.pow(2,21)-1?(this._loop=!1,z(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=C*Math.pow(2,32)+I.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=O:this._state=L}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=L}getData(I){let C=i;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}C=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&_(C,this._mask)}if(this._opcode>7)return this.controlMessage(C);if(this._compressed){this._state=H,this.decompress(C,I);return}return C.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(C)),this.dataMessage()}decompress(I,C){this._extensions[r.extensionName].decompress(I,this._fin,(N,U)=>{if(N)return C(N);if(U.length){if(this._messageLength+=U.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return C(z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(U)}const ae=this.dataMessage();if(ae)return C(ae);this.startLoop(C)})}dataMessage(){if(this._fin){const I=this._messageLength,C=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let S;this._binaryType==="nodebuffer"?S=l(C,I):this._binaryType==="arraybuffer"?S=p(l(C,I)):S=C,this.emit("message",S,!0)}else{const S=l(C,I);if(!this._skipUTF8Validation&&!m(S))return this._loop=!1,z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",S,!1)}}this._state=E}controlMessage(I){if(this._opcode===8)if(this._loop=!1,I.length===0)this.emit("conclude",1005,i),this.end();else{if(I.length===1)return z(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const C=I.readUInt16BE(0);if(!g(C))return z(RangeError,`invalid status code ${C}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const S=I.slice(2);if(!this._skipUTF8Validation&&!m(S))return z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",C,S),this.end()}}else this._opcode===9?this.emit("ping",I):this.emit("pong",I);this._state=E}}gc=B;function z(q,I,C,S,N){const U=new q(C?`Invalid WebSocket frame: ${I}`:I);return Error.captureStackTrace(U,z),U.code=N,U[o]=S,U}return gc}var vc,Il;function Qf(){if(Il)return vc;Il=1;const{randomFillSync:a}=rr,r=To(),{EMPTY_BUFFER:n}=Kn(),{isValidStatusCode:i}=Ao(),{mask:o,toBuffer:u}=Ro(),l=Symbol("kByteLength"),p=Buffer.alloc(4);class _{constructor(m,E,P){this._extensions=E||{},P&&(this._generateMask=P,this._maskBuffer=Buffer.alloc(4)),this._socket=m,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(m,E){let P,A=!1,O=2,L=!1;E.mask&&(P=E.maskBuffer||p,E.generateMask?E.generateMask(P):a(P,0,4),L=(P[0]|P[1]|P[2]|P[3])===0,O=6);let H;typeof m=="string"?(!E.mask||L)&&E[l]!==void 0?H=E[l]:(m=Buffer.from(m),H=m.length):(H=m.length,A=E.mask&&E.readOnly&&!L);let B=H;H>=65536?(O+=8,B=127):H>125&&(O+=2,B=126);const z=Buffer.allocUnsafe(A?H+O:O);return z[0]=E.fin?E.opcode|128:E.opcode,E.rsv1&&(z[0]|=64),z[1]=B,B===126?z.writeUInt16BE(H,2):B===127&&(z[2]=z[3]=0,z.writeUIntBE(H,4,6)),E.mask?(z[1]|=128,z[O-4]=P[0],z[O-3]=P[1],z[O-2]=P[2],z[O-1]=P[3],L?[z,m]:A?(o(m,P,z,O,H),[z]):(o(m,P,m,0,H),[z,m])):[z,m]}close(m,E,P,A){let O;if(m===void 0)O=n;else{if(typeof m!="number"||!i(m))throw new TypeError("First argument must be a valid error code number");if(E===void 0||!E.length)O=Buffer.allocUnsafe(2),O.writeUInt16BE(m,0);else{const H=Buffer.byteLength(E);if(H>123)throw new RangeError("The message must not be greater than 123 bytes");O=Buffer.allocUnsafe(2+H),O.writeUInt16BE(m,0),typeof E=="string"?O.write(E,2):O.set(E,2)}}const L={[l]:O.length,fin:!0,generateMask:this._generateMask,mask:P,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,O,!1,L,A]):this.sendFrame(_.frame(O,L),A)}ping(m,E,P){let A,O;if(typeof m=="string"?(A=Buffer.byteLength(m),O=!1):(m=u(m),A=m.length,O=u.readOnly),A>125)throw new RangeError("The data size must not be greater than 125 bytes");const L={[l]:A,fin:!0,generateMask:this._generateMask,mask:E,maskBuffer:this._maskBuffer,opcode:9,readOnly:O,rsv1:!1};this._deflating?this.enqueue([this.dispatch,m,!1,L,P]):this.sendFrame(_.frame(m,L),P)}pong(m,E,P){let A,O;if(typeof m=="string"?(A=Buffer.byteLength(m),O=!1):(m=u(m),A=m.length,O=u.readOnly),A>125)throw new RangeError("The data size must not be greater than 125 bytes");const L={[l]:A,fin:!0,generateMask:this._generateMask,mask:E,maskBuffer:this._maskBuffer,opcode:10,readOnly:O,rsv1:!1};this._deflating?this.enqueue([this.dispatch,m,!1,L,P]):this.sendFrame(_.frame(m,L),P)}send(m,E,P){const A=this._extensions[r.extensionName];let O=E.binary?2:1,L=E.compress,H,B;if(typeof m=="string"?(H=Buffer.byteLength(m),B=!1):(m=u(m),H=m.length,B=u.readOnly),this._firstFragment?(this._firstFragment=!1,L&&A&&A.params[A._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(L=H>=A._threshold),this._compress=L):(L=!1,O=0),E.fin&&(this._firstFragment=!0),A){const z={[l]:H,fin:E.fin,generateMask:this._generateMask,mask:E.mask,maskBuffer:this._maskBuffer,opcode:O,readOnly:B,rsv1:L};this._deflating?this.enqueue([this.dispatch,m,this._compress,z,P]):this.dispatch(m,this._compress,z,P)}else this.sendFrame(_.frame(m,{[l]:H,fin:E.fin,generateMask:this._generateMask,mask:E.mask,maskBuffer:this._maskBuffer,opcode:O,readOnly:B,rsv1:!1}),P)}dispatch(m,E,P,A){if(!E){this.sendFrame(_.frame(m,P),A);return}const O=this._extensions[r.extensionName];this._bufferedBytes+=P[l],this._deflating=!0,O.compress(m,P.fin,(L,H)=>{if(this._socket.destroyed){const B=new Error("The socket was closed while data was being compressed");typeof A=="function"&&A(B);for(let z=0;z<this._queue.length;z++){const q=this._queue[z],I=q[q.length-1];typeof I=="function"&&I(B)}return}this._bufferedBytes-=P[l],this._deflating=!1,P.readOnly=!1,this.sendFrame(_.frame(H,P),A),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const m=this._queue.shift();this._bufferedBytes-=m[3][l],Reflect.apply(m[0],this,m.slice(1))}}enqueue(m){this._bufferedBytes+=m[3][l],this._queue.push(m)}sendFrame(m,E){m.length===2?(this._socket.cork(),this._socket.write(m[0]),this._socket.write(m[1],E),this._socket.uncork()):this._socket.write(m[0],E)}}return vc=_,vc}var yc,Sl;function h0(){if(Sl)return yc;Sl=1;const{kForOnEventAttribute:a,kListener:r}=Kn(),n=Symbol("kCode"),i=Symbol("kData"),o=Symbol("kError"),u=Symbol("kMessage"),l=Symbol("kReason"),p=Symbol("kTarget"),_=Symbol("kType"),g=Symbol("kWasClean");class m{constructor(H){this[p]=null,this[_]=H}get target(){return this[p]}get type(){return this[_]}}Object.defineProperty(m.prototype,"target",{enumerable:!0}),Object.defineProperty(m.prototype,"type",{enumerable:!0});class E extends m{constructor(H,B={}){super(H),this[n]=B.code===void 0?0:B.code,this[l]=B.reason===void 0?"":B.reason,this[g]=B.wasClean===void 0?!1:B.wasClean}get code(){return this[n]}get reason(){return this[l]}get wasClean(){return this[g]}}Object.defineProperty(E.prototype,"code",{enumerable:!0}),Object.defineProperty(E.prototype,"reason",{enumerable:!0}),Object.defineProperty(E.prototype,"wasClean",{enumerable:!0});class P extends m{constructor(H,B={}){super(H),this[o]=B.error===void 0?null:B.error,this[u]=B.message===void 0?"":B.message}get error(){return this[o]}get message(){return this[u]}}Object.defineProperty(P.prototype,"error",{enumerable:!0}),Object.defineProperty(P.prototype,"message",{enumerable:!0});class A extends m{constructor(H,B={}){super(H),this[i]=B.data===void 0?null:B.data}get data(){return this[i]}}return Object.defineProperty(A.prototype,"data",{enumerable:!0}),yc={CloseEvent:E,ErrorEvent:P,Event:m,EventTarget:{addEventListener(L,H,B={}){let z;if(L==="message")z=function(I,C){const S=new A("message",{data:C?I:I.toString()});S[p]=this,H.call(this,S)};else if(L==="close")z=function(I,C){const S=new E("close",{code:I,reason:C.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});S[p]=this,H.call(this,S)};else if(L==="error")z=function(I){const C=new P("error",{error:I,message:I.message});C[p]=this,H.call(this,C)};else if(L==="open")z=function(){const I=new m("open");I[p]=this,H.call(this,I)};else return;z[a]=!!B[a],z[r]=H,B.once?this.once(L,z):this.on(L,z)},removeEventListener(L,H){for(const B of this.listeners(L))if(B[r]===H&&!B[a]){this.removeListener(L,B);break}}},MessageEvent:A},yc}var mc,xl;function Jf(){if(xl)return mc;xl=1;const{tokenChars:a}=Ao();function r(o,u,l){o[u]===void 0?o[u]=[l]:o[u].push(l)}function n(o){const u=Object.create(null);let l=Object.create(null),p=!1,_=!1,g=!1,m,E,P=-1,A=-1,O=-1,L=0;for(;L<o.length;L++)if(A=o.charCodeAt(L),m===void 0)if(O===-1&&a[A]===1)P===-1&&(P=L);else if(L!==0&&(A===32||A===9))O===-1&&P!==-1&&(O=L);else if(A===59||A===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L);const B=o.slice(P,O);A===44?(r(u,B,l),l=Object.create(null)):m=B,P=O=-1}else throw new SyntaxError(`Unexpected character at index ${L}`);else if(E===void 0)if(O===-1&&a[A]===1)P===-1&&(P=L);else if(A===32||A===9)O===-1&&P!==-1&&(O=L);else if(A===59||A===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L),r(l,o.slice(P,O),!0),A===44&&(r(u,m,l),l=Object.create(null),m=void 0),P=O=-1}else if(A===61&&P!==-1&&O===-1)E=o.slice(P,L),P=O=-1;else throw new SyntaxError(`Unexpected character at index ${L}`);else if(_){if(a[A]!==1)throw new SyntaxError(`Unexpected character at index ${L}`);P===-1?P=L:p||(p=!0),_=!1}else if(g)if(a[A]===1)P===-1&&(P=L);else if(A===34&&P!==-1)g=!1,O=L;else if(A===92)_=!0;else throw new SyntaxError(`Unexpected character at index ${L}`);else if(A===34&&o.charCodeAt(L-1)===61)g=!0;else if(O===-1&&a[A]===1)P===-1&&(P=L);else if(P!==-1&&(A===32||A===9))O===-1&&(O=L);else if(A===59||A===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L);let B=o.slice(P,O);p&&(B=B.replace(/\\/g,""),p=!1),r(l,E,B),A===44&&(r(u,m,l),l=Object.create(null),m=void 0),E=void 0,P=O=-1}else throw new SyntaxError(`Unexpected character at index ${L}`);if(P===-1||g||A===32||A===9)throw new SyntaxError("Unexpected end of input");O===-1&&(O=L);const H=o.slice(P,O);return m===void 0?r(u,H,l):(E===void 0?r(l,H,!0):p?r(l,E,H.replace(/\\/g,"")):r(l,E,H),r(u,m,l)),u}function i(o){return Object.keys(o).map(u=>{let l=o[u];return Array.isArray(l)||(l=[l]),l.map(p=>[u].concat(Object.keys(p).map(_=>{let g=p[_];return Array.isArray(g)||(g=[g]),g.map(m=>m===!0?_:`${_}=${m}`).join("; ")})).join("; ")).join(", ")}).join(", ")}return mc={format:i,parse:n},mc}var _c,Pl;function Xf(){if(Pl)return _c;Pl=1;const a=Wf(),r=rr,n=rr,i=rr,o=rr,{randomBytes:u,createHash:l}=rr,{URL:p}=rr,_=To(),g=Yf(),m=Qf(),{BINARY_TYPES:E,EMPTY_BUFFER:P,GUID:A,kForOnEventAttribute:O,kListener:L,kStatusCode:H,kWebSocket:B,NOOP:z}=Kn(),{EventTarget:{addEventListener:q,removeEventListener:I}}=h0(),{format:C,parse:S}=Jf(),{toBuffer:N}=Ro(),U=["CONNECTING","OPEN","CLOSING","CLOSED"],ae=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Z=[8,13],he=30*1e3;class W extends a{constructor($,te,oe){super(),this._binaryType=E[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=P,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=W.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,$!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,te===void 0?te=[]:Array.isArray(te)||(typeof te=="object"&&te!==null?(oe=te,te=[]):te=[te]),le(this,$,te,oe)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType($){E.includes($)&&(this._binaryType=$,this._receiver&&(this._receiver._binaryType=$))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket($,te,oe){const ie=new g({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:oe.maxPayload,skipUTF8Validation:oe.skipUTF8Validation});this._sender=new m($,this._extensions,oe.generateMask),this._receiver=ie,this._socket=$,ie[B]=this,$[B]=this,ie.on("conclude",J),ie.on("drain",ee),ie.on("error",se),ie.on("message",Be),ie.on("ping",nr),ie.on("pong",xe),$.setTimeout(0),$.setNoDelay(),te.length>0&&$.unshift(te),$.on("close",F),$.on("data",K),$.on("end",M),$.on("error",h),this._readyState=W.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=W.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[_.extensionName]&&this._extensions[_.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=W.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close($,te){if(this.readyState!==W.CLOSED){if(this.readyState===W.CONNECTING)return ue(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===W.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=W.CLOSING,this._sender.close($,te,!this._isServer,oe=>{oe||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),he)}}pause(){this.readyState===W.CONNECTING||this.readyState===W.CLOSED||(this._paused=!0,this._socket.pause())}ping($,te,oe){if(this.readyState===W.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof $=="function"?(oe=$,$=te=void 0):typeof te=="function"&&(oe=te,te=void 0),typeof $=="number"&&($=$.toString()),this.readyState!==W.OPEN){ne(this,$,oe);return}te===void 0&&(te=!this._isServer),this._sender.ping($||P,te,oe)}pong($,te,oe){if(this.readyState===W.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof $=="function"?(oe=$,$=te=void 0):typeof te=="function"&&(oe=te,te=void 0),typeof $=="number"&&($=$.toString()),this.readyState!==W.OPEN){ne(this,$,oe);return}te===void 0&&(te=!this._isServer),this._sender.pong($||P,te,oe)}resume(){this.readyState===W.CONNECTING||this.readyState===W.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send($,te,oe){if(this.readyState===W.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof te=="function"&&(oe=te,te={}),typeof $=="number"&&($=$.toString()),this.readyState!==W.OPEN){ne(this,$,oe);return}const ie={binary:typeof $!="string",mask:!this._isServer,compress:!0,fin:!0,...te};this._extensions[_.extensionName]||(ie.compress=!1),this._sender.send($||P,ie,oe)}terminate(){if(this.readyState!==W.CLOSED){if(this.readyState===W.CONNECTING)return ue(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=W.CLOSING,this._socket.destroy())}}}Object.defineProperty(W,"CONNECTING",{enumerable:!0,value:U.indexOf("CONNECTING")}),Object.defineProperty(W.prototype,"CONNECTING",{enumerable:!0,value:U.indexOf("CONNECTING")}),Object.defineProperty(W,"OPEN",{enumerable:!0,value:U.indexOf("OPEN")}),Object.defineProperty(W.prototype,"OPEN",{enumerable:!0,value:U.indexOf("OPEN")}),Object.defineProperty(W,"CLOSING",{enumerable:!0,value:U.indexOf("CLOSING")}),Object.defineProperty(W.prototype,"CLOSING",{enumerable:!0,value:U.indexOf("CLOSING")}),Object.defineProperty(W,"CLOSED",{enumerable:!0,value:U.indexOf("CLOSED")}),Object.defineProperty(W.prototype,"CLOSED",{enumerable:!0,value:U.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(w=>{Object.defineProperty(W.prototype,w,{enumerable:!0})}),["open","error","close","message"].forEach(w=>{Object.defineProperty(W.prototype,`on${w}`,{enumerable:!0,get(){for(const $ of this.listeners(w))if($[O])return $[L];return null},set($){for(const te of this.listeners(w))if(te[O]){this.removeListener(w,te);break}typeof $=="function"&&this.addEventListener(w,$,{[O]:!0})}})}),W.prototype.addEventListener=q,W.prototype.removeEventListener=I,_c=W;function le(w,$,te,oe){const ie={protocolVersion:Z[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...oe,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!Z.includes(ie.protocolVersion))throw new RangeError(`Unsupported protocol version: ${ie.protocolVersion} (supported versions: ${Z.join(", ")})`);let _e;if($ instanceof p)_e=$,w._url=$.href;else{try{_e=new p($)}catch{throw new SyntaxError(`Invalid URL: ${$}`)}w._url=$}const Re=_e.protocol==="wss:",ct=_e.protocol==="ws+unix:";let Qe;if(_e.protocol!=="ws:"&&!Re&&!ct?Qe=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:ct&&!_e.pathname?Qe="The URL's pathname is empty":_e.hash&&(Qe="The URL contains a fragment identifier"),Qe){const ye=new SyntaxError(Qe);if(w._redirects===0)throw ye;y(w,ye);return}const it=Re?443:80,ze=u(16).toString("base64"),Je=Re?r.get:n.get,He=new Set;let Fe;if(ie.createConnection=Re?ce:T,ie.defaultPort=ie.defaultPort||it,ie.port=_e.port||it,ie.host=_e.hostname.startsWith("[")?_e.hostname.slice(1,-1):_e.hostname,ie.headers={"Sec-WebSocket-Version":ie.protocolVersion,"Sec-WebSocket-Key":ze,Connection:"Upgrade",Upgrade:"websocket",...ie.headers},ie.path=_e.pathname+_e.search,ie.timeout=ie.handshakeTimeout,ie.perMessageDeflate&&(Fe=new _(ie.perMessageDeflate!==!0?ie.perMessageDeflate:{},!1,ie.maxPayload),ie.headers["Sec-WebSocket-Extensions"]=C({[_.extensionName]:Fe.offer()})),te.length){for(const ye of te){if(typeof ye!="string"||!ae.test(ye)||He.has(ye))throw new SyntaxError("An invalid or duplicated subprotocol was specified");He.add(ye)}ie.headers["Sec-WebSocket-Protocol"]=te.join(",")}if(ie.origin&&(ie.protocolVersion<13?ie.headers["Sec-WebSocket-Origin"]=ie.origin:ie.headers.Origin=ie.origin),(_e.username||_e.password)&&(ie.auth=`${_e.username}:${_e.password}`),ct){const ye=ie.path.split(":");ie.socketPath=ye[0],ie.path=ye[1]}if(ie.followRedirects){if(w._redirects===0){w._originalHost=_e.host;const ye=oe&&oe.headers;if(oe={...oe,headers:{}},ye)for(const[Ie,Ue]of Object.entries(ye))oe.headers[Ie.toLowerCase()]=Ue}else _e.host!==w._originalHost&&(delete ie.headers.authorization,delete ie.headers.cookie,delete ie.headers.host,ie.auth=void 0);ie.auth&&!oe.headers.authorization&&(oe.headers.authorization="Basic "+Buffer.from(ie.auth).toString("base64"))}let Oe=w._req=Je(ie);ie.timeout&&Oe.on("timeout",()=>{ue(w,Oe,"Opening handshake has timed out")}),Oe.on("error",ye=>{Oe===null||Oe.aborted||(Oe=w._req=null,y(w,ye))}),Oe.on("response",ye=>{const Ie=ye.headers.location,Ue=ye.statusCode;if(Ie&&ie.followRedirects&&Ue>=300&&Ue<400){if(++w._redirects>ie.maxRedirects){ue(w,Oe,"Maximum redirects exceeded");return}Oe.abort();let Xe;try{Xe=new p(Ie,$)}catch{const Ge=new SyntaxError(`Invalid URL: ${Ie}`);y(w,Ge);return}le(w,Xe,te,oe)}else w.emit("unexpected-response",Oe,ye)||ue(w,Oe,`Unexpected server response: ${ye.statusCode}`)}),Oe.on("upgrade",(ye,Ie,Ue)=>{if(w.emit("upgrade",ye),w.readyState!==W.CONNECTING)return;Oe=w._req=null;const Xe=l("sha1").update(ze+A).digest("base64");if(ye.headers["sec-websocket-accept"]!==Xe){ue(w,Ie,"Invalid Sec-WebSocket-Accept header");return}const je=ye.headers["sec-websocket-protocol"];let Ge;if(je!==void 0?He.size?He.has(je)||(Ge="Server sent an invalid subprotocol"):Ge="Server sent a subprotocol but none was requested":He.size&&(Ge="Server sent no subprotocol"),Ge){ue(w,Ie,Ge);return}je&&(w._protocol=je);const gt=ye.headers["sec-websocket-extensions"];if(gt!==void 0){if(!Fe){ue(w,Ie,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let St;try{St=S(gt)}catch{ue(w,Ie,"Invalid Sec-WebSocket-Extensions header");return}const Rt=Object.keys(St);if(Rt.length!==1||Rt[0]!==_.extensionName){ue(w,Ie,"Server indicated an extension that was not requested");return}try{Fe.accept(St[_.extensionName])}catch{ue(w,Ie,"Invalid Sec-WebSocket-Extensions header");return}w._extensions[_.extensionName]=Fe}w.setSocket(Ie,Ue,{generateMask:ie.generateMask,maxPayload:ie.maxPayload,skipUTF8Validation:ie.skipUTF8Validation})})}function y(w,$){w._readyState=W.CLOSING,w.emit("error",$),w.emitClose()}function T(w){return w.path=w.socketPath,i.connect(w)}function ce(w){return w.path=void 0,!w.servername&&w.servername!==""&&(w.servername=i.isIP(w.host)?"":w.host),o.connect(w)}function ue(w,$,te){w._readyState=W.CLOSING;const oe=new Error(te);Error.captureStackTrace(oe,ue),$.setHeader?($.abort(),$.socket&&!$.socket.destroyed&&$.socket.destroy(),$.once("abort",w.emitClose.bind(w)),w.emit("error",oe)):($.destroy(oe),$.once("error",w.emit.bind(w,"error")),$.once("close",w.emitClose.bind(w)))}function ne(w,$,te){if($){const oe=N($).length;w._socket?w._sender._bufferedBytes+=oe:w._bufferedAmount+=oe}if(te){const oe=new Error(`WebSocket is not open: readyState ${w.readyState} (${U[w.readyState]})`);te(oe)}}function J(w,$){const te=this[B];te._closeFrameReceived=!0,te._closeMessage=$,te._closeCode=w,te._socket[B]!==void 0&&(te._socket.removeListener("data",K),process.nextTick(nt,te._socket),w===1005?te.close():te.close(w,$))}function ee(){const w=this[B];w.isPaused||w._socket.resume()}function se(w){const $=this[B];$._socket[B]!==void 0&&($._socket.removeListener("data",K),process.nextTick(nt,$._socket),$.close(w[H])),$.emit("error",w)}function $e(){this[B].emitClose()}function Be(w,$){this[B].emit("message",w,$)}function nr(w){const $=this[B];$.pong(w,!$._isServer,z),$.emit("ping",w)}function xe(w){this[B].emit("pong",w)}function nt(w){w.resume()}function F(){const w=this[B];this.removeListener("close",F),this.removeListener("data",K),this.removeListener("end",M),w._readyState=W.CLOSING;let $;!this._readableState.endEmitted&&!w._closeFrameReceived&&!w._receiver._writableState.errorEmitted&&($=w._socket.read())!==null&&w._receiver.write($),w._receiver.end(),this[B]=void 0,clearTimeout(w._closeTimer),w._receiver._writableState.finished||w._receiver._writableState.errorEmitted?w.emitClose():(w._receiver.on("error",$e),w._receiver.on("finish",$e))}function K(w){this[B]._receiver.write(w)||this.pause()}function M(){const w=this[B];w._readyState=W.CLOSING,w._receiver.end(),this.end()}function h(){const w=this[B];this.removeListener("error",h),this.on("error",z),w&&(w._readyState=W.CLOSING,this.destroy())}return _c}var wc,Ol;function l0(){if(Ol)return wc;Ol=1;const{Duplex:a}=rr;function r(u){u.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function i(u){this.removeListener("error",i),this.destroy(),this.listenerCount("error")===0&&this.emit("error",u)}function o(u,l){let p=!0;const _=new a({...l,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return u.on("message",function(m,E){const P=!E&&_._readableState.objectMode?m.toString():m;_.push(P)||u.pause()}),u.once("error",function(m){_.destroyed||(p=!1,_.destroy(m))}),u.once("close",function(){_.destroyed||_.push(null)}),_._destroy=function(g,m){if(u.readyState===u.CLOSED){m(g),process.nextTick(r,_);return}let E=!1;u.once("error",function(A){E=!0,m(A)}),u.once("close",function(){E||m(g),process.nextTick(r,_)}),p&&u.terminate()},_._final=function(g){if(u.readyState===u.CONNECTING){u.once("open",function(){_._final(g)});return}u._socket!==null&&(u._socket._writableState.finished?(g(),_._readableState.endEmitted&&_.destroy()):(u._socket.once("finish",function(){g()}),u.close()))},_._read=function(){u.isPaused&&u.resume()},_._write=function(g,m,E){if(u.readyState===u.CONNECTING){u.once("open",function(){_._write(g,m,E)});return}u.send(g,E)},_.on("end",n),_.on("error",i),_}return wc=o,wc}var bc,Cl;function f0(){if(Cl)return bc;Cl=1;const{tokenChars:a}=Ao();function r(n){const i=new Set;let o=-1,u=-1,l=0;for(l;l<n.length;l++){const _=n.charCodeAt(l);if(u===-1&&a[_]===1)o===-1&&(o=l);else if(l!==0&&(_===32||_===9))u===-1&&o!==-1&&(u=l);else if(_===44){if(o===-1)throw new SyntaxError(`Unexpected character at index ${l}`);u===-1&&(u=l);const g=n.slice(o,u);if(i.has(g))throw new SyntaxError(`The "${g}" subprotocol is duplicated`);i.add(g),o=u=-1}else throw new SyntaxError(`Unexpected character at index ${l}`)}if(o===-1||u!==-1)throw new SyntaxError("Unexpected end of input");const p=n.slice(o,l);if(i.has(p))throw new SyntaxError(`The "${p}" subprotocol is duplicated`);return i.add(p),i}return bc={parse:r},bc}var Ec,Rl;function p0(){if(Rl)return Ec;Rl=1;const a=Wf(),r=rr,{createHash:n}=rr,i=Jf(),o=To(),u=f0(),l=Xf(),{GUID:p,kWebSocket:_}=Kn(),g=/^[+/0-9A-Za-z]{22}==$/,m=0,E=1,P=2;class A extends a{constructor(q,I){if(super(),q={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...q},q.port==null&&!q.server&&!q.noServer||q.port!=null&&(q.server||q.noServer)||q.server&&q.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(q.port!=null?(this._server=r.createServer((C,S)=>{const N=r.STATUS_CODES[426];S.writeHead(426,{"Content-Length":N.length,"Content-Type":"text/plain"}),S.end(N)}),this._server.listen(q.port,q.host,q.backlog,I)):q.server&&(this._server=q.server),this._server){const C=this.emit.bind(this,"connection");this._removeListeners=O(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(S,N,U)=>{this.handleUpgrade(S,N,U,C)}})}q.perMessageDeflate===!0&&(q.perMessageDeflate={}),q.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=q,this._state=m}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(q){if(this._state===P){q&&this.once("close",()=>{q(new Error("The server is not running"))}),process.nextTick(L,this);return}if(q&&this.once("close",q),this._state!==E)if(this._state=E,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(L,this):process.nextTick(L,this);else{const I=this._server;this._removeListeners(),this._removeListeners=this._server=null,I.close(()=>{L(this)})}}shouldHandle(q){if(this.options.path){const I=q.url.indexOf("?");if((I!==-1?q.url.slice(0,I):q.url)!==this.options.path)return!1}return!0}handleUpgrade(q,I,C,S){I.on("error",H);const N=q.headers["sec-websocket-key"]!==void 0?q.headers["sec-websocket-key"]:!1,U=+q.headers["sec-websocket-version"];if(q.method!=="GET"||q.headers.upgrade.toLowerCase()!=="websocket"||!N||!g.test(N)||U!==8&&U!==13||!this.shouldHandle(q))return B(I,400);const ae=q.headers["sec-websocket-protocol"];let Z=new Set;if(ae!==void 0)try{Z=u.parse(ae)}catch{return B(I,400)}const he=q.headers["sec-websocket-extensions"],W={};if(this.options.perMessageDeflate&&he!==void 0){const le=new o(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const y=i.parse(he);y[o.extensionName]&&(le.accept(y[o.extensionName]),W[o.extensionName]=le)}catch{return B(I,400)}}if(this.options.verifyClient){const le={origin:q.headers[`${U===8?"sec-websocket-origin":"origin"}`],secure:!!(q.socket.authorized||q.socket.encrypted),req:q};if(this.options.verifyClient.length===2){this.options.verifyClient(le,(y,T,ce,ue)=>{if(!y)return B(I,T||401,ce,ue);this.completeUpgrade(W,N,Z,q,I,C,S)});return}if(!this.options.verifyClient(le))return B(I,401)}this.completeUpgrade(W,N,Z,q,I,C,S)}completeUpgrade(q,I,C,S,N,U,ae){if(!N.readable||!N.writable)return N.destroy();if(N[_])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>m)return B(N,503);const he=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${n("sha1").update(I+p).digest("base64")}`],W=new this.options.WebSocket(null);if(C.size){const le=this.options.handleProtocols?this.options.handleProtocols(C,S):C.values().next().value;le&&(he.push(`Sec-WebSocket-Protocol: ${le}`),W._protocol=le)}if(q[o.extensionName]){const le=q[o.extensionName].params,y=i.format({[o.extensionName]:[le]});he.push(`Sec-WebSocket-Extensions: ${y}`),W._extensions=q}this.emit("headers",he,S),N.write(he.concat(`\r
`).join(`\r
`)),N.removeListener("error",H),W.setSocket(N,U,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(W),W.on("close",()=>{this.clients.delete(W),this._shouldEmitClose&&!this.clients.size&&process.nextTick(L,this)})),ae(W,S)}}Ec=A;function O(z,q){for(const I of Object.keys(q))z.on(I,q[I]);return function(){for(const C of Object.keys(q))z.removeListener(C,q[C])}}function L(z){z._state=P,z.emit("close")}function H(){this.destroy()}function B(z,q,I,C){z.writable&&(I=I||r.STATUS_CODES[q],C={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(I),...C},z.write(`HTTP/1.1 ${q} ${r.STATUS_CODES[q]}\r
`+Object.keys(C).map(S=>`${S}: ${C[S]}`).join(`\r
`)+`\r
\r
`+I)),z.removeListener("error",H),z.destroy()}return Ec}var Ic,Tl;function d0(){if(Tl)return Ic;Tl=1;const a=Xf();return a.createWebSocketStream=l0(),a.Server=p0(),a.Receiver=Yf(),a.Sender=Qf(),a.WebSocket=a,a.WebSocketServer=a.Server,Ic=a,Ic}var g0={};const v0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,y0=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,m0=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _0(a,r){if(a==="__proto__"||a==="constructor"&&r&&typeof r=="object"&&"prototype"in r){w0(a);return}return r}function w0(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function vo(a,r={}){if(typeof a!="string")return a;const n=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return n.slice(1,-1);if(n.length<=9){const i=n.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!m0.test(a)){if(r.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(v0.test(a)||y0.test(a)){if(r.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,_0)}return JSON.parse(a)}catch(i){if(r.strict)throw i;return a}}function b0(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Bt(a,...r){try{return b0(a(...r))}catch(n){return Promise.reject(n)}}function E0(a){const r=typeof a;return a===null||r!=="object"&&r!=="function"}function I0(a){const r=Object.getPrototypeOf(a);return!r||r.isPrototypeOf(Object)}function Io(a){if(E0(a))return String(a);if(I0(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return Io(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Zf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Uc="base64:";function S0(a){if(typeof a=="string")return a;Zf();const r=Buffer.from(a).toString("base64");return Uc+r}function x0(a){return typeof a!="string"||!a.startsWith(Uc)?a:(Zf(),Buffer.from(a.slice(Uc.length),"base64"))}function lr(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function P0(...a){return lr(a.join(":"))}function yo(a){return a=lr(a),a?a+":":""}const O0="memory",C0=()=>{const a=new Map;return{name:O0,options:{},hasItem(r){return a.has(r)},getItem(r){return a.get(r)??null},getItemRaw(r){return a.get(r)??null},setItem(r,n){a.set(r,n)},setItemRaw(r,n){a.set(r,n)},removeItem(r){a.delete(r)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function R0(a={}){const r={mounts:{"":a.driver||C0()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=g=>{for(const m of r.mountpoints)if(g.startsWith(m))return{base:m,relativeKey:g.slice(m.length),driver:r.mounts[m]};return{base:"",relativeKey:g,driver:r.mounts[""]}},i=(g,m)=>r.mountpoints.filter(E=>E.startsWith(g)||m&&g.startsWith(E)).map(E=>({relativeBase:g.length>E.length?g.slice(E.length):void 0,mountpoint:E,driver:r.mounts[E]})),o=(g,m)=>{if(r.watching){m=lr(m);for(const E of r.watchListeners)E(g,m)}},u=async()=>{if(!r.watching){r.watching=!0;for(const g in r.mounts)r.unwatch[g]=await Al(r.mounts[g],o,g)}},l=async()=>{if(r.watching){for(const g in r.unwatch)await r.unwatch[g]();r.unwatch={},r.watching=!1}},p=(g,m,E)=>{const P=new Map,A=O=>{let L=P.get(O.base);return L||(L={driver:O.driver,base:O.base,items:[]},P.set(O.base,L)),L};for(const O of g){const L=typeof O=="string",H=lr(L?O:O.key),B=L?void 0:O.value,z=L||!O.options?m:{...m,...O.options},q=n(H);A(q).items.push({key:H,value:B,relativeKey:q.relativeKey,options:z})}return Promise.all([...P.values()].map(O=>E(O))).then(O=>O.flat())},_={hasItem(g,m={}){g=lr(g);const{relativeKey:E,driver:P}=n(g);return Bt(P.hasItem,E,m)},getItem(g,m={}){g=lr(g);const{relativeKey:E,driver:P}=n(g);return Bt(P.getItem,E,m).then(A=>vo(A))},getItems(g,m){return p(g,m,E=>E.driver.getItems?Bt(E.driver.getItems,E.items.map(P=>({key:P.relativeKey,options:P.options})),m).then(P=>P.map(A=>({key:P0(E.base,A.key),value:vo(A.value)}))):Promise.all(E.items.map(P=>Bt(E.driver.getItem,P.relativeKey,P.options).then(A=>({key:P.key,value:vo(A)})))))},getItemRaw(g,m={}){g=lr(g);const{relativeKey:E,driver:P}=n(g);return P.getItemRaw?Bt(P.getItemRaw,E,m):Bt(P.getItem,E,m).then(A=>x0(A))},async setItem(g,m,E={}){if(m===void 0)return _.removeItem(g);g=lr(g);const{relativeKey:P,driver:A}=n(g);A.setItem&&(await Bt(A.setItem,P,Io(m),E),A.watch||o("update",g))},async setItems(g,m){await p(g,m,async E=>{E.driver.setItems&&await Bt(E.driver.setItems,E.items.map(P=>({key:P.relativeKey,value:Io(P.value),options:P.options})),m),E.driver.setItem&&await Promise.all(E.items.map(P=>Bt(E.driver.setItem,P.relativeKey,Io(P.value),P.options)))})},async setItemRaw(g,m,E={}){if(m===void 0)return _.removeItem(g,E);g=lr(g);const{relativeKey:P,driver:A}=n(g);if(A.setItemRaw)await Bt(A.setItemRaw,P,m,E);else if(A.setItem)await Bt(A.setItem,P,S0(m),E);else return;A.watch||o("update",g)},async removeItem(g,m={}){typeof m=="boolean"&&(m={removeMeta:m}),g=lr(g);const{relativeKey:E,driver:P}=n(g);P.removeItem&&(await Bt(P.removeItem,E,m),(m.removeMeta||m.removeMata)&&await Bt(P.removeItem,E+"$",m),P.watch||o("remove",g))},async getMeta(g,m={}){typeof m=="boolean"&&(m={nativeOnly:m}),g=lr(g);const{relativeKey:E,driver:P}=n(g),A=Object.create(null);if(P.getMeta&&Object.assign(A,await Bt(P.getMeta,E,m)),!m.nativeOnly){const O=await Bt(P.getItem,E+"$",m).then(L=>vo(L));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(A,O))}return A},setMeta(g,m,E={}){return this.setItem(g+"$",m,E)},removeMeta(g,m={}){return this.removeItem(g+"$",m)},async getKeys(g,m={}){g=yo(g);const E=i(g,!0);let P=[];const A=[];for(const O of E){const L=(await Bt(O.driver.getKeys,O.relativeBase,m)).map(H=>O.mountpoint+lr(H)).filter(H=>!P.some(B=>H.startsWith(B)));A.push(...L),P=[O.mountpoint,...P.filter(H=>!H.startsWith(O.mountpoint))]}return g?A.filter(O=>O.startsWith(g)&&!O.endsWith("$")):A.filter(O=>!O.endsWith("$"))},async clear(g,m={}){g=yo(g),await Promise.all(i(g,!1).map(async E=>{if(E.driver.clear)return Bt(E.driver.clear,E.relativeBase,m);if(E.driver.removeItem){const P=await E.driver.getKeys(E.relativeBase||"",m);return Promise.all(P.map(A=>E.driver.removeItem(A,m)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(g=>Nl(g)))},async watch(g){return await u(),r.watchListeners.push(g),async()=>{r.watchListeners=r.watchListeners.filter(m=>m!==g),r.watchListeners.length===0&&await l()}},async unwatch(){r.watchListeners=[],await l()},mount(g,m){if(g=yo(g),g&&r.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(r.mountpoints.push(g),r.mountpoints.sort((E,P)=>P.length-E.length)),r.mounts[g]=m,r.watching&&Promise.resolve(Al(m,o,g)).then(E=>{r.unwatch[g]=E}).catch(console.error),_},async unmount(g,m=!0){g=yo(g),!(!g||!r.mounts[g])&&(r.watching&&g in r.unwatch&&(r.unwatch[g](),delete r.unwatch[g]),m&&await Nl(r.mounts[g]),r.mountpoints=r.mountpoints.filter(E=>E!==g),delete r.mounts[g])},getMount(g=""){g=lr(g)+":";const m=n(g);return{driver:m.driver,base:m.base}},getMounts(g="",m={}){return g=lr(g),i(g,m.parents).map(E=>({driver:E.driver,base:E.mountpoint}))}};return _}function Al(a,r,n){return a.watch?a.watch((i,o)=>r(i,n+o)):()=>{}}async function Nl(a){typeof a.dispose=="function"&&await Bt(a.dispose)}function Fn(a){return new Promise((r,n)=>{a.oncomplete=a.onsuccess=()=>r(a.result),a.onabort=a.onerror=()=>n(a.error)})}function ep(a,r){const n=indexedDB.open(a);n.onupgradeneeded=()=>n.result.createObjectStore(r);const i=Fn(n);return(o,u)=>i.then(l=>u(l.transaction(r,o).objectStore(r)))}let Sc;function ts(){return Sc||(Sc=ep("keyval-store","keyval")),Sc}function Ll(a,r=ts()){return r("readonly",n=>Fn(n.get(a)))}function T0(a,r,n=ts()){return n("readwrite",i=>(i.put(r,a),Fn(i.transaction)))}function A0(a,r=ts()){return r("readwrite",n=>(n.delete(a),Fn(n.transaction)))}function N0(a=ts()){return a("readwrite",r=>(r.clear(),Fn(r.transaction)))}function L0(a,r){return a.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},Fn(a.transaction)}function D0(a=ts()){return a("readonly",r=>{if(r.getAllKeys)return Fn(r.getAllKeys());const n=[];return L0(r,i=>n.push(i.key)).then(()=>n)})}const k0=a=>JSON.stringify(a,(r,n)=>typeof n=="bigint"?n.toString()+"n":n),j0=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=a.replace(r,'$1"$2n"$3');return JSON.parse(n,(i,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function rs(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return j0(a)}catch{return a}}function Vn(a){return typeof a=="string"?a:k0(a)||""}const M0="idb-keyval";var q0=(a={})=>{const r=a.base&&a.base.length>0?`${a.base}:`:"",n=o=>r+o;let i;return a.dbName&&a.storeName&&(i=ep(a.dbName,a.storeName)),{name:M0,options:a,async hasItem(o){return!(typeof await Ll(n(o),i)>"u")},async getItem(o){return await Ll(n(o),i)??null},setItem(o,u){return T0(n(o),u,i)},removeItem(o){return A0(n(o),i)},getKeys(){return D0(i)},clear(){return N0(i)}}};const U0="WALLET_CONNECT_V2_INDEXED_DB",z0="keyvaluestorage";let $0=class{constructor(){this.indexedDb=R0({driver:q0({dbName:U0,storeName:z0})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(a=>[a.key,a.value])}async getItem(a){const r=await this.indexedDb.getItem(a);if(r!==null)return r}async setItem(a,r){await this.indexedDb.setItem(a,Vn(r))}async removeItem(a){await this.indexedDb.removeItem(a)}};var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},So={exports:{}};(function(){let a;function r(){}a=r,a.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},a.prototype.setItem=function(n,i){this[n]=String(i)},a.prototype.removeItem=function(n){delete this[n]},a.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(i){n[i]=void 0,delete n[i]})},a.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof xc<"u"&&xc.localStorage?So.exports=xc.localStorage:typeof window<"u"&&window.localStorage?So.exports=window.localStorage:So.exports=new r})();function B0(a){var r;return[a[0],rs((r=a[1])!=null?r:"")]}class H0{constructor(){this.localStorage=So.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(B0)}async getItem(r){const n=this.localStorage.getItem(r);if(n!==null)return rs(n)}async setItem(r,n){this.localStorage.setItem(r,Vn(n))}async removeItem(r){this.localStorage.removeItem(r)}}const V0="wc_storage_version",Dl=1,K0=async(a,r,n)=>{const i=V0,o=await r.getItem(i);if(o&&o>=Dl){n(r);return}const u=await a.getKeys();if(!u.length){n(r);return}const l=[];for(;u.length;){const p=u.shift();if(!p)continue;const _=p.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const g=await a.getItem(p);await r.setItem(p,g),l.push(p)}}await r.setItem(i,Dl),n(r),F0(a,l)},F0=async(a,r)=>{r.length&&r.forEach(async n=>{await a.removeItem(n)})};let W0=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const a=new H0;this.storage=a;try{const r=new $0;K0(a,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(a){return await this.initialize(),this.storage.getItem(a)}async setItem(a,r){return await this.initialize(),this.storage.setItem(a,r)}async removeItem(a){return await this.initialize(),this.storage.removeItem(a)}async initialize(){this.initialized||await new Promise(a=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),a())},20)})}};var Ii={},Hi={},kl={},Vi={};let Wn=class{};const G0=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Wn},Symbol.toStringTag,{value:"Module"})),Y0=qf(G0);var jl;function Q0(){if(jl)return Vi;jl=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.IHeartBeat=void 0;const a=Y0;class r extends a.IEvents{constructor(i){super()}}return Vi.IHeartBeat=r,Vi}var Ml;function tp(){return Ml||(Ml=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Ei.__exportStar(Q0(),a)}(kl)),kl}var ql={},Hn={},Ul;function J0(){if(Ul)return Hn;Ul=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.HEARTBEAT_EVENTS=Hn.HEARTBEAT_INTERVAL=void 0;const a=me;return Hn.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hn}var zl;function rp(){return zl||(zl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Ei.__exportStar(J0(),a)}(ql)),ql}var $l;function X0(){if($l)return Hi;$l=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HeartBeat=void 0;const a=Ei,r=Rr,n=me,i=tp(),o=rp();class u extends i.IHeartBeat{constructor(p){super(p),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||o.HEARTBEAT_INTERVAL}static init(p){return a.__awaiter(this,void 0,void 0,function*(){const _=new u(p);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,_){this.events.on(p,_)}once(p,_){this.events.once(p,_)}off(p,_){this.events.off(p,_)}removeListener(p,_){this.events.removeListener(p,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),n.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Hi.HeartBeat=u,Hi}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Ei;r.__exportStar(X0(),a),r.__exportStar(tp(),a),r.__exportStar(rp(),a)})(Ii);var ke={},Pc,Bl;function Z0(){if(Bl)return Pc;Bl=1;function a(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}Pc=r;function r(n,i,o){var u=o&&o.stringify||a,l=1;if(typeof n=="object"&&n!==null){var p=i.length+l;if(p===1)return n;var _=new Array(p);_[0]=u(n);for(var g=1;g<p;g++)_[g]=u(i[g]);return _.join(" ")}if(typeof n!="string")return n;var m=i.length;if(m===0)return n;for(var E="",P=1-l,A=-1,O=n&&n.length||0,L=0;L<O;){if(n.charCodeAt(L)===37&&L+1<O){switch(A=A>-1?A:0,n.charCodeAt(L+1)){case 100:case 102:if(P>=m||i[P]==null)break;A<L&&(E+=n.slice(A,L)),E+=Number(i[P]),A=L+2,L++;break;case 105:if(P>=m||i[P]==null)break;A<L&&(E+=n.slice(A,L)),E+=Math.floor(Number(i[P])),A=L+2,L++;break;case 79:case 111:case 106:if(P>=m||i[P]===void 0)break;A<L&&(E+=n.slice(A,L));var H=typeof i[P];if(H==="string"){E+="'"+i[P]+"'",A=L+2,L++;break}if(H==="function"){E+=i[P].name||"<anonymous>",A=L+2,L++;break}E+=u(i[P]),A=L+2,L++;break;case 115:if(P>=m)break;A<L&&(E+=n.slice(A,L)),E+=String(i[P]),A=L+2,L++;break;case 37:A<L&&(E+=n.slice(A,L)),E+="%",A=L+2,L++,P--;break}++P}++L}return A===-1?n:(A<O&&(E+=n.slice(A)),E)}return Pc}var Oc,Hl;function eb(){if(Hl)return Oc;Hl=1;const a=Z0();Oc=o;const r=C().console||{},n={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:L,wrapResponseSerializer:L,wrapErrorSerializer:L,req:O,res:O,err:P};function i(S,N){return Array.isArray(S)?S.filter(function(U){return U!=="!stdSerializers.err"}):S===!0?Object.keys(N):!1}function o(S){S=S||{},S.browser=S.browser||{};const N=S.browser.transmit;if(N&&typeof N.send!="function")throw Error("pino: transmit option must have a send function");const U=S.browser.write||r;S.browser.write&&(S.browser.asObject=!0);const ae=S.serializers||{},Z=i(S.browser.serialize,ae);let he=S.browser.serialize;Array.isArray(S.browser.serialize)&&S.browser.serialize.indexOf("!stdSerializers.err")>-1&&(he=!1);const W=["error","fatal","warn","info","debug","trace"];typeof U=="function"&&(U.error=U.fatal=U.warn=U.info=U.debug=U.trace=U),S.enabled===!1&&(S.level="silent");const le=S.level||"info",y=Object.create(U);y.log||(y.log=H),Object.defineProperty(y,"levelVal",{get:ce}),Object.defineProperty(y,"level",{get:ue,set:ne});const T={transmit:N,serialize:Z,asObject:S.browser.asObject,levels:W,timestamp:A(S)};y.levels=o.levels,y.level=le,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=H,y.serializers=ae,y._serialize=Z,y._stdErrSerialize=he,y.child=J,N&&(y._logEvent=E());function ce(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ue(){return this._level}function ne(ee){if(ee!=="silent"&&!this.levels.values[ee])throw Error("unknown level "+ee);this._level=ee,u(T,y,"error","log"),u(T,y,"fatal","error"),u(T,y,"warn","error"),u(T,y,"info","log"),u(T,y,"debug","log"),u(T,y,"trace","log")}function J(ee,se){if(!ee)throw new Error("missing bindings for child Pino");se=se||{},Z&&ee.serializers&&(se.serializers=ee.serializers);const $e=se.serializers;if(Z&&$e){var Be=Object.assign({},ae,$e),nr=S.browser.serialize===!0?Object.keys(Be):Z;delete ee.serializers,_([ee],nr,Be,this._stdErrSerialize)}function xe(nt){this._childLevel=(nt._childLevel|0)+1,this.error=g(nt,ee,"error"),this.fatal=g(nt,ee,"fatal"),this.warn=g(nt,ee,"warn"),this.info=g(nt,ee,"info"),this.debug=g(nt,ee,"debug"),this.trace=g(nt,ee,"trace"),Be&&(this.serializers=Be,this._serialize=nr),N&&(this._logEvent=E([].concat(nt._logEvent.bindings,ee)))}return xe.prototype=this,new xe(this)}return y}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=n,o.stdTimeFunctions=Object.assign({},{nullTime:B,epochTime:z,unixTime:q,isoTime:I});function u(S,N,U,ae){const Z=Object.getPrototypeOf(N);N[U]=N.levelVal>N.levels.values[U]?H:Z[U]?Z[U]:r[U]||r[ae]||H,l(S,N,U)}function l(S,N,U){!S.transmit&&N[U]===H||(N[U]=function(ae){return function(){const Z=S.timestamp(),he=new Array(arguments.length),W=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var le=0;le<he.length;le++)he[le]=arguments[le];if(S.serialize&&!S.asObject&&_(he,this._serialize,this.serializers,this._stdErrSerialize),S.asObject?ae.call(W,p(this,U,he,Z)):ae.apply(W,he),S.transmit){const y=S.transmit.level||N.level,T=o.levels.values[y],ce=o.levels.values[U];if(ce<T)return;m(this,{ts:Z,methodLevel:U,methodValue:ce,transmitLevel:y,transmitValue:o.levels.values[S.transmit.level||N.level],send:S.transmit.send,val:N.levelVal},he)}}}(N[U]))}function p(S,N,U,ae){S._serialize&&_(U,S._serialize,S.serializers,S._stdErrSerialize);const Z=U.slice();let he=Z[0];const W={};ae&&(W.time=ae),W.level=o.levels.values[N];let le=(S._childLevel|0)+1;if(le<1&&(le=1),he!==null&&typeof he=="object"){for(;le--&&typeof Z[0]=="object";)Object.assign(W,Z.shift());he=Z.length?a(Z.shift(),Z):void 0}else typeof he=="string"&&(he=a(Z.shift(),Z));return he!==void 0&&(W.msg=he),W}function _(S,N,U,ae){for(const Z in S)if(ae&&S[Z]instanceof Error)S[Z]=o.stdSerializers.err(S[Z]);else if(typeof S[Z]=="object"&&!Array.isArray(S[Z]))for(const he in S[Z])N&&N.indexOf(he)>-1&&he in U&&(S[Z][he]=U[he](S[Z][he]))}function g(S,N,U){return function(){const ae=new Array(1+arguments.length);ae[0]=N;for(var Z=1;Z<ae.length;Z++)ae[Z]=arguments[Z-1];return S[U].apply(this,ae)}}function m(S,N,U){const ae=N.send,Z=N.ts,he=N.methodLevel,W=N.methodValue,le=N.val,y=S._logEvent.bindings;_(U,S._serialize||Object.keys(S.serializers),S.serializers,S._stdErrSerialize===void 0?!0:S._stdErrSerialize),S._logEvent.ts=Z,S._logEvent.messages=U.filter(function(T){return y.indexOf(T)===-1}),S._logEvent.level.label=he,S._logEvent.level.value=W,ae(he,S._logEvent,le),S._logEvent=E(y)}function E(S){return{ts:0,messages:[],bindings:S||[],level:{label:"",value:0}}}function P(S){const N={type:S.constructor.name,msg:S.message,stack:S.stack};for(const U in S)N[U]===void 0&&(N[U]=S[U]);return N}function A(S){return typeof S.timestamp=="function"?S.timestamp:S.timestamp===!1?B:z}function O(){return{}}function L(S){return S}function H(){}function B(){return!1}function z(){return Date.now()}function q(){return Math.round(Date.now()/1e3)}function I(){return new Date(Date.now()).toISOString()}function C(){function S(N){return typeof N<"u"&&N}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return S(self)||S(window)||S(this)||{}}}return Oc}var gi={},Vl;function np(){return Vl||(Vl=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.PINO_CUSTOM_CONTEXT_KEY=gi.PINO_LOGGER_DEFAULTS=void 0,gi.PINO_LOGGER_DEFAULTS={level:"info"},gi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),gi}var tr={},Kl;function tb(){if(Kl)return tr;Kl=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const a=np();function r(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||a.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=r;function n(p,_=a.PINO_CUSTOM_CONTEXT_KEY){return p[_]||""}tr.getBrowserLoggerContext=n;function i(p,_,g=a.PINO_CUSTOM_CONTEXT_KEY){return p[g]=_,p}tr.setBrowserLoggerContext=i;function o(p,_=a.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof p.bindings>"u"?g=n(p,_):g=p.bindings().context||"",g}tr.getLoggerContext=o;function u(p,_,g=a.PINO_CUSTOM_CONTEXT_KEY){const m=o(p,g);return m.trim()?`${m}/${_}`:_}tr.formatChildLoggerContext=u;function l(p,_,g=a.PINO_CUSTOM_CONTEXT_KEY){const m=u(p,_,g),E=p.child({context:m});return i(E,m,g)}return tr.generateChildLogger=l,tr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=Ei,n=r.__importDefault(eb());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return n.default}}),r.__exportStar(np(),a),r.__exportStar(tb(),a)})(ke);class rb extends Wn{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}let nb=class extends Wn{constructor(a,r){super(),this.core=a,this.logger=r,this.records=new Map}},ib=class{constructor(a,r){this.logger=a,this.core=r}},sb=class extends Wn{constructor(a,r){super(),this.relayer=a,this.logger=r}},ob=class extends Wn{constructor(a){super()}},ab=class{constructor(a,r,n,i){this.core=a,this.logger=r,this.name=n}};class cb extends Wn{constructor(r,n){super(),this.relayer=r,this.logger=n}}let ub=class extends Wn{constructor(a,r){super(),this.core=a,this.logger=r}},hb=class{constructor(a,r){this.projectId=a,this.logger=r}},lb=class{constructor(a,r){this.projectId=a,this.logger=r}},fb=class{constructor(a){this.opts=a,this.protocol="wc",this.version=2}},pb=class{constructor(a){this.client=a}};var Qc={},ip={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=vw,n=Uf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var i=function(){function p(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){n.wipe(this._buffer),n.wipe(this._tempHi),n.wipe(this._tempLo),this.reset()},p.prototype.update=function(_,g){if(g===void 0&&(g=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=_[m++],g--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=_[m++],g--;return this},p.prototype.finish=function(_){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,E=g/536870912|0,P=g<<3,A=g%128<112?128:256;this._buffer[m]=128;for(var O=m+1;O<A-8;O++)this._buffer[O]=0;r.writeUint32BE(E,this._buffer,A-8),r.writeUint32BE(P,this._buffer,A-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)r.writeUint32BE(this._stateHi[O],_,O*8),r.writeUint32BE(this._stateLo[O],_,O*8+4);return this},p.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(_){n.wipe(_.stateHi),n.wipe(_.stateLo),_.buffer&&n.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},p}();a.SHA512=i;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(p,_,g,m,E,P,A){for(var O=g[0],L=g[1],H=g[2],B=g[3],z=g[4],q=g[5],I=g[6],C=g[7],S=m[0],N=m[1],U=m[2],ae=m[3],Z=m[4],he=m[5],W=m[6],le=m[7],y,T,ce,ue,ne,J,ee,se;A>=128;){for(var $e=0;$e<16;$e++){var Be=8*$e+P;p[$e]=r.readUint32BE(E,Be),_[$e]=r.readUint32BE(E,Be+4)}for(var $e=0;$e<80;$e++){var nr=O,xe=L,nt=H,F=B,K=z,M=q,h=I,w=C,$=S,te=N,oe=U,ie=ae,_e=Z,Re=he,ct=W,Qe=le;if(y=C,T=le,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=(z>>>14|Z<<18)^(z>>>18|Z<<14)^(Z>>>9|z<<23),T=(Z>>>14|z<<18)^(Z>>>18|z<<14)^(z>>>9|Z<<23),ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,y=z&q^~z&I,T=Z&he^~Z&W,ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,y=o[$e*2],T=o[$e*2+1],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,y=p[$e%16],T=_[$e%16],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,ce=ee&65535|se<<16,ue=ne&65535|J<<16,y=ce,T=ue,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=(O>>>28|S<<4)^(S>>>2|O<<30)^(S>>>7|O<<25),T=(S>>>28|O<<4)^(O>>>2|S<<30)^(O>>>7|S<<25),ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,y=O&L^O&H^L&H,T=S&N^S&U^N&U,ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,w=ee&65535|se<<16,Qe=ne&65535|J<<16,y=F,T=ie,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=ce,T=ue,ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,F=ee&65535|se<<16,ie=ne&65535|J<<16,L=nr,H=xe,B=nt,z=F,q=K,I=M,C=h,O=w,N=$,U=te,ae=oe,Z=ie,he=_e,W=Re,le=ct,S=Qe,$e%16===15)for(var Be=0;Be<16;Be++)y=p[Be],T=_[Be],ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=p[(Be+9)%16],T=_[(Be+9)%16],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,ce=p[(Be+1)%16],ue=_[(Be+1)%16],y=(ce>>>1|ue<<31)^(ce>>>8|ue<<24)^ce>>>7,T=(ue>>>1|ce<<31)^(ue>>>8|ce<<24)^(ue>>>7|ce<<25),ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,ce=p[(Be+14)%16],ue=_[(Be+14)%16],y=(ce>>>19|ue<<13)^(ue>>>29|ce<<3)^ce>>>6,T=(ue>>>19|ce<<13)^(ce>>>29|ue<<3)^(ue>>>6|ce<<26),ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,p[Be]=ee&65535|se<<16,_[Be]=ne&65535|J<<16}y=O,T=S,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[0],T=m[0],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[0]=O=ee&65535|se<<16,m[0]=S=ne&65535|J<<16,y=L,T=N,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[1],T=m[1],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[1]=L=ee&65535|se<<16,m[1]=N=ne&65535|J<<16,y=H,T=U,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[2],T=m[2],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[2]=H=ee&65535|se<<16,m[2]=U=ne&65535|J<<16,y=B,T=ae,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[3],T=m[3],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[3]=B=ee&65535|se<<16,m[3]=ae=ne&65535|J<<16,y=z,T=Z,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[4],T=m[4],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[4]=z=ee&65535|se<<16,m[4]=Z=ne&65535|J<<16,y=q,T=he,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[5],T=m[5],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[5]=q=ee&65535|se<<16,m[5]=he=ne&65535|J<<16,y=I,T=W,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[6],T=m[6],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[6]=I=ee&65535|se<<16,m[6]=W=ne&65535|J<<16,y=C,T=le,ne=T&65535,J=T>>>16,ee=y&65535,se=y>>>16,y=g[7],T=m[7],ne+=T&65535,J+=T>>>16,ee+=y&65535,se+=y>>>16,J+=ne>>>16,ee+=J>>>16,se+=ee>>>16,g[7]=C=ee&65535|se<<16,m[7]=le=ne&65535|J<<16,P+=128,A-=128}return P}function l(p){var _=new i;_.update(p);var g=_.digest();return _.clean(),g}a.hash=l})(ip);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=zf,n=ip,i=Uf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(F){const K=new Float64Array(16);if(F)for(let M=0;M<F.length;M++)K[M]=F[M];return K}const u=new Uint8Array(32);u[0]=9;const l=o(),p=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),P=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(F,K){for(let M=0;M<16;M++)F[M]=K[M]|0}function O(F){let K=1;for(let M=0;M<16;M++){let h=F[M]+K+65535;K=Math.floor(h/65536),F[M]=h-K*65536}F[0]+=K-1+37*(K-1)}function L(F,K,M){const h=~(M-1);for(let w=0;w<16;w++){const $=h&(F[w]^K[w]);F[w]^=$,K[w]^=$}}function H(F,K){const M=o(),h=o();for(let w=0;w<16;w++)h[w]=K[w];O(h),O(h),O(h);for(let w=0;w<2;w++){M[0]=h[0]-65517;for(let te=1;te<15;te++)M[te]=h[te]-65535-(M[te-1]>>16&1),M[te-1]&=65535;M[15]=h[15]-32767-(M[14]>>16&1);const $=M[15]>>16&1;M[14]&=65535,L(h,M,1-$)}for(let w=0;w<16;w++)F[2*w]=h[w]&255,F[2*w+1]=h[w]>>8}function B(F,K){let M=0;for(let h=0;h<32;h++)M|=F[h]^K[h];return(1&M-1>>>8)-1}function z(F,K){const M=new Uint8Array(32),h=new Uint8Array(32);return H(M,F),H(h,K),B(M,h)}function q(F){const K=new Uint8Array(32);return H(K,F),K[0]&1}function I(F,K){for(let M=0;M<16;M++)F[M]=K[2*M]+(K[2*M+1]<<8);F[15]&=32767}function C(F,K,M){for(let h=0;h<16;h++)F[h]=K[h]+M[h]}function S(F,K,M){for(let h=0;h<16;h++)F[h]=K[h]-M[h]}function N(F,K,M){let h,w,$=0,te=0,oe=0,ie=0,_e=0,Re=0,ct=0,Qe=0,it=0,ze=0,Je=0,He=0,Fe=0,Oe=0,ye=0,Ie=0,Ue=0,Xe=0,je=0,Ge=0,gt=0,St=0,Rt=0,vt=0,Ht=0,ir=0,zr=0,Qt=0,Wr=0,pn=0,Rn=0,yt=M[0],ut=M[1],mt=M[2],_t=M[3],pt=M[4],ht=M[5],Tt=M[6],At=M[7],wt=M[8],Nt=M[9],bt=M[10],xt=M[11],Et=M[12],st=M[13],Lt=M[14],Dt=M[15];h=K[0],$+=h*yt,te+=h*ut,oe+=h*mt,ie+=h*_t,_e+=h*pt,Re+=h*ht,ct+=h*Tt,Qe+=h*At,it+=h*wt,ze+=h*Nt,Je+=h*bt,He+=h*xt,Fe+=h*Et,Oe+=h*st,ye+=h*Lt,Ie+=h*Dt,h=K[1],te+=h*yt,oe+=h*ut,ie+=h*mt,_e+=h*_t,Re+=h*pt,ct+=h*ht,Qe+=h*Tt,it+=h*At,ze+=h*wt,Je+=h*Nt,He+=h*bt,Fe+=h*xt,Oe+=h*Et,ye+=h*st,Ie+=h*Lt,Ue+=h*Dt,h=K[2],oe+=h*yt,ie+=h*ut,_e+=h*mt,Re+=h*_t,ct+=h*pt,Qe+=h*ht,it+=h*Tt,ze+=h*At,Je+=h*wt,He+=h*Nt,Fe+=h*bt,Oe+=h*xt,ye+=h*Et,Ie+=h*st,Ue+=h*Lt,Xe+=h*Dt,h=K[3],ie+=h*yt,_e+=h*ut,Re+=h*mt,ct+=h*_t,Qe+=h*pt,it+=h*ht,ze+=h*Tt,Je+=h*At,He+=h*wt,Fe+=h*Nt,Oe+=h*bt,ye+=h*xt,Ie+=h*Et,Ue+=h*st,Xe+=h*Lt,je+=h*Dt,h=K[4],_e+=h*yt,Re+=h*ut,ct+=h*mt,Qe+=h*_t,it+=h*pt,ze+=h*ht,Je+=h*Tt,He+=h*At,Fe+=h*wt,Oe+=h*Nt,ye+=h*bt,Ie+=h*xt,Ue+=h*Et,Xe+=h*st,je+=h*Lt,Ge+=h*Dt,h=K[5],Re+=h*yt,ct+=h*ut,Qe+=h*mt,it+=h*_t,ze+=h*pt,Je+=h*ht,He+=h*Tt,Fe+=h*At,Oe+=h*wt,ye+=h*Nt,Ie+=h*bt,Ue+=h*xt,Xe+=h*Et,je+=h*st,Ge+=h*Lt,gt+=h*Dt,h=K[6],ct+=h*yt,Qe+=h*ut,it+=h*mt,ze+=h*_t,Je+=h*pt,He+=h*ht,Fe+=h*Tt,Oe+=h*At,ye+=h*wt,Ie+=h*Nt,Ue+=h*bt,Xe+=h*xt,je+=h*Et,Ge+=h*st,gt+=h*Lt,St+=h*Dt,h=K[7],Qe+=h*yt,it+=h*ut,ze+=h*mt,Je+=h*_t,He+=h*pt,Fe+=h*ht,Oe+=h*Tt,ye+=h*At,Ie+=h*wt,Ue+=h*Nt,Xe+=h*bt,je+=h*xt,Ge+=h*Et,gt+=h*st,St+=h*Lt,Rt+=h*Dt,h=K[8],it+=h*yt,ze+=h*ut,Je+=h*mt,He+=h*_t,Fe+=h*pt,Oe+=h*ht,ye+=h*Tt,Ie+=h*At,Ue+=h*wt,Xe+=h*Nt,je+=h*bt,Ge+=h*xt,gt+=h*Et,St+=h*st,Rt+=h*Lt,vt+=h*Dt,h=K[9],ze+=h*yt,Je+=h*ut,He+=h*mt,Fe+=h*_t,Oe+=h*pt,ye+=h*ht,Ie+=h*Tt,Ue+=h*At,Xe+=h*wt,je+=h*Nt,Ge+=h*bt,gt+=h*xt,St+=h*Et,Rt+=h*st,vt+=h*Lt,Ht+=h*Dt,h=K[10],Je+=h*yt,He+=h*ut,Fe+=h*mt,Oe+=h*_t,ye+=h*pt,Ie+=h*ht,Ue+=h*Tt,Xe+=h*At,je+=h*wt,Ge+=h*Nt,gt+=h*bt,St+=h*xt,Rt+=h*Et,vt+=h*st,Ht+=h*Lt,ir+=h*Dt,h=K[11],He+=h*yt,Fe+=h*ut,Oe+=h*mt,ye+=h*_t,Ie+=h*pt,Ue+=h*ht,Xe+=h*Tt,je+=h*At,Ge+=h*wt,gt+=h*Nt,St+=h*bt,Rt+=h*xt,vt+=h*Et,Ht+=h*st,ir+=h*Lt,zr+=h*Dt,h=K[12],Fe+=h*yt,Oe+=h*ut,ye+=h*mt,Ie+=h*_t,Ue+=h*pt,Xe+=h*ht,je+=h*Tt,Ge+=h*At,gt+=h*wt,St+=h*Nt,Rt+=h*bt,vt+=h*xt,Ht+=h*Et,ir+=h*st,zr+=h*Lt,Qt+=h*Dt,h=K[13],Oe+=h*yt,ye+=h*ut,Ie+=h*mt,Ue+=h*_t,Xe+=h*pt,je+=h*ht,Ge+=h*Tt,gt+=h*At,St+=h*wt,Rt+=h*Nt,vt+=h*bt,Ht+=h*xt,ir+=h*Et,zr+=h*st,Qt+=h*Lt,Wr+=h*Dt,h=K[14],ye+=h*yt,Ie+=h*ut,Ue+=h*mt,Xe+=h*_t,je+=h*pt,Ge+=h*ht,gt+=h*Tt,St+=h*At,Rt+=h*wt,vt+=h*Nt,Ht+=h*bt,ir+=h*xt,zr+=h*Et,Qt+=h*st,Wr+=h*Lt,pn+=h*Dt,h=K[15],Ie+=h*yt,Ue+=h*ut,Xe+=h*mt,je+=h*_t,Ge+=h*pt,gt+=h*ht,St+=h*Tt,Rt+=h*At,vt+=h*wt,Ht+=h*Nt,ir+=h*bt,zr+=h*xt,Qt+=h*Et,Wr+=h*st,pn+=h*Lt,Rn+=h*Dt,$+=38*Ue,te+=38*Xe,oe+=38*je,ie+=38*Ge,_e+=38*gt,Re+=38*St,ct+=38*Rt,Qe+=38*vt,it+=38*Ht,ze+=38*ir,Je+=38*zr,He+=38*Qt,Fe+=38*Wr,Oe+=38*pn,ye+=38*Rn,w=1,h=$+w+65535,w=Math.floor(h/65536),$=h-w*65536,h=te+w+65535,w=Math.floor(h/65536),te=h-w*65536,h=oe+w+65535,w=Math.floor(h/65536),oe=h-w*65536,h=ie+w+65535,w=Math.floor(h/65536),ie=h-w*65536,h=_e+w+65535,w=Math.floor(h/65536),_e=h-w*65536,h=Re+w+65535,w=Math.floor(h/65536),Re=h-w*65536,h=ct+w+65535,w=Math.floor(h/65536),ct=h-w*65536,h=Qe+w+65535,w=Math.floor(h/65536),Qe=h-w*65536,h=it+w+65535,w=Math.floor(h/65536),it=h-w*65536,h=ze+w+65535,w=Math.floor(h/65536),ze=h-w*65536,h=Je+w+65535,w=Math.floor(h/65536),Je=h-w*65536,h=He+w+65535,w=Math.floor(h/65536),He=h-w*65536,h=Fe+w+65535,w=Math.floor(h/65536),Fe=h-w*65536,h=Oe+w+65535,w=Math.floor(h/65536),Oe=h-w*65536,h=ye+w+65535,w=Math.floor(h/65536),ye=h-w*65536,h=Ie+w+65535,w=Math.floor(h/65536),Ie=h-w*65536,$+=w-1+37*(w-1),w=1,h=$+w+65535,w=Math.floor(h/65536),$=h-w*65536,h=te+w+65535,w=Math.floor(h/65536),te=h-w*65536,h=oe+w+65535,w=Math.floor(h/65536),oe=h-w*65536,h=ie+w+65535,w=Math.floor(h/65536),ie=h-w*65536,h=_e+w+65535,w=Math.floor(h/65536),_e=h-w*65536,h=Re+w+65535,w=Math.floor(h/65536),Re=h-w*65536,h=ct+w+65535,w=Math.floor(h/65536),ct=h-w*65536,h=Qe+w+65535,w=Math.floor(h/65536),Qe=h-w*65536,h=it+w+65535,w=Math.floor(h/65536),it=h-w*65536,h=ze+w+65535,w=Math.floor(h/65536),ze=h-w*65536,h=Je+w+65535,w=Math.floor(h/65536),Je=h-w*65536,h=He+w+65535,w=Math.floor(h/65536),He=h-w*65536,h=Fe+w+65535,w=Math.floor(h/65536),Fe=h-w*65536,h=Oe+w+65535,w=Math.floor(h/65536),Oe=h-w*65536,h=ye+w+65535,w=Math.floor(h/65536),ye=h-w*65536,h=Ie+w+65535,w=Math.floor(h/65536),Ie=h-w*65536,$+=w-1+37*(w-1),F[0]=$,F[1]=te,F[2]=oe,F[3]=ie,F[4]=_e,F[5]=Re,F[6]=ct,F[7]=Qe,F[8]=it,F[9]=ze,F[10]=Je,F[11]=He,F[12]=Fe,F[13]=Oe,F[14]=ye,F[15]=Ie}function U(F,K){N(F,K,K)}function ae(F,K){const M=o();let h;for(h=0;h<16;h++)M[h]=K[h];for(h=253;h>=0;h--)U(M,M),h!==2&&h!==4&&N(M,M,K);for(h=0;h<16;h++)F[h]=M[h]}function Z(F,K){const M=o();let h;for(h=0;h<16;h++)M[h]=K[h];for(h=250;h>=0;h--)U(M,M),h!==1&&N(M,M,K);for(h=0;h<16;h++)F[h]=M[h]}function he(F,K){const M=o(),h=o(),w=o(),$=o(),te=o(),oe=o(),ie=o(),_e=o(),Re=o();S(M,F[1],F[0]),S(Re,K[1],K[0]),N(M,M,Re),C(h,F[0],F[1]),C(Re,K[0],K[1]),N(h,h,Re),N(w,F[3],K[3]),N(w,w,g),N($,F[2],K[2]),C($,$,$),S(te,h,M),S(oe,$,w),C(ie,$,w),C(_e,h,M),N(F[0],te,oe),N(F[1],_e,ie),N(F[2],ie,oe),N(F[3],te,_e)}function W(F,K,M){for(let h=0;h<4;h++)L(F[h],K[h],M)}function le(F,K){const M=o(),h=o(),w=o();ae(w,K[2]),N(M,K[0],w),N(h,K[1],w),H(F,h),F[31]^=q(M)<<7}function y(F,K,M){A(F[0],l),A(F[1],p),A(F[2],p),A(F[3],l);for(let h=255;h>=0;--h){const w=M[h/8|0]>>(h&7)&1;W(F,K,w),he(K,F),he(F,F),W(F,K,w)}}function T(F,K){const M=[o(),o(),o(),o()];A(M[0],m),A(M[1],E),A(M[2],p),N(M[3],m,E),y(F,M,K)}function ce(F){if(F.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const K=(0,n.hash)(F);K[0]&=248,K[31]&=127,K[31]|=64;const M=new Uint8Array(32),h=[o(),o(),o(),o()];T(h,K),le(M,h);const w=new Uint8Array(64);return w.set(F),w.set(M,32),{publicKey:M,secretKey:w}}a.generateKeyPairFromSeed=ce;function ue(F){const K=(0,r.randomBytes)(32,F),M=ce(K);return(0,i.wipe)(K),M}a.generateKeyPair=ue;function ne(F){if(F.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(F.subarray(32))}a.extractPublicKeyFromSecretKey=ne;const J=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ee(F,K){let M,h,w,$;for(h=63;h>=32;--h){for(M=0,w=h-32,$=h-12;w<$;++w)K[w]+=M-16*K[h]*J[w-(h-32)],M=Math.floor((K[w]+128)/256),K[w]-=M*256;K[w]+=M,K[h]=0}for(M=0,w=0;w<32;w++)K[w]+=M-(K[31]>>4)*J[w],M=K[w]>>8,K[w]&=255;for(w=0;w<32;w++)K[w]-=M*J[w];for(h=0;h<32;h++)K[h+1]+=K[h]>>8,F[h]=K[h]&255}function se(F){const K=new Float64Array(64);for(let M=0;M<64;M++)K[M]=F[M];for(let M=0;M<64;M++)F[M]=0;ee(F,K)}function $e(F,K){const M=new Float64Array(64),h=[o(),o(),o(),o()],w=(0,n.hash)(F.subarray(0,32));w[0]&=248,w[31]&=127,w[31]|=64;const $=new Uint8Array(64);$.set(w.subarray(32),32);const te=new n.SHA512;te.update($.subarray(32)),te.update(K);const oe=te.digest();te.clean(),se(oe),T(h,oe),le($,h),te.reset(),te.update($.subarray(0,32)),te.update(F.subarray(32)),te.update(K);const ie=te.digest();se(ie);for(let _e=0;_e<32;_e++)M[_e]=oe[_e];for(let _e=0;_e<32;_e++)for(let Re=0;Re<32;Re++)M[_e+Re]+=ie[_e]*w[Re];return ee($.subarray(32),M),$}a.sign=$e;function Be(F,K){const M=o(),h=o(),w=o(),$=o(),te=o(),oe=o(),ie=o();return A(F[2],p),I(F[1],K),U(w,F[1]),N($,w,_),S(w,w,F[2]),C($,F[2],$),U(te,$),U(oe,te),N(ie,oe,te),N(M,ie,w),N(M,M,$),Z(M,M),N(M,M,w),N(M,M,$),N(M,M,$),N(F[0],M,$),U(h,F[0]),N(h,h,$),z(h,w)&&N(F[0],F[0],P),U(h,F[0]),N(h,h,$),z(h,w)?-1:(q(F[0])===K[31]>>7&&S(F[0],l,F[0]),N(F[3],F[0],F[1]),0)}function nr(F,K,M){const h=new Uint8Array(32),w=[o(),o(),o(),o()],$=[o(),o(),o(),o()];if(M.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be($,F))return!1;const te=new n.SHA512;te.update(M.subarray(0,32)),te.update(F),te.update(K);const oe=te.digest();return se(oe),y(w,$,oe),T($,M.subarray(32)),he(w,$),le(h,w),!B(M,h)}a.verify=nr;function xe(F){let K=[o(),o(),o(),o()];if(Be(K,F))throw new Error("Ed25519: invalid public key");let M=o(),h=o(),w=K[1];C(M,p,w),S(h,p,w),ae(h,h),N(M,M,h);let $=new Uint8Array(32);return H($,M),$}a.convertPublicKeyToX25519=xe;function nt(F){const K=(0,n.hash)(F.subarray(0,32));K[0]&=248,K[31]&=127,K[31]|=64;const M=new Uint8Array(K.subarray(0,32));return(0,i.wipe)(K),M}a.convertSecretKeyToX25519=nt})(Qc);const db="EdDSA",gb="JWT",sp=".",op="base64url",vb="utf8",yb="utf8",mb=":",_b="did",wb="key",Fl="base58btc",bb="z",Eb="K36",Ib=32;function xo(a){return Co(Yc(Vn(a),vb),op)}function ap(a){const r=Yc(Eb,Fl),n=bb+Co(t0([r,a]),Fl);return[_b,wb,n].join(mb)}function Sb(a){return Co(a,op)}function xb(a){return Yc([xo(a.header),xo(a.payload)].join(sp),yb)}function Pb(a){return[xo(a.header),xo(a.payload),Sb(a.signature)].join(sp)}function Wl(a=zf.randomBytes(Ib)){return Qc.generateKeyPairFromSeed(a)}async function Ob(a,r,n,i,o=me.fromMiliseconds(Date.now())){const u={alg:db,typ:gb},l=ap(i.publicKey),p=o+n,_={iss:l,sub:a,aud:r,iat:o,exp:p},g=xb({header:u,payload:_}),m=Qc.sign(i.secretKey,g);return Pb({header:u,payload:_,signature:m})}const Cb="PARSE_ERROR",Rb="INVALID_REQUEST",Tb="METHOD_NOT_FOUND",Ab="INVALID_PARAMS",cp="INTERNAL_ERROR",Jc="SERVER_ERROR",Nb=[-32700,-32600,-32601,-32602,-32603],Zi={[Cb]:{code:-32700,message:"Parse error"},[Rb]:{code:-32600,message:"Invalid Request"},[Tb]:{code:-32601,message:"Method not found"},[Ab]:{code:-32602,message:"Invalid params"},[cp]:{code:-32603,message:"Internal error"},[Jc]:{code:-32e3,message:"Server error"}},up=Jc;function Lb(a){return Nb.includes(a)}function Gl(a){return Object.keys(Zi).includes(a)?Zi[a]:Zi[up]}function Db(a){return Object.values(Zi).find(n=>n.code===a)||Zi[up]}function hp(a,r,n){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${r}`):a}var lp={},on={},Yl;function kb(){if(Yl)return on;Yl=1,Object.defineProperty(on,"__esModule",{value:!0}),on.isBrowserCryptoAvailable=on.getSubtleCrypto=on.getBrowerCrypto=void 0;function a(){return(Ur===null||Ur===void 0?void 0:Ur.crypto)||(Ur===null||Ur===void 0?void 0:Ur.msCrypto)||{}}on.getBrowerCrypto=a;function r(){const i=a();return i.subtle||i.webkitSubtle}on.getSubtleCrypto=r;function n(){return!!a()&&!!r()}return on.isBrowserCryptoAvailable=n,on}var an={},Ql;function jb(){if(Ql)return an;Ql=1,Object.defineProperty(an,"__esModule",{value:!0}),an.isBrowser=an.isNode=an.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}an.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}an.isNode=r;function n(){return!a()&&!r()}return an.isBrowser=n,an}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Ei;r.__exportStar(kb(),a),r.__exportStar(jb(),a)})(lp);function Xc(a=3){const r=Date.now()*Math.pow(10,a),n=Math.floor(Math.random()*Math.pow(10,a));return r+n}function fp(a=6){return BigInt(Xc(a))}function wi(a,r,n){return{id:n||Xc(),jsonrpc:"2.0",method:a,params:r}}function No(a,r){return{id:a,jsonrpc:"2.0",result:r}}function Lo(a,r,n){return{id:a,jsonrpc:"2.0",error:Mb(r,n)}}function Mb(a,r){return typeof a>"u"?Gl(cp):(typeof a=="string"&&(a=Object.assign(Object.assign({},Gl(Jc)),{message:a})),typeof r<"u"&&(a.data=r),Lb(a.code)&&(a=Db(a.code)),a)}class qb{}class Ub extends qb{constructor(){super()}}class zb extends Ub{constructor(r){super()}}const $b="^https?:",Bb="^wss?:";function Hb(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function pp(a,r){const n=Hb(a);return typeof n>"u"?!1:new RegExp(r).test(n)}function Jl(a){return pp(a,$b)}function Xl(a){return pp(a,Bb)}function Vb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function dp(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Zc(a){return dp(a)&&"method"in a}function Do(a){return dp(a)&&(hn(a)||qr(a))}function hn(a){return"result"in a}function qr(a){return"error"in a}class ln extends zb{constructor(r){super(r),this.events=new Rr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,n){this.events.on(r,n)}once(r,n){this.events.once(r,n)}off(r,n){this.events.off(r,n)}removeListener(r,n){this.events.removeListener(r,n)}async request(r,n){return this.requestStrict(wi(r.method,r.params||[],r.id||fp().toString()),n)}async requestStrict(r,n){return new Promise(async(i,o)=>{if(!this.connection.connected)try{await this.open()}catch(u){o(u)}this.events.on(`${r.id}`,u=>{qr(u)?o(u.error):i(u.result)});try{await this.connection.send(r,n)}catch(u){o(u)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),Do(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Kb=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:d0(),Fb=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Zl=a=>a.split("?")[0],ef=10,Wb=Kb();let Gb=class{constructor(a){if(this.url=a,this.events=new Rr.EventEmitter,this.registering=!1,!Xl(a))throw new Error(`Provided URL is not compatible with WebSocket connection: ${a}`);this.url=a}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(a,r){this.events.on(a,r)}once(a,r){this.events.once(a,r)}off(a,r){this.events.off(a,r)}removeListener(a,r){this.events.removeListener(a,r)}async open(a=this.url){await this.register(a)}async close(){return new Promise((a,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),a()},this.socket.close()})}async send(a){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Vn(a))}catch(r){this.onError(a.id,r)}}register(a=this.url){if(!Xl(a))throw new Error(`Provided URL is not compatible with WebSocket connection: ${a}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),i(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=a,this.registering=!0,new Promise((r,n)=>{const i=new URLSearchParams(a).get("origin"),o=lp.isReactNative()?{headers:{origin:i}}:{rejectUnauthorized:!Vb(a)},u=new Wb(a,[],o);Fb()?u.onerror=l=>{const p=l;n(this.emitError(p.error))}:u.on("error",l=>{n(this.emitError(l))}),u.onopen=()=>{this.onOpen(u),r(u)}})}onOpen(a){a.onmessage=r=>this.onPayload(r),a.onclose=r=>this.onClose(r),this.socket=a,this.registering=!1,this.events.emit("open")}onClose(a){this.socket=void 0,this.registering=!1,this.events.emit("close",a)}onPayload(a){if(typeof a.data>"u")return;const r=typeof a.data=="string"?rs(a.data):a.data;this.events.emit("payload",r)}onError(a,r){const n=this.parseError(r),i=n.message||n.toString(),o=Lo(a,i);this.events.emit("payload",o)}parseError(a,r=this.url){return hp(a,Zl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ef&&this.events.setMaxListeners(ef)}emitError(a){const r=this.parseError(new Error((a==null?void 0:a.message)||`WebSocket connection failed for host: ${Zl(this.url)}`));return this.events.emit("register_error",r),r}};var Po={exports:{}};Po.exports;(function(a,r){var n=200,i="__lodash_hash_undefined__",o=1,u=2,l=9007199254740991,p="[object Arguments]",_="[object Array]",g="[object AsyncFunction]",m="[object Boolean]",E="[object Date]",P="[object Error]",A="[object Function]",O="[object GeneratorFunction]",L="[object Map]",H="[object Number]",B="[object Null]",z="[object Object]",q="[object Promise]",I="[object Proxy]",C="[object RegExp]",S="[object Set]",N="[object String]",U="[object Symbol]",ae="[object Undefined]",Z="[object WeakMap]",he="[object ArrayBuffer]",W="[object DataView]",le="[object Float32Array]",y="[object Float64Array]",T="[object Int8Array]",ce="[object Int16Array]",ue="[object Int32Array]",ne="[object Uint8Array]",J="[object Uint8ClampedArray]",ee="[object Uint16Array]",se="[object Uint32Array]",$e=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,nr=/^(?:0|[1-9]\d*)$/,xe={};xe[le]=xe[y]=xe[T]=xe[ce]=xe[ue]=xe[ne]=xe[J]=xe[ee]=xe[se]=!0,xe[p]=xe[_]=xe[he]=xe[m]=xe[W]=xe[E]=xe[P]=xe[A]=xe[L]=xe[H]=xe[z]=xe[C]=xe[S]=xe[N]=xe[Z]=!1;var nt=typeof Ur=="object"&&Ur&&Ur.Object===Object&&Ur,F=typeof self=="object"&&self&&self.Object===Object&&self,K=nt||F||Function("return this")(),M=r&&!r.nodeType&&r,h=M&&!0&&a&&!a.nodeType&&a,w=h&&h.exports===M,$=w&&nt.process,te=function(){try{return $&&$.binding&&$.binding("util")}catch{}}(),oe=te&&te.isTypedArray;function ie(b,k){for(var X=-1,pe=b==null?0:b.length,et=0,Ce=[];++X<pe;){var ot=b[X];k(ot,X,b)&&(Ce[et++]=ot)}return Ce}function _e(b,k){for(var X=-1,pe=k.length,et=b.length;++X<pe;)b[et+X]=k[X];return b}function Re(b,k){for(var X=-1,pe=b==null?0:b.length;++X<pe;)if(k(b[X],X,b))return!0;return!1}function ct(b,k){for(var X=-1,pe=Array(b);++X<b;)pe[X]=k(X);return pe}function Qe(b){return function(k){return b(k)}}function it(b,k){return b.has(k)}function ze(b,k){return b==null?void 0:b[k]}function Je(b){var k=-1,X=Array(b.size);return b.forEach(function(pe,et){X[++k]=[et,pe]}),X}function He(b,k){return function(X){return b(k(X))}}function Fe(b){var k=-1,X=Array(b.size);return b.forEach(function(pe){X[++k]=pe}),X}var Oe=Array.prototype,ye=Function.prototype,Ie=Object.prototype,Ue=K["__core-js_shared__"],Xe=ye.toString,je=Ie.hasOwnProperty,Ge=function(){var b=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),gt=Ie.toString,St=RegExp("^"+Xe.call(je).replace($e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rt=w?K.Buffer:void 0,vt=K.Symbol,Ht=K.Uint8Array,ir=Ie.propertyIsEnumerable,zr=Oe.splice,Qt=vt?vt.toStringTag:void 0,Wr=Object.getOwnPropertySymbols,pn=Rt?Rt.isBuffer:void 0,Rn=He(Object.keys,Object),yt=pr(K,"DataView"),ut=pr(K,"Map"),mt=pr(K,"Promise"),_t=pr(K,"Set"),pt=pr(K,"WeakMap"),ht=pr(Object,"create"),Tt=Yr(yt),At=Yr(ut),wt=Yr(mt),Nt=Yr(_t),bt=Yr(pt),xt=vt?vt.prototype:void 0,Et=xt?xt.valueOf:void 0;function st(b){var k=-1,X=b==null?0:b.length;for(this.clear();++k<X;){var pe=b[k];this.set(pe[0],pe[1])}}function Lt(){this.__data__=ht?ht(null):{},this.size=0}function Dt(b){var k=this.has(b)&&delete this.__data__[b];return this.size-=k?1:0,k}function Mo(b){var k=this.__data__;if(ht){var X=k[b];return X===i?void 0:X}return je.call(k,b)?k[b]:void 0}function qo(b){var k=this.__data__;return ht?k[b]!==void 0:je.call(k,b)}function Uo(b,k){var X=this.__data__;return this.size+=this.has(b)?0:1,X[b]=ht&&k===void 0?i:k,this}st.prototype.clear=Lt,st.prototype.delete=Dt,st.prototype.get=Mo,st.prototype.has=qo,st.prototype.set=Uo;function _r(b){var k=-1,X=b==null?0:b.length;for(this.clear();++k<X;){var pe=b[k];this.set(pe[0],pe[1])}}function zo(){this.__data__=[],this.size=0}function $o(b){var k=this.__data__,X=Tn(k,b);if(X<0)return!1;var pe=k.length-1;return X==pe?k.pop():zr.call(k,X,1),--this.size,!0}function Bo(b){var k=this.__data__,X=Tn(k,b);return X<0?void 0:k[X][1]}function Ho(b){return Tn(this.__data__,b)>-1}function Vo(b,k){var X=this.__data__,pe=Tn(X,b);return pe<0?(++this.size,X.push([b,k])):X[pe][1]=k,this}_r.prototype.clear=zo,_r.prototype.delete=$o,_r.prototype.get=Bo,_r.prototype.has=Ho,_r.prototype.set=Vo;function Gr(b){var k=-1,X=b==null?0:b.length;for(this.clear();++k<X;){var pe=b[k];this.set(pe[0],pe[1])}}function Yn(){this.size=0,this.__data__={hash:new st,map:new(ut||_r),string:new st}}function Ko(b){var k=dn(this,b).delete(b);return this.size-=k?1:0,k}function Qn(b){return dn(this,b).get(b)}function Fo(b){return dn(this,b).has(b)}function Wo(b,k){var X=dn(this,b),pe=X.size;return X.set(b,k),this.size+=X.size==pe?0:1,this}Gr.prototype.clear=Yn,Gr.prototype.delete=Ko,Gr.prototype.get=Qn,Gr.prototype.has=Fo,Gr.prototype.set=Wo;function Jn(b){var k=-1,X=b==null?0:b.length;for(this.__data__=new Gr;++k<X;)this.add(b[k])}function is(b){return this.__data__.set(b,i),this}function ss(b){return this.__data__.has(b)}Jn.prototype.add=Jn.prototype.push=is,Jn.prototype.has=ss;function Tr(b){var k=this.__data__=new _r(b);this.size=k.size}function Go(){this.__data__=new _r,this.size=0}function Yo(b){var k=this.__data__,X=k.delete(b);return this.size=k.size,X}function Qo(b){return this.__data__.get(b)}function Jo(b){return this.__data__.has(b)}function os(b,k){var X=this.__data__;if(X instanceof _r){var pe=X.__data__;if(!ut||pe.length<n-1)return pe.push([b,k]),this.size=++X.size,this;X=this.__data__=new Gr(pe)}return X.set(b,k),this.size=X.size,this}Tr.prototype.clear=Go,Tr.prototype.delete=Yo,Tr.prototype.get=Qo,Tr.prototype.has=Jo,Tr.prototype.set=os;function as(b,k){var X=ei(b),pe=!X&&_s(b),et=!X&&!pe&&Pi(b),Ce=!X&&!pe&&!et&&Es(b),ot=X||pe||et||Ce,kt=ot?ct(b.length,String):[],Me=kt.length;for(var tt in b)(k||je.call(b,tt))&&!(ot&&(tt=="length"||et&&(tt=="offset"||tt=="parent")||Ce&&(tt=="buffer"||tt=="byteLength"||tt=="byteOffset")||ds(tt,Me)))&&kt.push(tt);return kt}function Tn(b,k){for(var X=b.length;X--;)if(ms(b[X][0],k))return X;return-1}function Si(b,k,X){var pe=k(b);return ei(b)?pe:_e(pe,X(b))}function An(b){return b==null?b===void 0?ae:B:Qt&&Qt in Object(b)?fs(b):ea(b)}function xi(b){return Ln(b)&&An(b)==p}function Nn(b,k,X,pe,et){return b===k?!0:b==null||k==null||!Ln(b)&&!Ln(k)?b!==b&&k!==k:cs(b,k,X,pe,Nn,et)}function cs(b,k,X,pe,et,Ce){var ot=ei(b),kt=ei(k),Me=ot?_:$r(b),tt=kt?_:$r(k);Me=Me==p?z:Me,tt=tt==p?z:tt;var Pt=Me==z,sr=tt==z,jt=Me==tt;if(jt&&Pi(b)){if(!Pi(k))return!1;ot=!0,Pt=!1}if(jt&&!Pt)return Ce||(Ce=new Tr),ot||Es(b)?Xn(b,k,X,pe,et,Ce):Zo(b,k,Me,X,pe,et,Ce);if(!(X&o)){var at=Pt&&je.call(b,"__wrapped__"),Jt=sr&&je.call(k,"__wrapped__");if(at||Jt){var Ar=at?b.value():b,wr=Jt?k.value():k;return Ce||(Ce=new Tr),et(Ar,wr,X,pe,Ce)}}return jt?(Ce||(Ce=new Tr),ls(b,k,X,pe,et,Ce)):!1}function Xo(b){if(!bs(b)||vs(b))return!1;var k=ti(b)?St:Be;return k.test(Yr(b))}function us(b){return Ln(b)&&ws(b.length)&&!!xe[An(b)]}function hs(b){if(!ys(b))return Rn(b);var k=[];for(var X in Object(b))je.call(b,X)&&X!="constructor"&&k.push(X);return k}function Xn(b,k,X,pe,et,Ce){var ot=X&o,kt=b.length,Me=k.length;if(kt!=Me&&!(ot&&Me>kt))return!1;var tt=Ce.get(b);if(tt&&Ce.get(k))return tt==k;var Pt=-1,sr=!0,jt=X&u?new Jn:void 0;for(Ce.set(b,k),Ce.set(k,b);++Pt<kt;){var at=b[Pt],Jt=k[Pt];if(pe)var Ar=ot?pe(Jt,at,Pt,k,b,Ce):pe(at,Jt,Pt,b,k,Ce);if(Ar!==void 0){if(Ar)continue;sr=!1;break}if(jt){if(!Re(k,function(wr,Br){if(!it(jt,Br)&&(at===wr||et(at,wr,X,pe,Ce)))return jt.push(Br)})){sr=!1;break}}else if(!(at===Jt||et(at,Jt,X,pe,Ce))){sr=!1;break}}return Ce.delete(b),Ce.delete(k),sr}function Zo(b,k,X,pe,et,Ce,ot){switch(X){case W:if(b.byteLength!=k.byteLength||b.byteOffset!=k.byteOffset)return!1;b=b.buffer,k=k.buffer;case he:return!(b.byteLength!=k.byteLength||!Ce(new Ht(b),new Ht(k)));case m:case E:case H:return ms(+b,+k);case P:return b.name==k.name&&b.message==k.message;case C:case N:return b==k+"";case L:var kt=Je;case S:var Me=pe&o;if(kt||(kt=Fe),b.size!=k.size&&!Me)return!1;var tt=ot.get(b);if(tt)return tt==k;pe|=u,ot.set(b,k);var Pt=Xn(kt(b),kt(k),pe,et,Ce,ot);return ot.delete(b),Pt;case U:if(Et)return Et.call(b)==Et.call(k)}return!1}function ls(b,k,X,pe,et,Ce){var ot=X&o,kt=Zn(b),Me=kt.length,tt=Zn(k),Pt=tt.length;if(Me!=Pt&&!ot)return!1;for(var sr=Me;sr--;){var jt=kt[sr];if(!(ot?jt in k:je.call(k,jt)))return!1}var at=Ce.get(b);if(at&&Ce.get(k))return at==k;var Jt=!0;Ce.set(b,k),Ce.set(k,b);for(var Ar=ot;++sr<Me;){jt=kt[sr];var wr=b[jt],Br=k[jt];if(pe)var Oi=ot?pe(Br,wr,jt,k,b,Ce):pe(wr,Br,jt,b,k,Ce);if(!(Oi===void 0?wr===Br||et(wr,Br,X,pe,Ce):Oi)){Jt=!1;break}Ar||(Ar=jt=="constructor")}if(Jt&&!Ar){var Dn=b.constructor,zt=k.constructor;Dn!=zt&&"constructor"in b&&"constructor"in k&&!(typeof Dn=="function"&&Dn instanceof Dn&&typeof zt=="function"&&zt instanceof zt)&&(Jt=!1)}return Ce.delete(b),Ce.delete(k),Jt}function Zn(b){return Si(b,na,ps)}function dn(b,k){var X=b.__data__;return gs(k)?X[typeof k=="string"?"string":"hash"]:X.map}function pr(b,k){var X=ze(b,k);return Xo(X)?X:void 0}function fs(b){var k=je.call(b,Qt),X=b[Qt];try{b[Qt]=void 0;var pe=!0}catch{}var et=gt.call(b);return pe&&(k?b[Qt]=X:delete b[Qt]),et}var ps=Wr?function(b){return b==null?[]:(b=Object(b),ie(Wr(b),function(k){return ir.call(b,k)}))}:Ze,$r=An;(yt&&$r(new yt(new ArrayBuffer(1)))!=W||ut&&$r(new ut)!=L||mt&&$r(mt.resolve())!=q||_t&&$r(new _t)!=S||pt&&$r(new pt)!=Z)&&($r=function(b){var k=An(b),X=k==z?b.constructor:void 0,pe=X?Yr(X):"";if(pe)switch(pe){case Tt:return W;case At:return L;case wt:return q;case Nt:return S;case bt:return Z}return k});function ds(b,k){return k=k??l,!!k&&(typeof b=="number"||nr.test(b))&&b>-1&&b%1==0&&b<k}function gs(b){var k=typeof b;return k=="string"||k=="number"||k=="symbol"||k=="boolean"?b!=="__proto__":b===null}function vs(b){return!!Ge&&Ge in b}function ys(b){var k=b&&b.constructor,X=typeof k=="function"&&k.prototype||Ie;return b===X}function ea(b){return gt.call(b)}function Yr(b){if(b!=null){try{return Xe.call(b)}catch{}try{return b+""}catch{}}return""}function ms(b,k){return b===k||b!==b&&k!==k}var _s=xi(function(){return arguments}())?xi:function(b){return Ln(b)&&je.call(b,"callee")&&!ir.call(b,"callee")},ei=Array.isArray;function ta(b){return b!=null&&ws(b.length)&&!ti(b)}var Pi=pn||Ye;function ra(b,k){return Nn(b,k)}function ti(b){if(!bs(b))return!1;var k=An(b);return k==A||k==O||k==g||k==I}function ws(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=l}function bs(b){var k=typeof b;return b!=null&&(k=="object"||k=="function")}function Ln(b){return b!=null&&typeof b=="object"}var Es=oe?Qe(oe):us;function na(b){return ta(b)?as(b):hs(b)}function Ze(){return[]}function Ye(){return!1}a.exports=ra})(Po,Po.exports);var Yb=Po.exports;const Qb=Gc(Yb);function Jb(a,r){return r=r||{},new Promise(function(n,i){var o=new XMLHttpRequest,u=[],l=[],p={},_=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:_,headers:{keys:function(){return u},entries:function(){return l},get:function(m){return p[m.toLowerCase()]},has:function(m){return m.toLowerCase()in p}}}};for(var g in o.open(r.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(m,E,P){u.push(E=E.toLowerCase()),l.push([E,P]),p[E]=p[E]?p[E]+","+P:P}),n(_())},o.onerror=i,o.withCredentials=r.credentials=="include",r.headers)o.setRequestHeader(g,r.headers[g]);o.send(r.body||null)})}const Xb=Object.freeze(Object.defineProperty({__proto__:null,default:Jb},Symbol.toStringTag,{value:"Module"})),tf=qf(Xb);var Zb=self.fetch||(self.fetch=tf.default||tf);const e1=Gc(Zb);function t1(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),i=0;i<n.length;i++)n[i]=255;for(var o=0;o<a.length;o++){var u=a.charAt(o),l=u.charCodeAt(0);if(n[l]!==255)throw new TypeError(u+" is ambiguous");n[l]=o}var p=a.length,_=a.charAt(0),g=Math.log(p)/Math.log(256),m=Math.log(256)/Math.log(p);function E(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var L=0,H=0,B=0,z=O.length;B!==z&&O[B]===0;)B++,L++;for(var q=(z-B)*m+1>>>0,I=new Uint8Array(q);B!==z;){for(var C=O[B],S=0,N=q-1;(C!==0||S<H)&&N!==-1;N--,S++)C+=256*I[N]>>>0,I[N]=C%p>>>0,C=C/p>>>0;if(C!==0)throw new Error("Non-zero carry");H=S,B++}for(var U=q-H;U!==q&&I[U]===0;)U++;for(var ae=_.repeat(L);U<q;++U)ae+=a.charAt(I[U]);return ae}function P(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var L=0;if(O[L]!==" "){for(var H=0,B=0;O[L]===_;)H++,L++;for(var z=(O.length-L)*g+1>>>0,q=new Uint8Array(z);O[L];){var I=n[O.charCodeAt(L)];if(I===255)return;for(var C=0,S=z-1;(I!==0||C<B)&&S!==-1;S--,C++)I+=p*q[S]>>>0,q[S]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");B=C,L++}if(O[L]!==" "){for(var N=z-B;N!==z&&q[N]===0;)N++;for(var U=new Uint8Array(H+(z-N)),ae=H;N!==z;)U[ae++]=q[N++];return U}}}function A(O){var L=P(O);if(L)return L;throw new Error(`Non-${r} character`)}return{encode:E,decodeUnsafe:P,decode:A}}var r1=t1,n1=r1;const gp=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},i1=a=>new TextEncoder().encode(a),s1=a=>new TextDecoder().decode(a);class o1{constructor(r,n,i){this.name=r,this.prefix=n,this.baseEncode=i}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class a1{constructor(r,n,i){if(this.name=r,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=i}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return vp(this,r)}}class c1{constructor(r){this.decoders=r}or(r){return vp(this,r)}decode(r){const n=r[0],i=this.decoders[n];if(i)return i.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vp=(a,r)=>new c1({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class u1{constructor(r,n,i,o){this.name=r,this.prefix=n,this.baseEncode=i,this.baseDecode=o,this.encoder=new o1(r,n,i),this.decoder=new a1(r,n,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const ko=({name:a,prefix:r,encode:n,decode:i})=>new u1(a,r,n,i),ns=({prefix:a,name:r,alphabet:n})=>{const{encode:i,decode:o}=n1(n,r);return ko({prefix:a,name:r,encode:i,decode:u=>gp(o(u))})},h1=(a,r,n,i)=>{const o={};for(let m=0;m<r.length;++m)o[r[m]]=m;let u=a.length;for(;a[u-1]==="=";)--u;const l=new Uint8Array(u*n/8|0);let p=0,_=0,g=0;for(let m=0;m<u;++m){const E=o[a[m]];if(E===void 0)throw new SyntaxError(`Non-${i} character`);_=_<<n|E,p+=n,p>=8&&(p-=8,l[g++]=255&_>>p)}if(p>=n||255&_<<8-p)throw new SyntaxError("Unexpected end of data");return l},l1=(a,r,n)=>{const i=r[r.length-1]==="=",o=(1<<n)-1;let u="",l=0,p=0;for(let _=0;_<a.length;++_)for(p=p<<8|a[_],l+=8;l>n;)l-=n,u+=r[o&p>>l];if(l&&(u+=r[o&p<<n-l]),i)for(;u.length*n&7;)u+="=";return u},Kt=({name:a,prefix:r,bitsPerChar:n,alphabet:i})=>ko({prefix:r,name:a,encode(o){return l1(o,i,n)},decode(o){return h1(o,i,n,a)}}),f1=ko({prefix:"\0",name:"identity",encode:a=>s1(a),decode:a=>i1(a)});var p1=Object.freeze({__proto__:null,identity:f1});const d1=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var g1=Object.freeze({__proto__:null,base2:d1});const v1=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var y1=Object.freeze({__proto__:null,base8:v1});const m1=ns({prefix:"9",name:"base10",alphabet:"0123456789"});var _1=Object.freeze({__proto__:null,base10:m1});const w1=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),b1=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var E1=Object.freeze({__proto__:null,base16:w1,base16upper:b1});const I1=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),S1=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),x1=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),P1=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),O1=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),C1=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),R1=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),T1=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),A1=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var N1=Object.freeze({__proto__:null,base32:I1,base32upper:S1,base32pad:x1,base32padupper:P1,base32hex:O1,base32hexupper:C1,base32hexpad:R1,base32hexpadupper:T1,base32z:A1});const L1=ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),D1=ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var k1=Object.freeze({__proto__:null,base36:L1,base36upper:D1});const j1=ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),M1=ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q1=Object.freeze({__proto__:null,base58btc:j1,base58flickr:M1});const U1=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),z1=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$1=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),B1=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var H1=Object.freeze({__proto__:null,base64:U1,base64pad:z1,base64url:$1,base64urlpad:B1});const yp=Array.from(""),V1=yp.reduce((a,r,n)=>(a[n]=r,a),[]),K1=yp.reduce((a,r,n)=>(a[r.codePointAt(0)]=n,a),[]);function F1(a){return a.reduce((r,n)=>(r+=V1[n],r),"")}function W1(a){const r=[];for(const n of a){const i=K1[n.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${n}`);r.push(i)}return new Uint8Array(r)}const G1=ko({prefix:"",name:"base256emoji",encode:F1,decode:W1});var Y1=Object.freeze({__proto__:null,base256emoji:G1}),Q1=mp,rf=128,J1=127,X1=~J1,Z1=Math.pow(2,31);function mp(a,r,n){r=r||[],n=n||0;for(var i=n;a>=Z1;)r[n++]=a&255|rf,a/=128;for(;a&X1;)r[n++]=a&255|rf,a>>>=7;return r[n]=a|0,mp.bytes=n-i+1,r}var eE=zc,tE=128,nf=127;function zc(a,i){var n=0,i=i||0,o=0,u=i,l,p=a.length;do{if(u>=p)throw zc.bytes=0,new RangeError("Could not decode varint");l=a[u++],n+=o<28?(l&nf)<<o:(l&nf)*Math.pow(2,o),o+=7}while(l>=tE);return zc.bytes=u-i,n}var rE=Math.pow(2,7),nE=Math.pow(2,14),iE=Math.pow(2,21),sE=Math.pow(2,28),oE=Math.pow(2,35),aE=Math.pow(2,42),cE=Math.pow(2,49),uE=Math.pow(2,56),hE=Math.pow(2,63),lE=function(a){return a<rE?1:a<nE?2:a<iE?3:a<sE?4:a<oE?5:a<aE?6:a<cE?7:a<uE?8:a<hE?9:10},fE={encode:Q1,decode:eE,encodingLength:lE},_p=fE;const sf=(a,r,n=0)=>(_p.encode(a,r,n),r),of=a=>_p.encodingLength(a),$c=(a,r)=>{const n=r.byteLength,i=of(a),o=i+of(n),u=new Uint8Array(o+n);return sf(a,u,0),sf(n,u,i),u.set(r,o),new pE(a,n,r,u)};class pE{constructor(r,n,i,o){this.code=r,this.size=n,this.digest=i,this.bytes=o}}const wp=({name:a,code:r,encode:n})=>new dE(a,r,n);class dE{constructor(r,n,i){this.name=r,this.code=n,this.encode=i}digest(r){if(r instanceof Uint8Array){const n=this.encode(r);return n instanceof Uint8Array?$c(this.code,n):n.then(i=>$c(this.code,i))}else throw Error("Unknown type, must be binary type")}}const bp=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),gE=wp({name:"sha2-256",code:18,encode:bp("SHA-256")}),vE=wp({name:"sha2-512",code:19,encode:bp("SHA-512")});var yE=Object.freeze({__proto__:null,sha256:gE,sha512:vE});const Ep=0,mE="identity",Ip=gp,_E=a=>$c(Ep,Ip(a)),wE={code:Ep,name:mE,encode:Ip,digest:_E};var bE=Object.freeze({__proto__:null,identity:wE});new TextEncoder,new TextDecoder;const af={...p1,...g1,...y1,..._1,...E1,...N1,...k1,...q1,...H1,...Y1};({...yE,...bE});function Sp(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function EE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sp(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function xp(a,r,n,i){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:n},decoder:{decode:i}}}const cf=xp("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),Cc=xp("ascii","a",a=>{let r="a";for(let n=0;n<a.length;n++)r+=String.fromCharCode(a[n]);return r},a=>{a=a.substring(1);const r=EE(a.length);for(let n=0;n<a.length;n++)r[n]=a.charCodeAt(n);return r}),IE={utf8:cf,"utf-8":cf,hex:af.base16,latin1:Cc,ascii:Cc,binary:Cc,...af};function SE(a,r="utf8"){const n=IE[r];if(!n)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sp(globalThis.Buffer.from(a,"utf-8")):n.decoder.decode(`${n.prefix}${a}`)}const Pp="wc",xE=2,eu="core",Pn=`${Pp}@2:${eu}:`,PE={name:eu,logger:"error"},OE={database:":memory:"},CE="crypto",uf="client_ed25519_seed",RE=me.ONE_DAY,TE="keychain",AE="0.3",NE="messages",LE="0.3",DE=me.SIX_HOURS,kE="publisher",Op="irn",jE="error",Cp="wss://relay.walletconnect.com",hf="wss://relay.walletconnect.org",ME="relayer",Yt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},qE="_subscription",cn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},UE=me.ONE_SECOND,zE="2.11.0",$E=1e4,BE="0.3",HE="WALLETCONNECT_CLIENT_ID",jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},VE="subscription",KE="0.3",FE=me.FIVE_SECONDS*1e3,WE="pairing",GE="0.3",Ki={wc_pairingDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:me.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:me.ONE_DAY,prompt:!1,tag:0},res:{ttl:me.ONE_DAY,prompt:!1,tag:0}}},Ji={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Fr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},YE="history",QE="0.3",JE="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},XE="0.3",Rc="verify-api",mi="https://verify.walletconnect.com",Bc="https://verify.walletconnect.org",ZE=[mi,Bc],eI="echo",tI="https://echo.walletconnect.com";class rI{constructor(r,n){this.core=r,this.logger=n,this.keychain=new Map,this.name=TE,this.version=AE,this.initialized=!1,this.storagePrefix=Pn,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,o)=>{this.isInitialized(),this.keychain.set(i,o),await this.persist()},this.get=i=>{this.isInitialized();const o=this.keychain.get(i);if(typeof o>"u"){const{message:u}=de("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(u)}return o},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=r,this.logger=ke.generateChildLogger(n,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,Kf(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Ff(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class nI{constructor(r,n,i){this.core=r,this.logger=n,this.name=CE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),u=Wl(o);return ap(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Mw();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const u=await this.getClientSeed(),l=Wl(u),p=Mc();return await Ob(p,o,RE,l)},this.generateSharedKey=(o,u,l)=>{this.isInitialized();const p=this.getPrivateKey(o),_=qw(p,u);return this.setSymKey(_,l)},this.setSymKey=async(o,u)=>{this.isInitialized();const l=u||Uw(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,u,l)=>{this.isInitialized();const p=zw(l),_=Vn(u);if(ol(p)){const P=p.senderPublicKey,A=p.receiverPublicKey;o=await this.generateSharedKey(P,A)}const g=this.getSymKey(o),{type:m,senderPublicKey:E}=p;return $w({type:m,symKey:g,message:_,senderPublicKey:E})},this.decode=async(o,u,l)=>{this.isInitialized();const p=Bw(u,l);if(ol(p)){const _=p.receiverPublicKey,g=p.senderPublicKey;o=await this.generateSharedKey(_,g)}try{const _=this.getSymKey(o),g=Hw({symKey:_,encoded:u});return rs(g)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const u=al(o);return Vw(u.type)},this.getPayloadSenderPublicKey=o=>{const u=al(o);return u.senderPublicKey?Co(u.senderPublicKey,Kw):void 0},this.core=r,this.logger=ke.generateChildLogger(n,this.name),this.keychain=i||new rI(this.core,this.logger)}get context(){return ke.getLoggerContext(this.logger)}async setPrivateKey(r,n){return await this.keychain.set(r,n),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(uf)}catch{r=Mc(),await this.keychain.set(uf,r)}return SE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class iI extends ib{constructor(r,n){super(r,n),this.logger=r,this.core=n,this.messages=new Map,this.name=NE,this.version=LE,this.initialized=!1,this.storagePrefix=Pn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,o)=>{this.isInitialized();const u=_i(o);let l=this.messages.get(i);return typeof l>"u"&&(l={}),typeof l[u]<"u"||(l[u]=o,this.messages.set(i,l),await this.persist()),u},this.get=i=>{this.isInitialized();let o=this.messages.get(i);return typeof o>"u"&&(o={}),o},this.has=(i,o)=>{this.isInitialized();const u=this.get(i),l=_i(o);return typeof u[l]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=ke.generateChildLogger(r,this.name),this.core=n}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,Kf(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Ff(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class sI extends sb{constructor(r,n){super(r,n),this.relayer=r,this.logger=n,this.events=new Rr.EventEmitter,this.name=kE,this.queue=new Map,this.publishTimeout=me.toMiliseconds(me.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,o,u)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:u}});try{const p=(u==null?void 0:u.ttl)||DE,_=qc(u),g=(u==null?void 0:u.prompt)||!1,m=(u==null?void 0:u.tag)||0,E=(u==null?void 0:u.id)||fp().toString(),P={topic:i,message:o,opts:{ttl:p,relay:_,prompt:g,tag:m,id:E}},A=setTimeout(()=>this.queue.set(E,P),this.publishTimeout);try{await await es(this.rpcPublish(i,o,p,_,g,m,E),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(E),this.relayer.events.emit(Yt.publish,P)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=u==null?void 0:u.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(E),O;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:o,opts:u}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.relayer=r,this.logger=ke.generateChildLogger(n,this.name),this.registerEventListeners()}get context(){return ke.getLoggerContext(this.logger)}rpcPublish(r,n,i,o,u,l,p){var _,g,m,E;const P={method:Eo(o.protocol).publish,params:{topic:r,message:n,ttl:i,prompt:u,tag:l},id:p};return xn((_=P.params)==null?void 0:_.prompt)&&((g=P.params)==null||delete g.prompt),xn((m=P.params)==null?void 0:m.tag)&&((E=P.params)==null||delete E.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:n,message:i,opts:o}=r;await this.publish(n,i,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ii.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Yt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Yt.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class oI{constructor(){this.map=new Map,this.set=(r,n)=>{const i=this.get(r);this.exists(r,n)||this.map.set(r,[...i,n])},this.get=r=>this.map.get(r)||[],this.exists=(r,n)=>this.get(r).includes(n),this.delete=(r,n)=>{if(typeof n>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const i=this.get(r);if(!this.exists(r,n))return;const o=i.filter(u=>u!==n);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var aI=Object.defineProperty,cI=Object.defineProperties,uI=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,hI=Object.prototype.hasOwnProperty,lI=Object.prototype.propertyIsEnumerable,ff=(a,r,n)=>r in a?aI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,Fi=(a,r)=>{for(var n in r||(r={}))hI.call(r,n)&&ff(a,n,r[n]);if(lf)for(var n of lf(r))lI.call(r,n)&&ff(a,n,r[n]);return a},Tc=(a,r)=>cI(a,uI(r));class fI extends cb{constructor(r,n){super(r,n),this.relayer=r,this.logger=n,this.subscriptions=new Map,this.topicMap=new oI,this.events=new Rr.EventEmitter,this.name=VE,this.version=KE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}});try{const u=qc(o),l={topic:i,relay:u};this.pending.set(i,l);const p=await this.rpcSubscribe(i,u);return this.onSubscribe(p,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:o}}),p}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(i,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(i,o.id,o):await this.unsubscribeByTopic(i,o)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((o,u)=>{const l=new me.Watch;l.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=FE&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=ke.generateChildLogger(n,this.name),this.clientId=""}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,n){let i=!1;try{i=this.getSubscription(r).topic===n}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,n){const i=this.topicMap.get(r);await Promise.all(i.map(async o=>await this.unsubscribeById(r,o,n)))}async unsubscribeById(r,n,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:n,opts:i}});try{const o=qc(i);await this.rpcUnsubscribe(r,n,o);const u=Gt("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,n,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:n,opts:i}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,n){const i={method:Eo(n.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await es(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Yt.connection_stalled)}return _i(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const n=r[0].relay,i={method:Eo(n.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await es(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Yt.connection_stalled)}}rpcUnsubscribe(r,n,i){const o={method:Eo(i.protocol).unsubscribe,params:{topic:r,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,n){this.setSubscription(r,Tc(Fi({},n),{id:r})),this.pending.delete(n.topic)}onBatchSubscribe(r){r.length&&r.forEach(n=>{this.setSubscription(n.id,Fi({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(r,n,i){this.events.removeAllListeners(n),this.hasSubscription(n,r)&&this.deleteSubscription(n,i),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,n){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:n}),this.addSubscription(r,n))}addSubscription(r,n){this.subscriptions.set(r,Fi({},n)),this.topicMap.set(n.topic,r),this.events.emit(jr.created,n)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const n=this.subscriptions.get(r);if(!n){const{message:i}=de("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return n}deleteSubscription(r,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:n});const i=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(i.topic,r),this.events.emit(jr.deleted,Tc(Fi({},i),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(jr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(jr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:n}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const n=await this.rpcBatchSubscribe(r);bi(n)&&this.onBatchSubscribe(n.map((i,o)=>Tc(Fi({},r[o]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(n=>{r.push(n)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(Ii.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Yt.connect,async()=>{await this.onConnect()}),this.relayer.on(Yt.disconnect,()=>{this.onDisconnect()}),this.events.on(jr.created,async r=>{const n=jr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:r}),await this.persist()}),this.events.on(jr.deleted,async r=>{const n=jr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const n=setInterval(()=>{this.restartInProgress||(clearInterval(n),r())},this.pollingInterval)})}}var pI=Object.defineProperty,pf=Object.getOwnPropertySymbols,dI=Object.prototype.hasOwnProperty,gI=Object.prototype.propertyIsEnumerable,df=(a,r,n)=>r in a?pI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,vI=(a,r)=>{for(var n in r||(r={}))dI.call(r,n)&&df(a,n,r[n]);if(pf)for(var n of pf(r))gI.call(r,n)&&df(a,n,r[n]);return a};class yI extends ob{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Rr.EventEmitter,this.name=ME,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async n=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(n)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=n=>{this.onProviderPayload(n)},this.onConnectHandler=()=>{this.events.emit(Yt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=n=>{this.logger.error(n),this.events.emit(Yt.error,n),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(cn.payload,this.onPayloadHandler),this.provider.on(cn.connect,this.onConnectHandler),this.provider.on(cn.disconnect,this.onDisconnectHandler),this.provider.on(cn.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?ke.generateChildLogger(r.logger,this.name):ke.pino(ke.getDefaultLoggerOptions({level:r.logger||jE})),this.messages=new iI(this.logger,r.core),this.subscriber=new fI(this,this.logger),this.publisher=new sI(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Cp,this.projectId=r.projectId,this.bundleId=Fw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${hf}...`),await this.restartTransport(hf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},$E)}get context(){return ke.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,n,i){this.isInitialized(),await this.publisher.publish(r,n,i),await this.recordMessageEvent({topic:r,message:n,publishedAt:Date.now()})}async subscribe(r,n){var i;this.isInitialized();let o=((i=this.subscriber.topicMap.get(r))==null?void 0:i[0])||"";if(o)return o;let u;const l=p=>{p.topic===r&&(this.subscriber.off(jr.created,l),u())};return await Promise.all([new Promise(p=>{u=p,this.subscriber.on(jr.created,l)}),new Promise(async p=>{o=await this.subscriber.subscribe(r,n),p()})]),o}async unsubscribe(r,n){this.isInitialized(),await this.subscriber.unsubscribe(r,n)}on(r,n){this.events.on(r,n)}once(r,n){this.events.once(r,n)}off(r,n){this.events.off(r,n)}removeListener(r,n){this.events.removeListener(r,n)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await es(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(n=>{if(!this.initialized)return n();this.subscriber.once(jr.resubscribed,()=>{n()})}),new Promise(async(n,i)=>{try{await es(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){i(o);return}n()})])}catch(n){this.logger.error(n);const i=n;if(!this.isConnectionStalled(i.message))throw n;this.provider.events.emit(cn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await cl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(n=>r.includes(n))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ln(new Gb(Ww({sdkVersion:zE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:n,message:i}=r;await this.messages.set(n,i)}async shouldIgnoreMessageEvent(r){const{topic:n,message:i}=r;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(n))return this.logger.debug(`Ignoring message for non-subscribed topic ${n}`),!0;const o=this.messages.has(n,i);return o&&this.logger.debug(`Ignoring duplicate message: ${i}`),o}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Zc(r)){if(!r.method.endsWith(qE))return;const n=r.params,{topic:i,message:o,publishedAt:u}=n.data,l={topic:i,message:o,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vI({type:"event",event:n.id},l)),this.events.emit(n.id,l),await this.acknowledgePayload(r),await this.onMessageEvent(l)}else Do(r)&&this.events.emit(Yt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Yt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const n=No(r.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(cn.payload,this.onPayloadHandler),this.provider.off(cn.connect,this.onConnectHandler),this.provider.off(cn.disconnect,this.onDisconnectHandler),this.provider.off(cn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Yt.connection_stalled,()=>{this.restartTransport().catch(n=>this.logger.error(n))});let r=await cl();Gw(async n=>{this.initialized&&r!==n&&(r=n,n?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(Yt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},me.toMiliseconds(UE)))}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const n=setInterval(()=>{this.connected&&(clearInterval(n),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var mI=Object.defineProperty,gf=Object.getOwnPropertySymbols,_I=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,vf=(a,r,n)=>r in a?mI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,yf=(a,r)=>{for(var n in r||(r={}))_I.call(r,n)&&vf(a,n,r[n]);if(gf)for(var n of gf(r))wI.call(r,n)&&vf(a,n,r[n]);return a};class jo extends ab{constructor(r,n,i,o=Pn,u=void 0){super(r,n,i,o),this.core=r,this.logger=n,this.name=i,this.map=new Map,this.version=BE,this.cached=[],this.initialized=!1,this.storagePrefix=Pn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!xn(l)?this.map.set(this.getKey(l),l):kw(l)?this.map.set(l.id,l):jw(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,p)=>{this.isInitialized(),this.map.has(l)?await this.update(l,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:p}),this.map.set(l,p),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(p=>Object.keys(l).every(_=>Qb(p[_],l[_]))):this.values),this.update=async(l,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:p});const _=yf(yf({},this.getData(l)),p);this.map.set(l,_),await this.persist()},this.delete=async(l,p)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:p}),this.map.delete(l),await this.persist())},this.logger=ke.generateChildLogger(n,this.name),this.storagePrefix=o,this.getKey=u}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const n=this.map.get(r);if(!n){const{message:i}=de("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(i),new Error(i)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:n}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class bI{constructor(r,n){this.core=r,this.logger=n,this.name=WE,this.version=GE,this.events=new Wc,this.initialized=!1,this.storagePrefix=Pn,this.ignoredPayloadTypes=[Bf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Mc(),o=await this.core.crypto.setSymKey(i),u=Mr(me.FIVE_MINUTES),l={protocol:Op},p={topic:o,expiry:u,relay:l,active:!1},_=Yw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:i,relay:l});return await this.pairings.set(o,p),await this.core.relayer.subscribe(o),this.core.expirer.set(o,u),{topic:o,uri:_}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:o,symKey:u,relay:l}=ul(i.uri);let p;if(this.pairings.keys.includes(o)&&(p=this.pairings.get(o),p.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const _=Mr(me.FIVE_MINUTES),g={topic:o,relay:l,expiry:_,active:!1};return await this.pairings.set(o,g),this.core.expirer.set(o,_),i.activatePairing&&await this.activate({topic:o}),this.events.emit(Ji.create,g),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(u,o),await this.core.relayer.subscribe(o,{relay:l})),g},this.activate=async({topic:i})=>{this.isInitialized();const o=Mr(me.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:o}),this.core.expirer.set(i,o)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:o}=i;if(this.pairings.keys.includes(o)){const u=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:p,reject:_}=vi();this.events.once(Mt("pairing_ping",u),({error:g})=>{g?_(g):p()}),await l()}},this.updateExpiry=async({topic:i,expiry:o})=>{this.isInitialized(),await this.pairings.update(i,{expiry:o})},this.updateMetadata=async({topic:i,metadata:o})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:o}=i;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(i,o,u)=>{const l=wi(o,u),p=await this.core.crypto.encode(i,l),_=Ki[o].req;return this.core.history.set(i,l),this.core.relayer.publish(i,p,_),l.id},this.sendResult=async(i,o,u)=>{const l=No(i,u),p=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,i),g=Ki[_.request.method].res;await this.core.relayer.publish(o,p,g),await this.core.history.resolve(l)},this.sendError=async(i,o,u)=>{const l=Lo(i,u),p=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,i),g=Ki[_.request.method]?Ki[_.request.method].res:Ki.unregistered_method.res;await this.core.relayer.publish(o,p,g),await this.core.history.resolve(l)},this.deletePairing=async(i,o)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),o?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(o=>Sn(o.expiry));await Promise.all(i.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=i=>{const{topic:o,payload:u}=i;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(o,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,u);default:return this.onUnknownRpcMethodRequest(o,u)}},this.onRelayEventResponse=async i=>{const{topic:o,payload:u}=i,l=(await this.core.history.get(o,u.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,u);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(i,o)=>{const{id:u}=o;try{this.isValidPing({topic:i}),await this.sendResult(u,i,!0),this.events.emit(Ji.ping,{id:u,topic:i})}catch(l){await this.sendError(u,i,l),this.logger.error(l)}},this.onPairingPingResponse=(i,o)=>{const{id:u}=o;setTimeout(()=>{hn(o)?this.events.emit(Mt("pairing_ping",u),{}):qr(o)&&this.events.emit(Mt("pairing_ping",u),{error:o.error})},500)},this.onPairingDeleteRequest=async(i,o)=>{const{id:u}=o;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(Ji.delete,{id:u,topic:i})}catch(l){await this.sendError(u,i,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(i,o)=>{const{id:u,method:l}=o;try{if(this.registeredMethods.includes(l))return;const p=Gt("WC_METHOD_UNSUPPORTED",l);await this.sendError(u,i,p),this.logger.error(p)}catch(p){await this.sendError(u,i,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{var o;if(!fr(i)){const{message:l}=de("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(l)}if(!Qw(i.uri)){const{message:l}=de("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(l)}const u=ul(i.uri);if(!((o=u==null?void 0:u.relay)!=null&&o.protocol)){const{message:l}=de("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(u!=null&&u.symKey)){const{message:l}=de("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async i=>{if(!fr(i)){const{message:u}=de("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(u)}const{topic:o}=i;await this.isValidPairingTopic(o)},this.isValidDisconnect=async i=>{if(!fr(i)){const{message:u}=de("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(u)}const{topic:o}=i;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async i=>{if(!yi(i,!1)){const{message:o}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(o)}if(!this.pairings.keys.includes(i)){const{message:o}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(o)}if(Sn(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:o}=de("EXPIRED",`pairing topic: ${i}`);throw new Error(o)}},this.core=r,this.logger=ke.generateChildLogger(n,this.name),this.pairings=new jo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ke.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Yt.message,async r=>{const{topic:n,message:i}=r;if(!this.pairings.keys.includes(n)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const o=await this.core.crypto.decode(n,i);try{Zc(o)?(this.core.history.set(n,o),this.onRelayEventRequest({topic:n,payload:o})):Do(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:n,payload:o}),this.core.history.delete(n,o.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async r=>{const{topic:n}=Vf(r.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Ji.expire,{topic:n}))})}}class EI extends nb{constructor(r,n){super(r,n),this.core=r,this.logger=n,this.records=new Map,this.events=new Rr.EventEmitter,this.name=YE,this.version=QE,this.cached=[],this.initialized=!1,this.storagePrefix=Pn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,o,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:o,chainId:u}),this.records.has(o.id))return;const l={id:o.id,topic:i,request:{method:o.method,params:o.params||null},chainId:u,expiry:Mr(me.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Fr.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const o=await this.getRecord(i.id);typeof o.response>"u"&&(o.response=qr(i)?{error:i.error}:{result:i.result},this.records.set(o.id,o),this.events.emit(Fr.updated,o))},this.get=async(i,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:o}),await this.getRecord(o)),this.delete=(i,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(u=>{if(u.topic===i){if(typeof o<"u"&&u.id!==o)return;this.records.delete(u.id),this.events.emit(Fr.deleted,u)}})},this.exists=async(i,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===i:!1),this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=ke.generateChildLogger(n,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const i={topic:n.topic,request:wi(n.request.method,n.request.params,n.id),chainId:n.chainId};return r.push(i)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const n=this.records.get(r);if(!n){const{message:i}=de("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Fr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:n}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Fr.created,r=>{const n=Fr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:r}),this.persist()}),this.events.on(Fr.updated,r=>{const n=Fr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:r}),this.persist()}),this.events.on(Fr.deleted,r=>{const n=Fr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:r}),this.persist()}),this.core.heartbeat.on(Ii.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{me.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class II extends ub{constructor(r,n){super(r,n),this.core=r,this.logger=n,this.expirations=new Map,this.events=new Rr.EventEmitter,this.name=JE,this.version=XE,this.cached=[],this.initialized=!1,this.storagePrefix=Pn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const o=this.formatTarget(i);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(i,o)=>{this.isInitialized();const u=this.formatTarget(i),l={target:u,expiry:o};this.expirations.set(u,l),this.checkExpiry(u,l),this.events.emit(Cr.created,{target:u,expiration:l})},this.get=i=>{this.isInitialized();const o=this.formatTarget(i);return this.getExpiration(o)},this.del=i=>{if(this.isInitialized(),this.has(i)){const o=this.formatTarget(i),u=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Cr.deleted,{target:o,expiration:u})}},this.on=(i,o)=>{this.events.on(i,o)},this.once=(i,o)=>{this.events.once(i,o)},this.off=(i,o)=>{this.events.off(i,o)},this.removeListener=(i,o)=>{this.events.removeListener(i,o)},this.logger=ke.generateChildLogger(n,this.name)}get context(){return ke.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return Jw(r);if(typeof r=="number")return Xw(r);const{message:n}=de("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(n)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:n}=de("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const n=this.expirations.get(r);if(!n){const{message:i}=de("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(i),new Error(i)}return n}checkExpiry(r,n){const{expiry:i}=n;me.toMiliseconds(i)-Date.now()<=0&&this.expire(r,n)}expire(r,n){this.expirations.delete(r),this.events.emit(Cr.expired,{target:r,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,n)=>this.checkExpiry(n,r))}registerEventListeners(){this.core.heartbeat.on(Ii.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,r=>{const n=Cr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:r}),this.persist()}),this.events.on(Cr.expired,r=>{const n=Cr.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:r}),this.persist()}),this.events.on(Cr.deleted,r=>{const n=Cr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}}}class SI extends hb{constructor(r,n){super(r,n),this.projectId=r,this.logger=n,this.name=Rc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||Zw()||!Hf())return;const o=this.getVerifyUrl(i==null?void 0:i.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Bc;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(i==null?void 0:i.verifyUrl);let u;try{u=await this.fetchAttestation(i.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${o}`),this.logger.info(l),u=await this.fetchAttestation(i.attestationId,Bc)}return u},this.fetchAttestation=async(i,o)=>{this.logger.info(`resolving attestation: ${i} from url: ${o}`);const u=this.startAbortTimer(me.ONE_SECOND*2),l=await fetch(`${o}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(u),l.status===200?await l.json():void 0},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;const o=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),i())};await Promise.race([new Promise(u=>{if(document.getElementById(Rc))return u();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=Rc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,i=u}),new Promise((u,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},me.toMiliseconds(me.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let o=i||mi;return ZE.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${mi}`),o=mi),o},this.logger=ke.generateChildLogger(n,this.name),this.verifyUrl=mi,this.abortController=new AbortController,this.isDevEnv=e0()&&g0.IS_VITEST}get context(){return ke.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),me.toMiliseconds(r))}}class xI extends lb{constructor(r,n){super(r,n),this.projectId=r,this.logger=n,this.context=eI,this.registerDeviceToken=async i=>{const{clientId:o,token:u,notificationType:l,enableEncrypted:p=!1}=i,_=`${tI}/${this.projectId}/clients`;await e1(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:u,always_raw:p})})},this.logger=ke.generateChildLogger(n,this.context)}}var PI=Object.defineProperty,mf=Object.getOwnPropertySymbols,OI=Object.prototype.hasOwnProperty,CI=Object.prototype.propertyIsEnumerable,_f=(a,r,n)=>r in a?PI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,wf=(a,r)=>{for(var n in r||(r={}))OI.call(r,n)&&_f(a,n,r[n]);if(mf)for(var n of mf(r))CI.call(r,n)&&_f(a,n,r[n]);return a};class tu extends rb{constructor(r){super(r),this.protocol=Pp,this.version=xE,this.name=eu,this.events=new Rr.EventEmitter,this.initialized=!1,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Cp,this.customStoragePrefix=r!=null&&r.customStoragePrefix?`:${r.customStoragePrefix}`:"";const n=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:ke.pino(ke.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||PE.logger}));this.logger=ke.generateChildLogger(n,this.name),this.heartbeat=new Ii.HeartBeat,this.crypto=new nI(this,this.logger,r==null?void 0:r.keychain),this.history=new EI(this,this.logger),this.expirer=new II(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new W0(wf(wf({},OE),r==null?void 0:r.storageOptions)),this.relayer=new yI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new bI(this,this.logger),this.verify=new SI(this.projectId||"",this.logger),this.echoClient=new xI(this.projectId||"",this.logger)}static async init(r){const n=new tu(r);await n.initialize();const i=await n.crypto.getClientId();return await n.storage.setItem(HE,i),n}get context(){return ke.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const RI=tu,Rp="wc",Tp=2,Ap="client",ru=`${Rp}@${Tp}:${Ap}:`,Ac={name:Ap,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},bf="WALLETCONNECT_DEEPLINK_CHOICE",TI="proposal",Np="Proposal expired",AI="session",mo=me.SEVEN_DAYS,NI="engine",Wi={wc_sessionPropose:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1104},res:{ttl:me.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1106},res:{ttl:me.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:me.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:me.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:me.ONE_DAY,prompt:!1,tag:1112},res:{ttl:me.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:me.THIRTY_SECONDS,prompt:!1,tag:1115}}},Nc={min:me.FIVE_MINUTES,max:me.SEVEN_DAYS},un={idle:"IDLE",active:"ACTIVE"},LI="request",DI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var kI=Object.defineProperty,jI=Object.defineProperties,MI=Object.getOwnPropertyDescriptors,Ef=Object.getOwnPropertySymbols,qI=Object.prototype.hasOwnProperty,UI=Object.prototype.propertyIsEnumerable,If=(a,r,n)=>r in a?kI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,hr=(a,r)=>{for(var n in r||(r={}))qI.call(r,n)&&If(a,n,r[n]);if(Ef)for(var n of Ef(r))UI.call(r,n)&&If(a,n,r[n]);return a},Gi=(a,r)=>jI(a,MI(r));class zI extends pb{constructor(r){super(r),this.name=NI,this.events=new Wc,this.initialized=!1,this.ignoredPayloadTypes=[Bf],this.requestQueue={state:un.idle,queue:[]},this.sessionRequestQueue={state:un.idle,queue:[]},this.requestQueueDelay=me.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Wi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},me.toMiliseconds(this.requestQueueDelay)))},this.connect=async n=>{await this.isInitialized();const i=Gi(hr({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:o,requiredNamespaces:u,optionalNamespaces:l,sessionProperties:p,relays:_}=i;let g=o,m,E=!1;if(g&&(E=this.client.core.pairing.pairings.get(g).active),!g||!E){const{topic:q,uri:I}=await this.client.core.pairing.create();g=q,m=I}const P=await this.client.core.crypto.generateKeyPair(),A=hr({requiredNamespaces:u,optionalNamespaces:l,relays:_??[{protocol:Op}],proposer:{publicKey:P,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:O,resolve:L,done:H}=vi(me.FIVE_MINUTES,Np);if(this.events.once(Mt("session_connect"),async({error:q,session:I})=>{if(q)O(q);else if(I){I.self.publicKey=P;const C=Gi(hr({},I),{requiredNamespaces:I.requiredNamespaces,optionalNamespaces:I.optionalNamespaces});await this.client.session.set(I.topic,C),await this.setExpiry(I.topic,I.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:I.peer.metadata}),L(C)}}),!g){const{message:q}=de("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(q)}const B=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:A}),z=Mr(me.FIVE_MINUTES);return await this.setProposal(B,hr({id:B,expiry:z},A)),{uri:m,approval:H}},this.pair=async n=>(await this.isInitialized(),await this.client.core.pairing.pair(n)),this.approve=async n=>{await this.isInitialized(),await this.isValidApprove(n);const{id:i,relayProtocol:o,namespaces:u,sessionProperties:l}=n,p=this.client.proposal.get(i);let{pairingTopic:_,proposer:g,requiredNamespaces:m,optionalNamespaces:E}=p;_=_||"",bo(m)||(m=mw(u,"approve()"));const P=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,O=await this.client.core.crypto.generateSharedKey(P,A);_&&i&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:g.metadata}),await this.sendResult({id:i,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:P}}),await this.client.proposal.delete(i,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const L=hr({relay:{protocol:o??"irn"},namespaces:u,requiredNamespaces:m,optionalNamespaces:E,pairingTopic:_,controller:{publicKey:P,metadata:this.client.metadata},expiry:Mr(mo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(O),await this.sendRequest({topic:O,method:"wc_sessionSettle",params:L,throwOnFailedPublish:!0});const H=Gi(hr({},L),{topic:O,pairingTopic:_,acknowledged:!1,self:L.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:P});return await this.client.session.set(O,H),await this.setExpiry(O,Mr(mo)),{topic:O,acknowledged:()=>new Promise(B=>setTimeout(()=>B(this.client.session.get(O)),500))}},this.reject=async n=>{await this.isInitialized(),await this.isValidReject(n);const{id:i,reason:o}=n,{pairingTopic:u}=this.client.proposal.get(i);u&&(await this.sendError(i,u,o),await this.client.proposal.delete(i,Gt("USER_DISCONNECTED")))},this.update=async n=>{await this.isInitialized(),await this.isValidUpdate(n);const{topic:i,namespaces:o}=n,u=await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:p,reject:_}=vi();return this.events.once(Mt("session_update",u),({error:g})=>{g?_(g):p()}),await this.client.session.update(i,{namespaces:o}),{acknowledged:l}},this.extend=async n=>{await this.isInitialized(),await this.isValidExtend(n);const{topic:i}=n,o=await this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:u,resolve:l,reject:p}=vi();return this.events.once(Mt("session_extend",o),({error:_})=>{_?p(_):l()}),await this.setExpiry(i,Mr(mo)),{acknowledged:u}},this.request=async n=>{await this.isInitialized(),await this.isValidRequest(n);const{chainId:i,request:o,topic:u,expiry:l}=n,p=Xc(),{done:_,resolve:g,reject:m}=vi(l,"Request expired. Please try again.");return this.events.once(Mt("session_request",p),({error:E,result:P})=>{E?m(E):g(P)}),await Promise.all([new Promise(async E=>{await this.sendRequest({clientRpcId:p,topic:u,method:"wc_sessionRequest",params:{request:o,chainId:i},expiry:l,throwOnFailedPublish:!0}).catch(P=>m(P)),this.client.events.emit("session_request_sent",{topic:u,request:o,chainId:i,id:p}),E()}),new Promise(async E=>{const P=await _w(this.client.core.storage,bf);ww({id:p,topic:u,wcDeepLink:P}),E()}),_()]).then(E=>E[2])},this.respond=async n=>{await this.isInitialized(),await this.isValidRespond(n);const{topic:i,response:o}=n,{id:u}=o;hn(o)?await this.sendResult({id:u,topic:i,result:o.result,throwOnFailedPublish:!0}):qr(o)&&await this.sendError(u,i,o.error),this.cleanupAfterResponse(n)},this.ping=async n=>{await this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.client.session.keys.includes(i)){const o=await this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:u,resolve:l,reject:p}=vi();this.events.once(Mt("session_ping",o),({error:_})=>{_?p(_):l()}),await u()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async n=>{await this.isInitialized(),await this.isValidEmit(n);const{topic:i,event:o,chainId:u}=n;await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:o,chainId:u}})},this.disconnect=async n=>{await this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.client.session.keys.includes(i)?(await this.sendRequest({topic:i,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=n=>(this.isInitialized(),this.client.session.getAll().filter(i=>bw(i,n))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async n=>{if(n.pairingTopic)try{const i=this.client.core.pairing.pairings.get(n.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(u=>{var l,p;return((l=u.peerMetadata)==null?void 0:l.url)&&((p=u.peerMetadata)==null?void 0:p.url)===n.peer.metadata.url&&u.topic&&u.topic!==i.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(n,i)=>{const{self:o}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),this.client.session.delete(n,Gt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),i||this.client.core.expirer.del(n),this.client.core.storage.removeItem(bf).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===n&&this.deletePendingSessionRequest(u.id,Gt("USER_DISCONNECTED"))})},this.deleteProposal=async(n,i)=>{await Promise.all([this.client.proposal.delete(n,Gt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(n)])},this.deletePendingSessionRequest=async(n,i,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,i),o?Promise.resolve():this.client.core.expirer.del(n)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==n),o&&(this.sessionRequestQueue.state=un.idle)},this.setExpiry=async(n,i)=>{this.client.session.keys.includes(n)&&await this.client.session.update(n,{expiry:i}),this.client.core.expirer.set(n,i)},this.setProposal=async(n,i)=>{await this.client.proposal.set(n,i),this.client.core.expirer.set(n,i.expiry)},this.setPendingSessionRequest=async n=>{const i=Wi.wc_sessionRequest.req.ttl,{id:o,topic:u,params:l,verifyContext:p}=n;await this.client.pendingRequest.set(o,{id:o,topic:u,params:l,verifyContext:p}),i&&this.client.core.expirer.set(o,Mr(i))},this.sendRequest=async n=>{const{topic:i,method:o,params:u,expiry:l,relayRpcId:p,clientRpcId:_,throwOnFailedPublish:g}=n,m=wi(o,u,_);if(Hf()&&DI.includes(o)){const A=_i(JSON.stringify(m));this.client.core.verify.register({attestationId:A})}const E=await this.client.core.crypto.encode(i,m),P=Wi[o].req;return l&&(P.ttl=l),p&&(P.id=p),this.client.core.history.set(i,m),g?(P.internal=Gi(hr({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,E,P)):this.client.core.relayer.publish(i,E,P).catch(A=>this.client.logger.error(A)),m.id},this.sendResult=async n=>{const{id:i,topic:o,result:u,throwOnFailedPublish:l}=n,p=No(i,u),_=await this.client.core.crypto.encode(o,p),g=await this.client.core.history.get(o,i),m=Wi[g.request.method].res;l?(m.internal=Gi(hr({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,m)):this.client.core.relayer.publish(o,_,m).catch(E=>this.client.logger.error(E)),await this.client.core.history.resolve(p)},this.sendError=async(n,i,o)=>{const u=Lo(n,o),l=await this.client.core.crypto.encode(i,u),p=await this.client.core.history.get(i,n),_=Wi[p.request.method].res;this.client.core.relayer.publish(i,l,_),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const n=[],i=[];this.client.session.getAll().forEach(o=>{Sn(o.expiry)&&n.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Sn(o.expiry)&&i.push(o.id)}),await Promise.all([...n.map(o=>this.deleteSession(o)),...i.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===un.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=un.active;const n=this.requestQueue.queue.shift();if(n)try{this.processRequest(n),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=un.idle},this.processRequest=n=>{const{topic:i,payload:o}=n,u=o.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(i,o);case"wc_sessionSettle":return this.onSessionSettleRequest(i,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,o);case"wc_sessionExtend":return this.onSessionExtendRequest(i,o);case"wc_sessionPing":return this.onSessionPingRequest(i,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,o);case"wc_sessionRequest":return this.onSessionRequest(i,o);case"wc_sessionEvent":return this.onSessionEventRequest(i,o);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:o}=n,u=(await this.client.core.history.get(i,o.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(i,o);case"wc_sessionSettle":return this.onSessionSettleResponse(i,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,o);case"wc_sessionExtend":return this.onSessionExtendResponse(i,o);case"wc_sessionPing":return this.onSessionPingResponse(i,o);case"wc_sessionRequest":return this.onSessionRequestResponse(i,o);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=n=>{const{topic:i}=n,{message:o}=de("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(n,i)=>{const{params:o,id:u}=i;try{this.isValidConnect(hr({},i.params));const l=Mr(me.FIVE_MINUTES),p=hr({id:u,pairingTopic:n,expiry:l},o);await this.setProposal(u,p);const _=_i(JSON.stringify(i)),g=await this.getVerifyContext(_,p.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:p,verifyContext:g})}catch(l){await this.sendError(u,n,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(n,i)=>{const{id:o}=i;if(hn(i)){const{result:u}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const p=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const _=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const g=await this.client.core.crypto.generateSharedKey(p,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const m=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:n})}else qr(i)&&(await this.client.proposal.delete(o,Gt("USER_DISCONNECTED")),this.events.emit(Mt("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(n,i)=>{const{id:o,params:u}=i;try{this.isValidSessionSettleRequest(u);const{relay:l,controller:p,expiry:_,namespaces:g,requiredNamespaces:m,optionalNamespaces:E,sessionProperties:P,pairingTopic:A}=i.params,O=hr({topic:n,relay:l,expiry:_,namespaces:g,acknowledged:!0,pairingTopic:A,requiredNamespaces:m,optionalNamespaces:E,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},P&&{sessionProperties:P});await this.sendResult({id:i.id,topic:n,result:!0}),this.events.emit(Mt("session_connect"),{session:O}),this.cleanupDuplicatePairings(O)}catch(l){await this.sendError(o,n,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(n,i)=>{const{id:o}=i;hn(i)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Mt("session_approve",o),{})):qr(i)&&(await this.client.session.delete(n,Gt("USER_DISCONNECTED")),this.events.emit(Mt("session_approve",o),{error:i.error}))},this.onSessionUpdateRequest=async(n,i)=>{const{params:o,id:u}=i;try{const l=`${n}_session_update`,p=co.get(l);if(p&&this.isRequestOutOfSync(p,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(hr({topic:n},o)),await this.client.session.update(n,{namespaces:o.namespaces}),await this.sendResult({id:u,topic:n,result:!0}),this.client.events.emit("session_update",{id:u,topic:n,params:o}),co.set(l,u)}catch(l){await this.sendError(u,n,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(n,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(n.toString().slice(0,-3)),this.onSessionUpdateResponse=(n,i)=>{const{id:o}=i;hn(i)?this.events.emit(Mt("session_update",o),{}):qr(i)&&this.events.emit(Mt("session_update",o),{error:i.error})},this.onSessionExtendRequest=async(n,i)=>{const{id:o}=i;try{this.isValidExtend({topic:n}),await this.setExpiry(n,Mr(mo)),await this.sendResult({id:o,topic:n,result:!0}),this.client.events.emit("session_extend",{id:o,topic:n})}catch(u){await this.sendError(o,n,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(n,i)=>{const{id:o}=i;hn(i)?this.events.emit(Mt("session_extend",o),{}):qr(i)&&this.events.emit(Mt("session_extend",o),{error:i.error})},this.onSessionPingRequest=async(n,i)=>{const{id:o}=i;try{this.isValidPing({topic:n}),await this.sendResult({id:o,topic:n,result:!0}),this.client.events.emit("session_ping",{id:o,topic:n})}catch(u){await this.sendError(o,n,u),this.client.logger.error(u)}},this.onSessionPingResponse=(n,i)=>{const{id:o}=i;setTimeout(()=>{hn(i)?this.events.emit(Mt("session_ping",o),{}):qr(i)&&this.events.emit(Mt("session_ping",o),{error:i.error})},500)},this.onSessionDeleteRequest=async(n,i)=>{const{id:o}=i;try{this.isValidDisconnect({topic:n,reason:i.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Yt.publish,async()=>{u(await this.deleteSession(n))})}),this.sendResult({id:o,topic:n,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:n})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(n,i)=>{const{id:o,params:u}=i;try{this.isValidRequest(hr({topic:n},u));const l=_i(JSON.stringify(wi("wc_sessionRequest",u,o))),p=this.client.session.get(n),_=await this.getVerifyContext(l,p.peer.metadata),g={id:o,topic:n,params:u,verifyContext:_};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(l){await this.sendError(o,n,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(n,i)=>{const{id:o}=i;hn(i)?this.events.emit(Mt("session_request",o),{result:i.result}):qr(i)&&this.events.emit(Mt("session_request",o),{error:i.error})},this.onSessionEventRequest=async(n,i)=>{const{id:o,params:u}=i;try{const l=`${n}_session_event_${u.event.name}`,p=co.get(l);if(p&&this.isRequestOutOfSync(p,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(hr({topic:n},u)),this.client.events.emit("session_event",{id:o,topic:n,params:u}),co.set(l,o)}catch(l){await this.sendError(o,n,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=n=>{this.sessionRequestQueue.queue.push(n)},this.cleanupAfterResponse=n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=un.idle,this.processSessionRequestQueue()},me.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===un.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=un.active,this.client.events.emit("session_request",n)}catch(i){this.client.logger.error(i)}},this.onPairingCreated=n=>{if(n.active)return;const i=this.client.proposal.getAll().find(o=>o.pairingTopic===n.topic);i&&this.onSessionProposeRequest(n.topic,wi("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id))},this.isValidConnect=async n=>{if(!fr(n)){const{message:_}=de("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(_)}const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:u,sessionProperties:l,relays:p}=n;if(xn(i)||await this.isValidPairingTopic(i),!Ew(p,!0)){const{message:_}=de("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(_)}!xn(o)&&bo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!xn(u)&&bo(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),xn(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(n,i)=>{const o=Iw(n,"connect()",i);if(o)throw new Error(o.message)},this.isValidApprove=async n=>{if(!fr(n))throw new Error(de("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:i,namespaces:o,relayProtocol:u,sessionProperties:l}=n;await this.isValidProposalId(i);const p=this.client.proposal.get(i),_=cc(o,"approve()");if(_)throw new Error(_.message);const g=il(p.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!yi(u,!0)){const{message:m}=de("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(m)}xn(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async n=>{if(!fr(n)){const{message:u}=de("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(u)}const{id:i,reason:o}=n;if(await this.isValidProposalId(i),!Sw(o)){const{message:u}=de("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidSessionSettleRequest=n=>{if(!fr(n)){const{message:g}=de("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(g)}const{relay:i,controller:o,namespaces:u,expiry:l}=n;if(!xw(i)){const{message:g}=de("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const p=Pw(o,"onSessionSettleRequest()");if(p)throw new Error(p.message);const _=cc(u,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Sn(l)){const{message:g}=de("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async n=>{if(!fr(n)){const{message:_}=de("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(_)}const{topic:i,namespaces:o}=n;await this.isValidSessionTopic(i);const u=this.client.session.get(i),l=cc(o,"update()");if(l)throw new Error(l.message);const p=il(u.requiredNamespaces,o,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async n=>{if(!fr(n)){const{message:o}=de("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(o)}const{topic:i}=n;await this.isValidSessionTopic(i)},this.isValidRequest=async n=>{if(!fr(n)){const{message:_}=de("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(_)}const{topic:i,request:o,chainId:u,expiry:l}=n;await this.isValidSessionTopic(i);const{namespaces:p}=this.client.session.get(i);if(!sl(p,u)){const{message:_}=de("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(_)}if(!Ow(o)){const{message:_}=de("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!Cw(p,u,o.method)){const{message:_}=de("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(l&&!Rw(l,Nc)){const{message:_}=de("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${Nc.min} and ${Nc.max}`);throw new Error(_)}},this.isValidRespond=async n=>{var i;if(!fr(n)){const{message:l}=de("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(l)}const{topic:o,response:u}=n;try{await this.isValidSessionTopic(o)}catch(l){throw(i=n==null?void 0:n.response)!=null&&i.id&&this.cleanupAfterResponse(n),l}if(!Tw(u)){const{message:l}=de("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(u)}`);throw new Error(l)}},this.isValidPing=async n=>{if(!fr(n)){const{message:o}=de("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(o)}const{topic:i}=n;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async n=>{if(!fr(n)){const{message:p}=de("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(p)}const{topic:i,event:o,chainId:u}=n;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!sl(l,u)){const{message:p}=de("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(p)}if(!Aw(o)){const{message:p}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}if(!Nw(l,u,o.name)){const{message:p}=de("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidDisconnect=async n=>{if(!fr(n)){const{message:o}=de("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(o)}const{topic:i}=n;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(n,i)=>{const o={verified:{verifyUrl:i.verifyUrl||mi,validation:"UNKNOWN",origin:i.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:n,verifyUrl:i.verifyUrl});u&&(o.verified.origin=u.origin,o.verified.isScam=u.isScam,o.verified.validation=u.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(n,i)=>{Object.values(n).forEach(o=>{if(!yi(o,!1)){const{message:u}=de("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:r}=de("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Yt.message,async r=>{const{topic:n,message:i}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const o=await this.client.core.crypto.decode(n,i);try{Zc(o)?(this.client.core.history.set(n,o),this.onRelayEventRequest({topic:n,payload:o})):Do(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:n,payload:o}),this.client.core.history.delete(n,o.id)):this.onRelayEventUnknownPayload({topic:n,payload:o})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async r=>{const{topic:n,id:i}=Vf(r.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,de("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession(n,!0),this.client.events.emit("session_expire",{topic:n})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ji.create,r=>this.onPairingCreated(r))}isValidPairingTopic(r){if(!yi(r,!1)){const{message:n}=de("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:n}=de("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(n)}if(Sn(this.client.core.pairing.pairings.get(r).expiry)){const{message:n}=de("EXPIRED",`pairing topic: ${r}`);throw new Error(n)}}async isValidSessionTopic(r){if(!yi(r,!1)){const{message:n}=de("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(n)}if(!this.client.session.keys.includes(r)){const{message:n}=de("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(n)}if(Sn(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:n}=de("EXPIRED",`session topic: ${r}`);throw new Error(n)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(yi(r,!1)){const{message:n}=de("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(n)}else{const{message:n}=de("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(n)}}async isValidProposalId(r){if(!Lw(r)){const{message:n}=de("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(n)}if(!this.client.proposal.keys.includes(r)){const{message:n}=de("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(n)}if(Sn(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:n}=de("EXPIRED",`proposal id: ${r}`);throw new Error(n)}}}class $I extends jo{constructor(r,n){super(r,n,TI,ru),this.core=r,this.logger=n}}class BI extends jo{constructor(r,n){super(r,n,AI,ru),this.core=r,this.logger=n}}class HI extends jo{constructor(r,n){super(r,n,LI,ru,i=>i.id),this.core=r,this.logger=n}}let VI=class Lp extends fb{constructor(r){super(r),this.protocol=Rp,this.version=Tp,this.name=Ac.name,this.events=new Rr.EventEmitter,this.on=(i,o)=>this.events.on(i,o),this.once=(i,o)=>this.events.once(i,o),this.off=(i,o)=>this.events.off(i,o),this.removeListener=(i,o)=>this.events.removeListener(i,o),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(o){throw this.logger.error(o.message),o}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(o){throw this.logger.error(o.message),o}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(o){throw this.logger.error(o.message),o}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(o){throw this.logger.error(o.message),o}},this.update=async i=>{try{return await this.engine.update(i)}catch(o){throw this.logger.error(o.message),o}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(o){throw this.logger.error(o.message),o}},this.request=async i=>{try{return await this.engine.request(i)}catch(o){throw this.logger.error(o.message),o}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(o){throw this.logger.error(o.message),o}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(o){throw this.logger.error(o.message),o}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(o){throw this.logger.error(o.message),o}},this.find=i=>{try{return this.engine.find(i)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(r==null?void 0:r.name)||Ac.name,this.metadata=(r==null?void 0:r.metadata)||yw();const n=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:ke.pino(ke.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Ac.logger}));this.core=(r==null?void 0:r.core)||new RI(r),this.logger=ke.generateChildLogger(n,this.name),this.session=new BI(this.core,this.logger),this.proposal=new $I(this.core,this.logger),this.pendingRequest=new HI(this.core,this.logger),this.engine=new zI(this)}static async init(r){const n=new Lp(r);return await n.initialize(),n}get context(){return ke.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Hc={exports:{}};(function(a,r){var n=typeof self<"u"?self:Ur,i=function(){function u(){this.fetch=!1,this.DOMException=n.DOMException}return u.prototype=n,new u}();(function(u){(function(l){var p={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function _(y){return y&&DataView.prototype.isPrototypeOf(y)}if(p.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(y){return y&&g.indexOf(Object.prototype.toString.call(y))>-1};function E(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(y))throw new TypeError("Invalid character in header field name");return y.toLowerCase()}function P(y){return typeof y!="string"&&(y=String(y)),y}function A(y){var T={next:function(){var ce=y.shift();return{done:ce===void 0,value:ce}}};return p.iterable&&(T[Symbol.iterator]=function(){return T}),T}function O(y){this.map={},y instanceof O?y.forEach(function(T,ce){this.append(ce,T)},this):Array.isArray(y)?y.forEach(function(T){this.append(T[0],T[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(T){this.append(T,y[T])},this)}O.prototype.append=function(y,T){y=E(y),T=P(T);var ce=this.map[y];this.map[y]=ce?ce+", "+T:T},O.prototype.delete=function(y){delete this.map[E(y)]},O.prototype.get=function(y){return y=E(y),this.has(y)?this.map[y]:null},O.prototype.has=function(y){return this.map.hasOwnProperty(E(y))},O.prototype.set=function(y,T){this.map[E(y)]=P(T)},O.prototype.forEach=function(y,T){for(var ce in this.map)this.map.hasOwnProperty(ce)&&y.call(T,this.map[ce],ce,this)},O.prototype.keys=function(){var y=[];return this.forEach(function(T,ce){y.push(ce)}),A(y)},O.prototype.values=function(){var y=[];return this.forEach(function(T){y.push(T)}),A(y)},O.prototype.entries=function(){var y=[];return this.forEach(function(T,ce){y.push([ce,T])}),A(y)},p.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function L(y){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}function H(y){return new Promise(function(T,ce){y.onload=function(){T(y.result)},y.onerror=function(){ce(y.error)}})}function B(y){var T=new FileReader,ce=H(T);return T.readAsArrayBuffer(y),ce}function z(y){var T=new FileReader,ce=H(T);return T.readAsText(y),ce}function q(y){for(var T=new Uint8Array(y),ce=new Array(T.length),ue=0;ue<T.length;ue++)ce[ue]=String.fromCharCode(T[ue]);return ce.join("")}function I(y){if(y.slice)return y.slice(0);var T=new Uint8Array(y.byteLength);return T.set(new Uint8Array(y)),T.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(y){this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:p.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:p.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():p.arrayBuffer&&p.blob&&_(y)?(this._bodyArrayBuffer=I(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||m(y))?this._bodyArrayBuffer=I(y):this._bodyText=y=Object.prototype.toString.call(y):this._bodyText="",this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var y=L(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?L(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(B)}),this.text=function(){var y=L(this);if(y)return y;if(this._bodyBlob)return z(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(q(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ae)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function N(y){var T=y.toUpperCase();return S.indexOf(T)>-1?T:y}function U(y,T){T=T||{};var ce=T.body;if(y instanceof U){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,T.headers||(this.headers=new O(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!ce&&y._bodyInit!=null&&(ce=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=T.credentials||this.credentials||"same-origin",(T.headers||!this.headers)&&(this.headers=new O(T.headers)),this.method=N(T.method||this.method||"GET"),this.mode=T.mode||this.mode||null,this.signal=T.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ce)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ce)}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function ae(y){var T=new FormData;return y.trim().split("&").forEach(function(ce){if(ce){var ue=ce.split("="),ne=ue.shift().replace(/\+/g," "),J=ue.join("=").replace(/\+/g," ");T.append(decodeURIComponent(ne),decodeURIComponent(J))}}),T}function Z(y){var T=new O,ce=y.replace(/\r?\n[\t ]+/g," ");return ce.split(/\r?\n/).forEach(function(ue){var ne=ue.split(":"),J=ne.shift().trim();if(J){var ee=ne.join(":").trim();T.append(J,ee)}}),T}C.call(U.prototype);function he(y,T){T||(T={}),this.type="default",this.status=T.status===void 0?200:T.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in T?T.statusText:"OK",this.headers=new O(T.headers),this.url=T.url||"",this._initBody(y)}C.call(he.prototype),he.prototype.clone=function(){return new he(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},he.error=function(){var y=new he(null,{status:0,statusText:""});return y.type="error",y};var W=[301,302,303,307,308];he.redirect=function(y,T){if(W.indexOf(T)===-1)throw new RangeError("Invalid status code");return new he(null,{status:T,headers:{location:y}})},l.DOMException=u.DOMException;try{new l.DOMException}catch{l.DOMException=function(y,T){this.message=y,this.name=T;var ce=Error(y);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function le(y,T){return new Promise(function(ce,ue){var ne=new U(y,T);if(ne.signal&&ne.signal.aborted)return ue(new l.DOMException("Aborted","AbortError"));var J=new XMLHttpRequest;function ee(){J.abort()}J.onload=function(){var se={status:J.status,statusText:J.statusText,headers:Z(J.getAllResponseHeaders()||"")};se.url="responseURL"in J?J.responseURL:se.headers.get("X-Request-URL");var $e="response"in J?J.response:J.responseText;ce(new he($e,se))},J.onerror=function(){ue(new TypeError("Network request failed"))},J.ontimeout=function(){ue(new TypeError("Network request failed"))},J.onabort=function(){ue(new l.DOMException("Aborted","AbortError"))},J.open(ne.method,ne.url,!0),ne.credentials==="include"?J.withCredentials=!0:ne.credentials==="omit"&&(J.withCredentials=!1),"responseType"in J&&p.blob&&(J.responseType="blob"),ne.headers.forEach(function(se,$e){J.setRequestHeader($e,se)}),ne.signal&&(ne.signal.addEventListener("abort",ee),J.onreadystatechange=function(){J.readyState===4&&ne.signal.removeEventListener("abort",ee)}),J.send(typeof ne._bodyInit>"u"?null:ne._bodyInit)})}return le.polyfill=!0,u.fetch||(u.fetch=le,u.Headers=O,u.Request=U,u.Response=he),l.Headers=O,l.Request=U,l.Response=he,l.fetch=le,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=i;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,a.exports=r})(Hc,Hc.exports);var KI=Hc.exports;const Sf=Gc(KI),FI={Accept:"application/json","Content-Type":"application/json"},WI="POST",xf={headers:FI,method:WI},Pf=10;class Cn{constructor(r,n=!1){if(this.url=r,this.disableProviderPing=n,this.events=new Rr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Jl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,n){this.events.on(r,n)}once(r,n){this.events.once(r,n)}off(r,n){this.events.off(r,n)}removeListener(r,n){this.events.removeListener(r,n)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,n){this.isAvailable||await this.register();try{const i=Vn(r),o=await(await Sf(this.url,Object.assign(Object.assign({},xf),{body:i}))).json();this.onPayload({data:o})}catch(i){this.onError(r.id,i)}}async register(r=this.url){if(!Jl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((i,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));i()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const n=Vn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Sf(r,Object.assign(Object.assign({},xf),{body:n}))}this.onOpen()}catch(n){const i=this.parseError(n);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const n=typeof r.data=="string"?rs(r.data):r.data;this.events.emit("payload",n)}onError(r,n){const i=this.parseError(n),o=i.message||i.toString(),u=Lo(r,o);this.events.emit("payload",u)}parseError(r,n=this.url){return hp(r,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Pf&&this.events.setMaxListeners(Pf)}}const Of="error",GI="wss://relay.walletconnect.com",YI="wc",QI="universal_provider",Cf=`${YI}@2:${QI}:`,JI="https://rpc.walletconnect.com/v1/",fn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Yi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var n,i="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",p="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",g=500,m="__lodash_placeholder__",E=1,P=2,A=4,O=1,L=2,H=1,B=2,z=4,q=8,I=16,C=32,S=64,N=128,U=256,ae=512,Z=30,he="...",W=800,le=16,y=1,T=2,ce=3,ue=1/0,ne=9007199254740991,J=17976931348623157e292,ee=NaN,se=4294967295,$e=se-1,Be=se>>>1,nr=[["ary",N],["bind",H],["bindKey",B],["curry",q],["curryRight",I],["flip",ae],["partial",C],["partialRight",S],["rearg",U]],xe="[object Arguments]",nt="[object Array]",F="[object AsyncFunction]",K="[object Boolean]",M="[object Date]",h="[object DOMException]",w="[object Error]",$="[object Function]",te="[object GeneratorFunction]",oe="[object Map]",ie="[object Number]",_e="[object Null]",Re="[object Object]",ct="[object Promise]",Qe="[object Proxy]",it="[object RegExp]",ze="[object Set]",Je="[object String]",He="[object Symbol]",Fe="[object Undefined]",Oe="[object WeakMap]",ye="[object WeakSet]",Ie="[object ArrayBuffer]",Ue="[object DataView]",Xe="[object Float32Array]",je="[object Float64Array]",Ge="[object Int8Array]",gt="[object Int16Array]",St="[object Int32Array]",Rt="[object Uint8Array]",vt="[object Uint8ClampedArray]",Ht="[object Uint16Array]",ir="[object Uint32Array]",zr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,Wr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,pn=/&(?:amp|lt|gt|quot|#39);/g,Rn=/[&<>"']/g,yt=RegExp(pn.source),ut=RegExp(Rn.source),mt=/<%-([\s\S]+?)%>/g,_t=/<%([\s\S]+?)%>/g,pt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tt=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wt=/[\\^$.*+?()[\]{}|]/g,Nt=RegExp(wt.source),bt=/^\s+/,xt=/\s/,Et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Dt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Mo=/[()=,{}\[\]\/\s]/,qo=/\\(\\)?/g,Uo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_r=/\w*$/,zo=/^[-+]0x[0-9a-f]+$/i,$o=/^0b[01]+$/i,Bo=/^\[object .+?Constructor\]$/,Ho=/^0o[0-7]+$/i,Vo=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yn=/($^)/,Ko=/['\n\r\u2028\u2029\\]/g,Qn="\\ud800-\\udfff",Fo="\\u0300-\\u036f",Wo="\\ufe20-\\ufe2f",Jn="\\u20d0-\\u20ff",is=Fo+Wo+Jn,ss="\\u2700-\\u27bf",Tr="a-z\\xdf-\\xf6\\xf8-\\xff",Go="\\xac\\xb1\\xd7\\xf7",Yo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Qo="\\u2000-\\u206f",Jo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",os="A-Z\\xc0-\\xd6\\xd8-\\xde",as="\\ufe0e\\ufe0f",Tn=Go+Yo+Qo+Jo,Si="[']",An="["+Qn+"]",xi="["+Tn+"]",Nn="["+is+"]",cs="\\d+",Xo="["+ss+"]",us="["+Tr+"]",hs="[^"+Qn+Tn+cs+ss+Tr+os+"]",Xn="\\ud83c[\\udffb-\\udfff]",Zo="(?:"+Nn+"|"+Xn+")",ls="[^"+Qn+"]",Zn="(?:\\ud83c[\\udde6-\\uddff]){2}",dn="[\\ud800-\\udbff][\\udc00-\\udfff]",pr="["+os+"]",fs="\\u200d",ps="(?:"+us+"|"+hs+")",$r="(?:"+pr+"|"+hs+")",ds="(?:"+Si+"(?:d|ll|m|re|s|t|ve))?",gs="(?:"+Si+"(?:D|LL|M|RE|S|T|VE))?",vs=Zo+"?",ys="["+as+"]?",ea="(?:"+fs+"(?:"+[ls,Zn,dn].join("|")+")"+ys+vs+")*",Yr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ms="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_s=ys+vs+ea,ei="(?:"+[Xo,Zn,dn].join("|")+")"+_s,ta="(?:"+[ls+Nn+"?",Nn,Zn,dn,An].join("|")+")",Pi=RegExp(Si,"g"),ra=RegExp(Nn,"g"),ti=RegExp(Xn+"(?="+Xn+")|"+ta+_s,"g"),ws=RegExp([pr+"?"+us+"+"+ds+"(?="+[xi,pr,"$"].join("|")+")",$r+"+"+gs+"(?="+[xi,pr+ps,"$"].join("|")+")",pr+"?"+ps+"+"+ds,pr+"+"+gs,ms,Yr,cs,ei].join("|"),"g"),bs=RegExp("["+fs+Qn+is+as+"]"),Ln=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Es=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],na=-1,Ze={};Ze[Xe]=Ze[je]=Ze[Ge]=Ze[gt]=Ze[St]=Ze[Rt]=Ze[vt]=Ze[Ht]=Ze[ir]=!0,Ze[xe]=Ze[nt]=Ze[Ie]=Ze[K]=Ze[Ue]=Ze[M]=Ze[w]=Ze[$]=Ze[oe]=Ze[ie]=Ze[Re]=Ze[it]=Ze[ze]=Ze[Je]=Ze[Oe]=!1;var Ye={};Ye[xe]=Ye[nt]=Ye[Ie]=Ye[Ue]=Ye[K]=Ye[M]=Ye[Xe]=Ye[je]=Ye[Ge]=Ye[gt]=Ye[St]=Ye[oe]=Ye[ie]=Ye[Re]=Ye[it]=Ye[ze]=Ye[Je]=Ye[He]=Ye[Rt]=Ye[vt]=Ye[Ht]=Ye[ir]=!0,Ye[w]=Ye[$]=Ye[Oe]=!1;var b={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},et=parseFloat,Ce=parseInt,ot=typeof Yi=="object"&&Yi&&Yi.Object===Object&&Yi,kt=typeof self=="object"&&self&&self.Object===Object&&self,Me=ot||kt||Function("return this")(),tt=r&&!r.nodeType&&r,Pt=tt&&!0&&a&&!a.nodeType&&a,sr=Pt&&Pt.exports===tt,jt=sr&&ot.process,at=function(){try{var D=Pt&&Pt.require&&Pt.require("util").types;return D||jt&&jt.binding&&jt.binding("util")}catch{}}(),Jt=at&&at.isArrayBuffer,Ar=at&&at.isDate,wr=at&&at.isMap,Br=at&&at.isRegExp,Oi=at&&at.isSet,Dn=at&&at.isTypedArray;function zt(D,G,V){switch(V.length){case 0:return D.call(G);case 1:return D.call(G,V[0]);case 2:return D.call(G,V[0],V[1]);case 3:return D.call(G,V[0],V[1],V[2])}return D.apply(G,V)}function jp(D,G,V,ge){for(var Se=-1,Ve=D==null?0:D.length;++Se<Ve;){var qt=D[Se];G(ge,qt,V(qt),D)}return ge}function br(D,G){for(var V=-1,ge=D==null?0:D.length;++V<ge&&G(D[V],V,D)!==!1;);return D}function Mp(D,G){for(var V=D==null?0:D.length;V--&&G(D[V],V,D)!==!1;);return D}function su(D,G){for(var V=-1,ge=D==null?0:D.length;++V<ge;)if(!G(D[V],V,D))return!1;return!0}function gn(D,G){for(var V=-1,ge=D==null?0:D.length,Se=0,Ve=[];++V<ge;){var qt=D[V];G(qt,V,D)&&(Ve[Se++]=qt)}return Ve}function Is(D,G){var V=D==null?0:D.length;return!!V&&ri(D,G,0)>-1}function ia(D,G,V){for(var ge=-1,Se=D==null?0:D.length;++ge<Se;)if(V(G,D[ge]))return!0;return!1}function lt(D,G){for(var V=-1,ge=D==null?0:D.length,Se=Array(ge);++V<ge;)Se[V]=G(D[V],V,D);return Se}function vn(D,G){for(var V=-1,ge=G.length,Se=D.length;++V<ge;)D[Se+V]=G[V];return D}function sa(D,G,V,ge){var Se=-1,Ve=D==null?0:D.length;for(ge&&Ve&&(V=D[++Se]);++Se<Ve;)V=G(V,D[Se],Se,D);return V}function qp(D,G,V,ge){var Se=D==null?0:D.length;for(ge&&Se&&(V=D[--Se]);Se--;)V=G(V,D[Se],Se,D);return V}function oa(D,G){for(var V=-1,ge=D==null?0:D.length;++V<ge;)if(G(D[V],V,D))return!0;return!1}var Up=aa("length");function zp(D){return D.split("")}function $p(D){return D.match(Dt)||[]}function ou(D,G,V){var ge;return V(D,function(Se,Ve,qt){if(G(Se,Ve,qt))return ge=Ve,!1}),ge}function Ss(D,G,V,ge){for(var Se=D.length,Ve=V+(ge?1:-1);ge?Ve--:++Ve<Se;)if(G(D[Ve],Ve,D))return Ve;return-1}function ri(D,G,V){return G===G?Zp(D,G,V):Ss(D,au,V)}function Bp(D,G,V,ge){for(var Se=V-1,Ve=D.length;++Se<Ve;)if(ge(D[Se],G))return Se;return-1}function au(D){return D!==D}function cu(D,G){var V=D==null?0:D.length;return V?ua(D,G)/V:ee}function aa(D){return function(G){return G==null?n:G[D]}}function ca(D){return function(G){return D==null?n:D[G]}}function uu(D,G,V,ge,Se){return Se(D,function(Ve,qt,rt){V=ge?(ge=!1,Ve):G(V,Ve,qt,rt)}),V}function Hp(D,G){var V=D.length;for(D.sort(G);V--;)D[V]=D[V].value;return D}function ua(D,G){for(var V,ge=-1,Se=D.length;++ge<Se;){var Ve=G(D[ge]);Ve!==n&&(V=V===n?Ve:V+Ve)}return V}function ha(D,G){for(var V=-1,ge=Array(D);++V<D;)ge[V]=G(V);return ge}function Vp(D,G){return lt(G,function(V){return[V,D[V]]})}function hu(D){return D&&D.slice(0,du(D)+1).replace(bt,"")}function dr(D){return function(G){return D(G)}}function la(D,G){return lt(G,function(V){return D[V]})}function Ci(D,G){return D.has(G)}function lu(D,G){for(var V=-1,ge=D.length;++V<ge&&ri(G,D[V],0)>-1;);return V}function fu(D,G){for(var V=D.length;V--&&ri(G,D[V],0)>-1;);return V}function Kp(D,G){for(var V=D.length,ge=0;V--;)D[V]===G&&++ge;return ge}var Fp=ca(b),Wp=ca(k);function Gp(D){return"\\"+pe[D]}function Yp(D,G){return D==null?n:D[G]}function ni(D){return bs.test(D)}function Qp(D){return Ln.test(D)}function Jp(D){for(var G,V=[];!(G=D.next()).done;)V.push(G.value);return V}function fa(D){var G=-1,V=Array(D.size);return D.forEach(function(ge,Se){V[++G]=[Se,ge]}),V}function pu(D,G){return function(V){return D(G(V))}}function yn(D,G){for(var V=-1,ge=D.length,Se=0,Ve=[];++V<ge;){var qt=D[V];(qt===G||qt===m)&&(D[V]=m,Ve[Se++]=V)}return Ve}function xs(D){var G=-1,V=Array(D.size);return D.forEach(function(ge){V[++G]=ge}),V}function Xp(D){var G=-1,V=Array(D.size);return D.forEach(function(ge){V[++G]=[ge,ge]}),V}function Zp(D,G,V){for(var ge=V-1,Se=D.length;++ge<Se;)if(D[ge]===G)return ge;return-1}function ed(D,G,V){for(var ge=V+1;ge--;)if(D[ge]===G)return ge;return ge}function ii(D){return ni(D)?rd(D):Up(D)}function Nr(D){return ni(D)?nd(D):zp(D)}function du(D){for(var G=D.length;G--&&xt.test(D.charAt(G)););return G}var td=ca(X);function rd(D){for(var G=ti.lastIndex=0;ti.test(D);)++G;return G}function nd(D){return D.match(ti)||[]}function id(D){return D.match(ws)||[]}var sd=function D(G){G=G==null?Me:si.defaults(Me.Object(),G,si.pick(Me,Es));var V=G.Array,ge=G.Date,Se=G.Error,Ve=G.Function,qt=G.Math,rt=G.Object,pa=G.RegExp,od=G.String,Er=G.TypeError,Ps=V.prototype,ad=Ve.prototype,oi=rt.prototype,Os=G["__core-js_shared__"],Cs=ad.toString,We=oi.hasOwnProperty,cd=0,gu=function(){var e=/[^.]+$/.exec(Os&&Os.keys&&Os.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Rs=oi.toString,ud=Cs.call(rt),hd=Me._,ld=pa("^"+Cs.call(We).replace(wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ts=sr?G.Buffer:n,mn=G.Symbol,As=G.Uint8Array,vu=Ts?Ts.allocUnsafe:n,Ns=pu(rt.getPrototypeOf,rt),yu=rt.create,mu=oi.propertyIsEnumerable,Ls=Ps.splice,_u=mn?mn.isConcatSpreadable:n,Ri=mn?mn.iterator:n,kn=mn?mn.toStringTag:n,Ds=function(){try{var e=zn(rt,"defineProperty");return e({},"",{}),e}catch{}}(),fd=G.clearTimeout!==Me.clearTimeout&&G.clearTimeout,pd=ge&&ge.now!==Me.Date.now&&ge.now,dd=G.setTimeout!==Me.setTimeout&&G.setTimeout,ks=qt.ceil,js=qt.floor,da=rt.getOwnPropertySymbols,gd=Ts?Ts.isBuffer:n,wu=G.isFinite,vd=Ps.join,yd=pu(rt.keys,rt),Ut=qt.max,Ft=qt.min,md=ge.now,_d=G.parseInt,bu=qt.random,wd=Ps.reverse,ga=zn(G,"DataView"),Ti=zn(G,"Map"),va=zn(G,"Promise"),ai=zn(G,"Set"),Ai=zn(G,"WeakMap"),Ni=zn(rt,"create"),Ms=Ai&&new Ai,ci={},bd=$n(ga),Ed=$n(Ti),Id=$n(va),Sd=$n(ai),xd=$n(Ai),qs=mn?mn.prototype:n,Li=qs?qs.valueOf:n,Eu=qs?qs.toString:n;function d(e){if(It(e)&&!Pe(e)&&!(e instanceof De)){if(e instanceof Ir)return e;if(We.call(e,"__wrapped__"))return Ih(e)}return new Ir(e)}var ui=function(){function e(){}return function(t){if(!dt(t))return{};if(yu)return yu(t);e.prototype=t;var s=new e;return e.prototype=n,s}}();function Us(){}function Ir(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}d.templateSettings={escape:mt,evaluate:_t,interpolate:pt,variable:"",imports:{_:d}},d.prototype=Us.prototype,d.prototype.constructor=d,Ir.prototype=ui(Us.prototype),Ir.prototype.constructor=Ir;function De(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function Pd(){var e=new De(this.__wrapped__);return e.__actions__=or(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=or(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=or(this.__views__),e}function Od(){if(this.__filtered__){var e=new De(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Cd(){var e=this.__wrapped__.value(),t=this.__dir__,s=Pe(e),c=t<0,f=s?e.length:0,v=zg(0,f,this.__views__),x=v.start,R=v.end,j=R-x,Y=c?R:x-1,Q=this.__iteratees__,re=Q.length,fe=0,ve=Ft(j,this.__takeCount__);if(!s||!c&&f==j&&ve==j)return Fu(e,this.__actions__);var be=[];e:for(;j--&&fe<ve;){Y+=t;for(var Ae=-1,Ee=e[Y];++Ae<re;){var Le=Q[Ae],qe=Le.iteratee,yr=Le.type,er=qe(Ee);if(yr==T)Ee=er;else if(!er){if(yr==y)continue e;break e}}be[fe++]=Ee}return be}De.prototype=ui(Us.prototype),De.prototype.constructor=De;function jn(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Rd(){this.__data__=Ni?Ni(null):{},this.size=0}function Td(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Ad(e){var t=this.__data__;if(Ni){var s=t[e];return s===_?n:s}return We.call(t,e)?t[e]:n}function Nd(e){var t=this.__data__;return Ni?t[e]!==n:We.call(t,e)}function Ld(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ni&&t===n?_:t,this}jn.prototype.clear=Rd,jn.prototype.delete=Td,jn.prototype.get=Ad,jn.prototype.has=Nd,jn.prototype.set=Ld;function Qr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Dd(){this.__data__=[],this.size=0}function kd(e){var t=this.__data__,s=zs(t,e);if(s<0)return!1;var c=t.length-1;return s==c?t.pop():Ls.call(t,s,1),--this.size,!0}function jd(e){var t=this.__data__,s=zs(t,e);return s<0?n:t[s][1]}function Md(e){return zs(this.__data__,e)>-1}function qd(e,t){var s=this.__data__,c=zs(s,e);return c<0?(++this.size,s.push([e,t])):s[c][1]=t,this}Qr.prototype.clear=Dd,Qr.prototype.delete=kd,Qr.prototype.get=jd,Qr.prototype.has=Md,Qr.prototype.set=qd;function Jr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var c=e[t];this.set(c[0],c[1])}}function Ud(){this.size=0,this.__data__={hash:new jn,map:new(Ti||Qr),string:new jn}}function zd(e){var t=Xs(this,e).delete(e);return this.size-=t?1:0,t}function $d(e){return Xs(this,e).get(e)}function Bd(e){return Xs(this,e).has(e)}function Hd(e,t){var s=Xs(this,e),c=s.size;return s.set(e,t),this.size+=s.size==c?0:1,this}Jr.prototype.clear=Ud,Jr.prototype.delete=zd,Jr.prototype.get=$d,Jr.prototype.has=Bd,Jr.prototype.set=Hd;function Mn(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Jr;++t<s;)this.add(e[t])}function Vd(e){return this.__data__.set(e,_),this}function Kd(e){return this.__data__.has(e)}Mn.prototype.add=Mn.prototype.push=Vd,Mn.prototype.has=Kd;function Lr(e){var t=this.__data__=new Qr(e);this.size=t.size}function Fd(){this.__data__=new Qr,this.size=0}function Wd(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Gd(e){return this.__data__.get(e)}function Yd(e){return this.__data__.has(e)}function Qd(e,t){var s=this.__data__;if(s instanceof Qr){var c=s.__data__;if(!Ti||c.length<o-1)return c.push([e,t]),this.size=++s.size,this;s=this.__data__=new Jr(c)}return s.set(e,t),this.size=s.size,this}Lr.prototype.clear=Fd,Lr.prototype.delete=Wd,Lr.prototype.get=Gd,Lr.prototype.has=Yd,Lr.prototype.set=Qd;function Iu(e,t){var s=Pe(e),c=!s&&Bn(e),f=!s&&!c&&In(e),v=!s&&!c&&!f&&pi(e),x=s||c||f||v,R=x?ha(e.length,od):[],j=R.length;for(var Y in e)(t||We.call(e,Y))&&!(x&&(Y=="length"||f&&(Y=="offset"||Y=="parent")||v&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||tn(Y,j)))&&R.push(Y);return R}function Su(e){var t=e.length;return t?e[Oa(0,t-1)]:n}function Jd(e,t){return Zs(or(e),qn(t,0,e.length))}function Xd(e){return Zs(or(e))}function ya(e,t,s){(s!==n&&!Dr(e[t],s)||s===n&&!(t in e))&&Xr(e,t,s)}function Di(e,t,s){var c=e[t];(!(We.call(e,t)&&Dr(c,s))||s===n&&!(t in e))&&Xr(e,t,s)}function zs(e,t){for(var s=e.length;s--;)if(Dr(e[s][0],t))return s;return-1}function Zd(e,t,s,c){return _n(e,function(f,v,x){t(c,f,s(f),x)}),c}function xu(e,t){return e&&Vr(t,$t(t),e)}function eg(e,t){return e&&Vr(t,cr(t),e)}function Xr(e,t,s){t=="__proto__"&&Ds?Ds(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function ma(e,t){for(var s=-1,c=t.length,f=V(c),v=e==null;++s<c;)f[s]=v?n:Xa(e,t[s]);return f}function qn(e,t,s){return e===e&&(s!==n&&(e=e<=s?e:s),t!==n&&(e=e>=t?e:t)),e}function Sr(e,t,s,c,f,v){var x,R=t&E,j=t&P,Y=t&A;if(s&&(x=f?s(e,c,f,v):s(e)),x!==n)return x;if(!dt(e))return e;var Q=Pe(e);if(Q){if(x=Bg(e),!R)return or(e,x)}else{var re=Wt(e),fe=re==$||re==te;if(In(e))return Yu(e,R);if(re==Re||re==xe||fe&&!f){if(x=j||fe?{}:dh(e),!R)return j?Ag(e,eg(x,e)):Tg(e,xu(x,e))}else{if(!Ye[re])return f?e:{};x=Hg(e,re,R)}}v||(v=new Lr);var ve=v.get(e);if(ve)return ve;v.set(e,x),Hh(e)?e.forEach(function(Ee){x.add(Sr(Ee,t,s,Ee,e,v))}):$h(e)&&e.forEach(function(Ee,Le){x.set(Le,Sr(Ee,t,s,Le,e,v))});var be=Y?j?qa:Ma:j?cr:$t,Ae=Q?n:be(e);return br(Ae||e,function(Ee,Le){Ae&&(Le=Ee,Ee=e[Le]),Di(x,Le,Sr(Ee,t,s,Le,e,v))}),x}function tg(e){var t=$t(e);return function(s){return Pu(s,e,t)}}function Pu(e,t,s){var c=s.length;if(e==null)return!c;for(e=rt(e);c--;){var f=s[c],v=t[f],x=e[f];if(x===n&&!(f in e)||!v(x))return!1}return!0}function Ou(e,t,s){if(typeof e!="function")throw new Er(l);return $i(function(){e.apply(n,s)},t)}function ki(e,t,s,c){var f=-1,v=Is,x=!0,R=e.length,j=[],Y=t.length;if(!R)return j;s&&(t=lt(t,dr(s))),c?(v=ia,x=!1):t.length>=o&&(v=Ci,x=!1,t=new Mn(t));e:for(;++f<R;){var Q=e[f],re=s==null?Q:s(Q);if(Q=c||Q!==0?Q:0,x&&re===re){for(var fe=Y;fe--;)if(t[fe]===re)continue e;j.push(Q)}else v(t,re,c)||j.push(Q)}return j}var _n=eh(Hr),Cu=eh(wa,!0);function rg(e,t){var s=!0;return _n(e,function(c,f,v){return s=!!t(c,f,v),s}),s}function $s(e,t,s){for(var c=-1,f=e.length;++c<f;){var v=e[c],x=t(v);if(x!=null&&(R===n?x===x&&!vr(x):s(x,R)))var R=x,j=v}return j}function ng(e,t,s,c){var f=e.length;for(s=Te(s),s<0&&(s=-s>f?0:f+s),c=c===n||c>f?f:Te(c),c<0&&(c+=f),c=s>c?0:Kh(c);s<c;)e[s++]=t;return e}function Ru(e,t){var s=[];return _n(e,function(c,f,v){t(c,f,v)&&s.push(c)}),s}function Vt(e,t,s,c,f){var v=-1,x=e.length;for(s||(s=Kg),f||(f=[]);++v<x;){var R=e[v];t>0&&s(R)?t>1?Vt(R,t-1,s,c,f):vn(f,R):c||(f[f.length]=R)}return f}var _a=th(),Tu=th(!0);function Hr(e,t){return e&&_a(e,t,$t)}function wa(e,t){return e&&Tu(e,t,$t)}function Bs(e,t){return gn(t,function(s){return rn(e[s])})}function Un(e,t){t=bn(t,e);for(var s=0,c=t.length;e!=null&&s<c;)e=e[Kr(t[s++])];return s&&s==c?e:n}function Au(e,t,s){var c=t(e);return Pe(e)?c:vn(c,s(e))}function Xt(e){return e==null?e===n?Fe:_e:kn&&kn in rt(e)?Ug(e):Xg(e)}function ba(e,t){return e>t}function ig(e,t){return e!=null&&We.call(e,t)}function sg(e,t){return e!=null&&t in rt(e)}function og(e,t,s){return e>=Ft(t,s)&&e<Ut(t,s)}function Ea(e,t,s){for(var c=s?ia:Is,f=e[0].length,v=e.length,x=v,R=V(v),j=1/0,Y=[];x--;){var Q=e[x];x&&t&&(Q=lt(Q,dr(t))),j=Ft(Q.length,j),R[x]=!s&&(t||f>=120&&Q.length>=120)?new Mn(x&&Q):n}Q=e[0];var re=-1,fe=R[0];e:for(;++re<f&&Y.length<j;){var ve=Q[re],be=t?t(ve):ve;if(ve=s||ve!==0?ve:0,!(fe?Ci(fe,be):c(Y,be,s))){for(x=v;--x;){var Ae=R[x];if(!(Ae?Ci(Ae,be):c(e[x],be,s)))continue e}fe&&fe.push(be),Y.push(ve)}}return Y}function ag(e,t,s,c){return Hr(e,function(f,v,x){t(c,s(f),v,x)}),c}function ji(e,t,s){t=bn(t,e),e=mh(e,t);var c=e==null?e:e[Kr(Pr(t))];return c==null?n:zt(c,e,s)}function Nu(e){return It(e)&&Xt(e)==xe}function cg(e){return It(e)&&Xt(e)==Ie}function ug(e){return It(e)&&Xt(e)==M}function Mi(e,t,s,c,f){return e===t?!0:e==null||t==null||!It(e)&&!It(t)?e!==e&&t!==t:hg(e,t,s,c,Mi,f)}function hg(e,t,s,c,f,v){var x=Pe(e),R=Pe(t),j=x?nt:Wt(e),Y=R?nt:Wt(t);j=j==xe?Re:j,Y=Y==xe?Re:Y;var Q=j==Re,re=Y==Re,fe=j==Y;if(fe&&In(e)){if(!In(t))return!1;x=!0,Q=!1}if(fe&&!Q)return v||(v=new Lr),x||pi(e)?lh(e,t,s,c,f,v):Mg(e,t,j,s,c,f,v);if(!(s&O)){var ve=Q&&We.call(e,"__wrapped__"),be=re&&We.call(t,"__wrapped__");if(ve||be){var Ae=ve?e.value():e,Ee=be?t.value():t;return v||(v=new Lr),f(Ae,Ee,s,c,v)}}return fe?(v||(v=new Lr),qg(e,t,s,c,f,v)):!1}function lg(e){return It(e)&&Wt(e)==oe}function Ia(e,t,s,c){var f=s.length,v=f,x=!c;if(e==null)return!v;for(e=rt(e);f--;){var R=s[f];if(x&&R[2]?R[1]!==e[R[0]]:!(R[0]in e))return!1}for(;++f<v;){R=s[f];var j=R[0],Y=e[j],Q=R[1];if(x&&R[2]){if(Y===n&&!(j in e))return!1}else{var re=new Lr;if(c)var fe=c(Y,Q,j,e,t,re);if(!(fe===n?Mi(Q,Y,O|L,c,re):fe))return!1}}return!0}function Lu(e){if(!dt(e)||Wg(e))return!1;var t=rn(e)?ld:Bo;return t.test($n(e))}function fg(e){return It(e)&&Xt(e)==it}function pg(e){return It(e)&&Wt(e)==ze}function dg(e){return It(e)&&so(e.length)&&!!Ze[Xt(e)]}function Du(e){return typeof e=="function"?e:e==null?ur:typeof e=="object"?Pe(e)?Mu(e[0],e[1]):ju(e):rl(e)}function Sa(e){if(!zi(e))return yd(e);var t=[];for(var s in rt(e))We.call(e,s)&&s!="constructor"&&t.push(s);return t}function gg(e){if(!dt(e))return Jg(e);var t=zi(e),s=[];for(var c in e)c=="constructor"&&(t||!We.call(e,c))||s.push(c);return s}function xa(e,t){return e<t}function ku(e,t){var s=-1,c=ar(e)?V(e.length):[];return _n(e,function(f,v,x){c[++s]=t(f,v,x)}),c}function ju(e){var t=za(e);return t.length==1&&t[0][2]?vh(t[0][0],t[0][1]):function(s){return s===e||Ia(s,e,t)}}function Mu(e,t){return Ba(e)&&gh(t)?vh(Kr(e),t):function(s){var c=Xa(s,e);return c===n&&c===t?Za(s,e):Mi(t,c,O|L)}}function Hs(e,t,s,c,f){e!==t&&_a(t,function(v,x){if(f||(f=new Lr),dt(v))vg(e,t,x,s,Hs,c,f);else{var R=c?c(Va(e,x),v,x+"",e,t,f):n;R===n&&(R=v),ya(e,x,R)}},cr)}function vg(e,t,s,c,f,v,x){var R=Va(e,s),j=Va(t,s),Y=x.get(j);if(Y){ya(e,s,Y);return}var Q=v?v(R,j,s+"",e,t,x):n,re=Q===n;if(re){var fe=Pe(j),ve=!fe&&In(j),be=!fe&&!ve&&pi(j);Q=j,fe||ve||be?Pe(R)?Q=R:Ot(R)?Q=or(R):ve?(re=!1,Q=Yu(j,!0)):be?(re=!1,Q=Qu(j,!0)):Q=[]:Bi(j)||Bn(j)?(Q=R,Bn(R)?Q=Fh(R):(!dt(R)||rn(R))&&(Q=dh(j))):re=!1}re&&(x.set(j,Q),f(Q,j,c,v,x),x.delete(j)),ya(e,s,Q)}function qu(e,t){var s=e.length;if(s)return t+=t<0?s:0,tn(t,s)?e[t]:n}function Uu(e,t,s){t.length?t=lt(t,function(v){return Pe(v)?function(x){return Un(x,v.length===1?v[0]:v)}:v}):t=[ur];var c=-1;t=lt(t,dr(we()));var f=ku(e,function(v,x,R){var j=lt(t,function(Y){return Y(v)});return{criteria:j,index:++c,value:v}});return Hp(f,function(v,x){return Rg(v,x,s)})}function yg(e,t){return zu(e,t,function(s,c){return Za(e,c)})}function zu(e,t,s){for(var c=-1,f=t.length,v={};++c<f;){var x=t[c],R=Un(e,x);s(R,x)&&qi(v,bn(x,e),R)}return v}function mg(e){return function(t){return Un(t,e)}}function Pa(e,t,s,c){var f=c?Bp:ri,v=-1,x=t.length,R=e;for(e===t&&(t=or(t)),s&&(R=lt(e,dr(s)));++v<x;)for(var j=0,Y=t[v],Q=s?s(Y):Y;(j=f(R,Q,j,c))>-1;)R!==e&&Ls.call(R,j,1),Ls.call(e,j,1);return e}function $u(e,t){for(var s=e?t.length:0,c=s-1;s--;){var f=t[s];if(s==c||f!==v){var v=f;tn(f)?Ls.call(e,f,1):Ta(e,f)}}return e}function Oa(e,t){return e+js(bu()*(t-e+1))}function _g(e,t,s,c){for(var f=-1,v=Ut(ks((t-e)/(s||1)),0),x=V(v);v--;)x[c?v:++f]=e,e+=s;return x}function Ca(e,t){var s="";if(!e||t<1||t>ne)return s;do t%2&&(s+=e),t=js(t/2),t&&(e+=e);while(t);return s}function Ne(e,t){return Ka(yh(e,t,ur),e+"")}function wg(e){return Su(di(e))}function bg(e,t){var s=di(e);return Zs(s,qn(t,0,s.length))}function qi(e,t,s,c){if(!dt(e))return e;t=bn(t,e);for(var f=-1,v=t.length,x=v-1,R=e;R!=null&&++f<v;){var j=Kr(t[f]),Y=s;if(j==="__proto__"||j==="constructor"||j==="prototype")return e;if(f!=x){var Q=R[j];Y=c?c(Q,j,R):n,Y===n&&(Y=dt(Q)?Q:tn(t[f+1])?[]:{})}Di(R,j,Y),R=R[j]}return e}var Bu=Ms?function(e,t){return Ms.set(e,t),e}:ur,Eg=Ds?function(e,t){return Ds(e,"toString",{configurable:!0,enumerable:!1,value:tc(t),writable:!0})}:ur;function Ig(e){return Zs(di(e))}function xr(e,t,s){var c=-1,f=e.length;t<0&&(t=-t>f?0:f+t),s=s>f?f:s,s<0&&(s+=f),f=t>s?0:s-t>>>0,t>>>=0;for(var v=V(f);++c<f;)v[c]=e[c+t];return v}function Sg(e,t){var s;return _n(e,function(c,f,v){return s=t(c,f,v),!s}),!!s}function Vs(e,t,s){var c=0,f=e==null?c:e.length;if(typeof t=="number"&&t===t&&f<=Be){for(;c<f;){var v=c+f>>>1,x=e[v];x!==null&&!vr(x)&&(s?x<=t:x<t)?c=v+1:f=v}return f}return Ra(e,t,ur,s)}function Ra(e,t,s,c){var f=0,v=e==null?0:e.length;if(v===0)return 0;t=s(t);for(var x=t!==t,R=t===null,j=vr(t),Y=t===n;f<v;){var Q=js((f+v)/2),re=s(e[Q]),fe=re!==n,ve=re===null,be=re===re,Ae=vr(re);if(x)var Ee=c||be;else Y?Ee=be&&(c||fe):R?Ee=be&&fe&&(c||!ve):j?Ee=be&&fe&&!ve&&(c||!Ae):ve||Ae?Ee=!1:Ee=c?re<=t:re<t;Ee?f=Q+1:v=Q}return Ft(v,$e)}function Hu(e,t){for(var s=-1,c=e.length,f=0,v=[];++s<c;){var x=e[s],R=t?t(x):x;if(!s||!Dr(R,j)){var j=R;v[f++]=x===0?0:x}}return v}function Vu(e){return typeof e=="number"?e:vr(e)?ee:+e}function gr(e){if(typeof e=="string")return e;if(Pe(e))return lt(e,gr)+"";if(vr(e))return Eu?Eu.call(e):"";var t=e+"";return t=="0"&&1/e==-ue?"-0":t}function wn(e,t,s){var c=-1,f=Is,v=e.length,x=!0,R=[],j=R;if(s)x=!1,f=ia;else if(v>=o){var Y=t?null:kg(e);if(Y)return xs(Y);x=!1,f=Ci,j=new Mn}else j=t?[]:R;e:for(;++c<v;){var Q=e[c],re=t?t(Q):Q;if(Q=s||Q!==0?Q:0,x&&re===re){for(var fe=j.length;fe--;)if(j[fe]===re)continue e;t&&j.push(re),R.push(Q)}else f(j,re,s)||(j!==R&&j.push(re),R.push(Q))}return R}function Ta(e,t){return t=bn(t,e),e=mh(e,t),e==null||delete e[Kr(Pr(t))]}function Ku(e,t,s,c){return qi(e,t,s(Un(e,t)),c)}function Ks(e,t,s,c){for(var f=e.length,v=c?f:-1;(c?v--:++v<f)&&t(e[v],v,e););return s?xr(e,c?0:v,c?v+1:f):xr(e,c?v+1:0,c?f:v)}function Fu(e,t){var s=e;return s instanceof De&&(s=s.value()),sa(t,function(c,f){return f.func.apply(f.thisArg,vn([c],f.args))},s)}function Aa(e,t,s){var c=e.length;if(c<2)return c?wn(e[0]):[];for(var f=-1,v=V(c);++f<c;)for(var x=e[f],R=-1;++R<c;)R!=f&&(v[f]=ki(v[f]||x,e[R],t,s));return wn(Vt(v,1),t,s)}function Wu(e,t,s){for(var c=-1,f=e.length,v=t.length,x={};++c<f;){var R=c<v?t[c]:n;s(x,e[c],R)}return x}function Na(e){return Ot(e)?e:[]}function La(e){return typeof e=="function"?e:ur}function bn(e,t){return Pe(e)?e:Ba(e,t)?[e]:Eh(Ke(e))}var xg=Ne;function En(e,t,s){var c=e.length;return s=s===n?c:s,!t&&s>=c?e:xr(e,t,s)}var Gu=fd||function(e){return Me.clearTimeout(e)};function Yu(e,t){if(t)return e.slice();var s=e.length,c=vu?vu(s):new e.constructor(s);return e.copy(c),c}function Da(e){var t=new e.constructor(e.byteLength);return new As(t).set(new As(e)),t}function Pg(e,t){var s=t?Da(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Og(e){var t=new e.constructor(e.source,_r.exec(e));return t.lastIndex=e.lastIndex,t}function Cg(e){return Li?rt(Li.call(e)):{}}function Qu(e,t){var s=t?Da(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Ju(e,t){if(e!==t){var s=e!==n,c=e===null,f=e===e,v=vr(e),x=t!==n,R=t===null,j=t===t,Y=vr(t);if(!R&&!Y&&!v&&e>t||v&&x&&j&&!R&&!Y||c&&x&&j||!s&&j||!f)return 1;if(!c&&!v&&!Y&&e<t||Y&&s&&f&&!c&&!v||R&&s&&f||!x&&f||!j)return-1}return 0}function Rg(e,t,s){for(var c=-1,f=e.criteria,v=t.criteria,x=f.length,R=s.length;++c<x;){var j=Ju(f[c],v[c]);if(j){if(c>=R)return j;var Y=s[c];return j*(Y=="desc"?-1:1)}}return e.index-t.index}function Xu(e,t,s,c){for(var f=-1,v=e.length,x=s.length,R=-1,j=t.length,Y=Ut(v-x,0),Q=V(j+Y),re=!c;++R<j;)Q[R]=t[R];for(;++f<x;)(re||f<v)&&(Q[s[f]]=e[f]);for(;Y--;)Q[R++]=e[f++];return Q}function Zu(e,t,s,c){for(var f=-1,v=e.length,x=-1,R=s.length,j=-1,Y=t.length,Q=Ut(v-R,0),re=V(Q+Y),fe=!c;++f<Q;)re[f]=e[f];for(var ve=f;++j<Y;)re[ve+j]=t[j];for(;++x<R;)(fe||f<v)&&(re[ve+s[x]]=e[f++]);return re}function or(e,t){var s=-1,c=e.length;for(t||(t=V(c));++s<c;)t[s]=e[s];return t}function Vr(e,t,s,c){var f=!s;s||(s={});for(var v=-1,x=t.length;++v<x;){var R=t[v],j=c?c(s[R],e[R],R,s,e):n;j===n&&(j=e[R]),f?Xr(s,R,j):Di(s,R,j)}return s}function Tg(e,t){return Vr(e,$a(e),t)}function Ag(e,t){return Vr(e,fh(e),t)}function Fs(e,t){return function(s,c){var f=Pe(s)?jp:Zd,v=t?t():{};return f(s,e,we(c,2),v)}}function hi(e){return Ne(function(t,s){var c=-1,f=s.length,v=f>1?s[f-1]:n,x=f>2?s[2]:n;for(v=e.length>3&&typeof v=="function"?(f--,v):n,x&&Zt(s[0],s[1],x)&&(v=f<3?n:v,f=1),t=rt(t);++c<f;){var R=s[c];R&&e(t,R,c,v)}return t})}function eh(e,t){return function(s,c){if(s==null)return s;if(!ar(s))return e(s,c);for(var f=s.length,v=t?f:-1,x=rt(s);(t?v--:++v<f)&&c(x[v],v,x)!==!1;);return s}}function th(e){return function(t,s,c){for(var f=-1,v=rt(t),x=c(t),R=x.length;R--;){var j=x[e?R:++f];if(s(v[j],j,v)===!1)break}return t}}function Ng(e,t,s){var c=t&H,f=Ui(e);function v(){var x=this&&this!==Me&&this instanceof v?f:e;return x.apply(c?s:this,arguments)}return v}function rh(e){return function(t){t=Ke(t);var s=ni(t)?Nr(t):n,c=s?s[0]:t.charAt(0),f=s?En(s,1).join(""):t.slice(1);return c[e]()+f}}function li(e){return function(t){return sa(el(Zh(t).replace(Pi,"")),e,"")}}function Ui(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=ui(e.prototype),c=e.apply(s,t);return dt(c)?c:s}}function Lg(e,t,s){var c=Ui(e);function f(){for(var v=arguments.length,x=V(v),R=v,j=fi(f);R--;)x[R]=arguments[R];var Y=v<3&&x[0]!==j&&x[v-1]!==j?[]:yn(x,j);if(v-=Y.length,v<s)return ah(e,t,Ws,f.placeholder,n,x,Y,n,n,s-v);var Q=this&&this!==Me&&this instanceof f?c:e;return zt(Q,this,x)}return f}function nh(e){return function(t,s,c){var f=rt(t);if(!ar(t)){var v=we(s,3);t=$t(t),s=function(R){return v(f[R],R,f)}}var x=e(t,s,c);return x>-1?f[v?t[x]:x]:n}}function ih(e){return en(function(t){var s=t.length,c=s,f=Ir.prototype.thru;for(e&&t.reverse();c--;){var v=t[c];if(typeof v!="function")throw new Er(l);if(f&&!x&&Js(v)=="wrapper")var x=new Ir([],!0)}for(c=x?c:s;++c<s;){v=t[c];var R=Js(v),j=R=="wrapper"?Ua(v):n;j&&Ha(j[0])&&j[1]==(N|q|C|U)&&!j[4].length&&j[9]==1?x=x[Js(j[0])].apply(x,j[3]):x=v.length==1&&Ha(v)?x[R]():x.thru(v)}return function(){var Y=arguments,Q=Y[0];if(x&&Y.length==1&&Pe(Q))return x.plant(Q).value();for(var re=0,fe=s?t[re].apply(this,Y):Q;++re<s;)fe=t[re].call(this,fe);return fe}})}function Ws(e,t,s,c,f,v,x,R,j,Y){var Q=t&N,re=t&H,fe=t&B,ve=t&(q|I),be=t&ae,Ae=fe?n:Ui(e);function Ee(){for(var Le=arguments.length,qe=V(Le),yr=Le;yr--;)qe[yr]=arguments[yr];if(ve)var er=fi(Ee),mr=Kp(qe,er);if(c&&(qe=Xu(qe,c,f,ve)),v&&(qe=Zu(qe,v,x,ve)),Le-=mr,ve&&Le<Y){var Ct=yn(qe,er);return ah(e,t,Ws,Ee.placeholder,s,qe,Ct,R,j,Y-Le)}var kr=re?s:this,sn=fe?kr[e]:e;return Le=qe.length,R?qe=Zg(qe,R):be&&Le>1&&qe.reverse(),Q&&j<Le&&(qe.length=j),this&&this!==Me&&this instanceof Ee&&(sn=Ae||Ui(sn)),sn.apply(kr,qe)}return Ee}function sh(e,t){return function(s,c){return ag(s,e,t(c),{})}}function Gs(e,t){return function(s,c){var f;if(s===n&&c===n)return t;if(s!==n&&(f=s),c!==n){if(f===n)return c;typeof s=="string"||typeof c=="string"?(s=gr(s),c=gr(c)):(s=Vu(s),c=Vu(c)),f=e(s,c)}return f}}function ka(e){return en(function(t){return t=lt(t,dr(we())),Ne(function(s){var c=this;return e(t,function(f){return zt(f,c,s)})})})}function Ys(e,t){t=t===n?" ":gr(t);var s=t.length;if(s<2)return s?Ca(t,e):t;var c=Ca(t,ks(e/ii(t)));return ni(t)?En(Nr(c),0,e).join(""):c.slice(0,e)}function Dg(e,t,s,c){var f=t&H,v=Ui(e);function x(){for(var R=-1,j=arguments.length,Y=-1,Q=c.length,re=V(Q+j),fe=this&&this!==Me&&this instanceof x?v:e;++Y<Q;)re[Y]=c[Y];for(;j--;)re[Y++]=arguments[++R];return zt(fe,f?s:this,re)}return x}function oh(e){return function(t,s,c){return c&&typeof c!="number"&&Zt(t,s,c)&&(s=c=n),t=nn(t),s===n?(s=t,t=0):s=nn(s),c=c===n?t<s?1:-1:nn(c),_g(t,s,c,e)}}function Qs(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Or(t),s=Or(s)),e(t,s)}}function ah(e,t,s,c,f,v,x,R,j,Y){var Q=t&q,re=Q?x:n,fe=Q?n:x,ve=Q?v:n,be=Q?n:v;t|=Q?C:S,t&=~(Q?S:C),t&z||(t&=~(H|B));var Ae=[e,t,f,ve,re,be,fe,R,j,Y],Ee=s.apply(n,Ae);return Ha(e)&&_h(Ee,Ae),Ee.placeholder=c,wh(Ee,e,t)}function ja(e){var t=qt[e];return function(s,c){if(s=Or(s),c=c==null?0:Ft(Te(c),292),c&&wu(s)){var f=(Ke(s)+"e").split("e"),v=t(f[0]+"e"+(+f[1]+c));return f=(Ke(v)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return t(s)}}var kg=ai&&1/xs(new ai([,-0]))[1]==ue?function(e){return new ai(e)}:ic;function ch(e){return function(t){var s=Wt(t);return s==oe?fa(t):s==ze?Xp(t):Vp(t,e(t))}}function Zr(e,t,s,c,f,v,x,R){var j=t&B;if(!j&&typeof e!="function")throw new Er(l);var Y=c?c.length:0;if(Y||(t&=~(C|S),c=f=n),x=x===n?x:Ut(Te(x),0),R=R===n?R:Te(R),Y-=f?f.length:0,t&S){var Q=c,re=f;c=f=n}var fe=j?n:Ua(e),ve=[e,t,s,c,f,Q,re,v,x,R];if(fe&&Qg(ve,fe),e=ve[0],t=ve[1],s=ve[2],c=ve[3],f=ve[4],R=ve[9]=ve[9]===n?j?0:e.length:Ut(ve[9]-Y,0),!R&&t&(q|I)&&(t&=~(q|I)),!t||t==H)var be=Ng(e,t,s);else t==q||t==I?be=Lg(e,t,R):(t==C||t==(H|C))&&!f.length?be=Dg(e,t,s,c):be=Ws.apply(n,ve);var Ae=fe?Bu:_h;return wh(Ae(be,ve),e,t)}function uh(e,t,s,c){return e===n||Dr(e,oi[s])&&!We.call(c,s)?t:e}function hh(e,t,s,c,f,v){return dt(e)&&dt(t)&&(v.set(t,e),Hs(e,t,n,hh,v),v.delete(t)),e}function jg(e){return Bi(e)?n:e}function lh(e,t,s,c,f,v){var x=s&O,R=e.length,j=t.length;if(R!=j&&!(x&&j>R))return!1;var Y=v.get(e),Q=v.get(t);if(Y&&Q)return Y==t&&Q==e;var re=-1,fe=!0,ve=s&L?new Mn:n;for(v.set(e,t),v.set(t,e);++re<R;){var be=e[re],Ae=t[re];if(c)var Ee=x?c(Ae,be,re,t,e,v):c(be,Ae,re,e,t,v);if(Ee!==n){if(Ee)continue;fe=!1;break}if(ve){if(!oa(t,function(Le,qe){if(!Ci(ve,qe)&&(be===Le||f(be,Le,s,c,v)))return ve.push(qe)})){fe=!1;break}}else if(!(be===Ae||f(be,Ae,s,c,v))){fe=!1;break}}return v.delete(e),v.delete(t),fe}function Mg(e,t,s,c,f,v,x){switch(s){case Ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ie:return!(e.byteLength!=t.byteLength||!v(new As(e),new As(t)));case K:case M:case ie:return Dr(+e,+t);case w:return e.name==t.name&&e.message==t.message;case it:case Je:return e==t+"";case oe:var R=fa;case ze:var j=c&O;if(R||(R=xs),e.size!=t.size&&!j)return!1;var Y=x.get(e);if(Y)return Y==t;c|=L,x.set(e,t);var Q=lh(R(e),R(t),c,f,v,x);return x.delete(e),Q;case He:if(Li)return Li.call(e)==Li.call(t)}return!1}function qg(e,t,s,c,f,v){var x=s&O,R=Ma(e),j=R.length,Y=Ma(t),Q=Y.length;if(j!=Q&&!x)return!1;for(var re=j;re--;){var fe=R[re];if(!(x?fe in t:We.call(t,fe)))return!1}var ve=v.get(e),be=v.get(t);if(ve&&be)return ve==t&&be==e;var Ae=!0;v.set(e,t),v.set(t,e);for(var Ee=x;++re<j;){fe=R[re];var Le=e[fe],qe=t[fe];if(c)var yr=x?c(qe,Le,fe,t,e,v):c(Le,qe,fe,e,t,v);if(!(yr===n?Le===qe||f(Le,qe,s,c,v):yr)){Ae=!1;break}Ee||(Ee=fe=="constructor")}if(Ae&&!Ee){var er=e.constructor,mr=t.constructor;er!=mr&&"constructor"in e&&"constructor"in t&&!(typeof er=="function"&&er instanceof er&&typeof mr=="function"&&mr instanceof mr)&&(Ae=!1)}return v.delete(e),v.delete(t),Ae}function en(e){return Ka(yh(e,n,Ph),e+"")}function Ma(e){return Au(e,$t,$a)}function qa(e){return Au(e,cr,fh)}var Ua=Ms?function(e){return Ms.get(e)}:ic;function Js(e){for(var t=e.name+"",s=ci[t],c=We.call(ci,t)?s.length:0;c--;){var f=s[c],v=f.func;if(v==null||v==e)return f.name}return t}function fi(e){var t=We.call(d,"placeholder")?d:e;return t.placeholder}function we(){var e=d.iteratee||rc;return e=e===rc?Du:e,arguments.length?e(arguments[0],arguments[1]):e}function Xs(e,t){var s=e.__data__;return Fg(t)?s[typeof t=="string"?"string":"hash"]:s.map}function za(e){for(var t=$t(e),s=t.length;s--;){var c=t[s],f=e[c];t[s]=[c,f,gh(f)]}return t}function zn(e,t){var s=Yp(e,t);return Lu(s)?s:n}function Ug(e){var t=We.call(e,kn),s=e[kn];try{e[kn]=n;var c=!0}catch{}var f=Rs.call(e);return c&&(t?e[kn]=s:delete e[kn]),f}var $a=da?function(e){return e==null?[]:(e=rt(e),gn(da(e),function(t){return mu.call(e,t)}))}:sc,fh=da?function(e){for(var t=[];e;)vn(t,$a(e)),e=Ns(e);return t}:sc,Wt=Xt;(ga&&Wt(new ga(new ArrayBuffer(1)))!=Ue||Ti&&Wt(new Ti)!=oe||va&&Wt(va.resolve())!=ct||ai&&Wt(new ai)!=ze||Ai&&Wt(new Ai)!=Oe)&&(Wt=function(e){var t=Xt(e),s=t==Re?e.constructor:n,c=s?$n(s):"";if(c)switch(c){case bd:return Ue;case Ed:return oe;case Id:return ct;case Sd:return ze;case xd:return Oe}return t});function zg(e,t,s){for(var c=-1,f=s.length;++c<f;){var v=s[c],x=v.size;switch(v.type){case"drop":e+=x;break;case"dropRight":t-=x;break;case"take":t=Ft(t,e+x);break;case"takeRight":e=Ut(e,t-x);break}}return{start:e,end:t}}function $g(e){var t=e.match(st);return t?t[1].split(Lt):[]}function ph(e,t,s){t=bn(t,e);for(var c=-1,f=t.length,v=!1;++c<f;){var x=Kr(t[c]);if(!(v=e!=null&&s(e,x)))break;e=e[x]}return v||++c!=f?v:(f=e==null?0:e.length,!!f&&so(f)&&tn(x,f)&&(Pe(e)||Bn(e)))}function Bg(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&We.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function dh(e){return typeof e.constructor=="function"&&!zi(e)?ui(Ns(e)):{}}function Hg(e,t,s){var c=e.constructor;switch(t){case Ie:return Da(e);case K:case M:return new c(+e);case Ue:return Pg(e,s);case Xe:case je:case Ge:case gt:case St:case Rt:case vt:case Ht:case ir:return Qu(e,s);case oe:return new c;case ie:case Je:return new c(e);case it:return Og(e);case ze:return new c;case He:return Cg(e)}}function Vg(e,t){var s=t.length;if(!s)return e;var c=s-1;return t[c]=(s>1?"& ":"")+t[c],t=t.join(s>2?", ":" "),e.replace(Et,`{
/* [wrapped with `+t+`] */
`)}function Kg(e){return Pe(e)||Bn(e)||!!(_u&&e&&e[_u])}function tn(e,t){var s=typeof e;return t=t??ne,!!t&&(s=="number"||s!="symbol"&&Vo.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,s){if(!dt(s))return!1;var c=typeof t;return(c=="number"?ar(s)&&tn(t,s.length):c=="string"&&t in s)?Dr(s[t],e):!1}function Ba(e,t){if(Pe(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||vr(e)?!0:Tt.test(e)||!ht.test(e)||t!=null&&e in rt(t)}function Fg(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ha(e){var t=Js(e),s=d[t];if(typeof s!="function"||!(t in De.prototype))return!1;if(e===s)return!0;var c=Ua(s);return!!c&&e===c[0]}function Wg(e){return!!gu&&gu in e}var Gg=Os?rn:oc;function zi(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||oi;return e===s}function gh(e){return e===e&&!dt(e)}function vh(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==n||e in rt(s))}}function Yg(e){var t=no(e,function(c){return s.size===g&&s.clear(),c}),s=t.cache;return t}function Qg(e,t){var s=e[1],c=t[1],f=s|c,v=f<(H|B|N),x=c==N&&s==q||c==N&&s==U&&e[7].length<=t[8]||c==(N|U)&&t[7].length<=t[8]&&s==q;if(!(v||x))return e;c&H&&(e[2]=t[2],f|=s&H?0:z);var R=t[3];if(R){var j=e[3];e[3]=j?Xu(j,R,t[4]):R,e[4]=j?yn(e[3],m):t[4]}return R=t[5],R&&(j=e[5],e[5]=j?Zu(j,R,t[6]):R,e[6]=j?yn(e[5],m):t[6]),R=t[7],R&&(e[7]=R),c&N&&(e[8]=e[8]==null?t[8]:Ft(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=f,e}function Jg(e){var t=[];if(e!=null)for(var s in rt(e))t.push(s);return t}function Xg(e){return Rs.call(e)}function yh(e,t,s){return t=Ut(t===n?e.length-1:t,0),function(){for(var c=arguments,f=-1,v=Ut(c.length-t,0),x=V(v);++f<v;)x[f]=c[t+f];f=-1;for(var R=V(t+1);++f<t;)R[f]=c[f];return R[t]=s(x),zt(e,this,R)}}function mh(e,t){return t.length<2?e:Un(e,xr(t,0,-1))}function Zg(e,t){for(var s=e.length,c=Ft(t.length,s),f=or(e);c--;){var v=t[c];e[c]=tn(v,s)?f[v]:n}return e}function Va(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var _h=bh(Bu),$i=dd||function(e,t){return Me.setTimeout(e,t)},Ka=bh(Eg);function wh(e,t,s){var c=t+"";return Ka(e,Vg(c,ev($g(c),s)))}function bh(e){var t=0,s=0;return function(){var c=md(),f=le-(c-s);if(s=c,f>0){if(++t>=W)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Zs(e,t){var s=-1,c=e.length,f=c-1;for(t=t===n?c:t;++s<t;){var v=Oa(s,f),x=e[v];e[v]=e[s],e[s]=x}return e.length=t,e}var Eh=Yg(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(At,function(s,c,f,v){t.push(f?v.replace(qo,"$1"):c||s)}),t});function Kr(e){if(typeof e=="string"||vr(e))return e;var t=e+"";return t=="0"&&1/e==-ue?"-0":t}function $n(e){if(e!=null){try{return Cs.call(e)}catch{}try{return e+""}catch{}}return""}function ev(e,t){return br(nr,function(s){var c="_."+s[0];t&s[1]&&!Is(e,c)&&e.push(c)}),e.sort()}function Ih(e){if(e instanceof De)return e.clone();var t=new Ir(e.__wrapped__,e.__chain__);return t.__actions__=or(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function tv(e,t,s){(s?Zt(e,t,s):t===n)?t=1:t=Ut(Te(t),0);var c=e==null?0:e.length;if(!c||t<1)return[];for(var f=0,v=0,x=V(ks(c/t));f<c;)x[v++]=xr(e,f,f+=t);return x}function rv(e){for(var t=-1,s=e==null?0:e.length,c=0,f=[];++t<s;){var v=e[t];v&&(f[c++]=v)}return f}function nv(){var e=arguments.length;if(!e)return[];for(var t=V(e-1),s=arguments[0],c=e;c--;)t[c-1]=arguments[c];return vn(Pe(s)?or(s):[s],Vt(t,1))}var iv=Ne(function(e,t){return Ot(e)?ki(e,Vt(t,1,Ot,!0)):[]}),sv=Ne(function(e,t){var s=Pr(t);return Ot(s)&&(s=n),Ot(e)?ki(e,Vt(t,1,Ot,!0),we(s,2)):[]}),ov=Ne(function(e,t){var s=Pr(t);return Ot(s)&&(s=n),Ot(e)?ki(e,Vt(t,1,Ot,!0),n,s):[]});function av(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===n?1:Te(t),xr(e,t<0?0:t,c)):[]}function cv(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===n?1:Te(t),t=c-t,xr(e,0,t<0?0:t)):[]}function uv(e,t){return e&&e.length?Ks(e,we(t,3),!0,!0):[]}function hv(e,t){return e&&e.length?Ks(e,we(t,3),!0):[]}function lv(e,t,s,c){var f=e==null?0:e.length;return f?(s&&typeof s!="number"&&Zt(e,t,s)&&(s=0,c=f),ng(e,t,s,c)):[]}function Sh(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:Te(s);return f<0&&(f=Ut(c+f,0)),Ss(e,we(t,3),f)}function xh(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var f=c-1;return s!==n&&(f=Te(s),f=s<0?Ut(c+f,0):Ft(f,c-1)),Ss(e,we(t,3),f,!0)}function Ph(e){var t=e==null?0:e.length;return t?Vt(e,1):[]}function fv(e){var t=e==null?0:e.length;return t?Vt(e,ue):[]}function pv(e,t){var s=e==null?0:e.length;return s?(t=t===n?1:Te(t),Vt(e,t)):[]}function dv(e){for(var t=-1,s=e==null?0:e.length,c={};++t<s;){var f=e[t];c[f[0]]=f[1]}return c}function Oh(e){return e&&e.length?e[0]:n}function gv(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:Te(s);return f<0&&(f=Ut(c+f,0)),ri(e,t,f)}function vv(e){var t=e==null?0:e.length;return t?xr(e,0,-1):[]}var yv=Ne(function(e){var t=lt(e,Na);return t.length&&t[0]===e[0]?Ea(t):[]}),mv=Ne(function(e){var t=Pr(e),s=lt(e,Na);return t===Pr(s)?t=n:s.pop(),s.length&&s[0]===e[0]?Ea(s,we(t,2)):[]}),_v=Ne(function(e){var t=Pr(e),s=lt(e,Na);return t=typeof t=="function"?t:n,t&&s.pop(),s.length&&s[0]===e[0]?Ea(s,n,t):[]});function wv(e,t){return e==null?"":vd.call(e,t)}function Pr(e){var t=e==null?0:e.length;return t?e[t-1]:n}function bv(e,t,s){var c=e==null?0:e.length;if(!c)return-1;var f=c;return s!==n&&(f=Te(s),f=f<0?Ut(c+f,0):Ft(f,c-1)),t===t?ed(e,t,f):Ss(e,au,f,!0)}function Ev(e,t){return e&&e.length?qu(e,Te(t)):n}var Iv=Ne(Ch);function Ch(e,t){return e&&e.length&&t&&t.length?Pa(e,t):e}function Sv(e,t,s){return e&&e.length&&t&&t.length?Pa(e,t,we(s,2)):e}function xv(e,t,s){return e&&e.length&&t&&t.length?Pa(e,t,n,s):e}var Pv=en(function(e,t){var s=e==null?0:e.length,c=ma(e,t);return $u(e,lt(t,function(f){return tn(f,s)?+f:f}).sort(Ju)),c});function Ov(e,t){var s=[];if(!(e&&e.length))return s;var c=-1,f=[],v=e.length;for(t=we(t,3);++c<v;){var x=e[c];t(x,c,e)&&(s.push(x),f.push(c))}return $u(e,f),s}function Fa(e){return e==null?e:wd.call(e)}function Cv(e,t,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&Zt(e,t,s)?(t=0,s=c):(t=t==null?0:Te(t),s=s===n?c:Te(s)),xr(e,t,s)):[]}function Rv(e,t){return Vs(e,t)}function Tv(e,t,s){return Ra(e,t,we(s,2))}function Av(e,t){var s=e==null?0:e.length;if(s){var c=Vs(e,t);if(c<s&&Dr(e[c],t))return c}return-1}function Nv(e,t){return Vs(e,t,!0)}function Lv(e,t,s){return Ra(e,t,we(s,2),!0)}function Dv(e,t){var s=e==null?0:e.length;if(s){var c=Vs(e,t,!0)-1;if(Dr(e[c],t))return c}return-1}function kv(e){return e&&e.length?Hu(e):[]}function jv(e,t){return e&&e.length?Hu(e,we(t,2)):[]}function Mv(e){var t=e==null?0:e.length;return t?xr(e,1,t):[]}function qv(e,t,s){return e&&e.length?(t=s||t===n?1:Te(t),xr(e,0,t<0?0:t)):[]}function Uv(e,t,s){var c=e==null?0:e.length;return c?(t=s||t===n?1:Te(t),t=c-t,xr(e,t<0?0:t,c)):[]}function zv(e,t){return e&&e.length?Ks(e,we(t,3),!1,!0):[]}function $v(e,t){return e&&e.length?Ks(e,we(t,3)):[]}var Bv=Ne(function(e){return wn(Vt(e,1,Ot,!0))}),Hv=Ne(function(e){var t=Pr(e);return Ot(t)&&(t=n),wn(Vt(e,1,Ot,!0),we(t,2))}),Vv=Ne(function(e){var t=Pr(e);return t=typeof t=="function"?t:n,wn(Vt(e,1,Ot,!0),n,t)});function Kv(e){return e&&e.length?wn(e):[]}function Fv(e,t){return e&&e.length?wn(e,we(t,2)):[]}function Wv(e,t){return t=typeof t=="function"?t:n,e&&e.length?wn(e,n,t):[]}function Wa(e){if(!(e&&e.length))return[];var t=0;return e=gn(e,function(s){if(Ot(s))return t=Ut(s.length,t),!0}),ha(t,function(s){return lt(e,aa(s))})}function Rh(e,t){if(!(e&&e.length))return[];var s=Wa(e);return t==null?s:lt(s,function(c){return zt(t,n,c)})}var Gv=Ne(function(e,t){return Ot(e)?ki(e,t):[]}),Yv=Ne(function(e){return Aa(gn(e,Ot))}),Qv=Ne(function(e){var t=Pr(e);return Ot(t)&&(t=n),Aa(gn(e,Ot),we(t,2))}),Jv=Ne(function(e){var t=Pr(e);return t=typeof t=="function"?t:n,Aa(gn(e,Ot),n,t)}),Xv=Ne(Wa);function Zv(e,t){return Wu(e||[],t||[],Di)}function ey(e,t){return Wu(e||[],t||[],qi)}var ty=Ne(function(e){var t=e.length,s=t>1?e[t-1]:n;return s=typeof s=="function"?(e.pop(),s):n,Rh(e,s)});function Th(e){var t=d(e);return t.__chain__=!0,t}function ry(e,t){return t(e),e}function eo(e,t){return t(e)}var ny=en(function(e){var t=e.length,s=t?e[0]:0,c=this.__wrapped__,f=function(v){return ma(v,e)};return t>1||this.__actions__.length||!(c instanceof De)||!tn(s)?this.thru(f):(c=c.slice(s,+s+(t?1:0)),c.__actions__.push({func:eo,args:[f],thisArg:n}),new Ir(c,this.__chain__).thru(function(v){return t&&!v.length&&v.push(n),v}))});function iy(){return Th(this)}function sy(){return new Ir(this.value(),this.__chain__)}function oy(){this.__values__===n&&(this.__values__=Vh(this.value()));var e=this.__index__>=this.__values__.length,t=e?n:this.__values__[this.__index__++];return{done:e,value:t}}function ay(){return this}function cy(e){for(var t,s=this;s instanceof Us;){var c=Ih(s);c.__index__=0,c.__values__=n,t?f.__wrapped__=c:t=c;var f=c;s=s.__wrapped__}return f.__wrapped__=e,t}function uy(){var e=this.__wrapped__;if(e instanceof De){var t=e;return this.__actions__.length&&(t=new De(this)),t=t.reverse(),t.__actions__.push({func:eo,args:[Fa],thisArg:n}),new Ir(t,this.__chain__)}return this.thru(Fa)}function hy(){return Fu(this.__wrapped__,this.__actions__)}var ly=Fs(function(e,t,s){We.call(e,s)?++e[s]:Xr(e,s,1)});function fy(e,t,s){var c=Pe(e)?su:rg;return s&&Zt(e,t,s)&&(t=n),c(e,we(t,3))}function py(e,t){var s=Pe(e)?gn:Ru;return s(e,we(t,3))}var dy=nh(Sh),gy=nh(xh);function vy(e,t){return Vt(to(e,t),1)}function yy(e,t){return Vt(to(e,t),ue)}function my(e,t,s){return s=s===n?1:Te(s),Vt(to(e,t),s)}function Ah(e,t){var s=Pe(e)?br:_n;return s(e,we(t,3))}function Nh(e,t){var s=Pe(e)?Mp:Cu;return s(e,we(t,3))}var _y=Fs(function(e,t,s){We.call(e,s)?e[s].push(t):Xr(e,s,[t])});function wy(e,t,s,c){e=ar(e)?e:di(e),s=s&&!c?Te(s):0;var f=e.length;return s<0&&(s=Ut(f+s,0)),oo(e)?s<=f&&e.indexOf(t,s)>-1:!!f&&ri(e,t,s)>-1}var by=Ne(function(e,t,s){var c=-1,f=typeof t=="function",v=ar(e)?V(e.length):[];return _n(e,function(x){v[++c]=f?zt(t,x,s):ji(x,t,s)}),v}),Ey=Fs(function(e,t,s){Xr(e,s,t)});function to(e,t){var s=Pe(e)?lt:ku;return s(e,we(t,3))}function Iy(e,t,s,c){return e==null?[]:(Pe(t)||(t=t==null?[]:[t]),s=c?n:s,Pe(s)||(s=s==null?[]:[s]),Uu(e,t,s))}var Sy=Fs(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function xy(e,t,s){var c=Pe(e)?sa:uu,f=arguments.length<3;return c(e,we(t,4),s,f,_n)}function Py(e,t,s){var c=Pe(e)?qp:uu,f=arguments.length<3;return c(e,we(t,4),s,f,Cu)}function Oy(e,t){var s=Pe(e)?gn:Ru;return s(e,io(we(t,3)))}function Cy(e){var t=Pe(e)?Su:wg;return t(e)}function Ry(e,t,s){(s?Zt(e,t,s):t===n)?t=1:t=Te(t);var c=Pe(e)?Jd:bg;return c(e,t)}function Ty(e){var t=Pe(e)?Xd:Ig;return t(e)}function Ay(e){if(e==null)return 0;if(ar(e))return oo(e)?ii(e):e.length;var t=Wt(e);return t==oe||t==ze?e.size:Sa(e).length}function Ny(e,t,s){var c=Pe(e)?oa:Sg;return s&&Zt(e,t,s)&&(t=n),c(e,we(t,3))}var Ly=Ne(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Zt(e,t[0],t[1])?t=[]:s>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),Uu(e,Vt(t,1),[])}),ro=pd||function(){return Me.Date.now()};function Dy(e,t){if(typeof t!="function")throw new Er(l);return e=Te(e),function(){if(--e<1)return t.apply(this,arguments)}}function Lh(e,t,s){return t=s?n:t,t=e&&t==null?e.length:t,Zr(e,N,n,n,n,n,t)}function Dh(e,t){var s;if(typeof t!="function")throw new Er(l);return e=Te(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=n),s}}var Ga=Ne(function(e,t,s){var c=H;if(s.length){var f=yn(s,fi(Ga));c|=C}return Zr(e,c,t,s,f)}),kh=Ne(function(e,t,s){var c=H|B;if(s.length){var f=yn(s,fi(kh));c|=C}return Zr(t,c,e,s,f)});function jh(e,t,s){t=s?n:t;var c=Zr(e,q,n,n,n,n,n,t);return c.placeholder=jh.placeholder,c}function Mh(e,t,s){t=s?n:t;var c=Zr(e,I,n,n,n,n,n,t);return c.placeholder=Mh.placeholder,c}function qh(e,t,s){var c,f,v,x,R,j,Y=0,Q=!1,re=!1,fe=!0;if(typeof e!="function")throw new Er(l);t=Or(t)||0,dt(s)&&(Q=!!s.leading,re="maxWait"in s,v=re?Ut(Or(s.maxWait)||0,t):v,fe="trailing"in s?!!s.trailing:fe);function ve(Ct){var kr=c,sn=f;return c=f=n,Y=Ct,x=e.apply(sn,kr),x}function be(Ct){return Y=Ct,R=$i(Le,t),Q?ve(Ct):x}function Ae(Ct){var kr=Ct-j,sn=Ct-Y,nl=t-kr;return re?Ft(nl,v-sn):nl}function Ee(Ct){var kr=Ct-j,sn=Ct-Y;return j===n||kr>=t||kr<0||re&&sn>=v}function Le(){var Ct=ro();if(Ee(Ct))return qe(Ct);R=$i(Le,Ae(Ct))}function qe(Ct){return R=n,fe&&c?ve(Ct):(c=f=n,x)}function yr(){R!==n&&Gu(R),Y=0,c=j=f=R=n}function er(){return R===n?x:qe(ro())}function mr(){var Ct=ro(),kr=Ee(Ct);if(c=arguments,f=this,j=Ct,kr){if(R===n)return be(j);if(re)return Gu(R),R=$i(Le,t),ve(j)}return R===n&&(R=$i(Le,t)),x}return mr.cancel=yr,mr.flush=er,mr}var ky=Ne(function(e,t){return Ou(e,1,t)}),jy=Ne(function(e,t,s){return Ou(e,Or(t)||0,s)});function My(e){return Zr(e,ae)}function no(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Er(l);var s=function(){var c=arguments,f=t?t.apply(this,c):c[0],v=s.cache;if(v.has(f))return v.get(f);var x=e.apply(this,c);return s.cache=v.set(f,x)||v,x};return s.cache=new(no.Cache||Jr),s}no.Cache=Jr;function io(e){if(typeof e!="function")throw new Er(l);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function qy(e){return Dh(2,e)}var Uy=xg(function(e,t){t=t.length==1&&Pe(t[0])?lt(t[0],dr(we())):lt(Vt(t,1),dr(we()));var s=t.length;return Ne(function(c){for(var f=-1,v=Ft(c.length,s);++f<v;)c[f]=t[f].call(this,c[f]);return zt(e,this,c)})}),Ya=Ne(function(e,t){var s=yn(t,fi(Ya));return Zr(e,C,n,t,s)}),Uh=Ne(function(e,t){var s=yn(t,fi(Uh));return Zr(e,S,n,t,s)}),zy=en(function(e,t){return Zr(e,U,n,n,n,t)});function $y(e,t){if(typeof e!="function")throw new Er(l);return t=t===n?t:Te(t),Ne(e,t)}function By(e,t){if(typeof e!="function")throw new Er(l);return t=t==null?0:Ut(Te(t),0),Ne(function(s){var c=s[t],f=En(s,0,t);return c&&vn(f,c),zt(e,this,f)})}function Hy(e,t,s){var c=!0,f=!0;if(typeof e!="function")throw new Er(l);return dt(s)&&(c="leading"in s?!!s.leading:c,f="trailing"in s?!!s.trailing:f),qh(e,t,{leading:c,maxWait:t,trailing:f})}function Vy(e){return Lh(e,1)}function Ky(e,t){return Ya(La(t),e)}function Fy(){if(!arguments.length)return[];var e=arguments[0];return Pe(e)?e:[e]}function Wy(e){return Sr(e,A)}function Gy(e,t){return t=typeof t=="function"?t:n,Sr(e,A,t)}function Yy(e){return Sr(e,E|A)}function Qy(e,t){return t=typeof t=="function"?t:n,Sr(e,E|A,t)}function Jy(e,t){return t==null||Pu(e,t,$t(t))}function Dr(e,t){return e===t||e!==e&&t!==t}var Xy=Qs(ba),Zy=Qs(function(e,t){return e>=t}),Bn=Nu(function(){return arguments}())?Nu:function(e){return It(e)&&We.call(e,"callee")&&!mu.call(e,"callee")},Pe=V.isArray,em=Jt?dr(Jt):cg;function ar(e){return e!=null&&so(e.length)&&!rn(e)}function Ot(e){return It(e)&&ar(e)}function tm(e){return e===!0||e===!1||It(e)&&Xt(e)==K}var In=gd||oc,rm=Ar?dr(Ar):ug;function nm(e){return It(e)&&e.nodeType===1&&!Bi(e)}function im(e){if(e==null)return!0;if(ar(e)&&(Pe(e)||typeof e=="string"||typeof e.splice=="function"||In(e)||pi(e)||Bn(e)))return!e.length;var t=Wt(e);if(t==oe||t==ze)return!e.size;if(zi(e))return!Sa(e).length;for(var s in e)if(We.call(e,s))return!1;return!0}function sm(e,t){return Mi(e,t)}function om(e,t,s){s=typeof s=="function"?s:n;var c=s?s(e,t):n;return c===n?Mi(e,t,n,s):!!c}function Qa(e){if(!It(e))return!1;var t=Xt(e);return t==w||t==h||typeof e.message=="string"&&typeof e.name=="string"&&!Bi(e)}function am(e){return typeof e=="number"&&wu(e)}function rn(e){if(!dt(e))return!1;var t=Xt(e);return t==$||t==te||t==F||t==Qe}function zh(e){return typeof e=="number"&&e==Te(e)}function so(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ne}function dt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function It(e){return e!=null&&typeof e=="object"}var $h=wr?dr(wr):lg;function cm(e,t){return e===t||Ia(e,t,za(t))}function um(e,t,s){return s=typeof s=="function"?s:n,Ia(e,t,za(t),s)}function hm(e){return Bh(e)&&e!=+e}function lm(e){if(Gg(e))throw new Se(u);return Lu(e)}function fm(e){return e===null}function pm(e){return e==null}function Bh(e){return typeof e=="number"||It(e)&&Xt(e)==ie}function Bi(e){if(!It(e)||Xt(e)!=Re)return!1;var t=Ns(e);if(t===null)return!0;var s=We.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&Cs.call(s)==ud}var Ja=Br?dr(Br):fg;function dm(e){return zh(e)&&e>=-ne&&e<=ne}var Hh=Oi?dr(Oi):pg;function oo(e){return typeof e=="string"||!Pe(e)&&It(e)&&Xt(e)==Je}function vr(e){return typeof e=="symbol"||It(e)&&Xt(e)==He}var pi=Dn?dr(Dn):dg;function gm(e){return e===n}function vm(e){return It(e)&&Wt(e)==Oe}function ym(e){return It(e)&&Xt(e)==ye}var mm=Qs(xa),_m=Qs(function(e,t){return e<=t});function Vh(e){if(!e)return[];if(ar(e))return oo(e)?Nr(e):or(e);if(Ri&&e[Ri])return Jp(e[Ri]());var t=Wt(e),s=t==oe?fa:t==ze?xs:di;return s(e)}function nn(e){if(!e)return e===0?e:0;if(e=Or(e),e===ue||e===-ue){var t=e<0?-1:1;return t*J}return e===e?e:0}function Te(e){var t=nn(e),s=t%1;return t===t?s?t-s:t:0}function Kh(e){return e?qn(Te(e),0,se):0}function Or(e){if(typeof e=="number")return e;if(vr(e))return ee;if(dt(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=dt(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=hu(e);var s=$o.test(e);return s||Ho.test(e)?Ce(e.slice(2),s?2:8):zo.test(e)?ee:+e}function Fh(e){return Vr(e,cr(e))}function wm(e){return e?qn(Te(e),-ne,ne):e===0?e:0}function Ke(e){return e==null?"":gr(e)}var bm=hi(function(e,t){if(zi(t)||ar(t)){Vr(t,$t(t),e);return}for(var s in t)We.call(t,s)&&Di(e,s,t[s])}),Wh=hi(function(e,t){Vr(t,cr(t),e)}),ao=hi(function(e,t,s,c){Vr(t,cr(t),e,c)}),Em=hi(function(e,t,s,c){Vr(t,$t(t),e,c)}),Im=en(ma);function Sm(e,t){var s=ui(e);return t==null?s:xu(s,t)}var xm=Ne(function(e,t){e=rt(e);var s=-1,c=t.length,f=c>2?t[2]:n;for(f&&Zt(t[0],t[1],f)&&(c=1);++s<c;)for(var v=t[s],x=cr(v),R=-1,j=x.length;++R<j;){var Y=x[R],Q=e[Y];(Q===n||Dr(Q,oi[Y])&&!We.call(e,Y))&&(e[Y]=v[Y])}return e}),Pm=Ne(function(e){return e.push(n,hh),zt(Gh,n,e)});function Om(e,t){return ou(e,we(t,3),Hr)}function Cm(e,t){return ou(e,we(t,3),wa)}function Rm(e,t){return e==null?e:_a(e,we(t,3),cr)}function Tm(e,t){return e==null?e:Tu(e,we(t,3),cr)}function Am(e,t){return e&&Hr(e,we(t,3))}function Nm(e,t){return e&&wa(e,we(t,3))}function Lm(e){return e==null?[]:Bs(e,$t(e))}function Dm(e){return e==null?[]:Bs(e,cr(e))}function Xa(e,t,s){var c=e==null?n:Un(e,t);return c===n?s:c}function km(e,t){return e!=null&&ph(e,t,ig)}function Za(e,t){return e!=null&&ph(e,t,sg)}var jm=sh(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Rs.call(t)),e[t]=s},tc(ur)),Mm=sh(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Rs.call(t)),We.call(e,t)?e[t].push(s):e[t]=[s]},we),qm=Ne(ji);function $t(e){return ar(e)?Iu(e):Sa(e)}function cr(e){return ar(e)?Iu(e,!0):gg(e)}function Um(e,t){var s={};return t=we(t,3),Hr(e,function(c,f,v){Xr(s,t(c,f,v),c)}),s}function zm(e,t){var s={};return t=we(t,3),Hr(e,function(c,f,v){Xr(s,f,t(c,f,v))}),s}var $m=hi(function(e,t,s){Hs(e,t,s)}),Gh=hi(function(e,t,s,c){Hs(e,t,s,c)}),Bm=en(function(e,t){var s={};if(e==null)return s;var c=!1;t=lt(t,function(v){return v=bn(v,e),c||(c=v.length>1),v}),Vr(e,qa(e),s),c&&(s=Sr(s,E|P|A,jg));for(var f=t.length;f--;)Ta(s,t[f]);return s});function Hm(e,t){return Yh(e,io(we(t)))}var Vm=en(function(e,t){return e==null?{}:yg(e,t)});function Yh(e,t){if(e==null)return{};var s=lt(qa(e),function(c){return[c]});return t=we(t),zu(e,s,function(c,f){return t(c,f[0])})}function Km(e,t,s){t=bn(t,e);var c=-1,f=t.length;for(f||(f=1,e=n);++c<f;){var v=e==null?n:e[Kr(t[c])];v===n&&(c=f,v=s),e=rn(v)?v.call(e):v}return e}function Fm(e,t,s){return e==null?e:qi(e,t,s)}function Wm(e,t,s,c){return c=typeof c=="function"?c:n,e==null?e:qi(e,t,s,c)}var Qh=ch($t),Jh=ch(cr);function Gm(e,t,s){var c=Pe(e),f=c||In(e)||pi(e);if(t=we(t,4),s==null){var v=e&&e.constructor;f?s=c?new v:[]:dt(e)?s=rn(v)?ui(Ns(e)):{}:s={}}return(f?br:Hr)(e,function(x,R,j){return t(s,x,R,j)}),s}function Ym(e,t){return e==null?!0:Ta(e,t)}function Qm(e,t,s){return e==null?e:Ku(e,t,La(s))}function Jm(e,t,s,c){return c=typeof c=="function"?c:n,e==null?e:Ku(e,t,La(s),c)}function di(e){return e==null?[]:la(e,$t(e))}function Xm(e){return e==null?[]:la(e,cr(e))}function Zm(e,t,s){return s===n&&(s=t,t=n),s!==n&&(s=Or(s),s=s===s?s:0),t!==n&&(t=Or(t),t=t===t?t:0),qn(Or(e),t,s)}function e_(e,t,s){return t=nn(t),s===n?(s=t,t=0):s=nn(s),e=Or(e),og(e,t,s)}function t_(e,t,s){if(s&&typeof s!="boolean"&&Zt(e,t,s)&&(t=s=n),s===n&&(typeof t=="boolean"?(s=t,t=n):typeof e=="boolean"&&(s=e,e=n)),e===n&&t===n?(e=0,t=1):(e=nn(e),t===n?(t=e,e=0):t=nn(t)),e>t){var c=e;e=t,t=c}if(s||e%1||t%1){var f=bu();return Ft(e+f*(t-e+et("1e-"+((f+"").length-1))),t)}return Oa(e,t)}var r_=li(function(e,t,s){return t=t.toLowerCase(),e+(s?Xh(t):t)});function Xh(e){return ec(Ke(e).toLowerCase())}function Zh(e){return e=Ke(e),e&&e.replace(Gr,Fp).replace(ra,"")}function n_(e,t,s){e=Ke(e),t=gr(t);var c=e.length;s=s===n?c:qn(Te(s),0,c);var f=s;return s-=t.length,s>=0&&e.slice(s,f)==t}function i_(e){return e=Ke(e),e&&ut.test(e)?e.replace(Rn,Wp):e}function s_(e){return e=Ke(e),e&&Nt.test(e)?e.replace(wt,"\\$&"):e}var o_=li(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),a_=li(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),c_=rh("toLowerCase");function u_(e,t,s){e=Ke(e),t=Te(t);var c=t?ii(e):0;if(!t||c>=t)return e;var f=(t-c)/2;return Ys(js(f),s)+e+Ys(ks(f),s)}function h_(e,t,s){e=Ke(e),t=Te(t);var c=t?ii(e):0;return t&&c<t?e+Ys(t-c,s):e}function l_(e,t,s){e=Ke(e),t=Te(t);var c=t?ii(e):0;return t&&c<t?Ys(t-c,s)+e:e}function f_(e,t,s){return s||t==null?t=0:t&&(t=+t),_d(Ke(e).replace(bt,""),t||0)}function p_(e,t,s){return(s?Zt(e,t,s):t===n)?t=1:t=Te(t),Ca(Ke(e),t)}function d_(){var e=arguments,t=Ke(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var g_=li(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function v_(e,t,s){return s&&typeof s!="number"&&Zt(e,t,s)&&(t=s=n),s=s===n?se:s>>>0,s?(e=Ke(e),e&&(typeof t=="string"||t!=null&&!Ja(t))&&(t=gr(t),!t&&ni(e))?En(Nr(e),0,s):e.split(t,s)):[]}var y_=li(function(e,t,s){return e+(s?" ":"")+ec(t)});function m_(e,t,s){return e=Ke(e),s=s==null?0:qn(Te(s),0,e.length),t=gr(t),e.slice(s,s+t.length)==t}function __(e,t,s){var c=d.templateSettings;s&&Zt(e,t,s)&&(t=n),e=Ke(e),t=ao({},t,c,uh);var f=ao({},t.imports,c.imports,uh),v=$t(f),x=la(f,v),R,j,Y=0,Q=t.interpolate||Yn,re="__p += '",fe=pa((t.escape||Yn).source+"|"+Q.source+"|"+(Q===pt?Uo:Yn).source+"|"+(t.evaluate||Yn).source+"|$","g"),ve="//# sourceURL="+(We.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++na+"]")+`
`;e.replace(fe,function(Ee,Le,qe,yr,er,mr){return qe||(qe=yr),re+=e.slice(Y,mr).replace(Ko,Gp),Le&&(R=!0,re+=`' +
__e(`+Le+`) +
'`),er&&(j=!0,re+=`';
`+er+`;
__p += '`),qe&&(re+=`' +
((__t = (`+qe+`)) == null ? '' : __t) +
'`),Y=mr+Ee.length,Ee}),re+=`';
`;var be=We.call(t,"variable")&&t.variable;if(!be)re=`with (obj) {
`+re+`
}
`;else if(Mo.test(be))throw new Se(p);re=(j?re.replace(zr,""):re).replace(Qt,"$1").replace(Wr,"$1;"),re="function("+(be||"obj")+`) {
`+(be?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(j?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+re+`return __p
}`;var Ae=tl(function(){return Ve(v,ve+"return "+re).apply(n,x)});if(Ae.source=re,Qa(Ae))throw Ae;return Ae}function w_(e){return Ke(e).toLowerCase()}function b_(e){return Ke(e).toUpperCase()}function E_(e,t,s){if(e=Ke(e),e&&(s||t===n))return hu(e);if(!e||!(t=gr(t)))return e;var c=Nr(e),f=Nr(t),v=lu(c,f),x=fu(c,f)+1;return En(c,v,x).join("")}function I_(e,t,s){if(e=Ke(e),e&&(s||t===n))return e.slice(0,du(e)+1);if(!e||!(t=gr(t)))return e;var c=Nr(e),f=fu(c,Nr(t))+1;return En(c,0,f).join("")}function S_(e,t,s){if(e=Ke(e),e&&(s||t===n))return e.replace(bt,"");if(!e||!(t=gr(t)))return e;var c=Nr(e),f=lu(c,Nr(t));return En(c,f).join("")}function x_(e,t){var s=Z,c=he;if(dt(t)){var f="separator"in t?t.separator:f;s="length"in t?Te(t.length):s,c="omission"in t?gr(t.omission):c}e=Ke(e);var v=e.length;if(ni(e)){var x=Nr(e);v=x.length}if(s>=v)return e;var R=s-ii(c);if(R<1)return c;var j=x?En(x,0,R).join(""):e.slice(0,R);if(f===n)return j+c;if(x&&(R+=j.length-R),Ja(f)){if(e.slice(R).search(f)){var Y,Q=j;for(f.global||(f=pa(f.source,Ke(_r.exec(f))+"g")),f.lastIndex=0;Y=f.exec(Q);)var re=Y.index;j=j.slice(0,re===n?R:re)}}else if(e.indexOf(gr(f),R)!=R){var fe=j.lastIndexOf(f);fe>-1&&(j=j.slice(0,fe))}return j+c}function P_(e){return e=Ke(e),e&&yt.test(e)?e.replace(pn,td):e}var O_=li(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),ec=rh("toUpperCase");function el(e,t,s){return e=Ke(e),t=s?n:t,t===n?Qp(e)?id(e):$p(e):e.match(t)||[]}var tl=Ne(function(e,t){try{return zt(e,n,t)}catch(s){return Qa(s)?s:new Se(s)}}),C_=en(function(e,t){return br(t,function(s){s=Kr(s),Xr(e,s,Ga(e[s],e))}),e});function R_(e){var t=e==null?0:e.length,s=we();return e=t?lt(e,function(c){if(typeof c[1]!="function")throw new Er(l);return[s(c[0]),c[1]]}):[],Ne(function(c){for(var f=-1;++f<t;){var v=e[f];if(zt(v[0],this,c))return zt(v[1],this,c)}})}function T_(e){return tg(Sr(e,E))}function tc(e){return function(){return e}}function A_(e,t){return e==null||e!==e?t:e}var N_=ih(),L_=ih(!0);function ur(e){return e}function rc(e){return Du(typeof e=="function"?e:Sr(e,E))}function D_(e){return ju(Sr(e,E))}function k_(e,t){return Mu(e,Sr(t,E))}var j_=Ne(function(e,t){return function(s){return ji(s,e,t)}}),M_=Ne(function(e,t){return function(s){return ji(e,s,t)}});function nc(e,t,s){var c=$t(t),f=Bs(t,c);s==null&&!(dt(t)&&(f.length||!c.length))&&(s=t,t=e,e=this,f=Bs(t,$t(t)));var v=!(dt(s)&&"chain"in s)||!!s.chain,x=rn(e);return br(f,function(R){var j=t[R];e[R]=j,x&&(e.prototype[R]=function(){var Y=this.__chain__;if(v||Y){var Q=e(this.__wrapped__),re=Q.__actions__=or(this.__actions__);return re.push({func:j,args:arguments,thisArg:e}),Q.__chain__=Y,Q}return j.apply(e,vn([this.value()],arguments))})}),e}function q_(){return Me._===this&&(Me._=hd),this}function ic(){}function U_(e){return e=Te(e),Ne(function(t){return qu(t,e)})}var z_=ka(lt),$_=ka(su),B_=ka(oa);function rl(e){return Ba(e)?aa(Kr(e)):mg(e)}function H_(e){return function(t){return e==null?n:Un(e,t)}}var V_=oh(),K_=oh(!0);function sc(){return[]}function oc(){return!1}function F_(){return{}}function W_(){return""}function G_(){return!0}function Y_(e,t){if(e=Te(e),e<1||e>ne)return[];var s=se,c=Ft(e,se);t=we(t),e-=se;for(var f=ha(c,t);++s<e;)t(s);return f}function Q_(e){return Pe(e)?lt(e,Kr):vr(e)?[e]:or(Eh(Ke(e)))}function J_(e){var t=++cd;return Ke(e)+t}var X_=Gs(function(e,t){return e+t},0),Z_=ja("ceil"),ew=Gs(function(e,t){return e/t},1),tw=ja("floor");function rw(e){return e&&e.length?$s(e,ur,ba):n}function nw(e,t){return e&&e.length?$s(e,we(t,2),ba):n}function iw(e){return cu(e,ur)}function sw(e,t){return cu(e,we(t,2))}function ow(e){return e&&e.length?$s(e,ur,xa):n}function aw(e,t){return e&&e.length?$s(e,we(t,2),xa):n}var cw=Gs(function(e,t){return e*t},1),uw=ja("round"),hw=Gs(function(e,t){return e-t},0);function lw(e){return e&&e.length?ua(e,ur):0}function fw(e,t){return e&&e.length?ua(e,we(t,2)):0}return d.after=Dy,d.ary=Lh,d.assign=bm,d.assignIn=Wh,d.assignInWith=ao,d.assignWith=Em,d.at=Im,d.before=Dh,d.bind=Ga,d.bindAll=C_,d.bindKey=kh,d.castArray=Fy,d.chain=Th,d.chunk=tv,d.compact=rv,d.concat=nv,d.cond=R_,d.conforms=T_,d.constant=tc,d.countBy=ly,d.create=Sm,d.curry=jh,d.curryRight=Mh,d.debounce=qh,d.defaults=xm,d.defaultsDeep=Pm,d.defer=ky,d.delay=jy,d.difference=iv,d.differenceBy=sv,d.differenceWith=ov,d.drop=av,d.dropRight=cv,d.dropRightWhile=uv,d.dropWhile=hv,d.fill=lv,d.filter=py,d.flatMap=vy,d.flatMapDeep=yy,d.flatMapDepth=my,d.flatten=Ph,d.flattenDeep=fv,d.flattenDepth=pv,d.flip=My,d.flow=N_,d.flowRight=L_,d.fromPairs=dv,d.functions=Lm,d.functionsIn=Dm,d.groupBy=_y,d.initial=vv,d.intersection=yv,d.intersectionBy=mv,d.intersectionWith=_v,d.invert=jm,d.invertBy=Mm,d.invokeMap=by,d.iteratee=rc,d.keyBy=Ey,d.keys=$t,d.keysIn=cr,d.map=to,d.mapKeys=Um,d.mapValues=zm,d.matches=D_,d.matchesProperty=k_,d.memoize=no,d.merge=$m,d.mergeWith=Gh,d.method=j_,d.methodOf=M_,d.mixin=nc,d.negate=io,d.nthArg=U_,d.omit=Bm,d.omitBy=Hm,d.once=qy,d.orderBy=Iy,d.over=z_,d.overArgs=Uy,d.overEvery=$_,d.overSome=B_,d.partial=Ya,d.partialRight=Uh,d.partition=Sy,d.pick=Vm,d.pickBy=Yh,d.property=rl,d.propertyOf=H_,d.pull=Iv,d.pullAll=Ch,d.pullAllBy=Sv,d.pullAllWith=xv,d.pullAt=Pv,d.range=V_,d.rangeRight=K_,d.rearg=zy,d.reject=Oy,d.remove=Ov,d.rest=$y,d.reverse=Fa,d.sampleSize=Ry,d.set=Fm,d.setWith=Wm,d.shuffle=Ty,d.slice=Cv,d.sortBy=Ly,d.sortedUniq=kv,d.sortedUniqBy=jv,d.split=v_,d.spread=By,d.tail=Mv,d.take=qv,d.takeRight=Uv,d.takeRightWhile=zv,d.takeWhile=$v,d.tap=ry,d.throttle=Hy,d.thru=eo,d.toArray=Vh,d.toPairs=Qh,d.toPairsIn=Jh,d.toPath=Q_,d.toPlainObject=Fh,d.transform=Gm,d.unary=Vy,d.union=Bv,d.unionBy=Hv,d.unionWith=Vv,d.uniq=Kv,d.uniqBy=Fv,d.uniqWith=Wv,d.unset=Ym,d.unzip=Wa,d.unzipWith=Rh,d.update=Qm,d.updateWith=Jm,d.values=di,d.valuesIn=Xm,d.without=Gv,d.words=el,d.wrap=Ky,d.xor=Yv,d.xorBy=Qv,d.xorWith=Jv,d.zip=Xv,d.zipObject=Zv,d.zipObjectDeep=ey,d.zipWith=ty,d.entries=Qh,d.entriesIn=Jh,d.extend=Wh,d.extendWith=ao,nc(d,d),d.add=X_,d.attempt=tl,d.camelCase=r_,d.capitalize=Xh,d.ceil=Z_,d.clamp=Zm,d.clone=Wy,d.cloneDeep=Yy,d.cloneDeepWith=Qy,d.cloneWith=Gy,d.conformsTo=Jy,d.deburr=Zh,d.defaultTo=A_,d.divide=ew,d.endsWith=n_,d.eq=Dr,d.escape=i_,d.escapeRegExp=s_,d.every=fy,d.find=dy,d.findIndex=Sh,d.findKey=Om,d.findLast=gy,d.findLastIndex=xh,d.findLastKey=Cm,d.floor=tw,d.forEach=Ah,d.forEachRight=Nh,d.forIn=Rm,d.forInRight=Tm,d.forOwn=Am,d.forOwnRight=Nm,d.get=Xa,d.gt=Xy,d.gte=Zy,d.has=km,d.hasIn=Za,d.head=Oh,d.identity=ur,d.includes=wy,d.indexOf=gv,d.inRange=e_,d.invoke=qm,d.isArguments=Bn,d.isArray=Pe,d.isArrayBuffer=em,d.isArrayLike=ar,d.isArrayLikeObject=Ot,d.isBoolean=tm,d.isBuffer=In,d.isDate=rm,d.isElement=nm,d.isEmpty=im,d.isEqual=sm,d.isEqualWith=om,d.isError=Qa,d.isFinite=am,d.isFunction=rn,d.isInteger=zh,d.isLength=so,d.isMap=$h,d.isMatch=cm,d.isMatchWith=um,d.isNaN=hm,d.isNative=lm,d.isNil=pm,d.isNull=fm,d.isNumber=Bh,d.isObject=dt,d.isObjectLike=It,d.isPlainObject=Bi,d.isRegExp=Ja,d.isSafeInteger=dm,d.isSet=Hh,d.isString=oo,d.isSymbol=vr,d.isTypedArray=pi,d.isUndefined=gm,d.isWeakMap=vm,d.isWeakSet=ym,d.join=wv,d.kebabCase=o_,d.last=Pr,d.lastIndexOf=bv,d.lowerCase=a_,d.lowerFirst=c_,d.lt=mm,d.lte=_m,d.max=rw,d.maxBy=nw,d.mean=iw,d.meanBy=sw,d.min=ow,d.minBy=aw,d.stubArray=sc,d.stubFalse=oc,d.stubObject=F_,d.stubString=W_,d.stubTrue=G_,d.multiply=cw,d.nth=Ev,d.noConflict=q_,d.noop=ic,d.now=ro,d.pad=u_,d.padEnd=h_,d.padStart=l_,d.parseInt=f_,d.random=t_,d.reduce=xy,d.reduceRight=Py,d.repeat=p_,d.replace=d_,d.result=Km,d.round=uw,d.runInContext=D,d.sample=Cy,d.size=Ay,d.snakeCase=g_,d.some=Ny,d.sortedIndex=Rv,d.sortedIndexBy=Tv,d.sortedIndexOf=Av,d.sortedLastIndex=Nv,d.sortedLastIndexBy=Lv,d.sortedLastIndexOf=Dv,d.startCase=y_,d.startsWith=m_,d.subtract=hw,d.sum=lw,d.sumBy=fw,d.template=__,d.times=Y_,d.toFinite=nn,d.toInteger=Te,d.toLength=Kh,d.toLower=w_,d.toNumber=Or,d.toSafeInteger=wm,d.toString=Ke,d.toUpper=b_,d.trim=E_,d.trimEnd=I_,d.trimStart=S_,d.truncate=x_,d.unescape=P_,d.uniqueId=J_,d.upperCase=O_,d.upperFirst=ec,d.each=Ah,d.eachRight=Nh,d.first=Oh,nc(d,function(){var e={};return Hr(d,function(t,s){We.call(d.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),d.VERSION=i,br(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),br(["drop","take"],function(e,t){De.prototype[e]=function(s){s=s===n?1:Ut(Te(s),0);var c=this.__filtered__&&!t?new De(this):this.clone();return c.__filtered__?c.__takeCount__=Ft(s,c.__takeCount__):c.__views__.push({size:Ft(s,se),type:e+(c.__dir__<0?"Right":"")}),c},De.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),br(["filter","map","takeWhile"],function(e,t){var s=t+1,c=s==y||s==ce;De.prototype[e]=function(f){var v=this.clone();return v.__iteratees__.push({iteratee:we(f,3),type:s}),v.__filtered__=v.__filtered__||c,v}}),br(["head","last"],function(e,t){var s="take"+(t?"Right":"");De.prototype[e]=function(){return this[s](1).value()[0]}}),br(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");De.prototype[e]=function(){return this.__filtered__?new De(this):this[s](1)}}),De.prototype.compact=function(){return this.filter(ur)},De.prototype.find=function(e){return this.filter(e).head()},De.prototype.findLast=function(e){return this.reverse().find(e)},De.prototype.invokeMap=Ne(function(e,t){return typeof e=="function"?new De(this):this.map(function(s){return ji(s,e,t)})}),De.prototype.reject=function(e){return this.filter(io(we(e)))},De.prototype.slice=function(e,t){e=Te(e);var s=this;return s.__filtered__&&(e>0||t<0)?new De(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==n&&(t=Te(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},De.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},De.prototype.toArray=function(){return this.take(se)},Hr(De.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),f=d[c?"take"+(t=="last"?"Right":""):t],v=c||/^find/.test(t);f&&(d.prototype[t]=function(){var x=this.__wrapped__,R=c?[1]:arguments,j=x instanceof De,Y=R[0],Q=j||Pe(x),re=function(Le){var qe=f.apply(d,vn([Le],R));return c&&fe?qe[0]:qe};Q&&s&&typeof Y=="function"&&Y.length!=1&&(j=Q=!1);var fe=this.__chain__,ve=!!this.__actions__.length,be=v&&!fe,Ae=j&&!ve;if(!v&&Q){x=Ae?x:new De(this);var Ee=e.apply(x,R);return Ee.__actions__.push({func:eo,args:[re],thisArg:n}),new Ir(Ee,fe)}return be&&Ae?e.apply(this,R):(Ee=this.thru(re),be?c?Ee.value()[0]:Ee.value():Ee)})}),br(["pop","push","shift","sort","splice","unshift"],function(e){var t=Ps[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(c&&!this.__chain__){var v=this.value();return t.apply(Pe(v)?v:[],f)}return this[s](function(x){return t.apply(Pe(x)?x:[],f)})}}),Hr(De.prototype,function(e,t){var s=d[t];if(s){var c=s.name+"";We.call(ci,c)||(ci[c]=[]),ci[c].push({name:t,func:s})}}),ci[Ws(n,B).name]=[{name:"wrapper",func:n}],De.prototype.clone=Pd,De.prototype.reverse=Od,De.prototype.value=Cd,d.prototype.at=ny,d.prototype.chain=iy,d.prototype.commit=sy,d.prototype.next=oy,d.prototype.plant=cy,d.prototype.reverse=uy,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=hy,d.prototype.first=d.prototype.head,Ri&&(d.prototype[Ri]=ay),d},si=sd();Pt?((Pt.exports=si)._=si,tt._=si):Me._=si}).call(Yi)})(Vc,Vc.exports);var XI=Object.defineProperty,ZI=Object.defineProperties,eS=Object.getOwnPropertyDescriptors,Rf=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,Tf=(a,r,n)=>r in a?XI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,_o=(a,r)=>{for(var n in r||(r={}))tS.call(r,n)&&Tf(a,n,r[n]);if(Rf)for(var n of Rf(r))rS.call(r,n)&&Tf(a,n,r[n]);return a},nS=(a,r)=>ZI(a,eS(r));function On(a,r,n){var i;const o=Dw(a);return((i=r.rpcMap)==null?void 0:i[o.reference])||`${JI}?chainId=${o.namespace}:${o.reference}&projectId=${n}`}function Gn(a){return a.includes(":")?a.split(":")[1]:a}function Dp(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function iS(a,r){const n=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!n.length)return[];const i=[];return n.forEach(o=>{const u=r.namespaces[o].accounts;i.push(...u)}),i}function sS(a={},r={}){const n=Af(a),i=Af(r);return Vc.exports.merge(n,i)}function Af(a){var r,n,i,o;const u={};if(!bo(a))return u;for(const[l,p]of Object.entries(a)){const _=$f(l)?[l]:p.chains,g=p.methods||[],m=p.events||[],E=p.rpcMap||{},P=Qi(l);u[P]=nS(_o(_o({},u[P]),p),{chains:ac(_,(r=u[P])==null?void 0:r.chains),methods:ac(g,(n=u[P])==null?void 0:n.methods),events:ac(m,(i=u[P])==null?void 0:i.events),rpcMap:_o(_o({},E),(o=u[P])==null?void 0:o.rpcMap)})}return u}function oS(a){return a.includes(":")?a.split(":")[2]:a}function aS(a){const r={};for(const[n,i]of Object.entries(a)){const o=i.methods||[],u=i.events||[],l=i.accounts||[],p=$f(n)?[n]:i.chains?i.chains:Dp(i.accounts);r[n]={chains:p,methods:o,events:u,accounts:l}}return r}function Lc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const kp={},ft=a=>kp[a],Dc=(a,r)=>{kp[a]=r};class cS{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=Gn(n);r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class uS{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(parseInt(r),n),this.chainId=parseInt(r),this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,n){const i=n||On(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=parseInt(Gn(n));r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}async handleSwitchChain(r){var n,i;let o=r.request.params?(n=r.request.params[0])==null?void 0:n.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const u=parseInt(o,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class hS{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=Gn(n);r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class lS{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=Gn(n);r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class fS{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{const i=this.getCardanoRPCUrl(n),o=Gn(n);r[o]=this.createHttpProvider(o,i)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}getCardanoRPCUrl(r){const n=this.namespace.rpcMap;if(n)return n[r]}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||this.getCardanoRPCUrl(r);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class pS{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=Gn(n);r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class dS{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){this.httpProviders[r]||this.setHttpProvider(r,n),this.chainId=r,this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;const o=Gn(n);r[o]=this.createHttpProvider(o,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);return new ln(new Cn(i,ft("disableProviderPing")))}}class gS{constructor(r){this.name="near",this.namespace=r.namespace,this.events=ft("events"),this.client=ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,n){if(this.chainId=r,!this.httpProviders[r]){const i=n||On(`${this.name}:${r}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,i)}this.events.emit(fn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(n=>{var i;r[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[n])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,n=this.httpProviders[r];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return n}setHttpProvider(r,n){const i=this.createHttpProvider(r,n);i&&(this.httpProviders[r]=i)}createHttpProvider(r,n){const i=n||On(r,this.namespace);return typeof i>"u"?void 0:new ln(new Cn(i,ft("disableProviderPing")))}}var vS=Object.defineProperty,yS=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,_S=Object.prototype.hasOwnProperty,wS=Object.prototype.propertyIsEnumerable,Lf=(a,r,n)=>r in a?vS(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,wo=(a,r)=>{for(var n in r||(r={}))_S.call(r,n)&&Lf(a,n,r[n]);if(Nf)for(var n of Nf(r))wS.call(r,n)&&Lf(a,n,r[n]);return a},kc=(a,r)=>yS(a,mS(r));class nu{constructor(r){this.events=new Wc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:ke.pino(ke.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Of})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const n=new nu(r);return await n.initialize(),n}async request(r,n){const[i,o]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:wo({},r),chainId:`${i}:${o}`,topic:this.session.topic})}sendAsync(r,n,i){const o=new Date().getTime();this.request(r,i).then(u=>n(null,No(o,u))).catch(u=>n(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:Gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,n){this.events.on(r,n)}once(r,n){this.events.once(r,n)}removeListener(r,n){this.events.removeListener(r,n)}off(r,n){this.events.off(r,n)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let n=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(n>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await o().then(u=>{this.session=u,this.namespaces||(this.namespaces=aS(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Np)throw u;n++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,n){try{if(!this.session)return;const[i,o]=this.validateChain(r);this.getProvider(i).setDefaultChain(o,n)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(bi(n)){for(const i of n)r.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await VI.init({logger:this.providerOpts.logger||Of,relayUrl:this.providerOpts.relayUrl||GI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(n=>Qi(n)))];Dc("client",this.client),Dc("events",this.events),Dc("disableProviderPing",this.disableProviderPing),r.forEach(n=>{if(!this.session)return;const i=iS(n,this.session),o=Dp(i),u=sS(this.namespaces,this.optionalNamespaces),l=kc(wo({},u[n]),{accounts:i,chains:o});switch(n){case"eip155":this.rpcProviders[n]=new uS({namespace:l});break;case"solana":this.rpcProviders[n]=new hS({namespace:l});break;case"cosmos":this.rpcProviders[n]=new lS({namespace:l});break;case"polkadot":this.rpcProviders[n]=new cS({namespace:l});break;case"cip34":this.rpcProviders[n]=new fS({namespace:l});break;case"elrond":this.rpcProviders[n]=new pS({namespace:l});break;case"multiversx":this.rpcProviders[n]=new dS({namespace:l});break;case"near":this.rpcProviders[n]=new gS({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:n}=r,{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&bi(o)&&this.events.emit("accountsChanged",o.map(oS))}else if(i.name==="chainChanged"){const o=n.chainId,u=n.event.data,l=Qi(o),p=Lc(o)!==Lc(u)?`${l}:${Lc(u)}`:o;this.onChainChanged(p)}else this.events.emit(i.name,i.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:n})=>{var i;const{namespaces:o}=n,u=(i=this.client)==null?void 0:i.session.get(r);this.session=kc(wo({},u),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:n})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",kc(wo({},Gt("USER_DISCONNECTED")),{data:r.topic}))}),this.on(fn.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var n;this.getProvider(r).updateNamespace((n=this.session)==null?void 0:n.namespaces[r])})}setNamespaces(r){const{namespaces:n,optionalNamespaces:i,sessionProperties:o}=r;n&&Object.keys(n).length&&(this.namespaces=n),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=o,this.persist("namespaces",n),this.persist("optionalNamespaces",i)}validateChain(r){const[n,i]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,i];if(n&&!Object.keys(this.namespaces||{}).map(l=>Qi(l)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&i)return[n,i];const o=Qi(Object.keys(this.namespaces)[0]),u=this.rpcProviders[o].getDefaultChain();return[o,u]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,n=!1){var i;if(!this.namespaces)return;const[o,u]=this.validateChain(r);n||this.getProvider(o).setDefaultChain(u),((i=this.namespaces[o])!=null?i:this.namespaces[`${o}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,n){this.client.core.storage.setItem(`${Cf}/${r}`,n)}async getFromStore(r){return await this.client.core.storage.getItem(`${Cf}/${r}`)}}const bS=nu,ES="wc",IS="ethereum_provider",SS=`${ES}@2:${IS}:`,xS="https://rpc.walletconnect.com/v1/",Kc=["eth_sendTransaction","personal_sign"],PS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Fc=["chainChanged","accountsChanged"],OS=["chainChanged","accountsChanged","message","disconnect","connect"];var CS=Object.defineProperty,RS=Object.defineProperties,TS=Object.getOwnPropertyDescriptors,Df=Object.getOwnPropertySymbols,AS=Object.prototype.hasOwnProperty,NS=Object.prototype.propertyIsEnumerable,kf=(a,r,n)=>r in a?CS(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n,Xi=(a,r)=>{for(var n in r||(r={}))AS.call(r,n)&&kf(a,n,r[n]);if(Df)for(var n of Df(r))NS.call(r,n)&&kf(a,n,r[n]);return a},jf=(a,r)=>RS(a,TS(r));function Oo(a){return Number(a[0].split(":")[1])}function jc(a){return`0x${a.toString(16)}`}function LS(a){const{chains:r,optionalChains:n,methods:i,optionalMethods:o,events:u,optionalEvents:l,rpcMap:p}=a;if(!bi(r))throw new Error("Invalid chains");const _={chains:r,methods:i||Kc,events:u||Fc,rpcMap:Xi({},r.length?{[Oo(r)]:p[Oo(r)]}:{})},g=u==null?void 0:u.filter(A=>!Fc.includes(A)),m=i==null?void 0:i.filter(A=>!Kc.includes(A));if(!n&&!l&&!o&&!(g!=null&&g.length)&&!(m!=null&&m.length))return{required:r.length?_:void 0};const E=(g==null?void 0:g.length)&&(m==null?void 0:m.length)||!n,P={chains:[...new Set(E?_.chains.concat(n||[]):n)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:PS))],events:[...new Set(_.events.concat(l!=null&&l.length?l:OS))],rpcMap:p};return{required:r.length?_:void 0,optional:n.length?P:void 0}}class iu{constructor(){this.events=new Rr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=SS,this.on=(r,n)=>(this.events.on(r,n),this),this.once=(r,n)=>(this.events.once(r,n),this),this.removeListener=(r,n)=>(this.events.removeListener(r,n),this),this.off=(r,n)=>(this.events.off(r,n),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const n=new iu;return await n.initialize(r),n}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,n){this.signer.sendAsync(r,n,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:n,optional:i}=LS(this.rpc);try{const o=await new Promise(async(l,p)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(jf(Xi({namespaces:Xi({},n&&{[this.namespace]:n})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(g=>{l(g)}).catch(g=>{p(new Error(g.message))})});if(!o)return;const u=gw(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:jc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:n}=r,{event:i}=n;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const n=parseInt(r);this.chainId=n,this.events.emit("chainChanged",jc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",jf(Xi({},Gt("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var n,i;this.rpc.showQrModal&&((n=this.modal)==null||n.closeModal(),(i=this.modal)==null||i.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const n=r.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));n.length&&(this.chainId=n[0],this.events.emit("chainChanged",jc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const n=this.parseChainId(r);this.chainId=n,this.switchEthereumChain(n)}}parseAccountId(r){const[n,i,o]=r.split(":");return{chainId:`${n}:${i}`,address:o}}setAccounts(r){this.accounts=r.filter(n=>this.parseChainId(this.parseAccountId(n).chainId)===this.chainId).map(n=>this.parseAccountId(n).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var n,i;const o=(n=r==null?void 0:r.chains)!=null?n:[],u=(i=r==null?void 0:r.optionalChains)!=null?i:[],l=o.concat(u);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=o.length?(r==null?void 0:r.methods)||Kc:[],_=o.length?(r==null?void 0:r.events)||Fc:[],g=(r==null?void 0:r.optionalMethods)||[],m=(r==null?void 0:r.optionalEvents)||[],E=(r==null?void 0:r.rpcMap)||this.buildRpcMap(l,r.projectId),P=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(A=>this.formatChainId(A)),optionalChains:u.map(A=>this.formatChainId(A)),methods:p,events:_,optionalMethods:g,optionalEvents:m,rpcMap:E,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:P,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,n){const i={};return r.forEach(o=>{i[o]=this.getRpcUrl(o,n)}),i}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?Oo(this.rpc.chains):Oo(this.rpc.optionalChains),this.signer=await bS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let n;try{const{WalletConnectModal:i}=await pw(()=>import("./index-tk75yDPv-9wPIKA0B.js"),__vite__mapDeps([0,1,2,3])).then(o=>o.i);n=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(n)try{this.modal=new n(Xi({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:n,optionalChains:i,rpcMap:o}=r;n&&bi(n)&&(this.rpc.chains=n.map(u=>this.formatChainId(u)),n.forEach(u=>{this.rpc.rpcMap[u]=(o==null?void 0:o[u])||this.getRpcUrl(u)})),i&&bi(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(u=>this.formatChainId(u)),i.forEach(u=>{this.rpc.rpcMap[u]=(o==null?void 0:o[u])||this.getRpcUrl(u)}))}getRpcUrl(r,n){var i;return((i=this.rpc.rpcMap)==null?void 0:i[r])||`${xS}?chainId=eip155:${r}&projectId=${n||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),n=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:n==null?void 0:n.accounts),this.setAccounts(n==null?void 0:n.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(n=>this.parseAccount(n))}}const MS=iu;export{MS as EthereumProvider,OS as OPTIONAL_EVENTS,PS as OPTIONAL_METHODS,Fc as REQUIRED_EVENTS,Kc as REQUIRED_METHODS,iu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-tk75yDPv-9wPIKA0B.js","assets/index-aJ1IhnCu.js","assets/vendor-KMCe_Sr5.js","assets/index-T5ldjviA.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}