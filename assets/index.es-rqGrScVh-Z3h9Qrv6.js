import{_ as fw}from"./index-vBUh_9IV.js";import{s as zr,C as st,a as Ar,b as dw,A as wn,w as _n,S as Kl,N as Fe,v as gw,d as Vl,h as Wl,c as bc,G as Yn,e as vw,Z as po,f as Bl,$ as Qa,g as Fl,i as dn,k as De,m as Lr,r as yw,t as mw,y as ww,_ as _w,x as Yl,z as yn,D as Ei,V as oo,O as hr,E as X,H as Ii,I as bw,P as Ew,Q as Ja,J as Nh,K as gn,R as Iw,L as Pw,T as Sw,W as Dh,X as Ow,Y as Aw,a0 as Rw,a1 as Cw,a2 as xw,a3 as Tw,a4 as Gl,a5 as Nw,a6 as Dw,a7 as jw,a8 as Lw,a9 as Ec,aa as qw,ab as lc,ac as zw,ad as Mw,ae as kw,af as jh,ag as Uw,ah as $w,ai as Hw,aj as Lh,ak as Kw,al as _o,am as Vw,an as Ww,ao as Xn,ap as qh,aq as Bw,ar as Fw,as as Yw,at as zh,au as Gw,av as Qw,aw as Jw,ax as Xw,ay as Zw,az as Ic,aA as t_,aB as Ql,aC as Jl,aD as pc,aE as fo}from"./index-IyzEmrXE.js";import"./vendor-kGWFO7TU.js";var e_={};const r_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,i_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,n_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function s_(a,r){if(a==="__proto__"||a==="constructor"&&r&&typeof r=="object"&&"prototype"in r){o_(a);return}return r}function o_(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function ao(a,r={}){if(typeof a!="string")return a;const i=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return i.slice(1,-1);if(i.length<=9){const s=i.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!n_.test(a)){if(r.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(r_.test(a)||i_.test(a)){if(r.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,s_)}return JSON.parse(a)}catch(s){if(r.strict)throw s;return a}}function a_(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ue(a,...r){try{return a_(a(...r))}catch(i){return Promise.reject(i)}}function c_(a){const r=typeof a;return a===null||r!=="object"&&r!=="function"}function u_(a){const r=Object.getPrototypeOf(a);return!r||r.isPrototypeOf(Object)}function go(a){if(c_(a))return String(a);if(u_(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return go(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Xl(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const fc="base64:";function h_(a){if(typeof a=="string")return a;Xl();const r=Buffer.from(a).toString("base64");return fc+r}function l_(a){return typeof a!="string"||!a.startsWith(fc)?a:(Xl(),Buffer.from(a.slice(fc.length),"base64"))}function ur(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function p_(...a){return ur(a.join(":"))}function co(a){return a=ur(a),a?a+":":""}const f_="memory",d_=()=>{const a=new Map;return{name:f_,options:{},hasItem(r){return a.has(r)},getItem(r){return a.get(r)??null},getItemRaw(r){return a.get(r)??null},setItem(r,i){a.set(r,i)},setItemRaw(r,i){a.set(r,i)},removeItem(r){a.delete(r)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function g_(a={}){const r={mounts:{"":a.driver||d_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=y=>{for(const I of r.mountpoints)if(y.startsWith(I))return{base:I,relativeKey:y.slice(I.length),driver:r.mounts[I]};return{base:"",relativeKey:y,driver:r.mounts[""]}},s=(y,I)=>r.mountpoints.filter(R=>R.startsWith(y)||I&&y.startsWith(R)).map(R=>({relativeBase:y.length>R.length?y.slice(R.length):void 0,mountpoint:R,driver:r.mounts[R]})),o=(y,I)=>{if(r.watching){I=ur(I);for(const R of r.watchListeners)R(y,I)}},h=async()=>{if(!r.watching){r.watching=!0;for(const y in r.mounts)r.unwatch[y]=await Mh(r.mounts[y],o,y)}},f=async()=>{if(r.watching){for(const y in r.unwatch)await r.unwatch[y]();r.unwatch={},r.watching=!1}},g=(y,I,R)=>{const N=new Map,k=x=>{let W=N.get(x.base);return W||(W={driver:x.driver,base:x.base,items:[]},N.set(x.base,W)),W};for(const x of y){const W=typeof x=="string",tt=ur(W?x:x.key),vt=W?void 0:x.value,ft=W||!x.options?I:{...I,...x.options},ut=i(tt);k(ut).items.push({key:tt,value:vt,relativeKey:ut.relativeKey,options:ft})}return Promise.all([...N.values()].map(x=>R(x))).then(x=>x.flat())},_={hasItem(y,I={}){y=ur(y);const{relativeKey:R,driver:N}=i(y);return Ue(N.hasItem,R,I)},getItem(y,I={}){y=ur(y);const{relativeKey:R,driver:N}=i(y);return Ue(N.getItem,R,I).then(k=>ao(k))},getItems(y,I){return g(y,I,R=>R.driver.getItems?Ue(R.driver.getItems,R.items.map(N=>({key:N.relativeKey,options:N.options})),I).then(N=>N.map(k=>({key:p_(R.base,k.key),value:ao(k.value)}))):Promise.all(R.items.map(N=>Ue(R.driver.getItem,N.relativeKey,N.options).then(k=>({key:N.key,value:ao(k)})))))},getItemRaw(y,I={}){y=ur(y);const{relativeKey:R,driver:N}=i(y);return N.getItemRaw?Ue(N.getItemRaw,R,I):Ue(N.getItem,R,I).then(k=>l_(k))},async setItem(y,I,R={}){if(I===void 0)return _.removeItem(y);y=ur(y);const{relativeKey:N,driver:k}=i(y);k.setItem&&(await Ue(k.setItem,N,go(I),R),k.watch||o("update",y))},async setItems(y,I){await g(y,I,async R=>{R.driver.setItems&&await Ue(R.driver.setItems,R.items.map(N=>({key:N.relativeKey,value:go(N.value),options:N.options})),I),R.driver.setItem&&await Promise.all(R.items.map(N=>Ue(R.driver.setItem,N.relativeKey,go(N.value),N.options)))})},async setItemRaw(y,I,R={}){if(I===void 0)return _.removeItem(y,R);y=ur(y);const{relativeKey:N,driver:k}=i(y);if(k.setItemRaw)await Ue(k.setItemRaw,N,I,R);else if(k.setItem)await Ue(k.setItem,N,h_(I),R);else return;k.watch||o("update",y)},async removeItem(y,I={}){typeof I=="boolean"&&(I={removeMeta:I}),y=ur(y);const{relativeKey:R,driver:N}=i(y);N.removeItem&&(await Ue(N.removeItem,R,I),(I.removeMeta||I.removeMata)&&await Ue(N.removeItem,R+"$",I),N.watch||o("remove",y))},async getMeta(y,I={}){typeof I=="boolean"&&(I={nativeOnly:I}),y=ur(y);const{relativeKey:R,driver:N}=i(y),k=Object.create(null);if(N.getMeta&&Object.assign(k,await Ue(N.getMeta,R,I)),!I.nativeOnly){const x=await Ue(N.getItem,R+"$",I).then(W=>ao(W));x&&typeof x=="object"&&(typeof x.atime=="string"&&(x.atime=new Date(x.atime)),typeof x.mtime=="string"&&(x.mtime=new Date(x.mtime)),Object.assign(k,x))}return k},setMeta(y,I,R={}){return this.setItem(y+"$",I,R)},removeMeta(y,I={}){return this.removeItem(y+"$",I)},async getKeys(y,I={}){y=co(y);const R=s(y,!0);let N=[];const k=[];for(const x of R){const W=(await Ue(x.driver.getKeys,x.relativeBase,I)).map(tt=>x.mountpoint+ur(tt)).filter(tt=>!N.some(vt=>tt.startsWith(vt)));k.push(...W),N=[x.mountpoint,...N.filter(tt=>!tt.startsWith(x.mountpoint))]}return y?k.filter(x=>x.startsWith(y)&&!x.endsWith("$")):k.filter(x=>!x.endsWith("$"))},async clear(y,I={}){y=co(y),await Promise.all(s(y,!1).map(async R=>{if(R.driver.clear)return Ue(R.driver.clear,R.relativeBase,I);if(R.driver.removeItem){const N=await R.driver.getKeys(R.relativeBase||"",I);return Promise.all(N.map(k=>R.driver.removeItem(k,I)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(y=>kh(y)))},async watch(y){return await h(),r.watchListeners.push(y),async()=>{r.watchListeners=r.watchListeners.filter(I=>I!==y),r.watchListeners.length===0&&await f()}},async unwatch(){r.watchListeners=[],await f()},mount(y,I){if(y=co(y),y&&r.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(r.mountpoints.push(y),r.mountpoints.sort((R,N)=>N.length-R.length)),r.mounts[y]=I,r.watching&&Promise.resolve(Mh(I,o,y)).then(R=>{r.unwatch[y]=R}).catch(console.error),_},async unmount(y,I=!0){y=co(y),!(!y||!r.mounts[y])&&(r.watching&&y in r.unwatch&&(r.unwatch[y](),delete r.unwatch[y]),I&&await kh(r.mounts[y]),r.mountpoints=r.mountpoints.filter(R=>R!==y),delete r.mounts[y])},getMount(y=""){y=ur(y)+":";const I=i(y);return{driver:I.driver,base:I.base}},getMounts(y="",I={}){return y=ur(y),s(y,I.parents).map(R=>({driver:R.driver,base:R.mountpoint}))}};return _}function Mh(a,r,i){return a.watch?a.watch((s,o)=>r(s,i+o)):()=>{}}async function kh(a){typeof a.dispose=="function"&&await Ue(a.dispose)}function Ki(a){return new Promise((r,i)=>{a.oncomplete=a.onsuccess=()=>r(a.result),a.onabort=a.onerror=()=>i(a.error)})}function Zl(a,r){const i=indexedDB.open(a);i.onupgradeneeded=()=>i.result.createObjectStore(r);const s=Ki(i);return(o,h)=>s.then(f=>h(f.transaction(r,o).objectStore(r)))}let Xa;function Zn(){return Xa||(Xa=Zl("keyval-store","keyval")),Xa}function Uh(a,r=Zn()){return r("readonly",i=>Ki(i.get(a)))}function v_(a,r,i=Zn()){return i("readwrite",s=>(s.put(r,a),Ki(s.transaction)))}function y_(a,r=Zn()){return r("readwrite",i=>(i.delete(a),Ki(i.transaction)))}function m_(a=Zn()){return a("readwrite",r=>(r.clear(),Ki(r.transaction)))}function w_(a,r){return a.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},Ki(a.transaction)}function __(a=Zn()){return a("readonly",r=>{if(r.getAllKeys)return Ki(r.getAllKeys());const i=[];return w_(r,s=>i.push(s.key)).then(()=>i)})}const b_=a=>JSON.stringify(a,(r,i)=>typeof i=="bigint"?i.toString()+"n":i),E_=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=a.replace(r,'$1"$2n"$3');return JSON.parse(i,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ts(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return E_(a)}catch{return a}}function Hi(a){return typeof a=="string"?a:b_(a)||""}const I_="idb-keyval";var P_=(a={})=>{const r=a.base&&a.base.length>0?`${a.base}:`:"",i=o=>r+o;let s;return a.dbName&&a.storeName&&(s=Zl(a.dbName,a.storeName)),{name:I_,options:a,async hasItem(o){return!(typeof await Uh(i(o),s)>"u")},async getItem(o){return await Uh(i(o),s)??null},setItem(o,h){return v_(i(o),h,s)},removeItem(o){return y_(i(o),s)},getKeys(){return __(s)},clear(){return m_(s)}}};const S_="WALLET_CONNECT_V2_INDEXED_DB",O_="keyvaluestorage";let A_=class{constructor(){this.indexedDb=g_({driver:P_({dbName:S_,storeName:O_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(a=>[a.key,a.value])}async getItem(a){const r=await this.indexedDb.getItem(a);if(r!==null)return r}async setItem(a,r){await this.indexedDb.setItem(a,Hi(r))}async removeItem(a){await this.indexedDb.removeItem(a)}};var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vo={exports:{}};(function(){let a;function r(){}a=r,a.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},a.prototype.setItem=function(i,s){this[i]=String(s)},a.prototype.removeItem=function(i){delete this[i]},a.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(s){i[s]=void 0,delete i[s]})},a.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Za<"u"&&Za.localStorage?vo.exports=Za.localStorage:typeof window<"u"&&window.localStorage?vo.exports=window.localStorage:vo.exports=new r})();function R_(a){var r;return[a[0],ts((r=a[1])!=null?r:"")]}class C_{constructor(){this.localStorage=vo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(R_)}async getItem(r){const i=this.localStorage.getItem(r);if(i!==null)return ts(i)}async setItem(r,i){this.localStorage.setItem(r,Hi(i))}async removeItem(r){this.localStorage.removeItem(r)}}const x_="wc_storage_version",$h=1,T_=async(a,r,i)=>{const s=x_,o=await r.getItem(s);if(o&&o>=$h){i(r);return}const h=await a.getKeys();if(!h.length){i(r);return}const f=[];for(;h.length;){const g=h.shift();if(!g)continue;const _=g.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const y=await a.getItem(g);await r.setItem(g,y),f.push(g)}}await r.setItem(s,$h),i(r),N_(a,f)},N_=async(a,r)=>{r.length&&r.forEach(async i=>{await a.removeItem(i)})};let D_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const a=new C_;this.storage=a;try{const r=new A_;T_(a,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(a){return await this.initialize(),this.storage.getItem(a)}async setItem(a,r){return await this.initialize(),this.storage.setItem(a,r)}async removeItem(a){return await this.initialize(),this.storage.removeItem(a)}async initialize(){this.initialized||await new Promise(a=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),a())},20)})}};var bn={},$n={},Hh={},Hn={};let Vi=class{};const j_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),L_=Kl(j_);var Kh;function q_(){if(Kh)return Hn;Kh=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.IHeartBeat=void 0;const a=L_;class r extends a.IEvents{constructor(s){super()}}return Hn.IHeartBeat=r,Hn}var Vh;function tp(){return Vh||(Vh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),_n.__exportStar(q_(),a)}(Hh)),Hh}var Wh={},$i={},Bh;function z_(){if(Bh)return $i;Bh=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.HEARTBEAT_EVENTS=$i.HEARTBEAT_INTERVAL=void 0;const a=st;return $i.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,$i.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},$i}var Fh;function ep(){return Fh||(Fh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),_n.__exportStar(z_(),a)}(Wh)),Wh}var Yh;function M_(){if(Yh)return $n;Yh=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.HeartBeat=void 0;const a=_n,r=Ar,i=st,s=tp(),o=ep();class h extends s.IHeartBeat{constructor(g){super(g),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const _=new h(g);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,_){this.events.on(g,_)}once(g,_){this.events.once(g,_)}off(g,_){this.events.off(g,_)}removeListener(g,_){this.events.removeListener(g,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return $n.HeartBeat=h,$n}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=_n;r.__exportStar(M_(),a),r.__exportStar(tp(),a),r.__exportStar(ep(),a)})(bn);var Rt={},tc,Gh;function k_(){if(Gh)return tc;Gh=1;function a(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}tc=r;function r(i,s,o){var h=o&&o.stringify||a,f=1;if(typeof i=="object"&&i!==null){var g=s.length+f;if(g===1)return i;var _=new Array(g);_[0]=h(i);for(var y=1;y<g;y++)_[y]=h(s[y]);return _.join(" ")}if(typeof i!="string")return i;var I=s.length;if(I===0)return i;for(var R="",N=1-f,k=-1,x=i&&i.length||0,W=0;W<x;){if(i.charCodeAt(W)===37&&W+1<x){switch(k=k>-1?k:0,i.charCodeAt(W+1)){case 100:case 102:if(N>=I||s[N]==null)break;k<W&&(R+=i.slice(k,W)),R+=Number(s[N]),k=W+2,W++;break;case 105:if(N>=I||s[N]==null)break;k<W&&(R+=i.slice(k,W)),R+=Math.floor(Number(s[N])),k=W+2,W++;break;case 79:case 111:case 106:if(N>=I||s[N]===void 0)break;k<W&&(R+=i.slice(k,W));var tt=typeof s[N];if(tt==="string"){R+="'"+s[N]+"'",k=W+2,W++;break}if(tt==="function"){R+=s[N].name||"<anonymous>",k=W+2,W++;break}R+=h(s[N]),k=W+2,W++;break;case 115:if(N>=I)break;k<W&&(R+=i.slice(k,W)),R+=String(s[N]),k=W+2,W++;break;case 37:k<W&&(R+=i.slice(k,W)),R+="%",k=W+2,W++,N--;break}++N}++W}return k===-1?i:(k<x&&(R+=i.slice(k)),R)}return tc}var ec,Qh;function U_(){if(Qh)return ec;Qh=1;const a=k_();ec=o;const r=lt().console||{},i={mapHttpRequest:x,mapHttpResponse:x,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:x,res:x,err:N};function s(L,H){return Array.isArray(L)?L.filter(function(Y){return Y!=="!stdSerializers.err"}):L===!0?Object.keys(H):!1}function o(L){L=L||{},L.browser=L.browser||{};const H=L.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const Y=L.browser.write||r;L.browser.write&&(L.browser.asObject=!0);const wt=L.serializers||{},it=s(L.browser.serialize,wt);let nt=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(nt=!1);const Lt=["error","fatal","warn","info","debug","trace"];typeof Y=="function"&&(Y.error=Y.fatal=Y.warn=Y.info=Y.debug=Y.trace=Y),L.enabled===!1&&(L.level="silent");const qt=L.level||"info",m=Object.create(Y);m.log||(m.log=tt),Object.defineProperty(m,"levelVal",{get:Q}),Object.defineProperty(m,"level",{get:dt,set:B});const P={transmit:H,serialize:it,asObject:L.browser.asObject,levels:Lt,timestamp:k(L)};m.levels=o.levels,m.level=qt,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=tt,m.serializers=wt,m._serialize=it,m._stdErrSerialize=nt,m.child=$,H&&(m._logEvent=R());function Q(){return this.level==="silent"?1/0:this.levels.values[this.level]}function dt(){return this._level}function B(V){if(V!=="silent"&&!this.levels.values[V])throw Error("unknown level "+V);this._level=V,h(P,m,"error","log"),h(P,m,"fatal","error"),h(P,m,"warn","error"),h(P,m,"info","log"),h(P,m,"debug","log"),h(P,m,"trace","log")}function $(V,F){if(!V)throw new Error("missing bindings for child Pino");F=F||{},it&&V.serializers&&(F.serializers=V.serializers);const Gt=F.serializers;if(it&&Gt){var Kt=Object.assign({},wt,Gt),Mr=L.browser.serialize===!0?Object.keys(Kt):it;delete V.serializers,_([V],Mr,Kt,this._stdErrSerialize)}function It(Ie){this._childLevel=(Ie._childLevel|0)+1,this.error=y(Ie,V,"error"),this.fatal=y(Ie,V,"fatal"),this.warn=y(Ie,V,"warn"),this.info=y(Ie,V,"info"),this.debug=y(Ie,V,"debug"),this.trace=y(Ie,V,"trace"),Kt&&(this.serializers=Kt,this._serialize=Mr),H&&(this._logEvent=R([].concat(Ie._logEvent.bindings,V)))}return It.prototype=this,new It(this)}return m}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:vt,epochTime:ft,unixTime:ut,isoTime:ht});function h(L,H,Y,wt){const it=Object.getPrototypeOf(H);H[Y]=H.levelVal>H.levels.values[Y]?tt:it[Y]?it[Y]:r[Y]||r[wt]||tt,f(L,H,Y)}function f(L,H,Y){!L.transmit&&H[Y]===tt||(H[Y]=function(wt){return function(){const it=L.timestamp(),nt=new Array(arguments.length),Lt=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var qt=0;qt<nt.length;qt++)nt[qt]=arguments[qt];if(L.serialize&&!L.asObject&&_(nt,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?wt.call(Lt,g(this,Y,nt,it)):wt.apply(Lt,nt),L.transmit){const m=L.transmit.level||H.level,P=o.levels.values[m],Q=o.levels.values[Y];if(Q<P)return;I(this,{ts:it,methodLevel:Y,methodValue:Q,transmitLevel:m,transmitValue:o.levels.values[L.transmit.level||H.level],send:L.transmit.send,val:H.levelVal},nt)}}}(H[Y]))}function g(L,H,Y,wt){L._serialize&&_(Y,L._serialize,L.serializers,L._stdErrSerialize);const it=Y.slice();let nt=it[0];const Lt={};wt&&(Lt.time=wt),Lt.level=o.levels.values[H];let qt=(L._childLevel|0)+1;if(qt<1&&(qt=1),nt!==null&&typeof nt=="object"){for(;qt--&&typeof it[0]=="object";)Object.assign(Lt,it.shift());nt=it.length?a(it.shift(),it):void 0}else typeof nt=="string"&&(nt=a(it.shift(),it));return nt!==void 0&&(Lt.msg=nt),Lt}function _(L,H,Y,wt){for(const it in L)if(wt&&L[it]instanceof Error)L[it]=o.stdSerializers.err(L[it]);else if(typeof L[it]=="object"&&!Array.isArray(L[it]))for(const nt in L[it])H&&H.indexOf(nt)>-1&&nt in Y&&(L[it][nt]=Y[nt](L[it][nt]))}function y(L,H,Y){return function(){const wt=new Array(1+arguments.length);wt[0]=H;for(var it=1;it<wt.length;it++)wt[it]=arguments[it-1];return L[Y].apply(this,wt)}}function I(L,H,Y){const wt=H.send,it=H.ts,nt=H.methodLevel,Lt=H.methodValue,qt=H.val,m=L._logEvent.bindings;_(Y,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=it,L._logEvent.messages=Y.filter(function(P){return m.indexOf(P)===-1}),L._logEvent.level.label=nt,L._logEvent.level.value=Lt,wt(nt,L._logEvent,qt),L._logEvent=R(m)}function R(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function N(L){const H={type:L.constructor.name,msg:L.message,stack:L.stack};for(const Y in L)H[Y]===void 0&&(H[Y]=L[Y]);return H}function k(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?vt:ft}function x(){return{}}function W(L){return L}function tt(){}function vt(){return!1}function ft(){return Date.now()}function ut(){return Math.round(Date.now()/1e3)}function ht(){return new Date(Date.now()).toISOString()}function lt(){function L(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return ec}var fn={},Jh;function rp(){return Jh||(Jh=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.PINO_CUSTOM_CONTEXT_KEY=fn.PINO_LOGGER_DEFAULTS=void 0,fn.PINO_LOGGER_DEFAULTS={level:"info"},fn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),fn}var er={},Xh;function $_(){if(Xh)return er;Xh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const a=rp();function r(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||a.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=r;function i(g,_=a.PINO_CUSTOM_CONTEXT_KEY){return g[_]||""}er.getBrowserLoggerContext=i;function s(g,_,y=a.PINO_CUSTOM_CONTEXT_KEY){return g[y]=_,g}er.setBrowserLoggerContext=s;function o(g,_=a.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof g.bindings>"u"?y=i(g,_):y=g.bindings().context||"",y}er.getLoggerContext=o;function h(g,_,y=a.PINO_CUSTOM_CONTEXT_KEY){const I=o(g,y);return I.trim()?`${I}/${_}`:_}er.formatChildLoggerContext=h;function f(g,_,y=a.PINO_CUSTOM_CONTEXT_KEY){const I=h(g,_,y),R=g.child({context:I});return s(R,I,y)}return er.generateChildLogger=f,er}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=_n,i=r.__importDefault(U_());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return i.default}}),r.__exportStar(rp(),a),r.__exportStar($_(),a)})(Rt);class H_ extends Vi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}let K_=class extends Vi{constructor(a,r){super(),this.core=a,this.logger=r,this.records=new Map}},V_=class{constructor(a,r){this.logger=a,this.core=r}},W_=class extends Vi{constructor(a,r){super(),this.relayer=a,this.logger=r}},B_=class extends Vi{constructor(a){super()}},F_=class{constructor(a,r,i,s){this.core=a,this.logger=r,this.name=i}};class Y_ extends Vi{constructor(r,i){super(),this.relayer=r,this.logger=i}}let G_=class extends Vi{constructor(a,r){super(),this.core=a,this.logger=r}},Q_=class{constructor(a,r){this.projectId=a,this.logger=r}},J_=class{constructor(a,r){this.projectId=a,this.logger=r}},X_=class{constructor(a){this.opts=a,this.protocol="wc",this.version=2}},Z_=class{constructor(a){this.client=a}};var Pc={},ip={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=gw,i=Vl;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},g.prototype.update=function(_,y){if(y===void 0&&(y=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=_[I++],y--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(I=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,I,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=_[I++],y--;return this},g.prototype.finish=function(_){if(!this._finished){var y=this._bytesHashed,I=this._bufferLength,R=y/536870912|0,N=y<<3,k=y%128<112?128:256;this._buffer[I]=128;for(var x=I+1;x<k-8;x++)this._buffer[x]=0;r.writeUint32BE(R,this._buffer,k-8),r.writeUint32BE(N,this._buffer,k-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,k),this._finished=!0}for(var x=0;x<this.digestLength/8;x++)r.writeUint32BE(this._stateHi[x],_,x*8),r.writeUint32BE(this._stateLo[x],_,x*8+4);return this},g.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(_){i.wipe(_.stateHi),i.wipe(_.stateLo),_.buffer&&i.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},g}();a.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,_,y,I,R,N,k){for(var x=y[0],W=y[1],tt=y[2],vt=y[3],ft=y[4],ut=y[5],ht=y[6],lt=y[7],L=I[0],H=I[1],Y=I[2],wt=I[3],it=I[4],nt=I[5],Lt=I[6],qt=I[7],m,P,Q,dt,B,$,V,F;k>=128;){for(var Gt=0;Gt<16;Gt++){var Kt=8*Gt+N;g[Gt]=r.readUint32BE(R,Kt),_[Gt]=r.readUint32BE(R,Kt+4)}for(var Gt=0;Gt<80;Gt++){var Mr=x,It=W,Ie=tt,j=vt,D=ft,C=ut,u=ht,E=lt,et=L,pt=H,bt=Y,Tt=wt,Dt=it,Ot=nt,Pe=Lt,me=qt;if(m=lt,P=qt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=(ft>>>14|it<<18)^(ft>>>18|it<<14)^(it>>>9|ft<<23),P=(it>>>14|ft<<18)^(it>>>18|ft<<14)^(ft>>>9|it<<23),B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,m=ft&ut^~ft&ht,P=it&nt^~it&Lt,B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,m=o[Gt*2],P=o[Gt*2+1],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,m=g[Gt%16],P=_[Gt%16],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,Q=V&65535|F<<16,dt=B&65535|$<<16,m=Q,P=dt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=(x>>>28|L<<4)^(L>>>2|x<<30)^(L>>>7|x<<25),P=(L>>>28|x<<4)^(x>>>2|L<<30)^(x>>>7|L<<25),B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,m=x&W^x&tt^W&tt,P=L&H^L&Y^H&Y,B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,E=V&65535|F<<16,me=B&65535|$<<16,m=j,P=Tt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=Q,P=dt,B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,j=V&65535|F<<16,Tt=B&65535|$<<16,W=Mr,tt=It,vt=Ie,ft=j,ut=D,ht=C,lt=u,x=E,H=et,Y=pt,wt=bt,it=Tt,nt=Dt,Lt=Ot,qt=Pe,L=me,Gt%16===15)for(var Kt=0;Kt<16;Kt++)m=g[Kt],P=_[Kt],B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=g[(Kt+9)%16],P=_[(Kt+9)%16],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,Q=g[(Kt+1)%16],dt=_[(Kt+1)%16],m=(Q>>>1|dt<<31)^(Q>>>8|dt<<24)^Q>>>7,P=(dt>>>1|Q<<31)^(dt>>>8|Q<<24)^(dt>>>7|Q<<25),B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,Q=g[(Kt+14)%16],dt=_[(Kt+14)%16],m=(Q>>>19|dt<<13)^(dt>>>29|Q<<3)^Q>>>6,P=(dt>>>19|Q<<13)^(Q>>>29|dt<<3)^(dt>>>6|Q<<26),B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,g[Kt]=V&65535|F<<16,_[Kt]=B&65535|$<<16}m=x,P=L,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[0],P=I[0],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[0]=x=V&65535|F<<16,I[0]=L=B&65535|$<<16,m=W,P=H,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[1],P=I[1],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[1]=W=V&65535|F<<16,I[1]=H=B&65535|$<<16,m=tt,P=Y,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[2],P=I[2],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[2]=tt=V&65535|F<<16,I[2]=Y=B&65535|$<<16,m=vt,P=wt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[3],P=I[3],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[3]=vt=V&65535|F<<16,I[3]=wt=B&65535|$<<16,m=ft,P=it,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[4],P=I[4],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[4]=ft=V&65535|F<<16,I[4]=it=B&65535|$<<16,m=ut,P=nt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[5],P=I[5],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[5]=ut=V&65535|F<<16,I[5]=nt=B&65535|$<<16,m=ht,P=Lt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[6],P=I[6],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[6]=ht=V&65535|F<<16,I[6]=Lt=B&65535|$<<16,m=lt,P=qt,B=P&65535,$=P>>>16,V=m&65535,F=m>>>16,m=y[7],P=I[7],B+=P&65535,$+=P>>>16,V+=m&65535,F+=m>>>16,$+=B>>>16,V+=$>>>16,F+=V>>>16,y[7]=lt=V&65535|F<<16,I[7]=qt=B&65535|$<<16,N+=128,k-=128}return N}function f(g){var _=new s;_.update(g);var y=_.digest();return _.clean(),y}a.hash=f})(ip);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=Wl,i=ip,s=Vl;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(j){const D=new Float64Array(16);if(j)for(let C=0;C<j.length;C++)D[C]=j[C];return D}const h=new Uint8Array(32);h[0]=9;const f=o(),g=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),R=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function k(j,D){for(let C=0;C<16;C++)j[C]=D[C]|0}function x(j){let D=1;for(let C=0;C<16;C++){let u=j[C]+D+65535;D=Math.floor(u/65536),j[C]=u-D*65536}j[0]+=D-1+37*(D-1)}function W(j,D,C){const u=~(C-1);for(let E=0;E<16;E++){const et=u&(j[E]^D[E]);j[E]^=et,D[E]^=et}}function tt(j,D){const C=o(),u=o();for(let E=0;E<16;E++)u[E]=D[E];x(u),x(u),x(u);for(let E=0;E<2;E++){C[0]=u[0]-65517;for(let pt=1;pt<15;pt++)C[pt]=u[pt]-65535-(C[pt-1]>>16&1),C[pt-1]&=65535;C[15]=u[15]-32767-(C[14]>>16&1);const et=C[15]>>16&1;C[14]&=65535,W(u,C,1-et)}for(let E=0;E<16;E++)j[2*E]=u[E]&255,j[2*E+1]=u[E]>>8}function vt(j,D){let C=0;for(let u=0;u<32;u++)C|=j[u]^D[u];return(1&C-1>>>8)-1}function ft(j,D){const C=new Uint8Array(32),u=new Uint8Array(32);return tt(C,j),tt(u,D),vt(C,u)}function ut(j){const D=new Uint8Array(32);return tt(D,j),D[0]&1}function ht(j,D){for(let C=0;C<16;C++)j[C]=D[2*C]+(D[2*C+1]<<8);j[15]&=32767}function lt(j,D,C){for(let u=0;u<16;u++)j[u]=D[u]+C[u]}function L(j,D,C){for(let u=0;u<16;u++)j[u]=D[u]-C[u]}function H(j,D,C){let u,E,et=0,pt=0,bt=0,Tt=0,Dt=0,Ot=0,Pe=0,me=0,oe=0,zt=0,Jt=0,Xt=0,ae=0,$t=0,Zt=0,Nt=0,Vt=0,he=0,kt=0,Se=0,je=0,$e=0,He=0,ze=0,Ge=0,rr=0,kr=0,Qe=0,Br=0,li=0,Ai=0,le=C[0],re=C[1],pe=C[2],fe=C[3],ce=C[4],ie=C[5],Oe=C[6],Ae=C[7],de=C[8],Re=C[9],ge=C[10],we=C[11],ve=C[12],Qt=C[13],Ce=C[14],xe=C[15];u=D[0],et+=u*le,pt+=u*re,bt+=u*pe,Tt+=u*fe,Dt+=u*ce,Ot+=u*ie,Pe+=u*Oe,me+=u*Ae,oe+=u*de,zt+=u*Re,Jt+=u*ge,Xt+=u*we,ae+=u*ve,$t+=u*Qt,Zt+=u*Ce,Nt+=u*xe,u=D[1],pt+=u*le,bt+=u*re,Tt+=u*pe,Dt+=u*fe,Ot+=u*ce,Pe+=u*ie,me+=u*Oe,oe+=u*Ae,zt+=u*de,Jt+=u*Re,Xt+=u*ge,ae+=u*we,$t+=u*ve,Zt+=u*Qt,Nt+=u*Ce,Vt+=u*xe,u=D[2],bt+=u*le,Tt+=u*re,Dt+=u*pe,Ot+=u*fe,Pe+=u*ce,me+=u*ie,oe+=u*Oe,zt+=u*Ae,Jt+=u*de,Xt+=u*Re,ae+=u*ge,$t+=u*we,Zt+=u*ve,Nt+=u*Qt,Vt+=u*Ce,he+=u*xe,u=D[3],Tt+=u*le,Dt+=u*re,Ot+=u*pe,Pe+=u*fe,me+=u*ce,oe+=u*ie,zt+=u*Oe,Jt+=u*Ae,Xt+=u*de,ae+=u*Re,$t+=u*ge,Zt+=u*we,Nt+=u*ve,Vt+=u*Qt,he+=u*Ce,kt+=u*xe,u=D[4],Dt+=u*le,Ot+=u*re,Pe+=u*pe,me+=u*fe,oe+=u*ce,zt+=u*ie,Jt+=u*Oe,Xt+=u*Ae,ae+=u*de,$t+=u*Re,Zt+=u*ge,Nt+=u*we,Vt+=u*ve,he+=u*Qt,kt+=u*Ce,Se+=u*xe,u=D[5],Ot+=u*le,Pe+=u*re,me+=u*pe,oe+=u*fe,zt+=u*ce,Jt+=u*ie,Xt+=u*Oe,ae+=u*Ae,$t+=u*de,Zt+=u*Re,Nt+=u*ge,Vt+=u*we,he+=u*ve,kt+=u*Qt,Se+=u*Ce,je+=u*xe,u=D[6],Pe+=u*le,me+=u*re,oe+=u*pe,zt+=u*fe,Jt+=u*ce,Xt+=u*ie,ae+=u*Oe,$t+=u*Ae,Zt+=u*de,Nt+=u*Re,Vt+=u*ge,he+=u*we,kt+=u*ve,Se+=u*Qt,je+=u*Ce,$e+=u*xe,u=D[7],me+=u*le,oe+=u*re,zt+=u*pe,Jt+=u*fe,Xt+=u*ce,ae+=u*ie,$t+=u*Oe,Zt+=u*Ae,Nt+=u*de,Vt+=u*Re,he+=u*ge,kt+=u*we,Se+=u*ve,je+=u*Qt,$e+=u*Ce,He+=u*xe,u=D[8],oe+=u*le,zt+=u*re,Jt+=u*pe,Xt+=u*fe,ae+=u*ce,$t+=u*ie,Zt+=u*Oe,Nt+=u*Ae,Vt+=u*de,he+=u*Re,kt+=u*ge,Se+=u*we,je+=u*ve,$e+=u*Qt,He+=u*Ce,ze+=u*xe,u=D[9],zt+=u*le,Jt+=u*re,Xt+=u*pe,ae+=u*fe,$t+=u*ce,Zt+=u*ie,Nt+=u*Oe,Vt+=u*Ae,he+=u*de,kt+=u*Re,Se+=u*ge,je+=u*we,$e+=u*ve,He+=u*Qt,ze+=u*Ce,Ge+=u*xe,u=D[10],Jt+=u*le,Xt+=u*re,ae+=u*pe,$t+=u*fe,Zt+=u*ce,Nt+=u*ie,Vt+=u*Oe,he+=u*Ae,kt+=u*de,Se+=u*Re,je+=u*ge,$e+=u*we,He+=u*ve,ze+=u*Qt,Ge+=u*Ce,rr+=u*xe,u=D[11],Xt+=u*le,ae+=u*re,$t+=u*pe,Zt+=u*fe,Nt+=u*ce,Vt+=u*ie,he+=u*Oe,kt+=u*Ae,Se+=u*de,je+=u*Re,$e+=u*ge,He+=u*we,ze+=u*ve,Ge+=u*Qt,rr+=u*Ce,kr+=u*xe,u=D[12],ae+=u*le,$t+=u*re,Zt+=u*pe,Nt+=u*fe,Vt+=u*ce,he+=u*ie,kt+=u*Oe,Se+=u*Ae,je+=u*de,$e+=u*Re,He+=u*ge,ze+=u*we,Ge+=u*ve,rr+=u*Qt,kr+=u*Ce,Qe+=u*xe,u=D[13],$t+=u*le,Zt+=u*re,Nt+=u*pe,Vt+=u*fe,he+=u*ce,kt+=u*ie,Se+=u*Oe,je+=u*Ae,$e+=u*de,He+=u*Re,ze+=u*ge,Ge+=u*we,rr+=u*ve,kr+=u*Qt,Qe+=u*Ce,Br+=u*xe,u=D[14],Zt+=u*le,Nt+=u*re,Vt+=u*pe,he+=u*fe,kt+=u*ce,Se+=u*ie,je+=u*Oe,$e+=u*Ae,He+=u*de,ze+=u*Re,Ge+=u*ge,rr+=u*we,kr+=u*ve,Qe+=u*Qt,Br+=u*Ce,li+=u*xe,u=D[15],Nt+=u*le,Vt+=u*re,he+=u*pe,kt+=u*fe,Se+=u*ce,je+=u*ie,$e+=u*Oe,He+=u*Ae,ze+=u*de,Ge+=u*Re,rr+=u*ge,kr+=u*we,Qe+=u*ve,Br+=u*Qt,li+=u*Ce,Ai+=u*xe,et+=38*Vt,pt+=38*he,bt+=38*kt,Tt+=38*Se,Dt+=38*je,Ot+=38*$e,Pe+=38*He,me+=38*ze,oe+=38*Ge,zt+=38*rr,Jt+=38*kr,Xt+=38*Qe,ae+=38*Br,$t+=38*li,Zt+=38*Ai,E=1,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=pt+E+65535,E=Math.floor(u/65536),pt=u-E*65536,u=bt+E+65535,E=Math.floor(u/65536),bt=u-E*65536,u=Tt+E+65535,E=Math.floor(u/65536),Tt=u-E*65536,u=Dt+E+65535,E=Math.floor(u/65536),Dt=u-E*65536,u=Ot+E+65535,E=Math.floor(u/65536),Ot=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=me+E+65535,E=Math.floor(u/65536),me=u-E*65536,u=oe+E+65535,E=Math.floor(u/65536),oe=u-E*65536,u=zt+E+65535,E=Math.floor(u/65536),zt=u-E*65536,u=Jt+E+65535,E=Math.floor(u/65536),Jt=u-E*65536,u=Xt+E+65535,E=Math.floor(u/65536),Xt=u-E*65536,u=ae+E+65535,E=Math.floor(u/65536),ae=u-E*65536,u=$t+E+65535,E=Math.floor(u/65536),$t=u-E*65536,u=Zt+E+65535,E=Math.floor(u/65536),Zt=u-E*65536,u=Nt+E+65535,E=Math.floor(u/65536),Nt=u-E*65536,et+=E-1+37*(E-1),E=1,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=pt+E+65535,E=Math.floor(u/65536),pt=u-E*65536,u=bt+E+65535,E=Math.floor(u/65536),bt=u-E*65536,u=Tt+E+65535,E=Math.floor(u/65536),Tt=u-E*65536,u=Dt+E+65535,E=Math.floor(u/65536),Dt=u-E*65536,u=Ot+E+65535,E=Math.floor(u/65536),Ot=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=me+E+65535,E=Math.floor(u/65536),me=u-E*65536,u=oe+E+65535,E=Math.floor(u/65536),oe=u-E*65536,u=zt+E+65535,E=Math.floor(u/65536),zt=u-E*65536,u=Jt+E+65535,E=Math.floor(u/65536),Jt=u-E*65536,u=Xt+E+65535,E=Math.floor(u/65536),Xt=u-E*65536,u=ae+E+65535,E=Math.floor(u/65536),ae=u-E*65536,u=$t+E+65535,E=Math.floor(u/65536),$t=u-E*65536,u=Zt+E+65535,E=Math.floor(u/65536),Zt=u-E*65536,u=Nt+E+65535,E=Math.floor(u/65536),Nt=u-E*65536,et+=E-1+37*(E-1),j[0]=et,j[1]=pt,j[2]=bt,j[3]=Tt,j[4]=Dt,j[5]=Ot,j[6]=Pe,j[7]=me,j[8]=oe,j[9]=zt,j[10]=Jt,j[11]=Xt,j[12]=ae,j[13]=$t,j[14]=Zt,j[15]=Nt}function Y(j,D){H(j,D,D)}function wt(j,D){const C=o();let u;for(u=0;u<16;u++)C[u]=D[u];for(u=253;u>=0;u--)Y(C,C),u!==2&&u!==4&&H(C,C,D);for(u=0;u<16;u++)j[u]=C[u]}function it(j,D){const C=o();let u;for(u=0;u<16;u++)C[u]=D[u];for(u=250;u>=0;u--)Y(C,C),u!==1&&H(C,C,D);for(u=0;u<16;u++)j[u]=C[u]}function nt(j,D){const C=o(),u=o(),E=o(),et=o(),pt=o(),bt=o(),Tt=o(),Dt=o(),Ot=o();L(C,j[1],j[0]),L(Ot,D[1],D[0]),H(C,C,Ot),lt(u,j[0],j[1]),lt(Ot,D[0],D[1]),H(u,u,Ot),H(E,j[3],D[3]),H(E,E,y),H(et,j[2],D[2]),lt(et,et,et),L(pt,u,C),L(bt,et,E),lt(Tt,et,E),lt(Dt,u,C),H(j[0],pt,bt),H(j[1],Dt,Tt),H(j[2],Tt,bt),H(j[3],pt,Dt)}function Lt(j,D,C){for(let u=0;u<4;u++)W(j[u],D[u],C)}function qt(j,D){const C=o(),u=o(),E=o();wt(E,D[2]),H(C,D[0],E),H(u,D[1],E),tt(j,u),j[31]^=ut(C)<<7}function m(j,D,C){k(j[0],f),k(j[1],g),k(j[2],g),k(j[3],f);for(let u=255;u>=0;--u){const E=C[u/8|0]>>(u&7)&1;Lt(j,D,E),nt(D,j),nt(j,j),Lt(j,D,E)}}function P(j,D){const C=[o(),o(),o(),o()];k(C[0],I),k(C[1],R),k(C[2],g),H(C[3],I,R),m(j,C,D)}function Q(j){if(j.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const D=(0,i.hash)(j);D[0]&=248,D[31]&=127,D[31]|=64;const C=new Uint8Array(32),u=[o(),o(),o(),o()];P(u,D),qt(C,u);const E=new Uint8Array(64);return E.set(j),E.set(C,32),{publicKey:C,secretKey:E}}a.generateKeyPairFromSeed=Q;function dt(j){const D=(0,r.randomBytes)(32,j),C=Q(D);return(0,s.wipe)(D),C}a.generateKeyPair=dt;function B(j){if(j.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}a.extractPublicKeyFromSecretKey=B;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function V(j,D){let C,u,E,et;for(u=63;u>=32;--u){for(C=0,E=u-32,et=u-12;E<et;++E)D[E]+=C-16*D[u]*$[E-(u-32)],C=Math.floor((D[E]+128)/256),D[E]-=C*256;D[E]+=C,D[u]=0}for(C=0,E=0;E<32;E++)D[E]+=C-(D[31]>>4)*$[E],C=D[E]>>8,D[E]&=255;for(E=0;E<32;E++)D[E]-=C*$[E];for(u=0;u<32;u++)D[u+1]+=D[u]>>8,j[u]=D[u]&255}function F(j){const D=new Float64Array(64);for(let C=0;C<64;C++)D[C]=j[C];for(let C=0;C<64;C++)j[C]=0;V(j,D)}function Gt(j,D){const C=new Float64Array(64),u=[o(),o(),o(),o()],E=(0,i.hash)(j.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const et=new Uint8Array(64);et.set(E.subarray(32),32);const pt=new i.SHA512;pt.update(et.subarray(32)),pt.update(D);const bt=pt.digest();pt.clean(),F(bt),P(u,bt),qt(et,u),pt.reset(),pt.update(et.subarray(0,32)),pt.update(j.subarray(32)),pt.update(D);const Tt=pt.digest();F(Tt);for(let Dt=0;Dt<32;Dt++)C[Dt]=bt[Dt];for(let Dt=0;Dt<32;Dt++)for(let Ot=0;Ot<32;Ot++)C[Dt+Ot]+=Tt[Dt]*E[Ot];return V(et.subarray(32),C),et}a.sign=Gt;function Kt(j,D){const C=o(),u=o(),E=o(),et=o(),pt=o(),bt=o(),Tt=o();return k(j[2],g),ht(j[1],D),Y(E,j[1]),H(et,E,_),L(E,E,j[2]),lt(et,j[2],et),Y(pt,et),Y(bt,pt),H(Tt,bt,pt),H(C,Tt,E),H(C,C,et),it(C,C),H(C,C,E),H(C,C,et),H(C,C,et),H(j[0],C,et),Y(u,j[0]),H(u,u,et),ft(u,E)&&H(j[0],j[0],N),Y(u,j[0]),H(u,u,et),ft(u,E)?-1:(ut(j[0])===D[31]>>7&&L(j[0],f,j[0]),H(j[3],j[0],j[1]),0)}function Mr(j,D,C){const u=new Uint8Array(32),E=[o(),o(),o(),o()],et=[o(),o(),o(),o()];if(C.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Kt(et,j))return!1;const pt=new i.SHA512;pt.update(C.subarray(0,32)),pt.update(j),pt.update(D);const bt=pt.digest();return F(bt),m(E,et,bt),P(et,C.subarray(32)),nt(E,et),qt(u,E),!vt(C,u)}a.verify=Mr;function It(j){let D=[o(),o(),o(),o()];if(Kt(D,j))throw new Error("Ed25519: invalid public key");let C=o(),u=o(),E=D[1];lt(C,g,E),L(u,g,E),wt(u,u),H(C,C,u);let et=new Uint8Array(32);return tt(et,C),et}a.convertPublicKeyToX25519=It;function Ie(j){const D=(0,i.hash)(j.subarray(0,32));D[0]&=248,D[31]&=127,D[31]|=64;const C=new Uint8Array(D.subarray(0,32));return(0,s.wipe)(D),C}a.convertSecretKeyToX25519=Ie})(Pc);const tb="EdDSA",eb="JWT",np=".",sp="base64url",rb="utf8",ib="utf8",nb=":",sb="did",ob="key",Zh="base58btc",ab="z",cb="K36",ub=32;function yo(a){return _o(Ic(Hi(a),rb),sp)}function op(a){const r=Ic(cb,Zh),i=ab+_o(t_([r,a]),Zh);return[sb,ob,i].join(nb)}function hb(a){return _o(a,sp)}function lb(a){return Ic([yo(a.header),yo(a.payload)].join(np),ib)}function pb(a){return[yo(a.header),yo(a.payload),hb(a.signature)].join(np)}function tl(a=Wl.randomBytes(ub)){return Pc.generateKeyPairFromSeed(a)}async function fb(a,r,i,s,o=st.fromMiliseconds(Date.now())){const h={alg:tb,typ:eb},f=op(s.publicKey),g=o+i,_={iss:f,sub:a,aud:r,iat:o,exp:g},y=lb({header:h,payload:_}),I=Pc.sign(s.secretKey,y);return pb({header:h,payload:_,signature:I})}const db="PARSE_ERROR",gb="INVALID_REQUEST",vb="METHOD_NOT_FOUND",yb="INVALID_PARAMS",ap="INTERNAL_ERROR",Sc="SERVER_ERROR",mb=[-32700,-32600,-32601,-32602,-32603],Jn={[db]:{code:-32700,message:"Parse error"},[gb]:{code:-32600,message:"Invalid Request"},[vb]:{code:-32601,message:"Method not found"},[yb]:{code:-32602,message:"Invalid params"},[ap]:{code:-32603,message:"Internal error"},[Sc]:{code:-32e3,message:"Server error"}},cp=Sc;function wb(a){return mb.includes(a)}function el(a){return Object.keys(Jn).includes(a)?Jn[a]:Jn[cp]}function _b(a){return Object.values(Jn).find(i=>i.code===a)||Jn[cp]}function up(a,r,i){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${r}`):a}var hp={},ni={},rl;function bb(){if(rl)return ni;rl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(zr===null||zr===void 0?void 0:zr.crypto)||(zr===null||zr===void 0?void 0:zr.msCrypto)||{}}ni.getBrowerCrypto=a;function r(){const s=a();return s.subtle||s.webkitSubtle}ni.getSubtleCrypto=r;function i(){return!!a()&&!!r()}return ni.isBrowserCryptoAvailable=i,ni}var si={},il;function Eb(){if(il)return si;il=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=r;function i(){return!a()&&!r()}return si.isBrowser=i,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=_n;r.__exportStar(bb(),a),r.__exportStar(Eb(),a)})(hp);function Oc(a=3){const r=Date.now()*Math.pow(10,a),i=Math.floor(Math.random()*Math.pow(10,a));return r+i}function lp(a=6){return BigInt(Oc(a))}function mn(a,r,i){return{id:i||Oc(),jsonrpc:"2.0",method:a,params:r}}function bo(a,r){return{id:a,jsonrpc:"2.0",result:r}}function Eo(a,r,i){return{id:a,jsonrpc:"2.0",error:Ib(r,i)}}function Ib(a,r){return typeof a>"u"?el(ap):(typeof a=="string"&&(a=Object.assign(Object.assign({},el(Sc)),{message:a})),typeof r<"u"&&(a.data=r),wb(a.code)&&(a=_b(a.code)),a)}class Pb{}class Sb extends Pb{constructor(){super()}}class Ob extends Sb{constructor(r){super()}}const Ab="^https?:",Rb="^wss?:";function Cb(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function pp(a,r){const i=Cb(a);return typeof i>"u"?!1:new RegExp(r).test(i)}function nl(a){return pp(a,Ab)}function sl(a){return pp(a,Rb)}function xb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function fp(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Ac(a){return fp(a)&&"method"in a}function Io(a){return fp(a)&&(ci(a)||qr(a))}function ci(a){return"result"in a}function qr(a){return"error"in a}class ui extends Ob{constructor(r){super(r),this.events=new Ar.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async request(r,i){return this.requestStrict(mn(r.method,r.params||[],r.id||lp().toString()),i)}async requestStrict(r,i){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${r.id}`,h=>{qr(h)?o(h.error):s(h.result)});try{await this.connection.send(r,i)}catch(h){o(h)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),Io(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Tb=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Nb=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ol=a=>a.split("?")[0],al=10,Db=Tb();let jb=class{constructor(a){if(this.url=a,this.events=new Ar.EventEmitter,this.registering=!1,!sl(a))throw new Error(`Provided URL is not compatible with WebSocket connection: ${a}`);this.url=a}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(a,r){this.events.on(a,r)}once(a,r){this.events.once(a,r)}off(a,r){this.events.off(a,r)}removeListener(a,r){this.events.removeListener(a,r)}async open(a=this.url){await this.register(a)}async close(){return new Promise((a,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),a()},this.socket.close()})}async send(a){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Hi(a))}catch(r){this.onError(a.id,r)}}register(a=this.url){if(!sl(a))throw new Error(`Provided URL is not compatible with WebSocket connection: ${a}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,s)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),s(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=a,this.registering=!0,new Promise((r,i)=>{const s=new URLSearchParams(a).get("origin"),o=hp.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!xb(a)},h=new Db(a,[],o);Nb()?h.onerror=f=>{const g=f;i(this.emitError(g.error))}:h.on("error",f=>{i(this.emitError(f))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(a){a.onmessage=r=>this.onPayload(r),a.onclose=r=>this.onClose(r),this.socket=a,this.registering=!1,this.events.emit("open")}onClose(a){this.socket=void 0,this.registering=!1,this.events.emit("close",a)}onPayload(a){if(typeof a.data>"u")return;const r=typeof a.data=="string"?ts(a.data):a.data;this.events.emit("payload",r)}onError(a,r){const i=this.parseError(r),s=i.message||i.toString(),o=Eo(a,s);this.events.emit("payload",o)}parseError(a,r=this.url){return up(a,ol(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>al&&this.events.setMaxListeners(al)}emitError(a){const r=this.parseError(new Error((a==null?void 0:a.message)||`WebSocket connection failed for host: ${ol(this.url)}`));return this.events.emit("register_error",r),r}};var mo={exports:{}};mo.exports;(function(a,r){var i=200,s="__lodash_hash_undefined__",o=1,h=2,f=9007199254740991,g="[object Arguments]",_="[object Array]",y="[object AsyncFunction]",I="[object Boolean]",R="[object Date]",N="[object Error]",k="[object Function]",x="[object GeneratorFunction]",W="[object Map]",tt="[object Number]",vt="[object Null]",ft="[object Object]",ut="[object Promise]",ht="[object Proxy]",lt="[object RegExp]",L="[object Set]",H="[object String]",Y="[object Symbol]",wt="[object Undefined]",it="[object WeakMap]",nt="[object ArrayBuffer]",Lt="[object DataView]",qt="[object Float32Array]",m="[object Float64Array]",P="[object Int8Array]",Q="[object Int16Array]",dt="[object Int32Array]",B="[object Uint8Array]",$="[object Uint8ClampedArray]",V="[object Uint16Array]",F="[object Uint32Array]",Gt=/[\\^$.*+?()[\]{}|]/g,Kt=/^\[object .+?Constructor\]$/,Mr=/^(?:0|[1-9]\d*)$/,It={};It[qt]=It[m]=It[P]=It[Q]=It[dt]=It[B]=It[$]=It[V]=It[F]=!0,It[g]=It[_]=It[nt]=It[I]=It[Lt]=It[R]=It[N]=It[k]=It[W]=It[tt]=It[ft]=It[lt]=It[L]=It[H]=It[it]=!1;var Ie=typeof zr=="object"&&zr&&zr.Object===Object&&zr,j=typeof self=="object"&&self&&self.Object===Object&&self,D=Ie||j||Function("return this")(),C=r&&!r.nodeType&&r,u=C&&!0&&a&&!a.nodeType&&a,E=u&&u.exports===C,et=E&&Ie.process,pt=function(){try{return et&&et.binding&&et.binding("util")}catch{}}(),bt=pt&&pt.isTypedArray;function Tt(v,O){for(var U=-1,J=v==null?0:v.length,Bt=0,mt=[];++U<J;){var te=v[U];O(te,U,v)&&(mt[Bt++]=te)}return mt}function Dt(v,O){for(var U=-1,J=O.length,Bt=v.length;++U<J;)v[Bt+U]=O[U];return v}function Ot(v,O){for(var U=-1,J=v==null?0:v.length;++U<J;)if(O(v[U],U,v))return!0;return!1}function Pe(v,O){for(var U=-1,J=Array(v);++U<v;)J[U]=O(U);return J}function me(v){return function(O){return v(O)}}function oe(v,O){return v.has(O)}function zt(v,O){return v==null?void 0:v[O]}function Jt(v){var O=-1,U=Array(v.size);return v.forEach(function(J,Bt){U[++O]=[Bt,J]}),U}function Xt(v,O){return function(U){return v(O(U))}}function ae(v){var O=-1,U=Array(v.size);return v.forEach(function(J){U[++O]=J}),U}var $t=Array.prototype,Zt=Function.prototype,Nt=Object.prototype,Vt=D["__core-js_shared__"],he=Zt.toString,kt=Nt.hasOwnProperty,Se=function(){var v=/[^.]+$/.exec(Vt&&Vt.keys&&Vt.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),je=Nt.toString,$e=RegExp("^"+he.call(kt).replace(Gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=E?D.Buffer:void 0,ze=D.Symbol,Ge=D.Uint8Array,rr=Nt.propertyIsEnumerable,kr=$t.splice,Qe=ze?ze.toStringTag:void 0,Br=Object.getOwnPropertySymbols,li=He?He.isBuffer:void 0,Ai=Xt(Object.keys,Object),le=lr(D,"DataView"),re=lr(D,"Map"),pe=lr(D,"Promise"),fe=lr(D,"Set"),ce=lr(D,"WeakMap"),ie=lr(Object,"create"),Oe=Yr(le),Ae=Yr(re),de=Yr(pe),Re=Yr(fe),ge=Yr(ce),we=ze?ze.prototype:void 0,ve=we?we.valueOf:void 0;function Qt(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var J=v[O];this.set(J[0],J[1])}}function Ce(){this.__data__=ie?ie(null):{},this.size=0}function xe(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}function Oo(v){var O=this.__data__;if(ie){var U=O[v];return U===s?void 0:U}return kt.call(O,v)?O[v]:void 0}function Ao(v){var O=this.__data__;return ie?O[v]!==void 0:kt.call(O,v)}function Ro(v,O){var U=this.__data__;return this.size+=this.has(v)?0:1,U[v]=ie&&O===void 0?s:O,this}Qt.prototype.clear=Ce,Qt.prototype.delete=xe,Qt.prototype.get=Oo,Qt.prototype.has=Ao,Qt.prototype.set=Ro;function yr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var J=v[O];this.set(J[0],J[1])}}function Co(){this.__data__=[],this.size=0}function xo(v){var O=this.__data__,U=Ri(O,v);if(U<0)return!1;var J=O.length-1;return U==J?O.pop():kr.call(O,U,1),--this.size,!0}function To(v){var O=this.__data__,U=Ri(O,v);return U<0?void 0:O[U][1]}function No(v){return Ri(this.__data__,v)>-1}function Do(v,O){var U=this.__data__,J=Ri(U,v);return J<0?(++this.size,U.push([v,O])):U[J][1]=O,this}yr.prototype.clear=Co,yr.prototype.delete=xo,yr.prototype.get=To,yr.prototype.has=No,yr.prototype.set=Do;function Fr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var J=v[O];this.set(J[0],J[1])}}function Bi(){this.size=0,this.__data__={hash:new Qt,map:new(re||yr),string:new Qt}}function jo(v){var O=pi(this,v).delete(v);return this.size-=O?1:0,O}function Fi(v){return pi(this,v).get(v)}function Lo(v){return pi(this,v).has(v)}function qo(v,O){var U=pi(this,v),J=U.size;return U.set(v,O),this.size+=U.size==J?0:1,this}Fr.prototype.clear=Bi,Fr.prototype.delete=jo,Fr.prototype.get=Fi,Fr.prototype.has=Lo,Fr.prototype.set=qo;function Yi(v){var O=-1,U=v==null?0:v.length;for(this.__data__=new Fr;++O<U;)this.add(v[O])}function rs(v){return this.__data__.set(v,s),this}function is(v){return this.__data__.has(v)}Yi.prototype.add=Yi.prototype.push=rs,Yi.prototype.has=is;function Rr(v){var O=this.__data__=new yr(v);this.size=O.size}function zo(){this.__data__=new yr,this.size=0}function Mo(v){var O=this.__data__,U=O.delete(v);return this.size=O.size,U}function ko(v){return this.__data__.get(v)}function Uo(v){return this.__data__.has(v)}function ns(v,O){var U=this.__data__;if(U instanceof yr){var J=U.__data__;if(!re||J.length<i-1)return J.push([v,O]),this.size=++U.size,this;U=this.__data__=new Fr(J)}return U.set(v,O),this.size=U.size,this}Rr.prototype.clear=zo,Rr.prototype.delete=Mo,Rr.prototype.get=ko,Rr.prototype.has=Uo,Rr.prototype.set=ns;function ss(v,O){var U=Ji(v),J=!U&&ys(v),Bt=!U&&!J&&Pn(v),mt=!U&&!J&&!Bt&&_s(v),te=U||J||Bt||mt,Te=te?Pe(v.length,String):[],Ct=Te.length;for(var Ft in v)(O||kt.call(v,Ft))&&!(te&&(Ft=="length"||Bt&&(Ft=="offset"||Ft=="parent")||mt&&(Ft=="buffer"||Ft=="byteLength"||Ft=="byteOffset")||ps(Ft,Ct)))&&Te.push(Ft);return Te}function Ri(v,O){for(var U=v.length;U--;)if(vs(v[U][0],O))return U;return-1}function En(v,O,U){var J=O(v);return Ji(v)?J:Dt(J,U(v))}function Ci(v){return v==null?v===void 0?wt:vt:Qe&&Qe in Object(v)?hs(v):Ko(v)}function In(v){return Ti(v)&&Ci(v)==g}function xi(v,O,U,J,Bt){return v===O?!0:v==null||O==null||!Ti(v)&&!Ti(O)?v!==v&&O!==O:os(v,O,U,J,xi,Bt)}function os(v,O,U,J,Bt,mt){var te=Ji(v),Te=Ji(O),Ct=te?_:Ur(v),Ft=Te?_:Ur(O);Ct=Ct==g?ft:Ct,Ft=Ft==g?ft:Ft;var _e=Ct==ft,ir=Ft==ft,Ne=Ct==Ft;if(Ne&&Pn(v)){if(!Pn(O))return!1;te=!0,_e=!1}if(Ne&&!_e)return mt||(mt=new Rr),te||_s(v)?Gi(v,O,U,J,Bt,mt):Ho(v,O,Ct,U,J,Bt,mt);if(!(U&o)){var ee=_e&&kt.call(v,"__wrapped__"),Je=ir&&kt.call(O,"__wrapped__");if(ee||Je){var Cr=ee?v.value():v,mr=Je?O.value():O;return mt||(mt=new Rr),Bt(Cr,mr,U,J,mt)}}return Ne?(mt||(mt=new Rr),us(v,O,U,J,Bt,mt)):!1}function $o(v){if(!ws(v)||ds(v))return!1;var O=Xi(v)?$e:Kt;return O.test(Yr(v))}function as(v){return Ti(v)&&ms(v.length)&&!!It[Ci(v)]}function cs(v){if(!gs(v))return Ai(v);var O=[];for(var U in Object(v))kt.call(v,U)&&U!="constructor"&&O.push(U);return O}function Gi(v,O,U,J,Bt,mt){var te=U&o,Te=v.length,Ct=O.length;if(Te!=Ct&&!(te&&Ct>Te))return!1;var Ft=mt.get(v);if(Ft&&mt.get(O))return Ft==O;var _e=-1,ir=!0,Ne=U&h?new Yi:void 0;for(mt.set(v,O),mt.set(O,v);++_e<Te;){var ee=v[_e],Je=O[_e];if(J)var Cr=te?J(Je,ee,_e,O,v,mt):J(ee,Je,_e,v,O,mt);if(Cr!==void 0){if(Cr)continue;ir=!1;break}if(Ne){if(!Ot(O,function(mr,$r){if(!oe(Ne,$r)&&(ee===mr||Bt(ee,mr,U,J,mt)))return Ne.push($r)})){ir=!1;break}}else if(!(ee===Je||Bt(ee,Je,U,J,mt))){ir=!1;break}}return mt.delete(v),mt.delete(O),ir}function Ho(v,O,U,J,Bt,mt,te){switch(U){case Lt:if(v.byteLength!=O.byteLength||v.byteOffset!=O.byteOffset)return!1;v=v.buffer,O=O.buffer;case nt:return!(v.byteLength!=O.byteLength||!mt(new Ge(v),new Ge(O)));case I:case R:case tt:return vs(+v,+O);case N:return v.name==O.name&&v.message==O.message;case lt:case H:return v==O+"";case W:var Te=Jt;case L:var Ct=J&o;if(Te||(Te=ae),v.size!=O.size&&!Ct)return!1;var Ft=te.get(v);if(Ft)return Ft==O;J|=h,te.set(v,O);var _e=Gi(Te(v),Te(O),J,Bt,mt,te);return te.delete(v),_e;case Y:if(ve)return ve.call(v)==ve.call(O)}return!1}function us(v,O,U,J,Bt,mt){var te=U&o,Te=Qi(v),Ct=Te.length,Ft=Qi(O),_e=Ft.length;if(Ct!=_e&&!te)return!1;for(var ir=Ct;ir--;){var Ne=Te[ir];if(!(te?Ne in O:kt.call(O,Ne)))return!1}var ee=mt.get(v);if(ee&&mt.get(O))return ee==O;var Je=!0;mt.set(v,O),mt.set(O,v);for(var Cr=te;++ir<Ct;){Ne=Te[ir];var mr=v[Ne],$r=O[Ne];if(J)var Sn=te?J($r,mr,Ne,O,v,mt):J(mr,$r,Ne,v,O,mt);if(!(Sn===void 0?mr===$r||Bt(mr,$r,U,J,mt):Sn)){Je=!1;break}Cr||(Cr=Ne=="constructor")}if(Je&&!Cr){var Ni=v.constructor,Me=O.constructor;Ni!=Me&&"constructor"in v&&"constructor"in O&&!(typeof Ni=="function"&&Ni instanceof Ni&&typeof Me=="function"&&Me instanceof Me)&&(Je=!1)}return mt.delete(v),mt.delete(O),Je}function Qi(v){return En(v,Bo,ls)}function pi(v,O){var U=v.__data__;return fs(O)?U[typeof O=="string"?"string":"hash"]:U.map}function lr(v,O){var U=zt(v,O);return $o(U)?U:void 0}function hs(v){var O=kt.call(v,Qe),U=v[Qe];try{v[Qe]=void 0;var J=!0}catch{}var Bt=je.call(v);return J&&(O?v[Qe]=U:delete v[Qe]),Bt}var ls=Br?function(v){return v==null?[]:(v=Object(v),Tt(Br(v),function(O){return rr.call(v,O)}))}:Wt,Ur=Ci;(le&&Ur(new le(new ArrayBuffer(1)))!=Lt||re&&Ur(new re)!=W||pe&&Ur(pe.resolve())!=ut||fe&&Ur(new fe)!=L||ce&&Ur(new ce)!=it)&&(Ur=function(v){var O=Ci(v),U=O==ft?v.constructor:void 0,J=U?Yr(U):"";if(J)switch(J){case Oe:return Lt;case Ae:return W;case de:return ut;case Re:return L;case ge:return it}return O});function ps(v,O){return O=O??f,!!O&&(typeof v=="number"||Mr.test(v))&&v>-1&&v%1==0&&v<O}function fs(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}function ds(v){return!!Se&&Se in v}function gs(v){var O=v&&v.constructor,U=typeof O=="function"&&O.prototype||Nt;return v===U}function Ko(v){return je.call(v)}function Yr(v){if(v!=null){try{return he.call(v)}catch{}try{return v+""}catch{}}return""}function vs(v,O){return v===O||v!==v&&O!==O}var ys=In(function(){return arguments}())?In:function(v){return Ti(v)&&kt.call(v,"callee")&&!rr.call(v,"callee")},Ji=Array.isArray;function Vo(v){return v!=null&&ms(v.length)&&!Xi(v)}var Pn=li||Ht;function Wo(v,O){return xi(v,O)}function Xi(v){if(!ws(v))return!1;var O=Ci(v);return O==k||O==x||O==y||O==ht}function ms(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function ws(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}function Ti(v){return v!=null&&typeof v=="object"}var _s=bt?me(bt):as;function Bo(v){return Vo(v)?ss(v):cs(v)}function Wt(){return[]}function Ht(){return!1}a.exports=Wo})(mo,mo.exports);var Lb=mo.exports;const qb=Ec(Lb);function zb(a,r){return r=r||{},new Promise(function(i,s){var o=new XMLHttpRequest,h=[],f=[],g={},_=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:_,headers:{keys:function(){return h},entries:function(){return f},get:function(I){return g[I.toLowerCase()]},has:function(I){return I.toLowerCase()in g}}}};for(var y in o.open(r.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(I,R,N){h.push(R=R.toLowerCase()),f.push([R,N]),g[R]=g[R]?g[R]+","+N:N}),i(_())},o.onerror=s,o.withCredentials=r.credentials=="include",r.headers)o.setRequestHeader(y,r.headers[y]);o.send(r.body||null)})}const Mb=Object.freeze(Object.defineProperty({__proto__:null,default:zb},Symbol.toStringTag,{value:"Module"})),cl=Kl(Mb);var kb=self.fetch||(self.fetch=cl.default||cl);const Ub=Ec(kb);function $b(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),s=0;s<i.length;s++)i[s]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),f=h.charCodeAt(0);if(i[f]!==255)throw new TypeError(h+" is ambiguous");i[f]=o}var g=a.length,_=a.charAt(0),y=Math.log(g)/Math.log(256),I=Math.log(256)/Math.log(g);function R(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var W=0,tt=0,vt=0,ft=x.length;vt!==ft&&x[vt]===0;)vt++,W++;for(var ut=(ft-vt)*I+1>>>0,ht=new Uint8Array(ut);vt!==ft;){for(var lt=x[vt],L=0,H=ut-1;(lt!==0||L<tt)&&H!==-1;H--,L++)lt+=256*ht[H]>>>0,ht[H]=lt%g>>>0,lt=lt/g>>>0;if(lt!==0)throw new Error("Non-zero carry");tt=L,vt++}for(var Y=ut-tt;Y!==ut&&ht[Y]===0;)Y++;for(var wt=_.repeat(W);Y<ut;++Y)wt+=a.charAt(ht[Y]);return wt}function N(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var W=0;if(x[W]!==" "){for(var tt=0,vt=0;x[W]===_;)tt++,W++;for(var ft=(x.length-W)*y+1>>>0,ut=new Uint8Array(ft);x[W];){var ht=i[x.charCodeAt(W)];if(ht===255)return;for(var lt=0,L=ft-1;(ht!==0||lt<vt)&&L!==-1;L--,lt++)ht+=g*ut[L]>>>0,ut[L]=ht%256>>>0,ht=ht/256>>>0;if(ht!==0)throw new Error("Non-zero carry");vt=lt,W++}if(x[W]!==" "){for(var H=ft-vt;H!==ft&&ut[H]===0;)H++;for(var Y=new Uint8Array(tt+(ft-H)),wt=tt;H!==ft;)Y[wt++]=ut[H++];return Y}}}function k(x){var W=N(x);if(W)return W;throw new Error(`Non-${r} character`)}return{encode:R,decodeUnsafe:N,decode:k}}var Hb=$b,Kb=Hb;const dp=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},Vb=a=>new TextEncoder().encode(a),Wb=a=>new TextDecoder().decode(a);class Bb{constructor(r,i,s){this.name=r,this.prefix=i,this.baseEncode=s}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class Fb{constructor(r,i,s){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=s}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return gp(this,r)}}class Yb{constructor(r){this.decoders=r}or(r){return gp(this,r)}decode(r){const i=r[0],s=this.decoders[i];if(s)return s.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const gp=(a,r)=>new Yb({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class Gb{constructor(r,i,s,o){this.name=r,this.prefix=i,this.baseEncode=s,this.baseDecode=o,this.encoder=new Bb(r,i,s),this.decoder=new Fb(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const Po=({name:a,prefix:r,encode:i,decode:s})=>new Gb(a,r,i,s),es=({prefix:a,name:r,alphabet:i})=>{const{encode:s,decode:o}=Kb(i,r);return Po({prefix:a,name:r,encode:s,decode:h=>dp(o(h))})},Qb=(a,r,i,s)=>{const o={};for(let I=0;I<r.length;++I)o[r[I]]=I;let h=a.length;for(;a[h-1]==="=";)--h;const f=new Uint8Array(h*i/8|0);let g=0,_=0,y=0;for(let I=0;I<h;++I){const R=o[a[I]];if(R===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<i|R,g+=i,g>=8&&(g-=8,f[y++]=255&_>>g)}if(g>=i||255&_<<8-g)throw new SyntaxError("Unexpected end of data");return f},Jb=(a,r,i)=>{const s=r[r.length-1]==="=",o=(1<<i)-1;let h="",f=0,g=0;for(let _=0;_<a.length;++_)for(g=g<<8|a[_],f+=8;f>i;)f-=i,h+=r[o&g>>f];if(f&&(h+=r[o&g<<i-f]),s)for(;h.length*i&7;)h+="=";return h},Ve=({name:a,prefix:r,bitsPerChar:i,alphabet:s})=>Po({prefix:r,name:a,encode(o){return Jb(o,s,i)},decode(o){return Qb(o,s,i,a)}}),Xb=Po({prefix:"\0",name:"identity",encode:a=>Wb(a),decode:a=>Vb(a)});var Zb=Object.freeze({__proto__:null,identity:Xb});const t0=Ve({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var e0=Object.freeze({__proto__:null,base2:t0});const r0=Ve({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var i0=Object.freeze({__proto__:null,base8:r0});const n0=es({prefix:"9",name:"base10",alphabet:"0123456789"});var s0=Object.freeze({__proto__:null,base10:n0});const o0=Ve({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),a0=Ve({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var c0=Object.freeze({__proto__:null,base16:o0,base16upper:a0});const u0=Ve({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),h0=Ve({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),l0=Ve({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),p0=Ve({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),f0=Ve({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),d0=Ve({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),g0=Ve({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),v0=Ve({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),y0=Ve({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var m0=Object.freeze({__proto__:null,base32:u0,base32upper:h0,base32pad:l0,base32padupper:p0,base32hex:f0,base32hexupper:d0,base32hexpad:g0,base32hexpadupper:v0,base32z:y0});const w0=es({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),_0=es({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var b0=Object.freeze({__proto__:null,base36:w0,base36upper:_0});const E0=es({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),I0=es({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var P0=Object.freeze({__proto__:null,base58btc:E0,base58flickr:I0});const S0=Ve({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),O0=Ve({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),A0=Ve({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),R0=Ve({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var C0=Object.freeze({__proto__:null,base64:S0,base64pad:O0,base64url:A0,base64urlpad:R0});const vp=Array.from(""),x0=vp.reduce((a,r,i)=>(a[i]=r,a),[]),T0=vp.reduce((a,r,i)=>(a[r.codePointAt(0)]=i,a),[]);function N0(a){return a.reduce((r,i)=>(r+=x0[i],r),"")}function D0(a){const r=[];for(const i of a){const s=T0[i.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(s)}return new Uint8Array(r)}const j0=Po({prefix:"",name:"base256emoji",encode:N0,decode:D0});var L0=Object.freeze({__proto__:null,base256emoji:j0}),q0=yp,ul=128,z0=127,M0=~z0,k0=Math.pow(2,31);function yp(a,r,i){r=r||[],i=i||0;for(var s=i;a>=k0;)r[i++]=a&255|ul,a/=128;for(;a&M0;)r[i++]=a&255|ul,a>>>=7;return r[i]=a|0,yp.bytes=i-s+1,r}var U0=dc,$0=128,hl=127;function dc(a,s){var i=0,s=s||0,o=0,h=s,f,g=a.length;do{if(h>=g)throw dc.bytes=0,new RangeError("Could not decode varint");f=a[h++],i+=o<28?(f&hl)<<o:(f&hl)*Math.pow(2,o),o+=7}while(f>=$0);return dc.bytes=h-s,i}var H0=Math.pow(2,7),K0=Math.pow(2,14),V0=Math.pow(2,21),W0=Math.pow(2,28),B0=Math.pow(2,35),F0=Math.pow(2,42),Y0=Math.pow(2,49),G0=Math.pow(2,56),Q0=Math.pow(2,63),J0=function(a){return a<H0?1:a<K0?2:a<V0?3:a<W0?4:a<B0?5:a<F0?6:a<Y0?7:a<G0?8:a<Q0?9:10},X0={encode:q0,decode:U0,encodingLength:J0},mp=X0;const ll=(a,r,i=0)=>(mp.encode(a,r,i),r),pl=a=>mp.encodingLength(a),gc=(a,r)=>{const i=r.byteLength,s=pl(a),o=s+pl(i),h=new Uint8Array(o+i);return ll(a,h,0),ll(i,h,s),h.set(r,o),new Z0(a,i,r,h)};class Z0{constructor(r,i,s,o){this.code=r,this.size=i,this.digest=s,this.bytes=o}}const wp=({name:a,code:r,encode:i})=>new t1(a,r,i);class t1{constructor(r,i,s){this.name=r,this.code=i,this.encode=s}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?gc(this.code,i):i.then(s=>gc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const _p=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),e1=wp({name:"sha2-256",code:18,encode:_p("SHA-256")}),r1=wp({name:"sha2-512",code:19,encode:_p("SHA-512")});var i1=Object.freeze({__proto__:null,sha256:e1,sha512:r1});const bp=0,n1="identity",Ep=dp,s1=a=>gc(bp,Ep(a)),o1={code:bp,name:n1,encode:Ep,digest:s1};var a1=Object.freeze({__proto__:null,identity:o1});new TextEncoder,new TextDecoder;const fl={...Zb,...e0,...i0,...s0,...c0,...m0,...b0,...P0,...C0,...L0};({...i1,...a1});function Ip(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function c1(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ip(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Pp(a,r,i,s){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:i},decoder:{decode:s}}}const dl=Pp("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),rc=Pp("ascii","a",a=>{let r="a";for(let i=0;i<a.length;i++)r+=String.fromCharCode(a[i]);return r},a=>{a=a.substring(1);const r=c1(a.length);for(let i=0;i<a.length;i++)r[i]=a.charCodeAt(i);return r}),u1={utf8:dl,"utf-8":dl,hex:fl.base16,latin1:rc,ascii:rc,binary:rc,...fl};function h1(a,r="utf8"){const i=u1[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ip(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const Sp="wc",l1=2,Rc="core",Pi=`${Sp}@2:${Rc}:`,p1={name:Rc,logger:"error"},f1={database:":memory:"},d1="crypto",gl="client_ed25519_seed",g1=st.ONE_DAY,v1="keychain",y1="0.3",m1="messages",w1="0.3",_1=st.SIX_HOURS,b1="publisher",Op="irn",E1="error",Ap="wss://relay.walletconnect.com",vl="wss://relay.walletconnect.org",I1="relayer",Ye={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},P1="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},S1=st.ONE_SECOND,O1="2.11.0",A1=1e4,R1="0.3",C1="WALLETCONNECT_CLIENT_ID",jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},x1="subscription",T1="0.3",N1=st.FIVE_SECONDS*1e3,D1="pairing",j1="0.3",Kn={wc_pairingDelete:{req:{ttl:st.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:st.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:st.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:st.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:st.ONE_DAY,prompt:!1,tag:0},res:{ttl:st.ONE_DAY,prompt:!1,tag:0}}},Gn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Wr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},L1="history",q1="0.3",z1="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},M1="0.3",ic="verify-api",vn="https://verify.walletconnect.com",vc="https://verify.walletconnect.org",k1=[vn,vc],U1="echo",$1="https://echo.walletconnect.com";class H1{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=v1,this.version=y1,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:h}=X("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=r,this.logger=Rt.generateChildLogger(i,this.name)}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,Ql(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Jl(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class K1{constructor(r,i,s){this.core=r,this.logger=i,this.name=d1,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=tl(o);return op(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=qw();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),f=tl(h),g=lc();return await fb(g,o,g1,f)},this.generateSharedKey=(o,h,f)=>{this.isInitialized();const g=this.getPrivateKey(o),_=zw(g,h);return this.setSymKey(_,f)},this.setSymKey=async(o,h)=>{this.isInitialized();const f=h||Mw(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,f)=>{this.isInitialized();const g=kw(f),_=Hi(h);if(jh(g)){const N=g.senderPublicKey,k=g.receiverPublicKey;o=await this.generateSharedKey(N,k)}const y=this.getSymKey(o),{type:I,senderPublicKey:R}=g;return Uw({type:I,symKey:y,message:_,senderPublicKey:R})},this.decode=async(o,h,f)=>{this.isInitialized();const g=$w(h,f);if(jh(g)){const _=g.receiverPublicKey,y=g.senderPublicKey;o=await this.generateSharedKey(_,y)}try{const _=this.getSymKey(o),y=Hw({symKey:_,encoded:h});return ts(y)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const h=Lh(o);return Kw(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Lh(o);return h.senderPublicKey?_o(h.senderPublicKey,Vw):void 0},this.core=r,this.logger=Rt.generateChildLogger(i,this.name),this.keychain=s||new H1(this.core,this.logger)}get context(){return Rt.getLoggerContext(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(gl)}catch{r=lc(),await this.keychain.set(gl,r)}return h1(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class V1 extends V_{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=m1,this.version=w1,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const h=yn(o);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[h]<"u"||(f[h]=o,this.messages.set(s,f),await this.persist()),h},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const h=this.get(s),f=yn(o);return typeof h[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Rt.generateChildLogger(r,this.name),this.core=i}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,Ql(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Jl(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class W1 extends W_{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new Ar.EventEmitter,this.name=b1,this.queue=new Map,this.publishTimeout=st.toMiliseconds(st.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,h)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}});try{const g=(h==null?void 0:h.ttl)||_1,_=pc(h),y=(h==null?void 0:h.prompt)||!1,I=(h==null?void 0:h.tag)||0,R=(h==null?void 0:h.id)||lp().toString(),N={topic:s,message:o,opts:{ttl:g,relay:_,prompt:y,tag:I,id:R}},k=setTimeout(()=>this.queue.set(R,N),this.publishTimeout);try{await await Xn(this.rpcPublish(s,o,g,_,y,I,R),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(R),this.relayer.events.emit(Ye.publish,N)}catch(x){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=h==null?void 0:h.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(R),x;return}finally{clearTimeout(k)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=r,this.logger=Rt.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Rt.getLoggerContext(this.logger)}rpcPublish(r,i,s,o,h,f,g){var _,y,I,R;const N={method:fo(o.protocol).publish,params:{topic:r,message:i,ttl:s,prompt:h,tag:f},id:g};return Ii((_=N.params)==null?void 0:_.prompt)&&((y=N.params)==null||delete y.prompt),Ii((I=N.params)==null?void 0:I.tag)&&((R=N.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:N}),this.relayer.request(N)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:s,opts:o}=r;await this.publish(i,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(bn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ye.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ye.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class B1{constructor(){this.map=new Map,this.set=(r,i)=>{const s=this.get(r);this.exists(r,i)||this.map.set(r,[...s,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const s=this.get(r);if(!this.exists(r,i))return;const o=s.filter(h=>h!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var F1=Object.defineProperty,Y1=Object.defineProperties,G1=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,Q1=Object.prototype.hasOwnProperty,J1=Object.prototype.propertyIsEnumerable,ml=(a,r,i)=>r in a?F1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Vn=(a,r)=>{for(var i in r||(r={}))Q1.call(r,i)&&ml(a,i,r[i]);if(yl)for(var i of yl(r))J1.call(r,i)&&ml(a,i,r[i]);return a},nc=(a,r)=>Y1(a,G1(r));class X1 extends Y_{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new B1,this.events=new Ar.EventEmitter,this.name=x1,this.version=T1,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const h=pc(o),f={topic:s,relay:h};this.pending.set(s,f);const g=await this.rpcSubscribe(s,h);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,h)=>{const f=new st.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=N1&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Rt.generateChildLogger(i,this.name),this.clientId=""}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let s=!1;try{s=this.getSubscription(r).topic===i}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const s=this.topicMap.get(r);await Promise.all(s.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:s}});try{const o=pc(s);await this.rpcUnsubscribe(r,i,o);const h=Fe("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const s={method:fo(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Xn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ye.connection_stalled)}return yn(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,s={method:fo(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Xn(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ye.connection_stalled)}}rpcUnsubscribe(r,i,s){const o={method:fo(s.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,nc(Vn({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,Vn({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,s){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,s),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,Vn({},i)),this.topicMap.set(i.topic,r),this.events.emit(jr.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const s=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(s.topic,r),this.events.emit(jr.deleted,nc(Vn({},s),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(jr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(jr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);wn(i)&&this.onBatchSubscribe(i.map((s,o)=>nc(Vn({},r[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(bn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ye.connect,async()=>{await this.onConnect()}),this.relayer.on(Ye.disconnect,()=>{this.onDisconnect()}),this.events.on(jr.created,async r=>{const i=jr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(jr.deleted,async r=>{const i=jr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var Z1=Object.defineProperty,wl=Object.getOwnPropertySymbols,tE=Object.prototype.hasOwnProperty,eE=Object.prototype.propertyIsEnumerable,_l=(a,r,i)=>r in a?Z1(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,rE=(a,r)=>{for(var i in r||(r={}))tE.call(r,i)&&_l(a,i,r[i]);if(wl)for(var i of wl(r))eE.call(r,i)&&_l(a,i,r[i]);return a};class iE extends B_{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Ar.EventEmitter,this.name=I1,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(Ye.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(Ye.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Rt.generateChildLogger(r.logger,this.name):Rt.pino(Rt.getDefaultLoggerOptions({level:r.logger||E1})),this.messages=new V1(this.logger,r.core),this.subscriber=new X1(this,this.logger),this.publisher=new W1(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Ap,this.projectId=r.projectId,this.bundleId=Ww(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${vl}...`),await this.restartTransport(vl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},A1)}get context(){return Rt.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,s){this.isInitialized(),await this.publisher.publish(r,i,s),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(r))==null?void 0:s[0])||"";if(o)return o;let h;const f=g=>{g.topic===r&&(this.subscriber.off(jr.created,f),h())};return await Promise.all([new Promise(g=>{h=g,this.subscriber.on(jr.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(r,i),g()})]),o}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Xn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once(jr.resubscribed,()=>{i()})}),new Promise(async(i,s)=>{try{await Xn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}i()})])}catch(i){this.logger.error(i);const s=i;if(!this.isConnectionStalled(s.message))throw i;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await qh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ui(new jb(Bw({sdkVersion:O1,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:s}=r;await this.messages.set(i,s)}async shouldIgnoreMessageEvent(r){const{topic:i,message:s}=r;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const o=this.messages.has(i,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Ac(r)){if(!r.method.endsWith(P1))return;const i=r.params,{topic:s,message:o,publishedAt:h}=i.data,f={topic:s,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(rE({type:"event",event:i.id},f)),this.events.emit(i.id,f),await this.acknowledgePayload(r),await this.onMessageEvent(f)}else Io(r)&&this.events.emit(Ye.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Ye.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=bo(r.id,!0);await this.provider.connection.send(i)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Ye.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let r=await qh();Fw(async i=>{this.initialized&&r!==i&&(r=i,i?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Ye.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},st.toMiliseconds(S1)))}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var nE=Object.defineProperty,bl=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,oE=Object.prototype.propertyIsEnumerable,El=(a,r,i)=>r in a?nE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Il=(a,r)=>{for(var i in r||(r={}))sE.call(r,i)&&El(a,i,r[i]);if(bl)for(var i of bl(r))oE.call(r,i)&&El(a,i,r[i]);return a};class So extends F_{constructor(r,i,s,o=Pi,h=void 0){super(r,i,s,o),this.core=r,this.logger=i,this.name=s,this.map=new Map,this.version=R1,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!Ii(f)?this.map.set(this.getKey(f),f):jw(f)?this.map.set(f.id,f):Lw(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(_=>qb(g[_],f[_]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const _=Il(Il({},this.getData(f)),g);this.map.set(f,_),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Rt.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(s),new Error(s)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class aE{constructor(r,i){this.core=r,this.logger=i,this.name=D1,this.version=j1,this.events=new bc,this.initialized=!1,this.storagePrefix=Pi,this.ignoredPayloadTypes=[Fl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=lc(),o=await this.core.crypto.setSymKey(s),h=Lr(st.FIVE_MINUTES),f={protocol:Op},g={topic:o,expiry:h,relay:f,active:!1},_=Yw({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:h,relay:f}=zh(s.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const _=Lr(st.FIVE_MINUTES),y={topic:o,relay:f,expiry:_,active:!1};return await this.pairings.set(o,y),this.core.expirer.set(o,_),s.activatePairing&&await this.activate({topic:o}),this.events.emit(Gn.create,y),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const o=Lr(st.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:_}=dn();this.events.once(De("pairing_ping",h),({error:y})=>{y?_(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Fe("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,h)=>{const f=mn(o,h),g=await this.core.crypto.encode(s,f),_=Kn[o].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,_),f.id},this.sendResult=async(s,o,h)=>{const f=bo(s,h),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),y=Kn[_.request.method].res;await this.core.relayer.publish(o,g,y),await this.core.history.resolve(f)},this.sendError=async(s,o,h)=>{const f=Eo(s,h),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,s),y=Kn[_.request.method]?Kn[_.request.method].res:Kn.unregistered_method.res;await this.core.relayer.publish(o,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Fe("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ei(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:h}=s,f=(await this.core.history.get(o,h.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,o)=>{const{id:h}=o;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(Gn.ping,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,o)=>{const{id:h}=o;setTimeout(()=>{ci(o)?this.events.emit(De("pairing_ping",h),{}):qr(o)&&this.events.emit(De("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(Gn.delete,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:h,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=Fe("WC_METHOD_UNSUPPORTED",f);await this.sendError(h,s,g),this.logger.error(g)}catch(g){await this.sendError(h,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Fe("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!hr(s)){const{message:f}=X("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!Gw(s.uri)){const{message:f}=X("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const h=zh(s.uri);if(!((o=h==null?void 0:h.relay)!=null&&o.protocol)){const{message:f}=X("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(h!=null&&h.symKey)){const{message:f}=X("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!hr(s)){const{message:h}=X("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!hr(s)){const{message:h}=X("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!gn(s,!1)){const{message:o}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ei(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=X("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=r,this.logger=Rt.generateChildLogger(i,this.name),this.pairings=new So(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Rt.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Ye.message,async r=>{const{topic:i,message:s}=r;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(i,s);try{Ac(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):Io(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async r=>{const{topic:i}=Gl(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit(Gn.expire,{topic:i}))})}}class cE extends K_{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new Ar.EventEmitter,this.name=L1,this.version=q1,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:h}),this.records.has(o.id))return;const f={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:h,expiry:Lr(st.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Wr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=qr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Wr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===s){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Wr.deleted,h)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Rt.generateChildLogger(i,this.name)}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const s={topic:i.topic,request:mn(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(s)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(s)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Wr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Wr.created,r=>{const i=Wr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Wr.updated,r=>{const i=Wr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Wr.deleted,r=>{const i=Wr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(bn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{st.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class uE extends G_{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new Ar.EventEmitter,this.name=z1,this.version=M1,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const h=this.formatTarget(s),f={target:h,expiry:o};this.expirations.set(h,f),this.checkExpiry(h,f),this.events.emit(Or.created,{target:h,expiration:f})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Or.deleted,{target:o,expiration:h})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Rt.generateChildLogger(i,this.name)}get context(){return Rt.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return Qw(r);if(typeof r=="number")return Jw(r);const{message:i}=X("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(s),new Error(s)}return i}checkExpiry(r,i){const{expiry:s}=i;st.toMiliseconds(s)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(Or.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(bn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Or.created,r=>{const i=Or.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Or.expired,r=>{const i=Or.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Or.deleted,r=>{const i=Or.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}}}class hE extends Q_{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=ic,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Xw()||!Yl())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=vc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(f),h=await this.fetchAttestation(s.attestationId,vc)}return h},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const h=this.startAbortTimer(st.ONE_SECOND*2),f=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(h=>{if(document.getElementById(ic))return h();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=ic,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=h}),new Promise((h,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},st.toMiliseconds(st.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||vn;return k1.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${vn}`),o=vn),o},this.logger=Rt.generateChildLogger(i,this.name),this.verifyUrl=vn,this.abortController=new AbortController,this.isDevEnv=Zw()&&e_.IS_VITEST}get context(){return Rt.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),st.toMiliseconds(r))}}class lE extends J_{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.context=U1,this.registerDeviceToken=async s=>{const{clientId:o,token:h,notificationType:f,enableEncrypted:g=!1}=s,_=`${$1}/${this.projectId}/clients`;await Ub(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:f,token:h,always_raw:g})})},this.logger=Rt.generateChildLogger(i,this.context)}}var pE=Object.defineProperty,Pl=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,dE=Object.prototype.propertyIsEnumerable,Sl=(a,r,i)=>r in a?pE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Ol=(a,r)=>{for(var i in r||(r={}))fE.call(r,i)&&Sl(a,i,r[i]);if(Pl)for(var i of Pl(r))dE.call(r,i)&&Sl(a,i,r[i]);return a};class Cc extends H_{constructor(r){super(r),this.protocol=Sp,this.version=l1,this.name=Rc,this.events=new Ar.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Ap,this.customStoragePrefix=r!=null&&r.customStoragePrefix?`:${r.customStoragePrefix}`:"";const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Rt.pino(Rt.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||p1.logger}));this.logger=Rt.generateChildLogger(i,this.name),this.heartbeat=new bn.HeartBeat,this.crypto=new K1(this,this.logger,r==null?void 0:r.keychain),this.history=new cE(this,this.logger),this.expirer=new uE(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new D_(Ol(Ol({},f1),r==null?void 0:r.storageOptions)),this.relayer=new iE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new aE(this,this.logger),this.verify=new hE(this.projectId||"",this.logger),this.echoClient=new lE(this.projectId||"",this.logger)}static async init(r){const i=new Cc(r);await i.initialize();const s=await i.crypto.getClientId();return await i.storage.setItem(C1,s),i}get context(){return Rt.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const gE=Cc,Rp="wc",Cp=2,xp="client",xc=`${Rp}@${Cp}:${xp}:`,sc={name:xp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Al="WALLETCONNECT_DEEPLINK_CHOICE",vE="proposal",Tp="Proposal expired",yE="session",uo=st.SEVEN_DAYS,mE="engine",Wn={wc_sessionPropose:{req:{ttl:st.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:st.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:st.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:st.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:st.ONE_DAY,prompt:!1,tag:1104},res:{ttl:st.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:st.ONE_DAY,prompt:!1,tag:1106},res:{ttl:st.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:st.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:st.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:st.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:st.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:st.ONE_DAY,prompt:!1,tag:1112},res:{ttl:st.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:st.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:st.THIRTY_SECONDS,prompt:!1,tag:1115}}},oc={min:st.FIVE_MINUTES,max:st.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},wE="request",_E=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var bE=Object.defineProperty,EE=Object.defineProperties,IE=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,PE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable,Cl=(a,r,i)=>r in a?bE(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,cr=(a,r)=>{for(var i in r||(r={}))PE.call(r,i)&&Cl(a,i,r[i]);if(Rl)for(var i of Rl(r))SE.call(r,i)&&Cl(a,i,r[i]);return a},Bn=(a,r)=>EE(a,IE(r));class OE extends Z_{constructor(r){super(r),this.name=mE,this.events=new bc,this.initialized=!1,this.ignoredPayloadTypes=[Fl],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=st.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Wn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},st.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const s=Bn(cr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:f,sessionProperties:g,relays:_}=s;let y=o,I,R=!1;if(y&&(R=this.client.core.pairing.pairings.get(y).active),!y||!R){const{topic:ut,uri:ht}=await this.client.core.pairing.create();y=ut,I=ht}const N=await this.client.core.crypto.generateKeyPair(),k=cr({requiredNamespaces:h,optionalNamespaces:f,relays:_??[{protocol:Op}],proposer:{publicKey:N,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:x,resolve:W,done:tt}=dn(st.FIVE_MINUTES,Tp);if(this.events.once(De("session_connect"),async({error:ut,session:ht})=>{if(ut)x(ut);else if(ht){ht.self.publicKey=N;const lt=Bn(cr({},ht),{requiredNamespaces:ht.requiredNamespaces,optionalNamespaces:ht.optionalNamespaces});await this.client.session.set(ht.topic,lt),await this.setExpiry(ht.topic,ht.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:ht.peer.metadata}),W(lt)}}),!y){const{message:ut}=X("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(ut)}const vt=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:k}),ft=Lr(st.FIVE_MINUTES);return await this.setProposal(vt,cr({id:vt,expiry:ft},k)),{uri:I,approval:tt}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:s,relayProtocol:o,namespaces:h,sessionProperties:f}=i,g=this.client.proposal.get(s);let{pairingTopic:_,proposer:y,requiredNamespaces:I,optionalNamespaces:R}=g;_=_||"",po(I)||(I=yw(h,"approve()"));const N=await this.client.core.crypto.generateKeyPair(),k=y.publicKey,x=await this.client.core.crypto.generateSharedKey(N,k);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:y.metadata}),await this.sendResult({id:s,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:N}}),await this.client.proposal.delete(s,Fe("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const W=cr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:I,optionalNamespaces:R,pairingTopic:_,controller:{publicKey:N,metadata:this.client.metadata},expiry:Lr(uo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(x),await this.sendRequest({topic:x,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0});const tt=Bn(cr({},W),{topic:x,pairingTopic:_,acknowledged:!1,self:W.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:N});return await this.client.session.set(x,tt),await this.setExpiry(x,Lr(uo)),{topic:x,acknowledged:()=>new Promise(vt=>setTimeout(()=>vt(this.client.session.get(x)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:s,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,o),await this.client.proposal.delete(s,Fe("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:s,namespaces:o}=i,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:_}=dn();return this.events.once(De("session_update",h),({error:y})=>{y?_(y):g()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:f}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:s}=i,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:f,reject:g}=dn();return this.events.once(De("session_extend",o),({error:_})=>{_?g(_):f()}),await this.setExpiry(s,Lr(uo)),{acknowledged:h}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:s,request:o,topic:h,expiry:f}=i,g=Oc(),{done:_,resolve:y,reject:I}=dn(f,"Request expired. Please try again.");return this.events.once(De("session_request",g),({error:R,result:N})=>{R?I(R):y(N)}),await Promise.all([new Promise(async R=>{await this.sendRequest({clientRpcId:g,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(N=>I(N)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:s,id:g}),R()}),new Promise(async R=>{const N=await mw(this.client.core.storage,Al);ww({id:g,topic:h,wcDeepLink:N}),R()}),_()]).then(R=>R[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:s,response:o}=i,{id:h}=o;ci(o)?await this.sendResult({id:h,topic:s,result:o.result,throwOnFailedPublish:!0}):qr(o)&&await this.sendError(h,s,o.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:f,reject:g}=dn();this.events.once(De("session_ping",o),({error:_})=>{_?g(_):f()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:s,event:o,chainId:h}=i;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Fe("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(s=>_w(s,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const s=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var f,g;return((f=h.peerMetadata)==null?void 0:f.url)&&((g=h.peerMetadata)==null?void 0:g.url)===i.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(i,s)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,Fe("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i),this.client.core.storage.removeItem(Al).catch(h=>this.client.logger.warn(h)),this.getPendingSessionRequests().forEach(h=>{h.topic===i&&this.deletePendingSessionRequest(h.id,Fe("USER_DISCONNECTED"))})},this.deleteProposal=async(i,s)=>{await Promise.all([this.client.proposal.delete(i,Fe("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,s),o?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==i),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(i,s)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:s}),this.client.core.expirer.set(i,s)},this.setProposal=async(i,s)=>{await this.client.proposal.set(i,s),this.client.core.expirer.set(i,s.expiry)},this.setPendingSessionRequest=async i=>{const s=Wn.wc_sessionRequest.req.ttl,{id:o,topic:h,params:f,verifyContext:g}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:f,verifyContext:g}),s&&this.client.core.expirer.set(o,Lr(s))},this.sendRequest=async i=>{const{topic:s,method:o,params:h,expiry:f,relayRpcId:g,clientRpcId:_,throwOnFailedPublish:y}=i,I=mn(o,h,_);if(Yl()&&_E.includes(o)){const k=yn(JSON.stringify(I));this.client.core.verify.register({attestationId:k})}const R=await this.client.core.crypto.encode(s,I),N=Wn[o].req;return f&&(N.ttl=f),g&&(N.id=g),this.client.core.history.set(s,I),y?(N.internal=Bn(cr({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,R,N)):this.client.core.relayer.publish(s,R,N).catch(k=>this.client.logger.error(k)),I.id},this.sendResult=async i=>{const{id:s,topic:o,result:h,throwOnFailedPublish:f}=i,g=bo(s,h),_=await this.client.core.crypto.encode(o,g),y=await this.client.core.history.get(o,s),I=Wn[y.request.method].res;f?(I.internal=Bn(cr({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,I)):this.client.core.relayer.publish(o,_,I).catch(R=>this.client.logger.error(R)),await this.client.core.history.resolve(g)},this.sendError=async(i,s,o)=>{const h=Eo(i,o),f=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,i),_=Wn[g.request.method].res;this.client.core.relayer.publish(s,f,_),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],s=[];this.client.session.getAll().forEach(o=>{Ei(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ei(o.expiry)&&s.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=ai.idle},this.processRequest=i=>{const{topic:s,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:o}=i,h=(await this.client.core.history.get(s,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:s}=i,{message:o}=X("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,s)=>{const{params:o,id:h}=s;try{this.isValidConnect(cr({},s.params));const f=Lr(st.FIVE_MINUTES),g=cr({id:h,pairingTopic:i,expiry:f},o);await this.setProposal(h,g);const _=yn(JSON.stringify(s)),y=await this.getVerifyContext(_,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:y})}catch(f){await this.sendError(h,i,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(i,s)=>{const{id:o}=s;if(ci(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const _=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const y=await this.client.core.crypto.generateSharedKey(g,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const I=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:i})}else qr(s)&&(await this.client.proposal.delete(o,Fe("USER_DISCONNECTED")),this.events.emit(De("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:f,controller:g,expiry:_,namespaces:y,requiredNamespaces:I,optionalNamespaces:R,sessionProperties:N,pairingTopic:k}=s.params,x=cr({topic:i,relay:f,expiry:_,namespaces:y,acknowledged:!0,pairingTopic:k,requiredNamespaces:I,optionalNamespaces:R,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},N&&{sessionProperties:N});await this.sendResult({id:s.id,topic:i,result:!0}),this.events.emit(De("session_connect"),{session:x}),this.cleanupDuplicatePairings(x)}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(i,s)=>{const{id:o}=s;ci(s)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(De("session_approve",o),{})):qr(s)&&(await this.client.session.delete(i,Fe("USER_DISCONNECTED")),this.events.emit(De("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(i,s)=>{const{params:o,id:h}=s;try{const f=`${i}_session_update`,g=oo.get(f);if(g&&this.isRequestOutOfSync(g,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(cr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:i,result:!0}),this.client.events.emit("session_update",{id:h,topic:i,params:o}),oo.set(f,h)}catch(f){await this.sendError(h,i,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(i,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(De("session_update",o),{}):qr(s)&&this.events.emit(De("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(i,s)=>{const{id:o}=s;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Lr(uo)),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(De("session_extend",o),{}):qr(s)&&this.events.emit(De("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(i,s)=>{const{id:o}=s;try{this.isValidPing({topic:i}),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,s)=>{const{id:o}=s;setTimeout(()=>{ci(s)?this.events.emit(De("session_ping",o),{}):qr(s)&&this.events.emit(De("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(i,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:i,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Ye.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult({id:o,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidRequest(cr({topic:i},h));const f=yn(JSON.stringify(mn("wc_sessionRequest",h,o))),g=this.client.session.get(i),_=await this.getVerifyContext(f,g.peer.metadata),y={id:o,topic:i,params:h,verifyContext:_};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(De("session_request",o),{result:s.result}):qr(s)&&this.events.emit(De("session_request",o),{error:s.error})},this.onSessionEventRequest=async(i,s)=>{const{id:o,params:h}=s;try{const f=`${i}_session_event_${h.event.name}`,g=oo.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(cr({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h}),oo.set(f,o)}catch(f){await this.sendError(o,i,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},st.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",i)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=i=>{if(i.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===i.topic);s&&this.onSessionProposeRequest(i.topic,mn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async i=>{if(!hr(i)){const{message:_}=X("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:f,relays:g}=i;if(Ii(s)||await this.isValidPairingTopic(s),!bw(g,!0)){const{message:_}=X("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(_)}!Ii(o)&&po(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ii(h)&&po(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),Ii(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(i,s)=>{const o=Ew(i,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!hr(i))throw new Error(X("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:s,namespaces:o,relayProtocol:h,sessionProperties:f}=i;await this.isValidProposalId(s);const g=this.client.proposal.get(s),_=Ja(o,"approve()");if(_)throw new Error(_.message);const y=Nh(g.requiredNamespaces,o,"approve()");if(y)throw new Error(y.message);if(!gn(h,!0)){const{message:I}=X("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(I)}Ii(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async i=>{if(!hr(i)){const{message:h}=X("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:s,reason:o}=i;if(await this.isValidProposalId(s),!Iw(o)){const{message:h}=X("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!hr(i)){const{message:y}=X("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(y)}const{relay:s,controller:o,namespaces:h,expiry:f}=i;if(!Pw(s)){const{message:y}=X("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=Sw(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const _=Ja(h,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Ei(f)){const{message:y}=X("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async i=>{if(!hr(i)){const{message:_}=X("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(_)}const{topic:s,namespaces:o}=i;await this.isValidSessionTopic(s);const h=this.client.session.get(s),f=Ja(o,"update()");if(f)throw new Error(f.message);const g=Nh(h.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async i=>{if(!hr(i)){const{message:o}=X("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionTopic(s)},this.isValidRequest=async i=>{if(!hr(i)){const{message:_}=X("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(_)}const{topic:s,request:o,chainId:h,expiry:f}=i;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Dh(g,h)){const{message:_}=X("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(_)}if(!Ow(o)){const{message:_}=X("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!Aw(g,h,o.method)){const{message:_}=X("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(f&&!Rw(f,oc)){const{message:_}=X("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${oc.min} and ${oc.max}`);throw new Error(_)}},this.isValidRespond=async i=>{var s;if(!hr(i)){const{message:f}=X("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(f)}const{topic:o,response:h}=i;try{await this.isValidSessionTopic(o)}catch(f){throw(s=i==null?void 0:i.response)!=null&&s.id&&this.cleanupAfterResponse(i),f}if(!Cw(h)){const{message:f}=X("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(f)}},this.isValidPing=async i=>{if(!hr(i)){const{message:o}=X("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async i=>{if(!hr(i)){const{message:g}=X("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(g)}const{topic:s,event:o,chainId:h}=i;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Dh(f,h)){const{message:g}=X("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!xw(o)){const{message:g}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!Tw(f,h,o.name)){const{message:g}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async i=>{if(!hr(i)){const{message:o}=X("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(i,s)=>{const o={verified:{verifyUrl:s.verifyUrl||vn,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:s.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,s)=>{Object.values(i).forEach(o=>{if(!gn(o,!1)){const{message:h}=X("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:r}=X("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ye.message,async r=>{const{topic:i,message:s}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(i,s);try{Ac(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):Io(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async r=>{const{topic:i,id:s}=Gl(r.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,X("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(Gn.create,r=>this.onPairingCreated(r))}isValidPairingTopic(r){if(!gn(r,!1)){const{message:i}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(Ei(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=X("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!gn(r,!1)){const{message:i}=X("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=X("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(Ei(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:i}=X("EXPIRED",`session topic: ${r}`);throw new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(gn(r,!1)){const{message:i}=X("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=X("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!Nw(r)){const{message:i}=X("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=X("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(Ei(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:i}=X("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class AE extends So{constructor(r,i){super(r,i,vE,xc),this.core=r,this.logger=i}}class RE extends So{constructor(r,i){super(r,i,yE,xc),this.core=r,this.logger=i}}class CE extends So{constructor(r,i){super(r,i,wE,xc,s=>s.id),this.core=r,this.logger=i}}let xE=class Np extends X_{constructor(r){super(r),this.protocol=Rp,this.version=Cp,this.name=sc.name,this.events=new Ar.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(r==null?void 0:r.name)||sc.name,this.metadata=(r==null?void 0:r.metadata)||vw();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Rt.pino(Rt.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||sc.logger}));this.core=(r==null?void 0:r.core)||new gE(r),this.logger=Rt.generateChildLogger(i,this.name),this.session=new RE(this.core,this.logger),this.proposal=new AE(this.core,this.logger),this.pendingRequest=new CE(this.core,this.logger),this.engine=new OE(this)}static async init(r){const i=new Np(r);return await i.initialize(),i}get context(){return Rt.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var yc={exports:{}};(function(a,r){var i=typeof self<"u"?self:zr,s=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(f){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function _(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(m){return m&&y.indexOf(Object.prototype.toString.call(m))>-1};function R(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function N(m){return typeof m!="string"&&(m=String(m)),m}function k(m){var P={next:function(){var Q=m.shift();return{done:Q===void 0,value:Q}}};return g.iterable&&(P[Symbol.iterator]=function(){return P}),P}function x(m){this.map={},m instanceof x?m.forEach(function(P,Q){this.append(Q,P)},this):Array.isArray(m)?m.forEach(function(P){this.append(P[0],P[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(P){this.append(P,m[P])},this)}x.prototype.append=function(m,P){m=R(m),P=N(P);var Q=this.map[m];this.map[m]=Q?Q+", "+P:P},x.prototype.delete=function(m){delete this.map[R(m)]},x.prototype.get=function(m){return m=R(m),this.has(m)?this.map[m]:null},x.prototype.has=function(m){return this.map.hasOwnProperty(R(m))},x.prototype.set=function(m,P){this.map[R(m)]=N(P)},x.prototype.forEach=function(m,P){for(var Q in this.map)this.map.hasOwnProperty(Q)&&m.call(P,this.map[Q],Q,this)},x.prototype.keys=function(){var m=[];return this.forEach(function(P,Q){m.push(Q)}),k(m)},x.prototype.values=function(){var m=[];return this.forEach(function(P){m.push(P)}),k(m)},x.prototype.entries=function(){var m=[];return this.forEach(function(P,Q){m.push([Q,P])}),k(m)},g.iterable&&(x.prototype[Symbol.iterator]=x.prototype.entries);function W(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function tt(m){return new Promise(function(P,Q){m.onload=function(){P(m.result)},m.onerror=function(){Q(m.error)}})}function vt(m){var P=new FileReader,Q=tt(P);return P.readAsArrayBuffer(m),Q}function ft(m){var P=new FileReader,Q=tt(P);return P.readAsText(m),Q}function ut(m){for(var P=new Uint8Array(m),Q=new Array(P.length),dt=0;dt<P.length;dt++)Q[dt]=String.fromCharCode(P[dt]);return Q.join("")}function ht(m){if(m.slice)return m.slice(0);var P=new Uint8Array(m.byteLength);return P.set(new Uint8Array(m)),P.buffer}function lt(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&_(m)?(this._bodyArrayBuffer=ht(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||I(m))?this._bodyArrayBuffer=ht(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=W(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(vt)}),this.text=function(){var m=W(this);if(m)return m;if(this._bodyBlob)return ft(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ut(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(wt)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var P=m.toUpperCase();return L.indexOf(P)>-1?P:m}function Y(m,P){P=P||{};var Q=P.body;if(m instanceof Y){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,P.headers||(this.headers=new x(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!Q&&m._bodyInit!=null&&(Q=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new x(P.headers)),this.method=H(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Q)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Q)}Y.prototype.clone=function(){return new Y(this,{body:this._bodyInit})};function wt(m){var P=new FormData;return m.trim().split("&").forEach(function(Q){if(Q){var dt=Q.split("="),B=dt.shift().replace(/\+/g," "),$=dt.join("=").replace(/\+/g," ");P.append(decodeURIComponent(B),decodeURIComponent($))}}),P}function it(m){var P=new x,Q=m.replace(/\r?\n[\t ]+/g," ");return Q.split(/\r?\n/).forEach(function(dt){var B=dt.split(":"),$=B.shift().trim();if($){var V=B.join(":").trim();P.append($,V)}}),P}lt.call(Y.prototype);function nt(m,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new x(P.headers),this.url=P.url||"",this._initBody(m)}lt.call(nt.prototype),nt.prototype.clone=function(){return new nt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new x(this.headers),url:this.url})},nt.error=function(){var m=new nt(null,{status:0,statusText:""});return m.type="error",m};var Lt=[301,302,303,307,308];nt.redirect=function(m,P){if(Lt.indexOf(P)===-1)throw new RangeError("Invalid status code");return new nt(null,{status:P,headers:{location:m}})},f.DOMException=h.DOMException;try{new f.DOMException}catch{f.DOMException=function(m,P){this.message=m,this.name=P;var Q=Error(m);this.stack=Q.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function qt(m,P){return new Promise(function(Q,dt){var B=new Y(m,P);if(B.signal&&B.signal.aborted)return dt(new f.DOMException("Aborted","AbortError"));var $=new XMLHttpRequest;function V(){$.abort()}$.onload=function(){var F={status:$.status,statusText:$.statusText,headers:it($.getAllResponseHeaders()||"")};F.url="responseURL"in $?$.responseURL:F.headers.get("X-Request-URL");var Gt="response"in $?$.response:$.responseText;Q(new nt(Gt,F))},$.onerror=function(){dt(new TypeError("Network request failed"))},$.ontimeout=function(){dt(new TypeError("Network request failed"))},$.onabort=function(){dt(new f.DOMException("Aborted","AbortError"))},$.open(B.method,B.url,!0),B.credentials==="include"?$.withCredentials=!0:B.credentials==="omit"&&($.withCredentials=!1),"responseType"in $&&g.blob&&($.responseType="blob"),B.headers.forEach(function(F,Gt){$.setRequestHeader(Gt,F)}),B.signal&&(B.signal.addEventListener("abort",V),$.onreadystatechange=function(){$.readyState===4&&B.signal.removeEventListener("abort",V)}),$.send(typeof B._bodyInit>"u"?null:B._bodyInit)})}return qt.polyfill=!0,h.fetch||(h.fetch=qt,h.Headers=x,h.Request=Y,h.Response=nt),f.Headers=x,f.Request=Y,f.Response=nt,f.fetch=qt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,a.exports=r})(yc,yc.exports);var TE=yc.exports;const xl=Ec(TE),NE={Accept:"application/json","Content-Type":"application/json"},DE="POST",Tl={headers:NE,method:DE},Nl=10;class Oi{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new Ar.EventEmitter,this.isAvailable=!1,this.registering=!1,!nl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,i){this.isAvailable||await this.register();try{const s=Hi(r),o=await(await xl(this.url,Object.assign(Object.assign({},Tl),{body:s}))).json();this.onPayload({data:o})}catch(s){this.onError(r.id,s)}}async register(r=this.url){if(!nl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((s,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=Hi({id:1,jsonrpc:"2.0",method:"test",params:[]});await xl(r,Object.assign(Object.assign({},Tl),{body:i}))}this.onOpen()}catch(i){const s=this.parseError(i);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?ts(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const s=this.parseError(i),o=s.message||s.toString(),h=Eo(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return up(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Nl&&this.events.setMaxListeners(Nl)}}const Dl="error",jE="wss://relay.walletconnect.com",LE="wc",qE="universal_provider",jl=`${LE}@2:${qE}:`,zE="https://rpc.walletconnect.com/v1/",hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var i,s="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",y=500,I="__lodash_placeholder__",R=1,N=2,k=4,x=1,W=2,tt=1,vt=2,ft=4,ut=8,ht=16,lt=32,L=64,H=128,Y=256,wt=512,it=30,nt="...",Lt=800,qt=16,m=1,P=2,Q=3,dt=1/0,B=9007199254740991,$=17976931348623157e292,V=NaN,F=4294967295,Gt=F-1,Kt=F>>>1,Mr=[["ary",H],["bind",tt],["bindKey",vt],["curry",ut],["curryRight",ht],["flip",wt],["partial",lt],["partialRight",L],["rearg",Y]],It="[object Arguments]",Ie="[object Array]",j="[object AsyncFunction]",D="[object Boolean]",C="[object Date]",u="[object DOMException]",E="[object Error]",et="[object Function]",pt="[object GeneratorFunction]",bt="[object Map]",Tt="[object Number]",Dt="[object Null]",Ot="[object Object]",Pe="[object Promise]",me="[object Proxy]",oe="[object RegExp]",zt="[object Set]",Jt="[object String]",Xt="[object Symbol]",ae="[object Undefined]",$t="[object WeakMap]",Zt="[object WeakSet]",Nt="[object ArrayBuffer]",Vt="[object DataView]",he="[object Float32Array]",kt="[object Float64Array]",Se="[object Int8Array]",je="[object Int16Array]",$e="[object Int32Array]",He="[object Uint8Array]",ze="[object Uint8ClampedArray]",Ge="[object Uint16Array]",rr="[object Uint32Array]",kr=/\b__p \+= '';/g,Qe=/\b(__p \+=) '' \+/g,Br=/(__e\(.*?\)|\b__t\)) \+\n'';/g,li=/&(?:amp|lt|gt|quot|#39);/g,Ai=/[&<>"']/g,le=RegExp(li.source),re=RegExp(Ai.source),pe=/<%-([\s\S]+?)%>/g,fe=/<%([\s\S]+?)%>/g,ce=/<%=([\s\S]+?)%>/g,ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oe=/^\w*$/,Ae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,de=/[\\^$.*+?()[\]{}|]/g,Re=RegExp(de.source),ge=/^\s+/,we=/\s/,ve=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ce=/,? & /,xe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oo=/[()=,{}\[\]\/\s]/,Ao=/\\(\\)?/g,Ro=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Co=/^[-+]0x[0-9a-f]+$/i,xo=/^0b[01]+$/i,To=/^\[object .+?Constructor\]$/,No=/^0o[0-7]+$/i,Do=/^(?:0|[1-9]\d*)$/,Fr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bi=/($^)/,jo=/['\n\r\u2028\u2029\\]/g,Fi="\\ud800-\\udfff",Lo="\\u0300-\\u036f",qo="\\ufe20-\\ufe2f",Yi="\\u20d0-\\u20ff",rs=Lo+qo+Yi,is="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",zo="\\xac\\xb1\\xd7\\xf7",Mo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ko="\\u2000-\\u206f",Uo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ns="A-Z\\xc0-\\xd6\\xd8-\\xde",ss="\\ufe0e\\ufe0f",Ri=zo+Mo+ko+Uo,En="[']",Ci="["+Fi+"]",In="["+Ri+"]",xi="["+rs+"]",os="\\d+",$o="["+is+"]",as="["+Rr+"]",cs="[^"+Fi+Ri+os+is+Rr+ns+"]",Gi="\\ud83c[\\udffb-\\udfff]",Ho="(?:"+xi+"|"+Gi+")",us="[^"+Fi+"]",Qi="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+ns+"]",hs="\\u200d",ls="(?:"+as+"|"+cs+")",Ur="(?:"+lr+"|"+cs+")",ps="(?:"+En+"(?:d|ll|m|re|s|t|ve))?",fs="(?:"+En+"(?:D|LL|M|RE|S|T|VE))?",ds=Ho+"?",gs="["+ss+"]?",Ko="(?:"+hs+"(?:"+[us,Qi,pi].join("|")+")"+gs+ds+")*",Yr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ys=gs+ds+Ko,Ji="(?:"+[$o,Qi,pi].join("|")+")"+ys,Vo="(?:"+[us+xi+"?",xi,Qi,pi,Ci].join("|")+")",Pn=RegExp(En,"g"),Wo=RegExp(xi,"g"),Xi=RegExp(Gi+"(?="+Gi+")|"+Vo+ys,"g"),ms=RegExp([lr+"?"+as+"+"+ps+"(?="+[In,lr,"$"].join("|")+")",Ur+"+"+fs+"(?="+[In,lr+ls,"$"].join("|")+")",lr+"?"+ls+"+"+ps,lr+"+"+fs,vs,Yr,os,Ji].join("|"),"g"),ws=RegExp("["+hs+Fi+rs+ss+"]"),Ti=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_s=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bo=-1,Wt={};Wt[he]=Wt[kt]=Wt[Se]=Wt[je]=Wt[$e]=Wt[He]=Wt[ze]=Wt[Ge]=Wt[rr]=!0,Wt[It]=Wt[Ie]=Wt[Nt]=Wt[D]=Wt[Vt]=Wt[C]=Wt[E]=Wt[et]=Wt[bt]=Wt[Tt]=Wt[Ot]=Wt[oe]=Wt[zt]=Wt[Jt]=Wt[$t]=!1;var Ht={};Ht[It]=Ht[Ie]=Ht[Nt]=Ht[Vt]=Ht[D]=Ht[C]=Ht[he]=Ht[kt]=Ht[Se]=Ht[je]=Ht[$e]=Ht[bt]=Ht[Tt]=Ht[Ot]=Ht[oe]=Ht[zt]=Ht[Jt]=Ht[Xt]=Ht[He]=Ht[ze]=Ht[Ge]=Ht[rr]=!0,Ht[E]=Ht[et]=Ht[$t]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},J={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Bt=parseFloat,mt=parseInt,te=typeof Fn=="object"&&Fn&&Fn.Object===Object&&Fn,Te=typeof self=="object"&&self&&self.Object===Object&&self,Ct=te||Te||Function("return this")(),Ft=r&&!r.nodeType&&r,_e=Ft&&!0&&a&&!a.nodeType&&a,ir=_e&&_e.exports===Ft,Ne=ir&&te.process,ee=function(){try{var S=_e&&_e.require&&_e.require("util").types;return S||Ne&&Ne.binding&&Ne.binding("util")}catch{}}(),Je=ee&&ee.isArrayBuffer,Cr=ee&&ee.isDate,mr=ee&&ee.isMap,$r=ee&&ee.isRegExp,Sn=ee&&ee.isSet,Ni=ee&&ee.isTypedArray;function Me(S,q,T){switch(T.length){case 0:return S.call(q);case 1:return S.call(q,T[0]);case 2:return S.call(q,T[0],T[1]);case 3:return S.call(q,T[0],T[1],T[2])}return S.apply(q,T)}function Lp(S,q,T,Z){for(var gt=-1,jt=S==null?0:S.length;++gt<jt;){var Le=S[gt];q(Z,Le,T(Le),S)}return Z}function wr(S,q){for(var T=-1,Z=S==null?0:S.length;++T<Z&&q(S[T],T,S)!==!1;);return S}function qp(S,q){for(var T=S==null?0:S.length;T--&&q(S[T],T,S)!==!1;);return S}function Dc(S,q){for(var T=-1,Z=S==null?0:S.length;++T<Z;)if(!q(S[T],T,S))return!1;return!0}function fi(S,q){for(var T=-1,Z=S==null?0:S.length,gt=0,jt=[];++T<Z;){var Le=S[T];q(Le,T,S)&&(jt[gt++]=Le)}return jt}function bs(S,q){var T=S==null?0:S.length;return!!T&&Zi(S,q,0)>-1}function Fo(S,q,T){for(var Z=-1,gt=S==null?0:S.length;++Z<gt;)if(T(q,S[Z]))return!0;return!1}function ne(S,q){for(var T=-1,Z=S==null?0:S.length,gt=Array(Z);++T<Z;)gt[T]=q(S[T],T,S);return gt}function di(S,q){for(var T=-1,Z=q.length,gt=S.length;++T<Z;)S[gt+T]=q[T];return S}function Yo(S,q,T,Z){var gt=-1,jt=S==null?0:S.length;for(Z&&jt&&(T=S[++gt]);++gt<jt;)T=q(T,S[gt],gt,S);return T}function zp(S,q,T,Z){var gt=S==null?0:S.length;for(Z&&gt&&(T=S[--gt]);gt--;)T=q(T,S[gt],gt,S);return T}function Go(S,q){for(var T=-1,Z=S==null?0:S.length;++T<Z;)if(q(S[T],T,S))return!0;return!1}var Mp=Qo("length");function kp(S){return S.split("")}function Up(S){return S.match(xe)||[]}function jc(S,q,T){var Z;return T(S,function(gt,jt,Le){if(q(gt,jt,Le))return Z=jt,!1}),Z}function Es(S,q,T,Z){for(var gt=S.length,jt=T+(Z?1:-1);Z?jt--:++jt<gt;)if(q(S[jt],jt,S))return jt;return-1}function Zi(S,q,T){return q===q?Xp(S,q,T):Es(S,Lc,T)}function $p(S,q,T,Z){for(var gt=T-1,jt=S.length;++gt<jt;)if(Z(S[gt],q))return gt;return-1}function Lc(S){return S!==S}function qc(S,q){var T=S==null?0:S.length;return T?Xo(S,q)/T:V}function Qo(S){return function(q){return q==null?i:q[S]}}function Jo(S){return function(q){return S==null?i:S[q]}}function zc(S,q,T,Z,gt){return gt(S,function(jt,Le,Yt){T=Z?(Z=!1,jt):q(T,jt,Le,Yt)}),T}function Hp(S,q){var T=S.length;for(S.sort(q);T--;)S[T]=S[T].value;return S}function Xo(S,q){for(var T,Z=-1,gt=S.length;++Z<gt;){var jt=q(S[Z]);jt!==i&&(T=T===i?jt:T+jt)}return T}function Zo(S,q){for(var T=-1,Z=Array(S);++T<S;)Z[T]=q(T);return Z}function Kp(S,q){return ne(q,function(T){return[T,S[T]]})}function Mc(S){return S&&S.slice(0,Hc(S)+1).replace(ge,"")}function pr(S){return function(q){return S(q)}}function ta(S,q){return ne(q,function(T){return S[T]})}function On(S,q){return S.has(q)}function kc(S,q){for(var T=-1,Z=S.length;++T<Z&&Zi(q,S[T],0)>-1;);return T}function Uc(S,q){for(var T=S.length;T--&&Zi(q,S[T],0)>-1;);return T}function Vp(S,q){for(var T=S.length,Z=0;T--;)S[T]===q&&++Z;return Z}var Wp=Jo(v),Bp=Jo(O);function Fp(S){return"\\"+J[S]}function Yp(S,q){return S==null?i:S[q]}function tn(S){return ws.test(S)}function Gp(S){return Ti.test(S)}function Qp(S){for(var q,T=[];!(q=S.next()).done;)T.push(q.value);return T}function ea(S){var q=-1,T=Array(S.size);return S.forEach(function(Z,gt){T[++q]=[gt,Z]}),T}function $c(S,q){return function(T){return S(q(T))}}function gi(S,q){for(var T=-1,Z=S.length,gt=0,jt=[];++T<Z;){var Le=S[T];(Le===q||Le===I)&&(S[T]=I,jt[gt++]=T)}return jt}function Is(S){var q=-1,T=Array(S.size);return S.forEach(function(Z){T[++q]=Z}),T}function Jp(S){var q=-1,T=Array(S.size);return S.forEach(function(Z){T[++q]=[Z,Z]}),T}function Xp(S,q,T){for(var Z=T-1,gt=S.length;++Z<gt;)if(S[Z]===q)return Z;return-1}function Zp(S,q,T){for(var Z=T+1;Z--;)if(S[Z]===q)return Z;return Z}function en(S){return tn(S)?ef(S):Mp(S)}function xr(S){return tn(S)?rf(S):kp(S)}function Hc(S){for(var q=S.length;q--&&we.test(S.charAt(q)););return q}var tf=Jo(U);function ef(S){for(var q=Xi.lastIndex=0;Xi.test(S);)++q;return q}function rf(S){return S.match(Xi)||[]}function nf(S){return S.match(ms)||[]}var sf=function S(q){q=q==null?Ct:rn.defaults(Ct.Object(),q,rn.pick(Ct,_s));var T=q.Array,Z=q.Date,gt=q.Error,jt=q.Function,Le=q.Math,Yt=q.Object,ra=q.RegExp,of=q.String,_r=q.TypeError,Ps=T.prototype,af=jt.prototype,nn=Yt.prototype,Ss=q["__core-js_shared__"],Os=af.toString,Ut=nn.hasOwnProperty,cf=0,Kc=function(){var t=/[^.]+$/.exec(Ss&&Ss.keys&&Ss.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),As=nn.toString,uf=Os.call(Yt),hf=Ct._,lf=ra("^"+Os.call(Ut).replace(de,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rs=ir?q.Buffer:i,vi=q.Symbol,Cs=q.Uint8Array,Vc=Rs?Rs.allocUnsafe:i,xs=$c(Yt.getPrototypeOf,Yt),Wc=Yt.create,Bc=nn.propertyIsEnumerable,Ts=Ps.splice,Fc=vi?vi.isConcatSpreadable:i,An=vi?vi.iterator:i,Di=vi?vi.toStringTag:i,Ns=function(){try{var t=Mi(Yt,"defineProperty");return t({},"",{}),t}catch{}}(),pf=q.clearTimeout!==Ct.clearTimeout&&q.clearTimeout,ff=Z&&Z.now!==Ct.Date.now&&Z.now,df=q.setTimeout!==Ct.setTimeout&&q.setTimeout,Ds=Le.ceil,js=Le.floor,ia=Yt.getOwnPropertySymbols,gf=Rs?Rs.isBuffer:i,Yc=q.isFinite,vf=Ps.join,yf=$c(Yt.keys,Yt),qe=Le.max,We=Le.min,mf=Z.now,wf=q.parseInt,Gc=Le.random,_f=Ps.reverse,na=Mi(q,"DataView"),Rn=Mi(q,"Map"),sa=Mi(q,"Promise"),sn=Mi(q,"Set"),Cn=Mi(q,"WeakMap"),xn=Mi(Yt,"create"),Ls=Cn&&new Cn,on={},bf=ki(na),Ef=ki(Rn),If=ki(sa),Pf=ki(sn),Sf=ki(Cn),qs=vi?vi.prototype:i,Tn=qs?qs.valueOf:i,Qc=qs?qs.toString:i;function p(t){if(ye(t)&&!yt(t)&&!(t instanceof At)){if(t instanceof br)return t;if(Ut.call(t,"__wrapped__"))return Ju(t)}return new br(t)}var an=function(){function t(){}return function(e){if(!ue(e))return{};if(Wc)return Wc(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function zs(){}function br(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}p.templateSettings={escape:pe,evaluate:fe,interpolate:ce,variable:"",imports:{_:p}},p.prototype=zs.prototype,p.prototype.constructor=p,br.prototype=an(zs.prototype),br.prototype.constructor=br;function At(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=F,this.__views__=[]}function Of(){var t=new At(this.__wrapped__);return t.__actions__=nr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=nr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=nr(this.__views__),t}function Af(){if(this.__filtered__){var t=new At(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Rf(){var t=this.__wrapped__.value(),e=this.__dir__,n=yt(t),c=e<0,l=n?t.length:0,d=Ud(0,l,this.__views__),w=d.start,b=d.end,A=b-w,z=c?b:w-1,M=this.__iteratees__,K=M.length,G=0,rt=We(A,this.__takeCount__);if(!n||!c&&l==A&&rt==A)return _u(t,this.__actions__);var at=[];t:for(;A--&&G<rt;){z+=e;for(var Et=-1,ct=t[z];++Et<K;){var St=M[Et],xt=St.iteratee,gr=St.type,tr=xt(ct);if(gr==P)ct=tr;else if(!tr){if(gr==m)continue t;break t}}at[G++]=ct}return at}At.prototype=an(zs.prototype),At.prototype.constructor=At;function ji(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var c=t[e];this.set(c[0],c[1])}}function Cf(){this.__data__=xn?xn(null):{},this.size=0}function xf(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Tf(t){var e=this.__data__;if(xn){var n=e[t];return n===_?i:n}return Ut.call(e,t)?e[t]:i}function Nf(t){var e=this.__data__;return xn?e[t]!==i:Ut.call(e,t)}function Df(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=xn&&e===i?_:e,this}ji.prototype.clear=Cf,ji.prototype.delete=xf,ji.prototype.get=Tf,ji.prototype.has=Nf,ji.prototype.set=Df;function Gr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var c=t[e];this.set(c[0],c[1])}}function jf(){this.__data__=[],this.size=0}function Lf(t){var e=this.__data__,n=Ms(e,t);if(n<0)return!1;var c=e.length-1;return n==c?e.pop():Ts.call(e,n,1),--this.size,!0}function qf(t){var e=this.__data__,n=Ms(e,t);return n<0?i:e[n][1]}function zf(t){return Ms(this.__data__,t)>-1}function Mf(t,e){var n=this.__data__,c=Ms(n,t);return c<0?(++this.size,n.push([t,e])):n[c][1]=e,this}Gr.prototype.clear=jf,Gr.prototype.delete=Lf,Gr.prototype.get=qf,Gr.prototype.has=zf,Gr.prototype.set=Mf;function Qr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var c=t[e];this.set(c[0],c[1])}}function kf(){this.size=0,this.__data__={hash:new ji,map:new(Rn||Gr),string:new ji}}function Uf(t){var e=Qs(this,t).delete(t);return this.size-=e?1:0,e}function $f(t){return Qs(this,t).get(t)}function Hf(t){return Qs(this,t).has(t)}function Kf(t,e){var n=Qs(this,t),c=n.size;return n.set(t,e),this.size+=n.size==c?0:1,this}Qr.prototype.clear=kf,Qr.prototype.delete=Uf,Qr.prototype.get=$f,Qr.prototype.has=Hf,Qr.prototype.set=Kf;function Li(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Qr;++e<n;)this.add(t[e])}function Vf(t){return this.__data__.set(t,_),this}function Wf(t){return this.__data__.has(t)}Li.prototype.add=Li.prototype.push=Vf,Li.prototype.has=Wf;function Tr(t){var e=this.__data__=new Gr(t);this.size=e.size}function Bf(){this.__data__=new Gr,this.size=0}function Ff(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Yf(t){return this.__data__.get(t)}function Gf(t){return this.__data__.has(t)}function Qf(t,e){var n=this.__data__;if(n instanceof Gr){var c=n.__data__;if(!Rn||c.length<o-1)return c.push([t,e]),this.size=++n.size,this;n=this.__data__=new Qr(c)}return n.set(t,e),this.size=n.size,this}Tr.prototype.clear=Bf,Tr.prototype.delete=Ff,Tr.prototype.get=Yf,Tr.prototype.has=Gf,Tr.prototype.set=Qf;function Jc(t,e){var n=yt(t),c=!n&&Ui(t),l=!n&&!c&&bi(t),d=!n&&!c&&!l&&ln(t),w=n||c||l||d,b=w?Zo(t.length,of):[],A=b.length;for(var z in t)(e||Ut.call(t,z))&&!(w&&(z=="length"||l&&(z=="offset"||z=="parent")||d&&(z=="buffer"||z=="byteLength"||z=="byteOffset")||ti(z,A)))&&b.push(z);return b}function Xc(t){var e=t.length;return e?t[va(0,e-1)]:i}function Jf(t,e){return Js(nr(t),qi(e,0,t.length))}function Xf(t){return Js(nr(t))}function oa(t,e,n){(n!==i&&!Nr(t[e],n)||n===i&&!(e in t))&&Jr(t,e,n)}function Nn(t,e,n){var c=t[e];(!(Ut.call(t,e)&&Nr(c,n))||n===i&&!(e in t))&&Jr(t,e,n)}function Ms(t,e){for(var n=t.length;n--;)if(Nr(t[n][0],e))return n;return-1}function Zf(t,e,n,c){return yi(t,function(l,d,w){e(c,l,n(l),w)}),c}function Zc(t,e){return t&&Kr(e,ke(e),t)}function td(t,e){return t&&Kr(e,or(e),t)}function Jr(t,e,n){e=="__proto__"&&Ns?Ns(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function aa(t,e){for(var n=-1,c=e.length,l=T(c),d=t==null;++n<c;)l[n]=d?i:$a(t,e[n]);return l}function qi(t,e,n){return t===t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function Er(t,e,n,c,l,d){var w,b=e&R,A=e&N,z=e&k;if(n&&(w=l?n(t,c,l,d):n(t)),w!==i)return w;if(!ue(t))return t;var M=yt(t);if(M){if(w=Hd(t),!b)return nr(t,w)}else{var K=Be(t),G=K==et||K==pt;if(bi(t))return Iu(t,b);if(K==Ot||K==It||G&&!l){if(w=A||G?{}:Hu(t),!b)return A?Td(t,td(w,t)):xd(t,Zc(w,t))}else{if(!Ht[K])return l?t:{};w=Kd(t,K,b)}}d||(d=new Tr);var rt=d.get(t);if(rt)return rt;d.set(t,w),yh(t)?t.forEach(function(ct){w.add(Er(ct,e,n,ct,t,d))}):gh(t)&&t.forEach(function(ct,St){w.set(St,Er(ct,e,n,St,t,d))});var at=z?A?Aa:Oa:A?or:ke,Et=M?i:at(t);return wr(Et||t,function(ct,St){Et&&(St=ct,ct=t[St]),Nn(w,St,Er(ct,e,n,St,t,d))}),w}function ed(t){var e=ke(t);return function(n){return tu(n,t,e)}}function tu(t,e,n){var c=n.length;if(t==null)return!c;for(t=Yt(t);c--;){var l=n[c],d=e[l],w=t[l];if(w===i&&!(l in t)||!d(w))return!1}return!0}function eu(t,e,n){if(typeof t!="function")throw new _r(f);return kn(function(){t.apply(i,n)},e)}function Dn(t,e,n,c){var l=-1,d=bs,w=!0,b=t.length,A=[],z=e.length;if(!b)return A;n&&(e=ne(e,pr(n))),c?(d=Fo,w=!1):e.length>=o&&(d=On,w=!1,e=new Li(e));t:for(;++l<b;){var M=t[l],K=n==null?M:n(M);if(M=c||M!==0?M:0,w&&K===K){for(var G=z;G--;)if(e[G]===K)continue t;A.push(M)}else d(e,K,c)||A.push(M)}return A}var yi=Ru(Hr),ru=Ru(ua,!0);function rd(t,e){var n=!0;return yi(t,function(c,l,d){return n=!!e(c,l,d),n}),n}function ks(t,e,n){for(var c=-1,l=t.length;++c<l;){var d=t[c],w=e(d);if(w!=null&&(b===i?w===w&&!dr(w):n(w,b)))var b=w,A=d}return A}function id(t,e,n,c){var l=t.length;for(n=_t(n),n<0&&(n=-n>l?0:l+n),c=c===i||c>l?l:_t(c),c<0&&(c+=l),c=n>c?0:wh(c);n<c;)t[n++]=e;return t}function iu(t,e){var n=[];return yi(t,function(c,l,d){e(c,l,d)&&n.push(c)}),n}function Ke(t,e,n,c,l){var d=-1,w=t.length;for(n||(n=Wd),l||(l=[]);++d<w;){var b=t[d];e>0&&n(b)?e>1?Ke(b,e-1,n,c,l):di(l,b):c||(l[l.length]=b)}return l}var ca=Cu(),nu=Cu(!0);function Hr(t,e){return t&&ca(t,e,ke)}function ua(t,e){return t&&nu(t,e,ke)}function Us(t,e){return fi(e,function(n){return ei(t[n])})}function zi(t,e){e=wi(e,t);for(var n=0,c=e.length;t!=null&&n<c;)t=t[Vr(e[n++])];return n&&n==c?t:i}function su(t,e,n){var c=e(t);return yt(t)?c:di(c,n(t))}function Xe(t){return t==null?t===i?ae:Dt:Di&&Di in Yt(t)?kd(t):Xd(t)}function ha(t,e){return t>e}function nd(t,e){return t!=null&&Ut.call(t,e)}function sd(t,e){return t!=null&&e in Yt(t)}function od(t,e,n){return t>=We(e,n)&&t<qe(e,n)}function la(t,e,n){for(var c=n?Fo:bs,l=t[0].length,d=t.length,w=d,b=T(d),A=1/0,z=[];w--;){var M=t[w];w&&e&&(M=ne(M,pr(e))),A=We(M.length,A),b[w]=!n&&(e||l>=120&&M.length>=120)?new Li(w&&M):i}M=t[0];var K=-1,G=b[0];t:for(;++K<l&&z.length<A;){var rt=M[K],at=e?e(rt):rt;if(rt=n||rt!==0?rt:0,!(G?On(G,at):c(z,at,n))){for(w=d;--w;){var Et=b[w];if(!(Et?On(Et,at):c(t[w],at,n)))continue t}G&&G.push(at),z.push(rt)}}return z}function ad(t,e,n,c){return Hr(t,function(l,d,w){e(c,n(l),d,w)}),c}function jn(t,e,n){e=wi(e,t),t=Bu(t,e);var c=t==null?t:t[Vr(Pr(e))];return c==null?i:Me(c,t,n)}function ou(t){return ye(t)&&Xe(t)==It}function cd(t){return ye(t)&&Xe(t)==Nt}function ud(t){return ye(t)&&Xe(t)==C}function Ln(t,e,n,c,l){return t===e?!0:t==null||e==null||!ye(t)&&!ye(e)?t!==t&&e!==e:hd(t,e,n,c,Ln,l)}function hd(t,e,n,c,l,d){var w=yt(t),b=yt(e),A=w?Ie:Be(t),z=b?Ie:Be(e);A=A==It?Ot:A,z=z==It?Ot:z;var M=A==Ot,K=z==Ot,G=A==z;if(G&&bi(t)){if(!bi(e))return!1;w=!0,M=!1}if(G&&!M)return d||(d=new Tr),w||ln(t)?ku(t,e,n,c,l,d):zd(t,e,A,n,c,l,d);if(!(n&x)){var rt=M&&Ut.call(t,"__wrapped__"),at=K&&Ut.call(e,"__wrapped__");if(rt||at){var Et=rt?t.value():t,ct=at?e.value():e;return d||(d=new Tr),l(Et,ct,n,c,d)}}return G?(d||(d=new Tr),Md(t,e,n,c,l,d)):!1}function ld(t){return ye(t)&&Be(t)==bt}function pa(t,e,n,c){var l=n.length,d=l,w=!c;if(t==null)return!d;for(t=Yt(t);l--;){var b=n[l];if(w&&b[2]?b[1]!==t[b[0]]:!(b[0]in t))return!1}for(;++l<d;){b=n[l];var A=b[0],z=t[A],M=b[1];if(w&&b[2]){if(z===i&&!(A in t))return!1}else{var K=new Tr;if(c)var G=c(z,M,A,t,e,K);if(!(G===i?Ln(M,z,x|W,c,K):G))return!1}}return!0}function au(t){if(!ue(t)||Fd(t))return!1;var e=ei(t)?lf:To;return e.test(ki(t))}function pd(t){return ye(t)&&Xe(t)==oe}function fd(t){return ye(t)&&Be(t)==zt}function dd(t){return ye(t)&&io(t.length)&&!!Wt[Xe(t)]}function cu(t){return typeof t=="function"?t:t==null?ar:typeof t=="object"?yt(t)?lu(t[0],t[1]):hu(t):xh(t)}function fa(t){if(!Mn(t))return yf(t);var e=[];for(var n in Yt(t))Ut.call(t,n)&&n!="constructor"&&e.push(n);return e}function gd(t){if(!ue(t))return Jd(t);var e=Mn(t),n=[];for(var c in t)c=="constructor"&&(e||!Ut.call(t,c))||n.push(c);return n}function da(t,e){return t<e}function uu(t,e){var n=-1,c=sr(t)?T(t.length):[];return yi(t,function(l,d,w){c[++n]=e(l,d,w)}),c}function hu(t){var e=Ca(t);return e.length==1&&e[0][2]?Vu(e[0][0],e[0][1]):function(n){return n===t||pa(n,t,e)}}function lu(t,e){return Ta(t)&&Ku(e)?Vu(Vr(t),e):function(n){var c=$a(n,t);return c===i&&c===e?Ha(n,t):Ln(e,c,x|W)}}function $s(t,e,n,c,l){t!==e&&ca(e,function(d,w){if(l||(l=new Tr),ue(d))vd(t,e,w,n,$s,c,l);else{var b=c?c(Da(t,w),d,w+"",t,e,l):i;b===i&&(b=d),oa(t,w,b)}},or)}function vd(t,e,n,c,l,d,w){var b=Da(t,n),A=Da(e,n),z=w.get(A);if(z){oa(t,n,z);return}var M=d?d(b,A,n+"",t,e,w):i,K=M===i;if(K){var G=yt(A),rt=!G&&bi(A),at=!G&&!rt&&ln(A);M=A,G||rt||at?yt(b)?M=b:be(b)?M=nr(b):rt?(K=!1,M=Iu(A,!0)):at?(K=!1,M=Pu(A,!0)):M=[]:Un(A)||Ui(A)?(M=b,Ui(b)?M=_h(b):(!ue(b)||ei(b))&&(M=Hu(A))):K=!1}K&&(w.set(A,M),l(M,A,c,d,w),w.delete(A)),oa(t,n,M)}function pu(t,e){var n=t.length;if(n)return e+=e<0?n:0,ti(e,n)?t[e]:i}function fu(t,e,n){e.length?e=ne(e,function(d){return yt(d)?function(w){return zi(w,d.length===1?d[0]:d)}:d}):e=[ar];var c=-1;e=ne(e,pr(ot()));var l=uu(t,function(d,w,b){var A=ne(e,function(z){return z(d)});return{criteria:A,index:++c,value:d}});return Hp(l,function(d,w){return Cd(d,w,n)})}function yd(t,e){return du(t,e,function(n,c){return Ha(t,c)})}function du(t,e,n){for(var c=-1,l=e.length,d={};++c<l;){var w=e[c],b=zi(t,w);n(b,w)&&qn(d,wi(w,t),b)}return d}function md(t){return function(e){return zi(e,t)}}function ga(t,e,n,c){var l=c?$p:Zi,d=-1,w=e.length,b=t;for(t===e&&(e=nr(e)),n&&(b=ne(t,pr(n)));++d<w;)for(var A=0,z=e[d],M=n?n(z):z;(A=l(b,M,A,c))>-1;)b!==t&&Ts.call(b,A,1),Ts.call(t,A,1);return t}function gu(t,e){for(var n=t?e.length:0,c=n-1;n--;){var l=e[n];if(n==c||l!==d){var d=l;ti(l)?Ts.call(t,l,1):wa(t,l)}}return t}function va(t,e){return t+js(Gc()*(e-t+1))}function wd(t,e,n,c){for(var l=-1,d=qe(Ds((e-t)/(n||1)),0),w=T(d);d--;)w[c?d:++l]=t,t+=n;return w}function ya(t,e){var n="";if(!t||e<1||e>B)return n;do e%2&&(n+=t),e=js(e/2),e&&(t+=t);while(e);return n}function Pt(t,e){return ja(Wu(t,e,ar),t+"")}function _d(t){return Xc(pn(t))}function bd(t,e){var n=pn(t);return Js(n,qi(e,0,n.length))}function qn(t,e,n,c){if(!ue(t))return t;e=wi(e,t);for(var l=-1,d=e.length,w=d-1,b=t;b!=null&&++l<d;){var A=Vr(e[l]),z=n;if(A==="__proto__"||A==="constructor"||A==="prototype")return t;if(l!=w){var M=b[A];z=c?c(M,A,b):i,z===i&&(z=ue(M)?M:ti(e[l+1])?[]:{})}Nn(b,A,z),b=b[A]}return t}var vu=Ls?function(t,e){return Ls.set(t,e),t}:ar,Ed=Ns?function(t,e){return Ns(t,"toString",{configurable:!0,enumerable:!1,value:Va(e),writable:!0})}:ar;function Id(t){return Js(pn(t))}function Ir(t,e,n){var c=-1,l=t.length;e<0&&(e=-e>l?0:l+e),n=n>l?l:n,n<0&&(n+=l),l=e>n?0:n-e>>>0,e>>>=0;for(var d=T(l);++c<l;)d[c]=t[c+e];return d}function Pd(t,e){var n;return yi(t,function(c,l,d){return n=e(c,l,d),!n}),!!n}function Hs(t,e,n){var c=0,l=t==null?c:t.length;if(typeof e=="number"&&e===e&&l<=Kt){for(;c<l;){var d=c+l>>>1,w=t[d];w!==null&&!dr(w)&&(n?w<=e:w<e)?c=d+1:l=d}return l}return ma(t,e,ar,n)}function ma(t,e,n,c){var l=0,d=t==null?0:t.length;if(d===0)return 0;e=n(e);for(var w=e!==e,b=e===null,A=dr(e),z=e===i;l<d;){var M=js((l+d)/2),K=n(t[M]),G=K!==i,rt=K===null,at=K===K,Et=dr(K);if(w)var ct=c||at;else z?ct=at&&(c||G):b?ct=at&&G&&(c||!rt):A?ct=at&&G&&!rt&&(c||!Et):rt||Et?ct=!1:ct=c?K<=e:K<e;ct?l=M+1:d=M}return We(d,Gt)}function yu(t,e){for(var n=-1,c=t.length,l=0,d=[];++n<c;){var w=t[n],b=e?e(w):w;if(!n||!Nr(b,A)){var A=b;d[l++]=w===0?0:w}}return d}function mu(t){return typeof t=="number"?t:dr(t)?V:+t}function fr(t){if(typeof t=="string")return t;if(yt(t))return ne(t,fr)+"";if(dr(t))return Qc?Qc.call(t):"";var e=t+"";return e=="0"&&1/t==-dt?"-0":e}function mi(t,e,n){var c=-1,l=bs,d=t.length,w=!0,b=[],A=b;if(n)w=!1,l=Fo;else if(d>=o){var z=e?null:Ld(t);if(z)return Is(z);w=!1,l=On,A=new Li}else A=e?[]:b;t:for(;++c<d;){var M=t[c],K=e?e(M):M;if(M=n||M!==0?M:0,w&&K===K){for(var G=A.length;G--;)if(A[G]===K)continue t;e&&A.push(K),b.push(M)}else l(A,K,n)||(A!==b&&A.push(K),b.push(M))}return b}function wa(t,e){return e=wi(e,t),t=Bu(t,e),t==null||delete t[Vr(Pr(e))]}function wu(t,e,n,c){return qn(t,e,n(zi(t,e)),c)}function Ks(t,e,n,c){for(var l=t.length,d=c?l:-1;(c?d--:++d<l)&&e(t[d],d,t););return n?Ir(t,c?0:d,c?d+1:l):Ir(t,c?d+1:0,c?l:d)}function _u(t,e){var n=t;return n instanceof At&&(n=n.value()),Yo(e,function(c,l){return l.func.apply(l.thisArg,di([c],l.args))},n)}function _a(t,e,n){var c=t.length;if(c<2)return c?mi(t[0]):[];for(var l=-1,d=T(c);++l<c;)for(var w=t[l],b=-1;++b<c;)b!=l&&(d[l]=Dn(d[l]||w,t[b],e,n));return mi(Ke(d,1),e,n)}function bu(t,e,n){for(var c=-1,l=t.length,d=e.length,w={};++c<l;){var b=c<d?e[c]:i;n(w,t[c],b)}return w}function ba(t){return be(t)?t:[]}function Ea(t){return typeof t=="function"?t:ar}function wi(t,e){return yt(t)?t:Ta(t,e)?[t]:Qu(Mt(t))}var Sd=Pt;function _i(t,e,n){var c=t.length;return n=n===i?c:n,!e&&n>=c?t:Ir(t,e,n)}var Eu=pf||function(t){return Ct.clearTimeout(t)};function Iu(t,e){if(e)return t.slice();var n=t.length,c=Vc?Vc(n):new t.constructor(n);return t.copy(c),c}function Ia(t){var e=new t.constructor(t.byteLength);return new Cs(e).set(new Cs(t)),e}function Od(t,e){var n=e?Ia(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Ad(t){var e=new t.constructor(t.source,yr.exec(t));return e.lastIndex=t.lastIndex,e}function Rd(t){return Tn?Yt(Tn.call(t)):{}}function Pu(t,e){var n=e?Ia(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Su(t,e){if(t!==e){var n=t!==i,c=t===null,l=t===t,d=dr(t),w=e!==i,b=e===null,A=e===e,z=dr(e);if(!b&&!z&&!d&&t>e||d&&w&&A&&!b&&!z||c&&w&&A||!n&&A||!l)return 1;if(!c&&!d&&!z&&t<e||z&&n&&l&&!c&&!d||b&&n&&l||!w&&l||!A)return-1}return 0}function Cd(t,e,n){for(var c=-1,l=t.criteria,d=e.criteria,w=l.length,b=n.length;++c<w;){var A=Su(l[c],d[c]);if(A){if(c>=b)return A;var z=n[c];return A*(z=="desc"?-1:1)}}return t.index-e.index}function Ou(t,e,n,c){for(var l=-1,d=t.length,w=n.length,b=-1,A=e.length,z=qe(d-w,0),M=T(A+z),K=!c;++b<A;)M[b]=e[b];for(;++l<w;)(K||l<d)&&(M[n[l]]=t[l]);for(;z--;)M[b++]=t[l++];return M}function Au(t,e,n,c){for(var l=-1,d=t.length,w=-1,b=n.length,A=-1,z=e.length,M=qe(d-b,0),K=T(M+z),G=!c;++l<M;)K[l]=t[l];for(var rt=l;++A<z;)K[rt+A]=e[A];for(;++w<b;)(G||l<d)&&(K[rt+n[w]]=t[l++]);return K}function nr(t,e){var n=-1,c=t.length;for(e||(e=T(c));++n<c;)e[n]=t[n];return e}function Kr(t,e,n,c){var l=!n;n||(n={});for(var d=-1,w=e.length;++d<w;){var b=e[d],A=c?c(n[b],t[b],b,n,t):i;A===i&&(A=t[b]),l?Jr(n,b,A):Nn(n,b,A)}return n}function xd(t,e){return Kr(t,xa(t),e)}function Td(t,e){return Kr(t,Uu(t),e)}function Vs(t,e){return function(n,c){var l=yt(n)?Lp:Zf,d=e?e():{};return l(n,t,ot(c,2),d)}}function cn(t){return Pt(function(e,n){var c=-1,l=n.length,d=l>1?n[l-1]:i,w=l>2?n[2]:i;for(d=t.length>3&&typeof d=="function"?(l--,d):i,w&&Ze(n[0],n[1],w)&&(d=l<3?i:d,l=1),e=Yt(e);++c<l;){var b=n[c];b&&t(e,b,c,d)}return e})}function Ru(t,e){return function(n,c){if(n==null)return n;if(!sr(n))return t(n,c);for(var l=n.length,d=e?l:-1,w=Yt(n);(e?d--:++d<l)&&c(w[d],d,w)!==!1;);return n}}function Cu(t){return function(e,n,c){for(var l=-1,d=Yt(e),w=c(e),b=w.length;b--;){var A=w[t?b:++l];if(n(d[A],A,d)===!1)break}return e}}function Nd(t,e,n){var c=e&tt,l=zn(t);function d(){var w=this&&this!==Ct&&this instanceof d?l:t;return w.apply(c?n:this,arguments)}return d}function xu(t){return function(e){e=Mt(e);var n=tn(e)?xr(e):i,c=n?n[0]:e.charAt(0),l=n?_i(n,1).join(""):e.slice(1);return c[t]()+l}}function un(t){return function(e){return Yo(Rh(Ah(e).replace(Pn,"")),t,"")}}function zn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=an(t.prototype),c=t.apply(n,e);return ue(c)?c:n}}function Dd(t,e,n){var c=zn(t);function l(){for(var d=arguments.length,w=T(d),b=d,A=hn(l);b--;)w[b]=arguments[b];var z=d<3&&w[0]!==A&&w[d-1]!==A?[]:gi(w,A);if(d-=z.length,d<n)return Lu(t,e,Ws,l.placeholder,i,w,z,i,i,n-d);var M=this&&this!==Ct&&this instanceof l?c:t;return Me(M,this,w)}return l}function Tu(t){return function(e,n,c){var l=Yt(e);if(!sr(e)){var d=ot(n,3);e=ke(e),n=function(b){return d(l[b],b,l)}}var w=t(e,n,c);return w>-1?l[d?e[w]:w]:i}}function Nu(t){return Zr(function(e){var n=e.length,c=n,l=br.prototype.thru;for(t&&e.reverse();c--;){var d=e[c];if(typeof d!="function")throw new _r(f);if(l&&!w&&Gs(d)=="wrapper")var w=new br([],!0)}for(c=w?c:n;++c<n;){d=e[c];var b=Gs(d),A=b=="wrapper"?Ra(d):i;A&&Na(A[0])&&A[1]==(H|ut|lt|Y)&&!A[4].length&&A[9]==1?w=w[Gs(A[0])].apply(w,A[3]):w=d.length==1&&Na(d)?w[b]():w.thru(d)}return function(){var z=arguments,M=z[0];if(w&&z.length==1&&yt(M))return w.plant(M).value();for(var K=0,G=n?e[K].apply(this,z):M;++K<n;)G=e[K].call(this,G);return G}})}function Ws(t,e,n,c,l,d,w,b,A,z){var M=e&H,K=e&tt,G=e&vt,rt=e&(ut|ht),at=e&wt,Et=G?i:zn(t);function ct(){for(var St=arguments.length,xt=T(St),gr=St;gr--;)xt[gr]=arguments[gr];if(rt)var tr=hn(ct),vr=Vp(xt,tr);if(c&&(xt=Ou(xt,c,l,rt)),d&&(xt=Au(xt,d,w,rt)),St-=vr,rt&&St<z){var Ee=gi(xt,tr);return Lu(t,e,Ws,ct.placeholder,n,xt,Ee,b,A,z-St)}var Dr=K?n:this,ii=G?Dr[t]:t;return St=xt.length,b?xt=Zd(xt,b):at&&St>1&&xt.reverse(),M&&A<St&&(xt.length=A),this&&this!==Ct&&this instanceof ct&&(ii=Et||zn(ii)),ii.apply(Dr,xt)}return ct}function Du(t,e){return function(n,c){return ad(n,t,e(c),{})}}function Bs(t,e){return function(n,c){var l;if(n===i&&c===i)return e;if(n!==i&&(l=n),c!==i){if(l===i)return c;typeof n=="string"||typeof c=="string"?(n=fr(n),c=fr(c)):(n=mu(n),c=mu(c)),l=t(n,c)}return l}}function Pa(t){return Zr(function(e){return e=ne(e,pr(ot())),Pt(function(n){var c=this;return t(e,function(l){return Me(l,c,n)})})})}function Fs(t,e){e=e===i?" ":fr(e);var n=e.length;if(n<2)return n?ya(e,t):e;var c=ya(e,Ds(t/en(e)));return tn(e)?_i(xr(c),0,t).join(""):c.slice(0,t)}function jd(t,e,n,c){var l=e&tt,d=zn(t);function w(){for(var b=-1,A=arguments.length,z=-1,M=c.length,K=T(M+A),G=this&&this!==Ct&&this instanceof w?d:t;++z<M;)K[z]=c[z];for(;A--;)K[z++]=arguments[++b];return Me(G,l?n:this,K)}return w}function ju(t){return function(e,n,c){return c&&typeof c!="number"&&Ze(e,n,c)&&(n=c=i),e=ri(e),n===i?(n=e,e=0):n=ri(n),c=c===i?e<n?1:-1:ri(c),wd(e,n,c,t)}}function Ys(t){return function(e,n){return typeof e=="string"&&typeof n=="string"||(e=Sr(e),n=Sr(n)),t(e,n)}}function Lu(t,e,n,c,l,d,w,b,A,z){var M=e&ut,K=M?w:i,G=M?i:w,rt=M?d:i,at=M?i:d;e|=M?lt:L,e&=~(M?L:lt),e&ft||(e&=~(tt|vt));var Et=[t,e,l,rt,K,at,G,b,A,z],ct=n.apply(i,Et);return Na(t)&&Fu(ct,Et),ct.placeholder=c,Yu(ct,t,e)}function Sa(t){var e=Le[t];return function(n,c){if(n=Sr(n),c=c==null?0:We(_t(c),292),c&&Yc(n)){var l=(Mt(n)+"e").split("e"),d=e(l[0]+"e"+(+l[1]+c));return l=(Mt(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return e(n)}}var Ld=sn&&1/Is(new sn([,-0]))[1]==dt?function(t){return new sn(t)}:Fa;function qu(t){return function(e){var n=Be(e);return n==bt?ea(e):n==zt?Jp(e):Kp(e,t(e))}}function Xr(t,e,n,c,l,d,w,b){var A=e&vt;if(!A&&typeof t!="function")throw new _r(f);var z=c?c.length:0;if(z||(e&=~(lt|L),c=l=i),w=w===i?w:qe(_t(w),0),b=b===i?b:_t(b),z-=l?l.length:0,e&L){var M=c,K=l;c=l=i}var G=A?i:Ra(t),rt=[t,e,n,c,l,M,K,d,w,b];if(G&&Qd(rt,G),t=rt[0],e=rt[1],n=rt[2],c=rt[3],l=rt[4],b=rt[9]=rt[9]===i?A?0:t.length:qe(rt[9]-z,0),!b&&e&(ut|ht)&&(e&=~(ut|ht)),!e||e==tt)var at=Nd(t,e,n);else e==ut||e==ht?at=Dd(t,e,b):(e==lt||e==(tt|lt))&&!l.length?at=jd(t,e,n,c):at=Ws.apply(i,rt);var Et=G?vu:Fu;return Yu(Et(at,rt),t,e)}function zu(t,e,n,c){return t===i||Nr(t,nn[n])&&!Ut.call(c,n)?e:t}function Mu(t,e,n,c,l,d){return ue(t)&&ue(e)&&(d.set(e,t),$s(t,e,i,Mu,d),d.delete(e)),t}function qd(t){return Un(t)?i:t}function ku(t,e,n,c,l,d){var w=n&x,b=t.length,A=e.length;if(b!=A&&!(w&&A>b))return!1;var z=d.get(t),M=d.get(e);if(z&&M)return z==e&&M==t;var K=-1,G=!0,rt=n&W?new Li:i;for(d.set(t,e),d.set(e,t);++K<b;){var at=t[K],Et=e[K];if(c)var ct=w?c(Et,at,K,e,t,d):c(at,Et,K,t,e,d);if(ct!==i){if(ct)continue;G=!1;break}if(rt){if(!Go(e,function(St,xt){if(!On(rt,xt)&&(at===St||l(at,St,n,c,d)))return rt.push(xt)})){G=!1;break}}else if(!(at===Et||l(at,Et,n,c,d))){G=!1;break}}return d.delete(t),d.delete(e),G}function zd(t,e,n,c,l,d,w){switch(n){case Vt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Nt:return!(t.byteLength!=e.byteLength||!d(new Cs(t),new Cs(e)));case D:case C:case Tt:return Nr(+t,+e);case E:return t.name==e.name&&t.message==e.message;case oe:case Jt:return t==e+"";case bt:var b=ea;case zt:var A=c&x;if(b||(b=Is),t.size!=e.size&&!A)return!1;var z=w.get(t);if(z)return z==e;c|=W,w.set(t,e);var M=ku(b(t),b(e),c,l,d,w);return w.delete(t),M;case Xt:if(Tn)return Tn.call(t)==Tn.call(e)}return!1}function Md(t,e,n,c,l,d){var w=n&x,b=Oa(t),A=b.length,z=Oa(e),M=z.length;if(A!=M&&!w)return!1;for(var K=A;K--;){var G=b[K];if(!(w?G in e:Ut.call(e,G)))return!1}var rt=d.get(t),at=d.get(e);if(rt&&at)return rt==e&&at==t;var Et=!0;d.set(t,e),d.set(e,t);for(var ct=w;++K<A;){G=b[K];var St=t[G],xt=e[G];if(c)var gr=w?c(xt,St,G,e,t,d):c(St,xt,G,t,e,d);if(!(gr===i?St===xt||l(St,xt,n,c,d):gr)){Et=!1;break}ct||(ct=G=="constructor")}if(Et&&!ct){var tr=t.constructor,vr=e.constructor;tr!=vr&&"constructor"in t&&"constructor"in e&&!(typeof tr=="function"&&tr instanceof tr&&typeof vr=="function"&&vr instanceof vr)&&(Et=!1)}return d.delete(t),d.delete(e),Et}function Zr(t){return ja(Wu(t,i,th),t+"")}function Oa(t){return su(t,ke,xa)}function Aa(t){return su(t,or,Uu)}var Ra=Ls?function(t){return Ls.get(t)}:Fa;function Gs(t){for(var e=t.name+"",n=on[e],c=Ut.call(on,e)?n.length:0;c--;){var l=n[c],d=l.func;if(d==null||d==t)return l.name}return e}function hn(t){var e=Ut.call(p,"placeholder")?p:t;return e.placeholder}function ot(){var t=p.iteratee||Wa;return t=t===Wa?cu:t,arguments.length?t(arguments[0],arguments[1]):t}function Qs(t,e){var n=t.__data__;return Bd(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Ca(t){for(var e=ke(t),n=e.length;n--;){var c=e[n],l=t[c];e[n]=[c,l,Ku(l)]}return e}function Mi(t,e){var n=Yp(t,e);return au(n)?n:i}function kd(t){var e=Ut.call(t,Di),n=t[Di];try{t[Di]=i;var c=!0}catch{}var l=As.call(t);return c&&(e?t[Di]=n:delete t[Di]),l}var xa=ia?function(t){return t==null?[]:(t=Yt(t),fi(ia(t),function(e){return Bc.call(t,e)}))}:Ya,Uu=ia?function(t){for(var e=[];t;)di(e,xa(t)),t=xs(t);return e}:Ya,Be=Xe;(na&&Be(new na(new ArrayBuffer(1)))!=Vt||Rn&&Be(new Rn)!=bt||sa&&Be(sa.resolve())!=Pe||sn&&Be(new sn)!=zt||Cn&&Be(new Cn)!=$t)&&(Be=function(t){var e=Xe(t),n=e==Ot?t.constructor:i,c=n?ki(n):"";if(c)switch(c){case bf:return Vt;case Ef:return bt;case If:return Pe;case Pf:return zt;case Sf:return $t}return e});function Ud(t,e,n){for(var c=-1,l=n.length;++c<l;){var d=n[c],w=d.size;switch(d.type){case"drop":t+=w;break;case"dropRight":e-=w;break;case"take":e=We(e,t+w);break;case"takeRight":t=qe(t,e-w);break}}return{start:t,end:e}}function $d(t){var e=t.match(Qt);return e?e[1].split(Ce):[]}function $u(t,e,n){e=wi(e,t);for(var c=-1,l=e.length,d=!1;++c<l;){var w=Vr(e[c]);if(!(d=t!=null&&n(t,w)))break;t=t[w]}return d||++c!=l?d:(l=t==null?0:t.length,!!l&&io(l)&&ti(w,l)&&(yt(t)||Ui(t)))}function Hd(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&Ut.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Hu(t){return typeof t.constructor=="function"&&!Mn(t)?an(xs(t)):{}}function Kd(t,e,n){var c=t.constructor;switch(e){case Nt:return Ia(t);case D:case C:return new c(+t);case Vt:return Od(t,n);case he:case kt:case Se:case je:case $e:case He:case ze:case Ge:case rr:return Pu(t,n);case bt:return new c;case Tt:case Jt:return new c(t);case oe:return Ad(t);case zt:return new c;case Xt:return Rd(t)}}function Vd(t,e){var n=e.length;if(!n)return t;var c=n-1;return e[c]=(n>1?"& ":"")+e[c],e=e.join(n>2?", ":" "),t.replace(ve,`{
/* [wrapped with `+e+`] */
`)}function Wd(t){return yt(t)||Ui(t)||!!(Fc&&t&&t[Fc])}function ti(t,e){var n=typeof t;return e=e??B,!!e&&(n=="number"||n!="symbol"&&Do.test(t))&&t>-1&&t%1==0&&t<e}function Ze(t,e,n){if(!ue(n))return!1;var c=typeof e;return(c=="number"?sr(n)&&ti(e,n.length):c=="string"&&e in n)?Nr(n[e],t):!1}function Ta(t,e){if(yt(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||dr(t)?!0:Oe.test(t)||!ie.test(t)||e!=null&&t in Yt(e)}function Bd(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Na(t){var e=Gs(t),n=p[e];if(typeof n!="function"||!(e in At.prototype))return!1;if(t===n)return!0;var c=Ra(n);return!!c&&t===c[0]}function Fd(t){return!!Kc&&Kc in t}var Yd=Ss?ei:Ga;function Mn(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||nn;return t===n}function Ku(t){return t===t&&!ue(t)}function Vu(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==i||t in Yt(n))}}function Gd(t){var e=eo(t,function(c){return n.size===y&&n.clear(),c}),n=e.cache;return e}function Qd(t,e){var n=t[1],c=e[1],l=n|c,d=l<(tt|vt|H),w=c==H&&n==ut||c==H&&n==Y&&t[7].length<=e[8]||c==(H|Y)&&e[7].length<=e[8]&&n==ut;if(!(d||w))return t;c&tt&&(t[2]=e[2],l|=n&tt?0:ft);var b=e[3];if(b){var A=t[3];t[3]=A?Ou(A,b,e[4]):b,t[4]=A?gi(t[3],I):e[4]}return b=e[5],b&&(A=t[5],t[5]=A?Au(A,b,e[6]):b,t[6]=A?gi(t[5],I):e[6]),b=e[7],b&&(t[7]=b),c&H&&(t[8]=t[8]==null?e[8]:We(t[8],e[8])),t[9]==null&&(t[9]=e[9]),t[0]=e[0],t[1]=l,t}function Jd(t){var e=[];if(t!=null)for(var n in Yt(t))e.push(n);return e}function Xd(t){return As.call(t)}function Wu(t,e,n){return e=qe(e===i?t.length-1:e,0),function(){for(var c=arguments,l=-1,d=qe(c.length-e,0),w=T(d);++l<d;)w[l]=c[e+l];l=-1;for(var b=T(e+1);++l<e;)b[l]=c[l];return b[e]=n(w),Me(t,this,b)}}function Bu(t,e){return e.length<2?t:zi(t,Ir(e,0,-1))}function Zd(t,e){for(var n=t.length,c=We(e.length,n),l=nr(t);c--;){var d=e[c];t[c]=ti(d,n)?l[d]:i}return t}function Da(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Fu=Gu(vu),kn=df||function(t,e){return Ct.setTimeout(t,e)},ja=Gu(Ed);function Yu(t,e,n){var c=e+"";return ja(t,Vd(c,tg($d(c),n)))}function Gu(t){var e=0,n=0;return function(){var c=mf(),l=qt-(c-n);if(n=c,l>0){if(++e>=Lt)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Js(t,e){var n=-1,c=t.length,l=c-1;for(e=e===i?c:e;++n<e;){var d=va(n,l),w=t[d];t[d]=t[n],t[n]=w}return t.length=e,t}var Qu=Gd(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Ae,function(n,c,l,d){e.push(l?d.replace(Ao,"$1"):c||n)}),e});function Vr(t){if(typeof t=="string"||dr(t))return t;var e=t+"";return e=="0"&&1/t==-dt?"-0":e}function ki(t){if(t!=null){try{return Os.call(t)}catch{}try{return t+""}catch{}}return""}function tg(t,e){return wr(Mr,function(n){var c="_."+n[0];e&n[1]&&!bs(t,c)&&t.push(c)}),t.sort()}function Ju(t){if(t instanceof At)return t.clone();var e=new br(t.__wrapped__,t.__chain__);return e.__actions__=nr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function eg(t,e,n){(n?Ze(t,e,n):e===i)?e=1:e=qe(_t(e),0);var c=t==null?0:t.length;if(!c||e<1)return[];for(var l=0,d=0,w=T(Ds(c/e));l<c;)w[d++]=Ir(t,l,l+=e);return w}function rg(t){for(var e=-1,n=t==null?0:t.length,c=0,l=[];++e<n;){var d=t[e];d&&(l[c++]=d)}return l}function ig(){var t=arguments.length;if(!t)return[];for(var e=T(t-1),n=arguments[0],c=t;c--;)e[c-1]=arguments[c];return di(yt(n)?nr(n):[n],Ke(e,1))}var ng=Pt(function(t,e){return be(t)?Dn(t,Ke(e,1,be,!0)):[]}),sg=Pt(function(t,e){var n=Pr(e);return be(n)&&(n=i),be(t)?Dn(t,Ke(e,1,be,!0),ot(n,2)):[]}),og=Pt(function(t,e){var n=Pr(e);return be(n)&&(n=i),be(t)?Dn(t,Ke(e,1,be,!0),i,n):[]});function ag(t,e,n){var c=t==null?0:t.length;return c?(e=n||e===i?1:_t(e),Ir(t,e<0?0:e,c)):[]}function cg(t,e,n){var c=t==null?0:t.length;return c?(e=n||e===i?1:_t(e),e=c-e,Ir(t,0,e<0?0:e)):[]}function ug(t,e){return t&&t.length?Ks(t,ot(e,3),!0,!0):[]}function hg(t,e){return t&&t.length?Ks(t,ot(e,3),!0):[]}function lg(t,e,n,c){var l=t==null?0:t.length;return l?(n&&typeof n!="number"&&Ze(t,e,n)&&(n=0,c=l),id(t,e,n,c)):[]}function Xu(t,e,n){var c=t==null?0:t.length;if(!c)return-1;var l=n==null?0:_t(n);return l<0&&(l=qe(c+l,0)),Es(t,ot(e,3),l)}function Zu(t,e,n){var c=t==null?0:t.length;if(!c)return-1;var l=c-1;return n!==i&&(l=_t(n),l=n<0?qe(c+l,0):We(l,c-1)),Es(t,ot(e,3),l,!0)}function th(t){var e=t==null?0:t.length;return e?Ke(t,1):[]}function pg(t){var e=t==null?0:t.length;return e?Ke(t,dt):[]}function fg(t,e){var n=t==null?0:t.length;return n?(e=e===i?1:_t(e),Ke(t,e)):[]}function dg(t){for(var e=-1,n=t==null?0:t.length,c={};++e<n;){var l=t[e];c[l[0]]=l[1]}return c}function eh(t){return t&&t.length?t[0]:i}function gg(t,e,n){var c=t==null?0:t.length;if(!c)return-1;var l=n==null?0:_t(n);return l<0&&(l=qe(c+l,0)),Zi(t,e,l)}function vg(t){var e=t==null?0:t.length;return e?Ir(t,0,-1):[]}var yg=Pt(function(t){var e=ne(t,ba);return e.length&&e[0]===t[0]?la(e):[]}),mg=Pt(function(t){var e=Pr(t),n=ne(t,ba);return e===Pr(n)?e=i:n.pop(),n.length&&n[0]===t[0]?la(n,ot(e,2)):[]}),wg=Pt(function(t){var e=Pr(t),n=ne(t,ba);return e=typeof e=="function"?e:i,e&&n.pop(),n.length&&n[0]===t[0]?la(n,i,e):[]});function _g(t,e){return t==null?"":vf.call(t,e)}function Pr(t){var e=t==null?0:t.length;return e?t[e-1]:i}function bg(t,e,n){var c=t==null?0:t.length;if(!c)return-1;var l=c;return n!==i&&(l=_t(n),l=l<0?qe(c+l,0):We(l,c-1)),e===e?Zp(t,e,l):Es(t,Lc,l,!0)}function Eg(t,e){return t&&t.length?pu(t,_t(e)):i}var Ig=Pt(rh);function rh(t,e){return t&&t.length&&e&&e.length?ga(t,e):t}function Pg(t,e,n){return t&&t.length&&e&&e.length?ga(t,e,ot(n,2)):t}function Sg(t,e,n){return t&&t.length&&e&&e.length?ga(t,e,i,n):t}var Og=Zr(function(t,e){var n=t==null?0:t.length,c=aa(t,e);return gu(t,ne(e,function(l){return ti(l,n)?+l:l}).sort(Su)),c});function Ag(t,e){var n=[];if(!(t&&t.length))return n;var c=-1,l=[],d=t.length;for(e=ot(e,3);++c<d;){var w=t[c];e(w,c,t)&&(n.push(w),l.push(c))}return gu(t,l),n}function La(t){return t==null?t:_f.call(t)}function Rg(t,e,n){var c=t==null?0:t.length;return c?(n&&typeof n!="number"&&Ze(t,e,n)?(e=0,n=c):(e=e==null?0:_t(e),n=n===i?c:_t(n)),Ir(t,e,n)):[]}function Cg(t,e){return Hs(t,e)}function xg(t,e,n){return ma(t,e,ot(n,2))}function Tg(t,e){var n=t==null?0:t.length;if(n){var c=Hs(t,e);if(c<n&&Nr(t[c],e))return c}return-1}function Ng(t,e){return Hs(t,e,!0)}function Dg(t,e,n){return ma(t,e,ot(n,2),!0)}function jg(t,e){var n=t==null?0:t.length;if(n){var c=Hs(t,e,!0)-1;if(Nr(t[c],e))return c}return-1}function Lg(t){return t&&t.length?yu(t):[]}function qg(t,e){return t&&t.length?yu(t,ot(e,2)):[]}function zg(t){var e=t==null?0:t.length;return e?Ir(t,1,e):[]}function Mg(t,e,n){return t&&t.length?(e=n||e===i?1:_t(e),Ir(t,0,e<0?0:e)):[]}function kg(t,e,n){var c=t==null?0:t.length;return c?(e=n||e===i?1:_t(e),e=c-e,Ir(t,e<0?0:e,c)):[]}function Ug(t,e){return t&&t.length?Ks(t,ot(e,3),!1,!0):[]}function $g(t,e){return t&&t.length?Ks(t,ot(e,3)):[]}var Hg=Pt(function(t){return mi(Ke(t,1,be,!0))}),Kg=Pt(function(t){var e=Pr(t);return be(e)&&(e=i),mi(Ke(t,1,be,!0),ot(e,2))}),Vg=Pt(function(t){var e=Pr(t);return e=typeof e=="function"?e:i,mi(Ke(t,1,be,!0),i,e)});function Wg(t){return t&&t.length?mi(t):[]}function Bg(t,e){return t&&t.length?mi(t,ot(e,2)):[]}function Fg(t,e){return e=typeof e=="function"?e:i,t&&t.length?mi(t,i,e):[]}function qa(t){if(!(t&&t.length))return[];var e=0;return t=fi(t,function(n){if(be(n))return e=qe(n.length,e),!0}),Zo(e,function(n){return ne(t,Qo(n))})}function ih(t,e){if(!(t&&t.length))return[];var n=qa(t);return e==null?n:ne(n,function(c){return Me(e,i,c)})}var Yg=Pt(function(t,e){return be(t)?Dn(t,e):[]}),Gg=Pt(function(t){return _a(fi(t,be))}),Qg=Pt(function(t){var e=Pr(t);return be(e)&&(e=i),_a(fi(t,be),ot(e,2))}),Jg=Pt(function(t){var e=Pr(t);return e=typeof e=="function"?e:i,_a(fi(t,be),i,e)}),Xg=Pt(qa);function Zg(t,e){return bu(t||[],e||[],Nn)}function tv(t,e){return bu(t||[],e||[],qn)}var ev=Pt(function(t){var e=t.length,n=e>1?t[e-1]:i;return n=typeof n=="function"?(t.pop(),n):i,ih(t,n)});function nh(t){var e=p(t);return e.__chain__=!0,e}function rv(t,e){return e(t),t}function Xs(t,e){return e(t)}var iv=Zr(function(t){var e=t.length,n=e?t[0]:0,c=this.__wrapped__,l=function(d){return aa(d,t)};return e>1||this.__actions__.length||!(c instanceof At)||!ti(n)?this.thru(l):(c=c.slice(n,+n+(e?1:0)),c.__actions__.push({func:Xs,args:[l],thisArg:i}),new br(c,this.__chain__).thru(function(d){return e&&!d.length&&d.push(i),d}))});function nv(){return nh(this)}function sv(){return new br(this.value(),this.__chain__)}function ov(){this.__values__===i&&(this.__values__=mh(this.value()));var t=this.__index__>=this.__values__.length,e=t?i:this.__values__[this.__index__++];return{done:t,value:e}}function av(){return this}function cv(t){for(var e,n=this;n instanceof zs;){var c=Ju(n);c.__index__=0,c.__values__=i,e?l.__wrapped__=c:e=c;var l=c;n=n.__wrapped__}return l.__wrapped__=t,e}function uv(){var t=this.__wrapped__;if(t instanceof At){var e=t;return this.__actions__.length&&(e=new At(this)),e=e.reverse(),e.__actions__.push({func:Xs,args:[La],thisArg:i}),new br(e,this.__chain__)}return this.thru(La)}function hv(){return _u(this.__wrapped__,this.__actions__)}var lv=Vs(function(t,e,n){Ut.call(t,n)?++t[n]:Jr(t,n,1)});function pv(t,e,n){var c=yt(t)?Dc:rd;return n&&Ze(t,e,n)&&(e=i),c(t,ot(e,3))}function fv(t,e){var n=yt(t)?fi:iu;return n(t,ot(e,3))}var dv=Tu(Xu),gv=Tu(Zu);function vv(t,e){return Ke(Zs(t,e),1)}function yv(t,e){return Ke(Zs(t,e),dt)}function mv(t,e,n){return n=n===i?1:_t(n),Ke(Zs(t,e),n)}function sh(t,e){var n=yt(t)?wr:yi;return n(t,ot(e,3))}function oh(t,e){var n=yt(t)?qp:ru;return n(t,ot(e,3))}var wv=Vs(function(t,e,n){Ut.call(t,n)?t[n].push(e):Jr(t,n,[e])});function _v(t,e,n,c){t=sr(t)?t:pn(t),n=n&&!c?_t(n):0;var l=t.length;return n<0&&(n=qe(l+n,0)),no(t)?n<=l&&t.indexOf(e,n)>-1:!!l&&Zi(t,e,n)>-1}var bv=Pt(function(t,e,n){var c=-1,l=typeof e=="function",d=sr(t)?T(t.length):[];return yi(t,function(w){d[++c]=l?Me(e,w,n):jn(w,e,n)}),d}),Ev=Vs(function(t,e,n){Jr(t,n,e)});function Zs(t,e){var n=yt(t)?ne:uu;return n(t,ot(e,3))}function Iv(t,e,n,c){return t==null?[]:(yt(e)||(e=e==null?[]:[e]),n=c?i:n,yt(n)||(n=n==null?[]:[n]),fu(t,e,n))}var Pv=Vs(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});function Sv(t,e,n){var c=yt(t)?Yo:zc,l=arguments.length<3;return c(t,ot(e,4),n,l,yi)}function Ov(t,e,n){var c=yt(t)?zp:zc,l=arguments.length<3;return c(t,ot(e,4),n,l,ru)}function Av(t,e){var n=yt(t)?fi:iu;return n(t,ro(ot(e,3)))}function Rv(t){var e=yt(t)?Xc:_d;return e(t)}function Cv(t,e,n){(n?Ze(t,e,n):e===i)?e=1:e=_t(e);var c=yt(t)?Jf:bd;return c(t,e)}function xv(t){var e=yt(t)?Xf:Id;return e(t)}function Tv(t){if(t==null)return 0;if(sr(t))return no(t)?en(t):t.length;var e=Be(t);return e==bt||e==zt?t.size:fa(t).length}function Nv(t,e,n){var c=yt(t)?Go:Pd;return n&&Ze(t,e,n)&&(e=i),c(t,ot(e,3))}var Dv=Pt(function(t,e){if(t==null)return[];var n=e.length;return n>1&&Ze(t,e[0],e[1])?e=[]:n>2&&Ze(e[0],e[1],e[2])&&(e=[e[0]]),fu(t,Ke(e,1),[])}),to=ff||function(){return Ct.Date.now()};function jv(t,e){if(typeof e!="function")throw new _r(f);return t=_t(t),function(){if(--t<1)return e.apply(this,arguments)}}function ah(t,e,n){return e=n?i:e,e=t&&e==null?t.length:e,Xr(t,H,i,i,i,i,e)}function ch(t,e){var n;if(typeof e!="function")throw new _r(f);return t=_t(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var za=Pt(function(t,e,n){var c=tt;if(n.length){var l=gi(n,hn(za));c|=lt}return Xr(t,c,e,n,l)}),uh=Pt(function(t,e,n){var c=tt|vt;if(n.length){var l=gi(n,hn(uh));c|=lt}return Xr(e,c,t,n,l)});function hh(t,e,n){e=n?i:e;var c=Xr(t,ut,i,i,i,i,i,e);return c.placeholder=hh.placeholder,c}function lh(t,e,n){e=n?i:e;var c=Xr(t,ht,i,i,i,i,i,e);return c.placeholder=lh.placeholder,c}function ph(t,e,n){var c,l,d,w,b,A,z=0,M=!1,K=!1,G=!0;if(typeof t!="function")throw new _r(f);e=Sr(e)||0,ue(n)&&(M=!!n.leading,K="maxWait"in n,d=K?qe(Sr(n.maxWait)||0,e):d,G="trailing"in n?!!n.trailing:G);function rt(Ee){var Dr=c,ii=l;return c=l=i,z=Ee,w=t.apply(ii,Dr),w}function at(Ee){return z=Ee,b=kn(St,e),M?rt(Ee):w}function Et(Ee){var Dr=Ee-A,ii=Ee-z,Th=e-Dr;return K?We(Th,d-ii):Th}function ct(Ee){var Dr=Ee-A,ii=Ee-z;return A===i||Dr>=e||Dr<0||K&&ii>=d}function St(){var Ee=to();if(ct(Ee))return xt(Ee);b=kn(St,Et(Ee))}function xt(Ee){return b=i,G&&c?rt(Ee):(c=l=i,w)}function gr(){b!==i&&Eu(b),z=0,c=A=l=b=i}function tr(){return b===i?w:xt(to())}function vr(){var Ee=to(),Dr=ct(Ee);if(c=arguments,l=this,A=Ee,Dr){if(b===i)return at(A);if(K)return Eu(b),b=kn(St,e),rt(A)}return b===i&&(b=kn(St,e)),w}return vr.cancel=gr,vr.flush=tr,vr}var Lv=Pt(function(t,e){return eu(t,1,e)}),qv=Pt(function(t,e,n){return eu(t,Sr(e)||0,n)});function zv(t){return Xr(t,wt)}function eo(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new _r(f);var n=function(){var c=arguments,l=e?e.apply(this,c):c[0],d=n.cache;if(d.has(l))return d.get(l);var w=t.apply(this,c);return n.cache=d.set(l,w)||d,w};return n.cache=new(eo.Cache||Qr),n}eo.Cache=Qr;function ro(t){if(typeof t!="function")throw new _r(f);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Mv(t){return ch(2,t)}var kv=Sd(function(t,e){e=e.length==1&&yt(e[0])?ne(e[0],pr(ot())):ne(Ke(e,1),pr(ot()));var n=e.length;return Pt(function(c){for(var l=-1,d=We(c.length,n);++l<d;)c[l]=e[l].call(this,c[l]);return Me(t,this,c)})}),Ma=Pt(function(t,e){var n=gi(e,hn(Ma));return Xr(t,lt,i,e,n)}),fh=Pt(function(t,e){var n=gi(e,hn(fh));return Xr(t,L,i,e,n)}),Uv=Zr(function(t,e){return Xr(t,Y,i,i,i,e)});function $v(t,e){if(typeof t!="function")throw new _r(f);return e=e===i?e:_t(e),Pt(t,e)}function Hv(t,e){if(typeof t!="function")throw new _r(f);return e=e==null?0:qe(_t(e),0),Pt(function(n){var c=n[e],l=_i(n,0,e);return c&&di(l,c),Me(t,this,l)})}function Kv(t,e,n){var c=!0,l=!0;if(typeof t!="function")throw new _r(f);return ue(n)&&(c="leading"in n?!!n.leading:c,l="trailing"in n?!!n.trailing:l),ph(t,e,{leading:c,maxWait:e,trailing:l})}function Vv(t){return ah(t,1)}function Wv(t,e){return Ma(Ea(e),t)}function Bv(){if(!arguments.length)return[];var t=arguments[0];return yt(t)?t:[t]}function Fv(t){return Er(t,k)}function Yv(t,e){return e=typeof e=="function"?e:i,Er(t,k,e)}function Gv(t){return Er(t,R|k)}function Qv(t,e){return e=typeof e=="function"?e:i,Er(t,R|k,e)}function Jv(t,e){return e==null||tu(t,e,ke(e))}function Nr(t,e){return t===e||t!==t&&e!==e}var Xv=Ys(ha),Zv=Ys(function(t,e){return t>=e}),Ui=ou(function(){return arguments}())?ou:function(t){return ye(t)&&Ut.call(t,"callee")&&!Bc.call(t,"callee")},yt=T.isArray,ty=Je?pr(Je):cd;function sr(t){return t!=null&&io(t.length)&&!ei(t)}function be(t){return ye(t)&&sr(t)}function ey(t){return t===!0||t===!1||ye(t)&&Xe(t)==D}var bi=gf||Ga,ry=Cr?pr(Cr):ud;function iy(t){return ye(t)&&t.nodeType===1&&!Un(t)}function ny(t){if(t==null)return!0;if(sr(t)&&(yt(t)||typeof t=="string"||typeof t.splice=="function"||bi(t)||ln(t)||Ui(t)))return!t.length;var e=Be(t);if(e==bt||e==zt)return!t.size;if(Mn(t))return!fa(t).length;for(var n in t)if(Ut.call(t,n))return!1;return!0}function sy(t,e){return Ln(t,e)}function oy(t,e,n){n=typeof n=="function"?n:i;var c=n?n(t,e):i;return c===i?Ln(t,e,i,n):!!c}function ka(t){if(!ye(t))return!1;var e=Xe(t);return e==E||e==u||typeof t.message=="string"&&typeof t.name=="string"&&!Un(t)}function ay(t){return typeof t=="number"&&Yc(t)}function ei(t){if(!ue(t))return!1;var e=Xe(t);return e==et||e==pt||e==j||e==me}function dh(t){return typeof t=="number"&&t==_t(t)}function io(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=B}function ue(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function ye(t){return t!=null&&typeof t=="object"}var gh=mr?pr(mr):ld;function cy(t,e){return t===e||pa(t,e,Ca(e))}function uy(t,e,n){return n=typeof n=="function"?n:i,pa(t,e,Ca(e),n)}function hy(t){return vh(t)&&t!=+t}function ly(t){if(Yd(t))throw new gt(h);return au(t)}function py(t){return t===null}function fy(t){return t==null}function vh(t){return typeof t=="number"||ye(t)&&Xe(t)==Tt}function Un(t){if(!ye(t)||Xe(t)!=Ot)return!1;var e=xs(t);if(e===null)return!0;var n=Ut.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Os.call(n)==uf}var Ua=$r?pr($r):pd;function dy(t){return dh(t)&&t>=-B&&t<=B}var yh=Sn?pr(Sn):fd;function no(t){return typeof t=="string"||!yt(t)&&ye(t)&&Xe(t)==Jt}function dr(t){return typeof t=="symbol"||ye(t)&&Xe(t)==Xt}var ln=Ni?pr(Ni):dd;function gy(t){return t===i}function vy(t){return ye(t)&&Be(t)==$t}function yy(t){return ye(t)&&Xe(t)==Zt}var my=Ys(da),wy=Ys(function(t,e){return t<=e});function mh(t){if(!t)return[];if(sr(t))return no(t)?xr(t):nr(t);if(An&&t[An])return Qp(t[An]());var e=Be(t),n=e==bt?ea:e==zt?Is:pn;return n(t)}function ri(t){if(!t)return t===0?t:0;if(t=Sr(t),t===dt||t===-dt){var e=t<0?-1:1;return e*$}return t===t?t:0}function _t(t){var e=ri(t),n=e%1;return e===e?n?e-n:e:0}function wh(t){return t?qi(_t(t),0,F):0}function Sr(t){if(typeof t=="number")return t;if(dr(t))return V;if(ue(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ue(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Mc(t);var n=xo.test(t);return n||No.test(t)?mt(t.slice(2),n?2:8):Co.test(t)?V:+t}function _h(t){return Kr(t,or(t))}function _y(t){return t?qi(_t(t),-B,B):t===0?t:0}function Mt(t){return t==null?"":fr(t)}var by=cn(function(t,e){if(Mn(e)||sr(e)){Kr(e,ke(e),t);return}for(var n in e)Ut.call(e,n)&&Nn(t,n,e[n])}),bh=cn(function(t,e){Kr(e,or(e),t)}),so=cn(function(t,e,n,c){Kr(e,or(e),t,c)}),Ey=cn(function(t,e,n,c){Kr(e,ke(e),t,c)}),Iy=Zr(aa);function Py(t,e){var n=an(t);return e==null?n:Zc(n,e)}var Sy=Pt(function(t,e){t=Yt(t);var n=-1,c=e.length,l=c>2?e[2]:i;for(l&&Ze(e[0],e[1],l)&&(c=1);++n<c;)for(var d=e[n],w=or(d),b=-1,A=w.length;++b<A;){var z=w[b],M=t[z];(M===i||Nr(M,nn[z])&&!Ut.call(t,z))&&(t[z]=d[z])}return t}),Oy=Pt(function(t){return t.push(i,Mu),Me(Eh,i,t)});function Ay(t,e){return jc(t,ot(e,3),Hr)}function Ry(t,e){return jc(t,ot(e,3),ua)}function Cy(t,e){return t==null?t:ca(t,ot(e,3),or)}function xy(t,e){return t==null?t:nu(t,ot(e,3),or)}function Ty(t,e){return t&&Hr(t,ot(e,3))}function Ny(t,e){return t&&ua(t,ot(e,3))}function Dy(t){return t==null?[]:Us(t,ke(t))}function jy(t){return t==null?[]:Us(t,or(t))}function $a(t,e,n){var c=t==null?i:zi(t,e);return c===i?n:c}function Ly(t,e){return t!=null&&$u(t,e,nd)}function Ha(t,e){return t!=null&&$u(t,e,sd)}var qy=Du(function(t,e,n){e!=null&&typeof e.toString!="function"&&(e=As.call(e)),t[e]=n},Va(ar)),zy=Du(function(t,e,n){e!=null&&typeof e.toString!="function"&&(e=As.call(e)),Ut.call(t,e)?t[e].push(n):t[e]=[n]},ot),My=Pt(jn);function ke(t){return sr(t)?Jc(t):fa(t)}function or(t){return sr(t)?Jc(t,!0):gd(t)}function ky(t,e){var n={};return e=ot(e,3),Hr(t,function(c,l,d){Jr(n,e(c,l,d),c)}),n}function Uy(t,e){var n={};return e=ot(e,3),Hr(t,function(c,l,d){Jr(n,l,e(c,l,d))}),n}var $y=cn(function(t,e,n){$s(t,e,n)}),Eh=cn(function(t,e,n,c){$s(t,e,n,c)}),Hy=Zr(function(t,e){var n={};if(t==null)return n;var c=!1;e=ne(e,function(d){return d=wi(d,t),c||(c=d.length>1),d}),Kr(t,Aa(t),n),c&&(n=Er(n,R|N|k,qd));for(var l=e.length;l--;)wa(n,e[l]);return n});function Ky(t,e){return Ih(t,ro(ot(e)))}var Vy=Zr(function(t,e){return t==null?{}:yd(t,e)});function Ih(t,e){if(t==null)return{};var n=ne(Aa(t),function(c){return[c]});return e=ot(e),du(t,n,function(c,l){return e(c,l[0])})}function Wy(t,e,n){e=wi(e,t);var c=-1,l=e.length;for(l||(l=1,t=i);++c<l;){var d=t==null?i:t[Vr(e[c])];d===i&&(c=l,d=n),t=ei(d)?d.call(t):d}return t}function By(t,e,n){return t==null?t:qn(t,e,n)}function Fy(t,e,n,c){return c=typeof c=="function"?c:i,t==null?t:qn(t,e,n,c)}var Ph=qu(ke),Sh=qu(or);function Yy(t,e,n){var c=yt(t),l=c||bi(t)||ln(t);if(e=ot(e,4),n==null){var d=t&&t.constructor;l?n=c?new d:[]:ue(t)?n=ei(d)?an(xs(t)):{}:n={}}return(l?wr:Hr)(t,function(w,b,A){return e(n,w,b,A)}),n}function Gy(t,e){return t==null?!0:wa(t,e)}function Qy(t,e,n){return t==null?t:wu(t,e,Ea(n))}function Jy(t,e,n,c){return c=typeof c=="function"?c:i,t==null?t:wu(t,e,Ea(n),c)}function pn(t){return t==null?[]:ta(t,ke(t))}function Xy(t){return t==null?[]:ta(t,or(t))}function Zy(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=Sr(n),n=n===n?n:0),e!==i&&(e=Sr(e),e=e===e?e:0),qi(Sr(t),e,n)}function tm(t,e,n){return e=ri(e),n===i?(n=e,e=0):n=ri(n),t=Sr(t),od(t,e,n)}function em(t,e,n){if(n&&typeof n!="boolean"&&Ze(t,e,n)&&(e=n=i),n===i&&(typeof e=="boolean"?(n=e,e=i):typeof t=="boolean"&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ri(t),e===i?(e=t,t=0):e=ri(e)),t>e){var c=t;t=e,e=c}if(n||t%1||e%1){var l=Gc();return We(t+l*(e-t+Bt("1e-"+((l+"").length-1))),e)}return va(t,e)}var rm=un(function(t,e,n){return e=e.toLowerCase(),t+(n?Oh(e):e)});function Oh(t){return Ka(Mt(t).toLowerCase())}function Ah(t){return t=Mt(t),t&&t.replace(Fr,Wp).replace(Wo,"")}function im(t,e,n){t=Mt(t),e=fr(e);var c=t.length;n=n===i?c:qi(_t(n),0,c);var l=n;return n-=e.length,n>=0&&t.slice(n,l)==e}function nm(t){return t=Mt(t),t&&re.test(t)?t.replace(Ai,Bp):t}function sm(t){return t=Mt(t),t&&Re.test(t)?t.replace(de,"\\$&"):t}var om=un(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),am=un(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),cm=xu("toLowerCase");function um(t,e,n){t=Mt(t),e=_t(e);var c=e?en(t):0;if(!e||c>=e)return t;var l=(e-c)/2;return Fs(js(l),n)+t+Fs(Ds(l),n)}function hm(t,e,n){t=Mt(t),e=_t(e);var c=e?en(t):0;return e&&c<e?t+Fs(e-c,n):t}function lm(t,e,n){t=Mt(t),e=_t(e);var c=e?en(t):0;return e&&c<e?Fs(e-c,n)+t:t}function pm(t,e,n){return n||e==null?e=0:e&&(e=+e),wf(Mt(t).replace(ge,""),e||0)}function fm(t,e,n){return(n?Ze(t,e,n):e===i)?e=1:e=_t(e),ya(Mt(t),e)}function dm(){var t=arguments,e=Mt(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var gm=un(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});function vm(t,e,n){return n&&typeof n!="number"&&Ze(t,e,n)&&(e=n=i),n=n===i?F:n>>>0,n?(t=Mt(t),t&&(typeof e=="string"||e!=null&&!Ua(e))&&(e=fr(e),!e&&tn(t))?_i(xr(t),0,n):t.split(e,n)):[]}var ym=un(function(t,e,n){return t+(n?" ":"")+Ka(e)});function mm(t,e,n){return t=Mt(t),n=n==null?0:qi(_t(n),0,t.length),e=fr(e),t.slice(n,n+e.length)==e}function wm(t,e,n){var c=p.templateSettings;n&&Ze(t,e,n)&&(e=i),t=Mt(t),e=so({},e,c,zu);var l=so({},e.imports,c.imports,zu),d=ke(l),w=ta(l,d),b,A,z=0,M=e.interpolate||Bi,K="__p += '",G=ra((e.escape||Bi).source+"|"+M.source+"|"+(M===ce?Ro:Bi).source+"|"+(e.evaluate||Bi).source+"|$","g"),rt="//# sourceURL="+(Ut.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Bo+"]")+`
`;t.replace(G,function(ct,St,xt,gr,tr,vr){return xt||(xt=gr),K+=t.slice(z,vr).replace(jo,Fp),St&&(b=!0,K+=`' +
__e(`+St+`) +
'`),tr&&(A=!0,K+=`';
`+tr+`;
__p += '`),xt&&(K+=`' +
((__t = (`+xt+`)) == null ? '' : __t) +
'`),z=vr+ct.length,ct}),K+=`';
`;var at=Ut.call(e,"variable")&&e.variable;if(!at)K=`with (obj) {
`+K+`
}
`;else if(Oo.test(at))throw new gt(g);K=(A?K.replace(kr,""):K).replace(Qe,"$1").replace(Br,"$1;"),K="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Et=Ch(function(){return jt(d,rt+"return "+K).apply(i,w)});if(Et.source=K,ka(Et))throw Et;return Et}function _m(t){return Mt(t).toLowerCase()}function bm(t){return Mt(t).toUpperCase()}function Em(t,e,n){if(t=Mt(t),t&&(n||e===i))return Mc(t);if(!t||!(e=fr(e)))return t;var c=xr(t),l=xr(e),d=kc(c,l),w=Uc(c,l)+1;return _i(c,d,w).join("")}function Im(t,e,n){if(t=Mt(t),t&&(n||e===i))return t.slice(0,Hc(t)+1);if(!t||!(e=fr(e)))return t;var c=xr(t),l=Uc(c,xr(e))+1;return _i(c,0,l).join("")}function Pm(t,e,n){if(t=Mt(t),t&&(n||e===i))return t.replace(ge,"");if(!t||!(e=fr(e)))return t;var c=xr(t),l=kc(c,xr(e));return _i(c,l).join("")}function Sm(t,e){var n=it,c=nt;if(ue(e)){var l="separator"in e?e.separator:l;n="length"in e?_t(e.length):n,c="omission"in e?fr(e.omission):c}t=Mt(t);var d=t.length;if(tn(t)){var w=xr(t);d=w.length}if(n>=d)return t;var b=n-en(c);if(b<1)return c;var A=w?_i(w,0,b).join(""):t.slice(0,b);if(l===i)return A+c;if(w&&(b+=A.length-b),Ua(l)){if(t.slice(b).search(l)){var z,M=A;for(l.global||(l=ra(l.source,Mt(yr.exec(l))+"g")),l.lastIndex=0;z=l.exec(M);)var K=z.index;A=A.slice(0,K===i?b:K)}}else if(t.indexOf(fr(l),b)!=b){var G=A.lastIndexOf(l);G>-1&&(A=A.slice(0,G))}return A+c}function Om(t){return t=Mt(t),t&&le.test(t)?t.replace(li,tf):t}var Am=un(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Ka=xu("toUpperCase");function Rh(t,e,n){return t=Mt(t),e=n?i:e,e===i?Gp(t)?nf(t):Up(t):t.match(e)||[]}var Ch=Pt(function(t,e){try{return Me(t,i,e)}catch(n){return ka(n)?n:new gt(n)}}),Rm=Zr(function(t,e){return wr(e,function(n){n=Vr(n),Jr(t,n,za(t[n],t))}),t});function Cm(t){var e=t==null?0:t.length,n=ot();return t=e?ne(t,function(c){if(typeof c[1]!="function")throw new _r(f);return[n(c[0]),c[1]]}):[],Pt(function(c){for(var l=-1;++l<e;){var d=t[l];if(Me(d[0],this,c))return Me(d[1],this,c)}})}function xm(t){return ed(Er(t,R))}function Va(t){return function(){return t}}function Tm(t,e){return t==null||t!==t?e:t}var Nm=Nu(),Dm=Nu(!0);function ar(t){return t}function Wa(t){return cu(typeof t=="function"?t:Er(t,R))}function jm(t){return hu(Er(t,R))}function Lm(t,e){return lu(t,Er(e,R))}var qm=Pt(function(t,e){return function(n){return jn(n,t,e)}}),zm=Pt(function(t,e){return function(n){return jn(t,n,e)}});function Ba(t,e,n){var c=ke(e),l=Us(e,c);n==null&&!(ue(e)&&(l.length||!c.length))&&(n=e,e=t,t=this,l=Us(e,ke(e)));var d=!(ue(n)&&"chain"in n)||!!n.chain,w=ei(t);return wr(l,function(b){var A=e[b];t[b]=A,w&&(t.prototype[b]=function(){var z=this.__chain__;if(d||z){var M=t(this.__wrapped__),K=M.__actions__=nr(this.__actions__);return K.push({func:A,args:arguments,thisArg:t}),M.__chain__=z,M}return A.apply(t,di([this.value()],arguments))})}),t}function Mm(){return Ct._===this&&(Ct._=hf),this}function Fa(){}function km(t){return t=_t(t),Pt(function(e){return pu(e,t)})}var Um=Pa(ne),$m=Pa(Dc),Hm=Pa(Go);function xh(t){return Ta(t)?Qo(Vr(t)):md(t)}function Km(t){return function(e){return t==null?i:zi(t,e)}}var Vm=ju(),Wm=ju(!0);function Ya(){return[]}function Ga(){return!1}function Bm(){return{}}function Fm(){return""}function Ym(){return!0}function Gm(t,e){if(t=_t(t),t<1||t>B)return[];var n=F,c=We(t,F);e=ot(e),t-=F;for(var l=Zo(c,e);++n<t;)e(n);return l}function Qm(t){return yt(t)?ne(t,Vr):dr(t)?[t]:nr(Qu(Mt(t)))}function Jm(t){var e=++cf;return Mt(t)+e}var Xm=Bs(function(t,e){return t+e},0),Zm=Sa("ceil"),tw=Bs(function(t,e){return t/e},1),ew=Sa("floor");function rw(t){return t&&t.length?ks(t,ar,ha):i}function iw(t,e){return t&&t.length?ks(t,ot(e,2),ha):i}function nw(t){return qc(t,ar)}function sw(t,e){return qc(t,ot(e,2))}function ow(t){return t&&t.length?ks(t,ar,da):i}function aw(t,e){return t&&t.length?ks(t,ot(e,2),da):i}var cw=Bs(function(t,e){return t*e},1),uw=Sa("round"),hw=Bs(function(t,e){return t-e},0);function lw(t){return t&&t.length?Xo(t,ar):0}function pw(t,e){return t&&t.length?Xo(t,ot(e,2)):0}return p.after=jv,p.ary=ah,p.assign=by,p.assignIn=bh,p.assignInWith=so,p.assignWith=Ey,p.at=Iy,p.before=ch,p.bind=za,p.bindAll=Rm,p.bindKey=uh,p.castArray=Bv,p.chain=nh,p.chunk=eg,p.compact=rg,p.concat=ig,p.cond=Cm,p.conforms=xm,p.constant=Va,p.countBy=lv,p.create=Py,p.curry=hh,p.curryRight=lh,p.debounce=ph,p.defaults=Sy,p.defaultsDeep=Oy,p.defer=Lv,p.delay=qv,p.difference=ng,p.differenceBy=sg,p.differenceWith=og,p.drop=ag,p.dropRight=cg,p.dropRightWhile=ug,p.dropWhile=hg,p.fill=lg,p.filter=fv,p.flatMap=vv,p.flatMapDeep=yv,p.flatMapDepth=mv,p.flatten=th,p.flattenDeep=pg,p.flattenDepth=fg,p.flip=zv,p.flow=Nm,p.flowRight=Dm,p.fromPairs=dg,p.functions=Dy,p.functionsIn=jy,p.groupBy=wv,p.initial=vg,p.intersection=yg,p.intersectionBy=mg,p.intersectionWith=wg,p.invert=qy,p.invertBy=zy,p.invokeMap=bv,p.iteratee=Wa,p.keyBy=Ev,p.keys=ke,p.keysIn=or,p.map=Zs,p.mapKeys=ky,p.mapValues=Uy,p.matches=jm,p.matchesProperty=Lm,p.memoize=eo,p.merge=$y,p.mergeWith=Eh,p.method=qm,p.methodOf=zm,p.mixin=Ba,p.negate=ro,p.nthArg=km,p.omit=Hy,p.omitBy=Ky,p.once=Mv,p.orderBy=Iv,p.over=Um,p.overArgs=kv,p.overEvery=$m,p.overSome=Hm,p.partial=Ma,p.partialRight=fh,p.partition=Pv,p.pick=Vy,p.pickBy=Ih,p.property=xh,p.propertyOf=Km,p.pull=Ig,p.pullAll=rh,p.pullAllBy=Pg,p.pullAllWith=Sg,p.pullAt=Og,p.range=Vm,p.rangeRight=Wm,p.rearg=Uv,p.reject=Av,p.remove=Ag,p.rest=$v,p.reverse=La,p.sampleSize=Cv,p.set=By,p.setWith=Fy,p.shuffle=xv,p.slice=Rg,p.sortBy=Dv,p.sortedUniq=Lg,p.sortedUniqBy=qg,p.split=vm,p.spread=Hv,p.tail=zg,p.take=Mg,p.takeRight=kg,p.takeRightWhile=Ug,p.takeWhile=$g,p.tap=rv,p.throttle=Kv,p.thru=Xs,p.toArray=mh,p.toPairs=Ph,p.toPairsIn=Sh,p.toPath=Qm,p.toPlainObject=_h,p.transform=Yy,p.unary=Vv,p.union=Hg,p.unionBy=Kg,p.unionWith=Vg,p.uniq=Wg,p.uniqBy=Bg,p.uniqWith=Fg,p.unset=Gy,p.unzip=qa,p.unzipWith=ih,p.update=Qy,p.updateWith=Jy,p.values=pn,p.valuesIn=Xy,p.without=Yg,p.words=Rh,p.wrap=Wv,p.xor=Gg,p.xorBy=Qg,p.xorWith=Jg,p.zip=Xg,p.zipObject=Zg,p.zipObjectDeep=tv,p.zipWith=ev,p.entries=Ph,p.entriesIn=Sh,p.extend=bh,p.extendWith=so,Ba(p,p),p.add=Xm,p.attempt=Ch,p.camelCase=rm,p.capitalize=Oh,p.ceil=Zm,p.clamp=Zy,p.clone=Fv,p.cloneDeep=Gv,p.cloneDeepWith=Qv,p.cloneWith=Yv,p.conformsTo=Jv,p.deburr=Ah,p.defaultTo=Tm,p.divide=tw,p.endsWith=im,p.eq=Nr,p.escape=nm,p.escapeRegExp=sm,p.every=pv,p.find=dv,p.findIndex=Xu,p.findKey=Ay,p.findLast=gv,p.findLastIndex=Zu,p.findLastKey=Ry,p.floor=ew,p.forEach=sh,p.forEachRight=oh,p.forIn=Cy,p.forInRight=xy,p.forOwn=Ty,p.forOwnRight=Ny,p.get=$a,p.gt=Xv,p.gte=Zv,p.has=Ly,p.hasIn=Ha,p.head=eh,p.identity=ar,p.includes=_v,p.indexOf=gg,p.inRange=tm,p.invoke=My,p.isArguments=Ui,p.isArray=yt,p.isArrayBuffer=ty,p.isArrayLike=sr,p.isArrayLikeObject=be,p.isBoolean=ey,p.isBuffer=bi,p.isDate=ry,p.isElement=iy,p.isEmpty=ny,p.isEqual=sy,p.isEqualWith=oy,p.isError=ka,p.isFinite=ay,p.isFunction=ei,p.isInteger=dh,p.isLength=io,p.isMap=gh,p.isMatch=cy,p.isMatchWith=uy,p.isNaN=hy,p.isNative=ly,p.isNil=fy,p.isNull=py,p.isNumber=vh,p.isObject=ue,p.isObjectLike=ye,p.isPlainObject=Un,p.isRegExp=Ua,p.isSafeInteger=dy,p.isSet=yh,p.isString=no,p.isSymbol=dr,p.isTypedArray=ln,p.isUndefined=gy,p.isWeakMap=vy,p.isWeakSet=yy,p.join=_g,p.kebabCase=om,p.last=Pr,p.lastIndexOf=bg,p.lowerCase=am,p.lowerFirst=cm,p.lt=my,p.lte=wy,p.max=rw,p.maxBy=iw,p.mean=nw,p.meanBy=sw,p.min=ow,p.minBy=aw,p.stubArray=Ya,p.stubFalse=Ga,p.stubObject=Bm,p.stubString=Fm,p.stubTrue=Ym,p.multiply=cw,p.nth=Eg,p.noConflict=Mm,p.noop=Fa,p.now=to,p.pad=um,p.padEnd=hm,p.padStart=lm,p.parseInt=pm,p.random=em,p.reduce=Sv,p.reduceRight=Ov,p.repeat=fm,p.replace=dm,p.result=Wy,p.round=uw,p.runInContext=S,p.sample=Rv,p.size=Tv,p.snakeCase=gm,p.some=Nv,p.sortedIndex=Cg,p.sortedIndexBy=xg,p.sortedIndexOf=Tg,p.sortedLastIndex=Ng,p.sortedLastIndexBy=Dg,p.sortedLastIndexOf=jg,p.startCase=ym,p.startsWith=mm,p.subtract=hw,p.sum=lw,p.sumBy=pw,p.template=wm,p.times=Gm,p.toFinite=ri,p.toInteger=_t,p.toLength=wh,p.toLower=_m,p.toNumber=Sr,p.toSafeInteger=_y,p.toString=Mt,p.toUpper=bm,p.trim=Em,p.trimEnd=Im,p.trimStart=Pm,p.truncate=Sm,p.unescape=Om,p.uniqueId=Jm,p.upperCase=Am,p.upperFirst=Ka,p.each=sh,p.eachRight=oh,p.first=eh,Ba(p,function(){var t={};return Hr(p,function(e,n){Ut.call(p.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),p.VERSION=s,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){p[t].placeholder=p}),wr(["drop","take"],function(t,e){At.prototype[t]=function(n){n=n===i?1:qe(_t(n),0);var c=this.__filtered__&&!e?new At(this):this.clone();return c.__filtered__?c.__takeCount__=We(n,c.__takeCount__):c.__views__.push({size:We(n,F),type:t+(c.__dir__<0?"Right":"")}),c},At.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),wr(["filter","map","takeWhile"],function(t,e){var n=e+1,c=n==m||n==Q;At.prototype[t]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ot(l,3),type:n}),d.__filtered__=d.__filtered__||c,d}}),wr(["head","last"],function(t,e){var n="take"+(e?"Right":"");At.prototype[t]=function(){return this[n](1).value()[0]}}),wr(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");At.prototype[t]=function(){return this.__filtered__?new At(this):this[n](1)}}),At.prototype.compact=function(){return this.filter(ar)},At.prototype.find=function(t){return this.filter(t).head()},At.prototype.findLast=function(t){return this.reverse().find(t)},At.prototype.invokeMap=Pt(function(t,e){return typeof t=="function"?new At(this):this.map(function(n){return jn(n,t,e)})}),At.prototype.reject=function(t){return this.filter(ro(ot(t)))},At.prototype.slice=function(t,e){t=_t(t);var n=this;return n.__filtered__&&(t>0||e<0)?new At(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(e=_t(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},At.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},At.prototype.toArray=function(){return this.take(F)},Hr(At.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),c=/^(?:head|last)$/.test(e),l=p[c?"take"+(e=="last"?"Right":""):e],d=c||/^find/.test(e);l&&(p.prototype[e]=function(){var w=this.__wrapped__,b=c?[1]:arguments,A=w instanceof At,z=b[0],M=A||yt(w),K=function(St){var xt=l.apply(p,di([St],b));return c&&G?xt[0]:xt};M&&n&&typeof z=="function"&&z.length!=1&&(A=M=!1);var G=this.__chain__,rt=!!this.__actions__.length,at=d&&!G,Et=A&&!rt;if(!d&&M){w=Et?w:new At(this);var ct=t.apply(w,b);return ct.__actions__.push({func:Xs,args:[K],thisArg:i}),new br(ct,G)}return at&&Et?t.apply(this,b):(ct=this.thru(K),at?c?ct.value()[0]:ct.value():ct)})}),wr(["pop","push","shift","sort","splice","unshift"],function(t){var e=Ps[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",c=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return e.apply(yt(d)?d:[],l)}return this[n](function(w){return e.apply(yt(w)?w:[],l)})}}),Hr(At.prototype,function(t,e){var n=p[e];if(n){var c=n.name+"";Ut.call(on,c)||(on[c]=[]),on[c].push({name:e,func:n})}}),on[Ws(i,vt).name]=[{name:"wrapper",func:i}],At.prototype.clone=Of,At.prototype.reverse=Af,At.prototype.value=Rf,p.prototype.at=iv,p.prototype.chain=nv,p.prototype.commit=sv,p.prototype.next=ov,p.prototype.plant=cv,p.prototype.reverse=uv,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=hv,p.prototype.first=p.prototype.head,An&&(p.prototype[An]=av),p},rn=sf();_e?((_e.exports=rn)._=rn,Ft._=rn):Ct._=rn}).call(Fn)})(mc,mc.exports);var ME=Object.defineProperty,kE=Object.defineProperties,UE=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,$E=Object.prototype.hasOwnProperty,HE=Object.prototype.propertyIsEnumerable,ql=(a,r,i)=>r in a?ME(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,ho=(a,r)=>{for(var i in r||(r={}))$E.call(r,i)&&ql(a,i,r[i]);if(Ll)for(var i of Ll(r))HE.call(r,i)&&ql(a,i,r[i]);return a},KE=(a,r)=>kE(a,UE(r));function Si(a,r,i){var s;const o=Dw(a);return((s=r.rpcMap)==null?void 0:s[o.reference])||`${zE}?chainId=${o.namespace}:${o.reference}&projectId=${i}`}function Wi(a){return a.includes(":")?a.split(":")[1]:a}function Dp(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function VE(a,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const s=[];return i.forEach(o=>{const h=r.namespaces[o].accounts;s.push(...h)}),s}function WE(a={},r={}){const i=zl(a),s=zl(r);return mc.exports.merge(i,s)}function zl(a){var r,i,s,o;const h={};if(!po(a))return h;for(const[f,g]of Object.entries(a)){const _=Bl(f)?[f]:g.chains,y=g.methods||[],I=g.events||[],R=g.rpcMap||{},N=Yn(f);h[N]=KE(ho(ho({},h[N]),g),{chains:Qa(_,(r=h[N])==null?void 0:r.chains),methods:Qa(y,(i=h[N])==null?void 0:i.methods),events:Qa(I,(s=h[N])==null?void 0:s.events),rpcMap:ho(ho({},R),(o=h[N])==null?void 0:o.rpcMap)})}return h}function BE(a){return a.includes(":")?a.split(":")[2]:a}function FE(a){const r={};for(const[i,s]of Object.entries(a)){const o=s.methods||[],h=s.events||[],f=s.accounts||[],g=Bl(i)?[i]:s.chains?s.chains:Dp(s.accounts);r[i]={chains:g,methods:o,events:h,accounts:f}}return r}function ac(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const jp={},se=a=>jp[a],cc=(a,r)=>{jp[a]=r};class YE{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=Wi(i);r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class GE{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(parseInt(r),i),this.chainId=parseInt(r),this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const s=i||Si(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=parseInt(Wi(i));r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,s;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class QE{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=Wi(i);r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class JE{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=Wi(i);r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class XE{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const s=this.getCardanoRPCUrl(i),o=Wi(i);r[o]=this.createHttpProvider(o,s)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||this.getCardanoRPCUrl(r);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class ZE{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=Wi(i);r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class tI{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){this.httpProviders[r]||this.setHttpProvider(r,i),this.chainId=r,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;const o=Wi(i);r[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);return new ui(new Oi(s,se("disableProviderPing")))}}class eI{constructor(r){this.name="near",this.namespace=r.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const s=i||Si(`${this.name}:${r}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,s)}this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var s;r[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const s=this.createHttpProvider(r,i);s&&(this.httpProviders[r]=s)}createHttpProvider(r,i){const s=i||Si(r,this.namespace);return typeof s>"u"?void 0:new ui(new Oi(s,se("disableProviderPing")))}}var rI=Object.defineProperty,iI=Object.defineProperties,nI=Object.getOwnPropertyDescriptors,Ml=Object.getOwnPropertySymbols,sI=Object.prototype.hasOwnProperty,oI=Object.prototype.propertyIsEnumerable,kl=(a,r,i)=>r in a?rI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,lo=(a,r)=>{for(var i in r||(r={}))sI.call(r,i)&&kl(a,i,r[i]);if(Ml)for(var i of Ml(r))oI.call(r,i)&&kl(a,i,r[i]);return a},uc=(a,r)=>iI(a,nI(r));class Tc{constructor(r){this.events=new bc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Rt.pino(Rt.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Dl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Tc(r);return await i.initialize(),i}async request(r,i){const[s,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:lo({},r),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(r,i,s){const o=new Date().getTime();this.request(r,s).then(h=>i(null,bo(o,h))).catch(h=>i(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:Fe("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=FE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Tp)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[s,o]=this.validateChain(r);this.getProvider(s).setDefaultChain(o,i)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(wn(i)){for(const s of i)r.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await xE.init({logger:this.providerOpts.logger||Dl,relayUrl:this.providerOpts.relayUrl||jE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>Yn(i)))];cc("client",this.client),cc("events",this.events),cc("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const s=VE(i,this.session),o=Dp(s),h=WE(this.namespaces,this.optionalNamespaces),f=uc(lo({},h[i]),{accounts:s,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new GE({namespace:f});break;case"solana":this.rpcProviders[i]=new QE({namespace:f});break;case"cosmos":this.rpcProviders[i]=new JE({namespace:f});break;case"polkadot":this.rpcProviders[i]=new YE({namespace:f});break;case"cip34":this.rpcProviders[i]=new XE({namespace:f});break;case"elrond":this.rpcProviders[i]=new ZE({namespace:f});break;case"multiversx":this.rpcProviders[i]=new tI({namespace:f});break;case"near":this.rpcProviders[i]=new eI({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:s}=i;if(s.name==="accountsChanged"){const o=s.data;o&&wn(o)&&this.events.emit("accountsChanged",o.map(BE))}else if(s.name==="chainChanged"){const o=i.chainId,h=i.event.data,f=Yn(o),g=ac(o)!==ac(h)?`${f}:${ac(h)}`:o;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var s;const{namespaces:o}=i,h=(s=this.client)==null?void 0:s.session.get(r);this.session=uc(lo({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",uc(lo({},Fe("USER_DISCONNECTED")),{data:r.topic}))}),this.on(hi.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:s,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",s)}validateChain(r){const[i,s]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,s];if(i&&!Object.keys(this.namespaces||{}).map(f=>Yn(f)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&s)return[i,s];const o=Yn(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){var s;if(!this.namespaces)return;const[o,h]=this.validateChain(r);i||this.getProvider(o).setDefaultChain(h),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${jl}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${jl}/${r}`)}}const aI=Tc,cI="wc",uI="ethereum_provider",hI=`${cI}@2:${uI}:`,lI="https://rpc.walletconnect.com/v1/",wc=["eth_sendTransaction","personal_sign"],pI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],_c=["chainChanged","accountsChanged"],fI=["chainChanged","accountsChanged","message","disconnect","connect"];var dI=Object.defineProperty,gI=Object.defineProperties,vI=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,yI=Object.prototype.hasOwnProperty,mI=Object.prototype.propertyIsEnumerable,$l=(a,r,i)=>r in a?dI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,Qn=(a,r)=>{for(var i in r||(r={}))yI.call(r,i)&&$l(a,i,r[i]);if(Ul)for(var i of Ul(r))mI.call(r,i)&&$l(a,i,r[i]);return a},Hl=(a,r)=>gI(a,vI(r));function wo(a){return Number(a[0].split(":")[1])}function hc(a){return`0x${a.toString(16)}`}function wI(a){const{chains:r,optionalChains:i,methods:s,optionalMethods:o,events:h,optionalEvents:f,rpcMap:g}=a;if(!wn(r))throw new Error("Invalid chains");const _={chains:r,methods:s||wc,events:h||_c,rpcMap:Qn({},r.length?{[wo(r)]:g[wo(r)]}:{})},y=h==null?void 0:h.filter(k=>!_c.includes(k)),I=s==null?void 0:s.filter(k=>!wc.includes(k));if(!i&&!f&&!o&&!(y!=null&&y.length)&&!(I!=null&&I.length))return{required:r.length?_:void 0};const R=(y==null?void 0:y.length)&&(I==null?void 0:I.length)||!i,N={chains:[...new Set(R?_.chains.concat(i||[]):i)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:pI))],events:[...new Set(_.events.concat(f!=null&&f.length?f:fI))],rpcMap:g};return{required:r.length?_:void 0,optional:i.length?N:void 0}}class Nc{constructor(){this.events=new Ar.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=hI,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new Nc;return await i.initialize(r),i}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,i){this.signer.sendAsync(r,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:s}=wI(this.rpc);try{const o=await new Promise(async(f,g)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Hl(Qn({namespaces:Qn({},i&&{[this.namespace]:i})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!o)return;const h=dw(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:hc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:s}=i;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",hc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Hl(Qn({},Fe("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,s;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(s=this.modal)==null||s.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",hc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,s,o]=r.split(":");return{chainId:`${i}:${s}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,s;const o=(i=r==null?void 0:r.chains)!=null?i:[],h=(s=r==null?void 0:r.optionalChains)!=null?s:[],f=o.concat(h);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(r==null?void 0:r.methods)||wc:[],_=o.length?(r==null?void 0:r.events)||_c:[],y=(r==null?void 0:r.optionalMethods)||[],I=(r==null?void 0:r.optionalEvents)||[],R=(r==null?void 0:r.rpcMap)||this.buildRpcMap(f,r.projectId),N=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(k=>this.formatChainId(k)),optionalChains:h.map(k=>this.formatChainId(k)),methods:g,events:_,optionalMethods:y,optionalEvents:I,rpcMap:R,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:N,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const s={};return r.forEach(o=>{s[o]=this.getRpcUrl(o,i)}),s}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?wo(this.rpc.chains):wo(this.rpc.optionalChains),this.signer=await aI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:s}=await fw(()=>import("./index-Ns5Amtha-Gp-PHYaq.js"),__vite__mapDeps([0,1,2,3])).then(o=>o.i);i=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Qn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:s,rpcMap:o}=r;i&&wn(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),s&&wn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(r,i){var s;return((s=this.rpc.rpcMap)==null?void 0:s[r])||`${lI}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const II=Nc;export{II as EthereumProvider,fI as OPTIONAL_EVENTS,pI as OPTIONAL_METHODS,_c as REQUIRED_EVENTS,wc as REQUIRED_METHODS,Nc as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-Ns5Amtha-Gp-PHYaq.js","assets/index-vBUh_9IV.js","assets/vendor-kGWFO7TU.js","assets/index-cvM-G4nh.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}