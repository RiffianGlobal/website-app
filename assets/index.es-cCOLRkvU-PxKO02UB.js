import{aF as cb,aG as Ep,aH as ub,aI as lb,aJ as hb,aK as fb,aL as pb,aM as db,aN as gb,aO as yb,aP as vb,aQ as mb,ap as Hr,aR as ve,as as kr,_ as _b,aS as Ti,aw as Ip,aT as wb,aU as Sp,aV as Bo,aW as fu,aX as bb,aY as pu,aZ as xp,a_ as Pp,aC as du,a$ as Op,b0 as Eb,b1 as Cp,b2 as ko,b3 as Ib}from"./vendor-AsFy8gcr.js";var bo={exports:{}},Nh;function Np(){if(Nh)return bo.exports;Nh=1;var i=typeof Reflect=="object"?Reflect:null,t=i&&typeof i.apply=="function"?i.apply:function(C,I,A){return Function.prototype.apply.call(C,I,A)},r;i&&typeof i.ownKeys=="function"?r=i.ownKeys:Object.getOwnPropertySymbols?r=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:r=function(C){return Object.getOwnPropertyNames(C)};function s(S){console&&console.warn&&console.warn(S)}var o=Number.isNaN||function(C){return C!==C};function c(){c.init.call(this)}bo.exports=c,bo.exports.once=q,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var h=10;function p(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(S){if(typeof S!="number"||S<0||o(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");h=S}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||o(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function y(S){return S._maxListeners===void 0?c.defaultMaxListeners:S._maxListeners}c.prototype.getMaxListeners=function(){return y(this)},c.prototype.emit=function(C){for(var I=[],A=1;A<arguments.length;A++)I.push(arguments[A]);var M=C==="error",ae=this._events;if(ae!==void 0)M=M&&ae.error===void 0;else if(!M)return!1;if(M){var Z;if(I.length>0&&(Z=I[0]),Z instanceof Error)throw Z;var he=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw he.context=Z,he}var F=ae[C];if(F===void 0)return!1;if(typeof F=="function")t(F,this,I);else for(var fe=F.length,_=O(F,fe),A=0;A<fe;++A)t(_[A],this,I);return!0};function g(S,C,I,A){var M,ae,Z;if(p(I),ae=S._events,ae===void 0?(ae=S._events=Object.create(null),S._eventsCount=0):(ae.newListener!==void 0&&(S.emit("newListener",C,I.listener?I.listener:I),ae=S._events),Z=ae[C]),Z===void 0)Z=ae[C]=I,++S._eventsCount;else if(typeof Z=="function"?Z=ae[C]=A?[I,Z]:[Z,I]:A?Z.unshift(I):Z.push(I),M=y(S),M>0&&Z.length>M&&!Z.warned){Z.warned=!0;var he=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");he.name="MaxListenersExceededWarning",he.emitter=S,he.type=C,he.count=Z.length,s(he)}return S}c.prototype.addListener=function(C,I){return g(this,C,I,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(C,I){return g(this,C,I,!0)};function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(S,C,I){var A={fired:!1,wrapFn:void 0,target:S,type:C,listener:I},M=v.bind(A);return M.listener=I,A.wrapFn=M,M}c.prototype.once=function(C,I){return p(I),this.on(C,b(this,C,I)),this},c.prototype.prependOnceListener=function(C,I){return p(I),this.prependListener(C,b(this,C,I)),this},c.prototype.removeListener=function(C,I){var A,M,ae,Z,he;if(p(I),M=this._events,M===void 0)return this;if(A=M[C],A===void 0)return this;if(A===I||A.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete M[C],M.removeListener&&this.emit("removeListener",C,A.listener||I));else if(typeof A!="function"){for(ae=-1,Z=A.length-1;Z>=0;Z--)if(A[Z]===I||A[Z].listener===I){he=A[Z].listener,ae=Z;break}if(ae<0)return this;ae===0?A.shift():L(A,ae),A.length===1&&(M[C]=A[0]),M.removeListener!==void 0&&this.emit("removeListener",C,he||I)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(C){var I,A,M;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[C]),this;if(arguments.length===0){var ae=Object.keys(A),Z;for(M=0;M<ae.length;++M)Z=ae[M],Z!=="removeListener"&&this.removeAllListeners(Z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=A[C],typeof I=="function")this.removeListener(C,I);else if(I!==void 0)for(M=I.length-1;M>=0;M--)this.removeListener(C,I[M]);return this};function P(S,C,I){var A=S._events;if(A===void 0)return[];var M=A[C];return M===void 0?[]:typeof M=="function"?I?[M.listener||M]:[M]:I?K(M):O(M,M.length)}c.prototype.listeners=function(C){return P(this,C,!0)},c.prototype.rawListeners=function(C){return P(this,C,!1)},c.listenerCount=function(S,C){return typeof S.listenerCount=="function"?S.listenerCount(C):R.call(S,C)},c.prototype.listenerCount=R;function R(S){var C=this._events;if(C!==void 0){var I=C[S];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function O(S,C){for(var I=new Array(C),A=0;A<C;++A)I[A]=S[A];return I}function L(S,C){for(;C+1<S.length;C++)S[C]=S[C+1];S.pop()}function K(S){for(var C=new Array(S.length),I=0;I<C.length;++I)C[I]=S[I].listener||S[I];return C}function q(S,C){return new Promise(function(I,A){function M(Z){S.removeListener(C,ae),A(Z)}function ae(){typeof S.removeListener=="function"&&S.removeListener("error",M),I([].slice.call(arguments))}B(S,C,ae,{once:!0}),C!=="error"&&$(S,M,{once:!0})})}function $(S,C,I){typeof S.on=="function"&&B(S,"error",C,I)}function B(S,C,I,A){if(typeof S.on=="function")A.once?S.once(C,I):S.on(C,I);else if(typeof S.addEventListener=="function")S.addEventListener(C,function M(ae){A.once&&S.removeEventListener(C,M),I(ae)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof S)}return bo.exports}const Sb={},xb=Object.freeze(Object.defineProperty({__proto__:null,default:Sb},Symbol.toStringTag,{value:"Module"})),ir=cb(xb);var Eo={exports:{}},bc,Th;function Zn(){return Th||(Th=1,bc={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}),bc}var Io={exports:{}},So={exports:{}},Ec,Rh;function Pb(){if(Rh)return Ec;Rh=1;var i={},t=ir,r=ir,s=ir,o=typeof __webpack_require__=="function"?__non_webpack_require__:Ep,c=process.config&&process.config.variables||{},h=!!i.PREBUILDS_ONLY,p=process.versions.modules,y=Z()?"electron":ae()?"node-webkit":"node",g=i.npm_config_arch||s.arch(),v=i.npm_config_platform||s.platform(),b=i.LIBC||(he(v)?"musl":"glibc"),P=i.ARM_VERSION||(g==="arm64"?"8":c.arm_version)||"",R=(process.versions.uv||"").split(".")[0];Ec=O;function O(F){return o(O.resolve(F))}O.resolve=O.path=function(F){F=r.resolve(F||".");try{var fe=o(r.join(F,"package.json")).name.toUpperCase().replace(/-/g,"_");i[fe+"_PREBUILD"]&&(F=i[fe+"_PREBUILD"])}catch{}if(!h){var _=K(r.join(F,"build/Release"),q);if(_)return _;var T=K(r.join(F,"build/Debug"),q);if(T)return T}var ce=Q(F);if(ce)return ce;var le=Q(r.dirname(process.execPath));if(le)return le;var ne=["platform="+v,"arch="+g,"runtime="+y,"abi="+p,"uv="+R,P?"armv="+P:"","libc="+b,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+ne+`
    loaded from: `+F+`
`);function Q(ee){var se=L(r.join(ee,"prebuilds")).map($),ze=se.filter(B(v,g)).sort(S)[0];if(ze){var Be=r.join(ee,"prebuilds",ze.name),cr=L(Be).map(C),xe=cr.filter(I(y,p)),nt=xe.sort(M(y))[0];if(nt)return r.join(Be,nt.file)}}};function L(F){try{return t.readdirSync(F)}catch{return[]}}function K(F,fe){var _=L(F).filter(fe);return _[0]&&r.join(F,_[0])}function q(F){return/\.node$/.test(F)}function $(F){var fe=F.split("-");if(fe.length===2){var _=fe[0],T=fe[1].split("+");if(_&&T.length&&T.every(Boolean))return{name:F,platform:_,architectures:T}}}function B(F,fe){return function(_){return _==null||_.platform!==F?!1:_.architectures.includes(fe)}}function S(F,fe){return F.architectures.length-fe.architectures.length}function C(F){var fe=F.split("."),_=fe.pop(),T={file:F,specificity:0};if(_==="node"){for(var ce=0;ce<fe.length;ce++){var le=fe[ce];if(le==="node"||le==="electron"||le==="node-webkit")T.runtime=le;else if(le==="napi")T.napi=!0;else if(le.slice(0,3)==="abi")T.abi=le.slice(3);else if(le.slice(0,2)==="uv")T.uv=le.slice(2);else if(le.slice(0,4)==="armv")T.armv=le.slice(4);else if(le==="glibc"||le==="musl")T.libc=le;else continue;T.specificity++}return T}}function I(F,fe){return function(_){return!(_==null||_.runtime!==F&&!A(_)||_.abi!==fe&&!_.napi||_.uv&&_.uv!==R||_.armv&&_.armv!==P||_.libc&&_.libc!==b)}}function A(F){return F.runtime==="node"&&F.napi}function M(F){return function(fe,_){return fe.runtime!==_.runtime?fe.runtime===F?-1:1:fe.abi!==_.abi?fe.abi?-1:1:fe.specificity!==_.specificity?fe.specificity>_.specificity?-1:1:0}}function ae(){return!!(process.versions&&process.versions.nw)}function Z(){return process.versions&&process.versions.electron||i.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function he(F){return F==="linux"&&t.existsSync("/etc/alpine-release")}return O.parseTags=C,O.matchTags=I,O.compareTags=M,O.parseTuple=$,O.matchTuple=B,O.compareTuples=S,Ec}var Ah;function Tp(){if(Ah)return So.exports;Ah=1;const i=typeof __webpack_require__=="function"?__non_webpack_require__:Ep;return typeof i.addon=="function"?So.exports=i.addon.bind(i):So.exports=Pb(),So.exports}var Ic,Lh;function Ob(){return Lh||(Lh=1,Ic={mask:(r,s,o,c,h)=>{for(var p=0;p<h;p++)o[c+p]=r[p]^s[p&3]},unmask:(r,s)=>{const o=r.length;for(var c=0;c<o;c++)r[c]^=s[c&3]}}),Ic}var jh;function Cb(){if(jh)return Io.exports;jh=1;try{Io.exports=Tp()(__dirname)}catch{Io.exports=Ob()}return Io.exports}var Dh;function Ko(){if(Dh)return Eo.exports;Dh=1;const{EMPTY_BUFFER:i}=Zn();function t(h,p){if(h.length===0)return i;if(h.length===1)return h[0];const y=Buffer.allocUnsafe(p);let g=0;for(let v=0;v<h.length;v++){const b=h[v];y.set(b,g),g+=b.length}return g<p?y.slice(0,g):y}function r(h,p,y,g,v){for(let b=0;b<v;b++)y[g+b]=h[b]^p[b&3]}function s(h,p){for(let y=0;y<h.length;y++)h[y]^=p[y&3]}function o(h){return h.byteLength===h.buffer.byteLength?h.buffer:h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength)}function c(h){if(c.readOnly=!0,Buffer.isBuffer(h))return h;let p;return h instanceof ArrayBuffer?p=Buffer.from(h):ArrayBuffer.isView(h)?p=Buffer.from(h.buffer,h.byteOffset,h.byteLength):(p=Buffer.from(h),c.readOnly=!1),p}try{const h=Cb();Eo.exports={concat:t,mask(p,y,g,v,b){b<48?r(p,y,g,v,b):h.mask(p,y,g,v,b)},toArrayBuffer:o,toBuffer:c,unmask(p,y){p.length<32?s(p,y):h.unmask(p,y)}}}catch{Eo.exports={concat:t,mask:r,toArrayBuffer:o,toBuffer:c,unmask:s}}return Eo.exports}var Sc,kh;function Nb(){if(kh)return Sc;kh=1;const i=Symbol("kDone"),t=Symbol("kRun");class r{constructor(o){this[i]=()=>{this.pending--,this[t]()},this.concurrency=o||1/0,this.jobs=[],this.pending=0}add(o){this.jobs.push(o),this[t]()}[t](){if(this.pending!==this.concurrency&&this.jobs.length){const o=this.jobs.shift();this.pending++,o(this[i])}}}return Sc=r,Sc}var xc,Uh;function Vo(){if(Uh)return xc;Uh=1;const i=ir,t=Ko(),r=Nb(),{kStatusCode:s}=Zn(),o=Buffer.from([0,0,255,255]),c=Symbol("permessage-deflate"),h=Symbol("total-length"),p=Symbol("callback"),y=Symbol("buffers"),g=Symbol("error");let v;class b{constructor(K,q,$){if(this._maxPayload=$|0,this._options=K||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!q,this._deflate=null,this._inflate=null,this.params=null,!v){const B=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;v=new r(B)}}static get extensionName(){return"permessage-deflate"}offer(){const K={};return this._options.serverNoContextTakeover&&(K.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(K.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(K.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?K.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(K.client_max_window_bits=!0),K}accept(K){return K=this.normalizeParams(K),this.params=this._isServer?this.acceptAsServer(K):this.acceptAsClient(K),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const K=this._deflate[p];this._deflate.close(),this._deflate=null,K&&K(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(K){const q=this._options,$=K.find(B=>!(q.serverNoContextTakeover===!1&&B.server_no_context_takeover||B.server_max_window_bits&&(q.serverMaxWindowBits===!1||typeof q.serverMaxWindowBits=="number"&&q.serverMaxWindowBits>B.server_max_window_bits)||typeof q.clientMaxWindowBits=="number"&&!B.client_max_window_bits));if(!$)throw new Error("None of the extension offers can be accepted");return q.serverNoContextTakeover&&($.server_no_context_takeover=!0),q.clientNoContextTakeover&&($.client_no_context_takeover=!0),typeof q.serverMaxWindowBits=="number"&&($.server_max_window_bits=q.serverMaxWindowBits),typeof q.clientMaxWindowBits=="number"?$.client_max_window_bits=q.clientMaxWindowBits:($.client_max_window_bits===!0||q.clientMaxWindowBits===!1)&&delete $.client_max_window_bits,$}acceptAsClient(K){const q=K[0];if(this._options.clientNoContextTakeover===!1&&q.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!q.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(q.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&q.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return q}normalizeParams(K){return K.forEach(q=>{Object.keys(q).forEach($=>{let B=q[$];if(B.length>1)throw new Error(`Parameter "${$}" must have only a single value`);if(B=B[0],$==="client_max_window_bits"){if(B!==!0){const S=+B;if(!Number.isInteger(S)||S<8||S>15)throw new TypeError(`Invalid value for parameter "${$}": ${B}`);B=S}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${$}": ${B}`)}else if($==="server_max_window_bits"){const S=+B;if(!Number.isInteger(S)||S<8||S>15)throw new TypeError(`Invalid value for parameter "${$}": ${B}`);B=S}else if($==="client_no_context_takeover"||$==="server_no_context_takeover"){if(B!==!0)throw new TypeError(`Invalid value for parameter "${$}": ${B}`)}else throw new Error(`Unknown parameter "${$}"`);q[$]=B})}),K}decompress(K,q,$){v.add(B=>{this._decompress(K,q,(S,C)=>{B(),$(S,C)})})}compress(K,q,$){v.add(B=>{this._compress(K,q,(S,C)=>{B(),$(S,C)})})}_decompress(K,q,$){const B=this._isServer?"client":"server";if(!this._inflate){const S=`${B}_max_window_bits`,C=typeof this.params[S]!="number"?i.Z_DEFAULT_WINDOWBITS:this.params[S];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:C}),this._inflate[c]=this,this._inflate[h]=0,this._inflate[y]=[],this._inflate.on("error",O),this._inflate.on("data",R)}this._inflate[p]=$,this._inflate.write(K),q&&this._inflate.write(o),this._inflate.flush(()=>{const S=this._inflate[g];if(S){this._inflate.close(),this._inflate=null,$(S);return}const C=t.concat(this._inflate[y],this._inflate[h]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[h]=0,this._inflate[y]=[],q&&this.params[`${B}_no_context_takeover`]&&this._inflate.reset()),$(null,C)})}_compress(K,q,$){const B=this._isServer?"server":"client";if(!this._deflate){const S=`${B}_max_window_bits`,C=typeof this.params[S]!="number"?i.Z_DEFAULT_WINDOWBITS:this.params[S];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:C}),this._deflate[h]=0,this._deflate[y]=[],this._deflate.on("data",P)}this._deflate[p]=$,this._deflate.write(K),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let S=t.concat(this._deflate[y],this._deflate[h]);q&&(S=S.slice(0,S.length-4)),this._deflate[p]=null,this._deflate[h]=0,this._deflate[y]=[],q&&this.params[`${B}_no_context_takeover`]&&this._deflate.reset(),$(null,S)})}}xc=b;function P(L){this[y].push(L),this[h]+=L.length}function R(L){if(this[h]+=L.length,this[c]._maxPayload<1||this[h]<=this[c]._maxPayload){this[y].push(L);return}this[g]=new RangeError("Max payload size exceeded"),this[g].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[g][s]=1009,this.removeListener("data",R),this.reset()}function O(L){this[c]._inflate=null,L[s]=1007,this[p](L)}return xc}var xo={exports:{}},Po={exports:{}},Pc,Mh;function Tb(){if(Mh)return Pc;Mh=1;function i(t){const r=t.length;let s=0;for(;s<r;)if(!(t[s]&128))s++;else if((t[s]&224)===192){if(s+1===r||(t[s+1]&192)!==128||(t[s]&254)===192)return!1;s+=2}else if((t[s]&240)===224){if(s+2>=r||(t[s+1]&192)!==128||(t[s+2]&192)!==128||t[s]===224&&(t[s+1]&224)===128||t[s]===237&&(t[s+1]&224)===160)return!1;s+=3}else if((t[s]&248)===240){if(s+3>=r||(t[s+1]&192)!==128||(t[s+2]&192)!==128||(t[s+3]&192)!==128||t[s]===240&&(t[s+1]&240)===128||t[s]===244&&t[s+1]>143||t[s]>244)return!1;s+=4}else return!1;return!0}return Pc=i,Pc}var qh;function Rb(){if(qh)return Po.exports;qh=1;try{Po.exports=Tp()(__dirname)}catch{Po.exports=Tb()}return Po.exports}var $h;function Ho(){if($h)return xo.exports;$h=1;const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function t(s){return s>=1e3&&s<=1014&&s!==1004&&s!==1005&&s!==1006||s>=3e3&&s<=4999}function r(s){const o=s.length;let c=0;for(;c<o;)if(!(s[c]&128))c++;else if((s[c]&224)===192){if(c+1===o||(s[c+1]&192)!==128||(s[c]&254)===192)return!1;c+=2}else if((s[c]&240)===224){if(c+2>=o||(s[c+1]&192)!==128||(s[c+2]&192)!==128||s[c]===224&&(s[c+1]&224)===128||s[c]===237&&(s[c+1]&224)===160)return!1;c+=3}else if((s[c]&248)===240){if(c+3>=o||(s[c+1]&192)!==128||(s[c+2]&192)!==128||(s[c+3]&192)!==128||s[c]===240&&(s[c+1]&240)===128||s[c]===244&&s[c+1]>143||s[c]>244)return!1;c+=4}else return!1;return!0}try{const s=Rb();xo.exports={isValidStatusCode:t,isValidUTF8(o){return o.length<150?r(o):s(o)},tokenChars:i}}catch{xo.exports={isValidStatusCode:t,isValidUTF8:r,tokenChars:i}}return xo.exports}var Oc,zh;function Rp(){if(zh)return Oc;zh=1;const{Writable:i}=ir,t=Vo(),{BINARY_TYPES:r,EMPTY_BUFFER:s,kStatusCode:o,kWebSocket:c}=Zn(),{concat:h,toArrayBuffer:p,unmask:y}=Ko(),{isValidStatusCode:g,isValidUTF8:v}=Ho(),b=0,P=1,R=2,O=3,L=4,K=5;class q extends i{constructor(S={}){super(),this._binaryType=S.binaryType||r[0],this._extensions=S.extensions||{},this._isServer=!!S.isServer,this._maxPayload=S.maxPayload|0,this._skipUTF8Validation=!!S.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=b,this._loop=!1}_write(S,C,I){if(this._opcode===8&&this._state==b)return I();this._bufferedBytes+=S.length,this._buffers.push(S),this.startLoop(I)}consume(S){if(this._bufferedBytes-=S,S===this._buffers[0].length)return this._buffers.shift();if(S<this._buffers[0].length){const I=this._buffers[0];return this._buffers[0]=I.slice(S),I.slice(0,S)}const C=Buffer.allocUnsafe(S);do{const I=this._buffers[0],A=C.length-S;S>=I.length?C.set(this._buffers.shift(),A):(C.set(new Uint8Array(I.buffer,I.byteOffset,S),A),this._buffers[0]=I.slice(S)),S-=I.length}while(S>0);return C}startLoop(S){let C;this._loop=!0;do switch(this._state){case b:C=this.getInfo();break;case P:C=this.getPayloadLength16();break;case R:C=this.getPayloadLength64();break;case O:this.getMask();break;case L:C=this.getData(S);break;default:this._loop=!1;return}while(this._loop);S(C)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}const S=this.consume(2);if(S[0]&48)return this._loop=!1,$(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const C=(S[0]&64)===64;if(C&&!this._extensions[t.extensionName])return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(S[0]&128)===128,this._opcode=S[0]&15,this._payloadLength=S[1]&127,this._opcode===0){if(C)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,$(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=C}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,$(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(C)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,$(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(S[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,$(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,$(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=P;else if(this._payloadLength===127)this._state=R;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}const S=this.consume(8),C=S.readUInt32BE(0);return C>Math.pow(2,21)-1?(this._loop=!1,$(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=C*Math.pow(2,32)+S.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,$(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=O:this._state=L}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=L}getData(S){let C=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}C=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&y(C,this._mask)}if(this._opcode>7)return this.controlMessage(C);if(this._compressed){this._state=K,this.decompress(C,S);return}return C.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(C)),this.dataMessage()}decompress(S,C){this._extensions[t.extensionName].decompress(S,this._fin,(A,M)=>{if(A)return C(A);if(M.length){if(this._messageLength+=M.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return C($(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(M)}const ae=this.dataMessage();if(ae)return C(ae);this.startLoop(C)})}dataMessage(){if(this._fin){const S=this._messageLength,C=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let I;this._binaryType==="nodebuffer"?I=h(C,S):this._binaryType==="arraybuffer"?I=p(h(C,S)):I=C,this.emit("message",I,!0)}else{const I=h(C,S);if(!this._skipUTF8Validation&&!v(I))return this._loop=!1,$(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",I,!1)}}this._state=b}controlMessage(S){if(this._opcode===8)if(this._loop=!1,S.length===0)this.emit("conclude",1005,s),this.end();else{if(S.length===1)return $(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const C=S.readUInt16BE(0);if(!g(C))return $(RangeError,`invalid status code ${C}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const I=S.slice(2);if(!this._skipUTF8Validation&&!v(I))return $(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",C,I),this.end()}}else this._opcode===9?this.emit("ping",S):this.emit("pong",S);this._state=b}}Oc=q;function $(B,S,C,I,A){const M=new B(C?`Invalid WebSocket frame: ${S}`:S);return Error.captureStackTrace(M,$),M.code=A,M[o]=I,M}return Oc}var Cc,Bh;function Ap(){if(Bh)return Cc;Bh=1;const{randomFillSync:i}=ir,t=Vo(),{EMPTY_BUFFER:r}=Zn(),{isValidStatusCode:s}=Ho(),{mask:o,toBuffer:c}=Ko(),h=Symbol("kByteLength"),p=Buffer.alloc(4);class y{constructor(v,b,P){this._extensions=b||{},P&&(this._generateMask=P,this._maskBuffer=Buffer.alloc(4)),this._socket=v,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(v,b){let P,R=!1,O=2,L=!1;b.mask&&(P=b.maskBuffer||p,b.generateMask?b.generateMask(P):i(P,0,4),L=(P[0]|P[1]|P[2]|P[3])===0,O=6);let K;typeof v=="string"?(!b.mask||L)&&b[h]!==void 0?K=b[h]:(v=Buffer.from(v),K=v.length):(K=v.length,R=b.mask&&b.readOnly&&!L);let q=K;K>=65536?(O+=8,q=127):K>125&&(O+=2,q=126);const $=Buffer.allocUnsafe(R?K+O:O);return $[0]=b.fin?b.opcode|128:b.opcode,b.rsv1&&($[0]|=64),$[1]=q,q===126?$.writeUInt16BE(K,2):q===127&&($[2]=$[3]=0,$.writeUIntBE(K,4,6)),b.mask?($[1]|=128,$[O-4]=P[0],$[O-3]=P[1],$[O-2]=P[2],$[O-1]=P[3],L?[$,v]:R?(o(v,P,$,O,K),[$]):(o(v,P,v,0,K),[$,v])):[$,v]}close(v,b,P,R){let O;if(v===void 0)O=r;else{if(typeof v!="number"||!s(v))throw new TypeError("First argument must be a valid error code number");if(b===void 0||!b.length)O=Buffer.allocUnsafe(2),O.writeUInt16BE(v,0);else{const K=Buffer.byteLength(b);if(K>123)throw new RangeError("The message must not be greater than 123 bytes");O=Buffer.allocUnsafe(2+K),O.writeUInt16BE(v,0),typeof b=="string"?O.write(b,2):O.set(b,2)}}const L={[h]:O.length,fin:!0,generateMask:this._generateMask,mask:P,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,O,!1,L,R]):this.sendFrame(y.frame(O,L),R)}ping(v,b,P){let R,O;if(typeof v=="string"?(R=Buffer.byteLength(v),O=!1):(v=c(v),R=v.length,O=c.readOnly),R>125)throw new RangeError("The data size must not be greater than 125 bytes");const L={[h]:R,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:O,rsv1:!1};this._deflating?this.enqueue([this.dispatch,v,!1,L,P]):this.sendFrame(y.frame(v,L),P)}pong(v,b,P){let R,O;if(typeof v=="string"?(R=Buffer.byteLength(v),O=!1):(v=c(v),R=v.length,O=c.readOnly),R>125)throw new RangeError("The data size must not be greater than 125 bytes");const L={[h]:R,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:O,rsv1:!1};this._deflating?this.enqueue([this.dispatch,v,!1,L,P]):this.sendFrame(y.frame(v,L),P)}send(v,b,P){const R=this._extensions[t.extensionName];let O=b.binary?2:1,L=b.compress,K,q;if(typeof v=="string"?(K=Buffer.byteLength(v),q=!1):(v=c(v),K=v.length,q=c.readOnly),this._firstFragment?(this._firstFragment=!1,L&&R&&R.params[R._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(L=K>=R._threshold),this._compress=L):(L=!1,O=0),b.fin&&(this._firstFragment=!0),R){const $={[h]:K,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:O,readOnly:q,rsv1:L};this._deflating?this.enqueue([this.dispatch,v,this._compress,$,P]):this.dispatch(v,this._compress,$,P)}else this.sendFrame(y.frame(v,{[h]:K,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:O,readOnly:q,rsv1:!1}),P)}dispatch(v,b,P,R){if(!b){this.sendFrame(y.frame(v,P),R);return}const O=this._extensions[t.extensionName];this._bufferedBytes+=P[h],this._deflating=!0,O.compress(v,P.fin,(L,K)=>{if(this._socket.destroyed){const q=new Error("The socket was closed while data was being compressed");typeof R=="function"&&R(q);for(let $=0;$<this._queue.length;$++){const B=this._queue[$],S=B[B.length-1];typeof S=="function"&&S(q)}return}this._bufferedBytes-=P[h],this._deflating=!1,P.readOnly=!1,this.sendFrame(y.frame(K,P),R),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const v=this._queue.shift();this._bufferedBytes-=v[3][h],Reflect.apply(v[0],this,v.slice(1))}}enqueue(v){this._bufferedBytes+=v[3][h],this._queue.push(v)}sendFrame(v,b){v.length===2?(this._socket.cork(),this._socket.write(v[0]),this._socket.write(v[1],b),this._socket.uncork()):this._socket.write(v[0],b)}}return Cc=y,Cc}var Nc,Kh;function Ab(){if(Kh)return Nc;Kh=1;const{kForOnEventAttribute:i,kListener:t}=Zn(),r=Symbol("kCode"),s=Symbol("kData"),o=Symbol("kError"),c=Symbol("kMessage"),h=Symbol("kReason"),p=Symbol("kTarget"),y=Symbol("kType"),g=Symbol("kWasClean");class v{constructor(K){this[p]=null,this[y]=K}get target(){return this[p]}get type(){return this[y]}}Object.defineProperty(v.prototype,"target",{enumerable:!0}),Object.defineProperty(v.prototype,"type",{enumerable:!0});class b extends v{constructor(K,q={}){super(K),this[r]=q.code===void 0?0:q.code,this[h]=q.reason===void 0?"":q.reason,this[g]=q.wasClean===void 0?!1:q.wasClean}get code(){return this[r]}get reason(){return this[h]}get wasClean(){return this[g]}}Object.defineProperty(b.prototype,"code",{enumerable:!0}),Object.defineProperty(b.prototype,"reason",{enumerable:!0}),Object.defineProperty(b.prototype,"wasClean",{enumerable:!0});class P extends v{constructor(K,q={}){super(K),this[o]=q.error===void 0?null:q.error,this[c]=q.message===void 0?"":q.message}get error(){return this[o]}get message(){return this[c]}}Object.defineProperty(P.prototype,"error",{enumerable:!0}),Object.defineProperty(P.prototype,"message",{enumerable:!0});class R extends v{constructor(K,q={}){super(K),this[s]=q.data===void 0?null:q.data}get data(){return this[s]}}return Object.defineProperty(R.prototype,"data",{enumerable:!0}),Nc={CloseEvent:b,ErrorEvent:P,Event:v,EventTarget:{addEventListener(L,K,q={}){let $;if(L==="message")$=function(S,C){const I=new R("message",{data:C?S:S.toString()});I[p]=this,K.call(this,I)};else if(L==="close")$=function(S,C){const I=new b("close",{code:S,reason:C.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});I[p]=this,K.call(this,I)};else if(L==="error")$=function(S){const C=new P("error",{error:S,message:S.message});C[p]=this,K.call(this,C)};else if(L==="open")$=function(){const S=new v("open");S[p]=this,K.call(this,S)};else return;$[i]=!!q[i],$[t]=K,q.once?this.once(L,$):this.on(L,$)},removeEventListener(L,K){for(const q of this.listeners(L))if(q[t]===K&&!q[i]){this.removeListener(L,q);break}}},MessageEvent:R},Nc}var Tc,Vh;function Lp(){if(Vh)return Tc;Vh=1;const{tokenChars:i}=Ho();function t(o,c,h){o[c]===void 0?o[c]=[h]:o[c].push(h)}function r(o){const c=Object.create(null);let h=Object.create(null),p=!1,y=!1,g=!1,v,b,P=-1,R=-1,O=-1,L=0;for(;L<o.length;L++)if(R=o.charCodeAt(L),v===void 0)if(O===-1&&i[R]===1)P===-1&&(P=L);else if(L!==0&&(R===32||R===9))O===-1&&P!==-1&&(O=L);else if(R===59||R===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L);const q=o.slice(P,O);R===44?(t(c,q,h),h=Object.create(null)):v=q,P=O=-1}else throw new SyntaxError(`Unexpected character at index ${L}`);else if(b===void 0)if(O===-1&&i[R]===1)P===-1&&(P=L);else if(R===32||R===9)O===-1&&P!==-1&&(O=L);else if(R===59||R===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L),t(h,o.slice(P,O),!0),R===44&&(t(c,v,h),h=Object.create(null),v=void 0),P=O=-1}else if(R===61&&P!==-1&&O===-1)b=o.slice(P,L),P=O=-1;else throw new SyntaxError(`Unexpected character at index ${L}`);else if(y){if(i[R]!==1)throw new SyntaxError(`Unexpected character at index ${L}`);P===-1?P=L:p||(p=!0),y=!1}else if(g)if(i[R]===1)P===-1&&(P=L);else if(R===34&&P!==-1)g=!1,O=L;else if(R===92)y=!0;else throw new SyntaxError(`Unexpected character at index ${L}`);else if(R===34&&o.charCodeAt(L-1)===61)g=!0;else if(O===-1&&i[R]===1)P===-1&&(P=L);else if(P!==-1&&(R===32||R===9))O===-1&&(O=L);else if(R===59||R===44){if(P===-1)throw new SyntaxError(`Unexpected character at index ${L}`);O===-1&&(O=L);let q=o.slice(P,O);p&&(q=q.replace(/\\/g,""),p=!1),t(h,b,q),R===44&&(t(c,v,h),h=Object.create(null),v=void 0),b=void 0,P=O=-1}else throw new SyntaxError(`Unexpected character at index ${L}`);if(P===-1||g||R===32||R===9)throw new SyntaxError("Unexpected end of input");O===-1&&(O=L);const K=o.slice(P,O);return v===void 0?t(c,K,h):(b===void 0?t(h,K,!0):p?t(h,b,K.replace(/\\/g,"")):t(h,b,K),t(c,v,h)),c}function s(o){return Object.keys(o).map(c=>{let h=o[c];return Array.isArray(h)||(h=[h]),h.map(p=>[c].concat(Object.keys(p).map(y=>{let g=p[y];return Array.isArray(g)||(g=[g]),g.map(v=>v===!0?y:`${y}=${v}`).join("; ")})).join("; ")).join(", ")}).join(", ")}return Tc={format:s,parse:r},Tc}var Rc,Hh;function jp(){if(Hh)return Rc;Hh=1;const i=Np(),t=ir,r=ir,s=ir,o=ir,{randomBytes:c,createHash:h}=ir,{URL:p}=ir,y=Vo(),g=Rp(),v=Ap(),{BINARY_TYPES:b,EMPTY_BUFFER:P,GUID:R,kForOnEventAttribute:O,kListener:L,kStatusCode:K,kWebSocket:q,NOOP:$}=Zn(),{EventTarget:{addEventListener:B,removeEventListener:S}}=Ab(),{format:C,parse:I}=Lp(),{toBuffer:A}=Ko(),M=["CONNECTING","OPEN","CLOSING","CLOSED"],ae=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Z=[8,13],he=30*1e3;class F extends i{constructor(z,te,oe){super(),this._binaryType=b[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=P,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=F.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,z!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,te===void 0?te=[]:Array.isArray(te)||(typeof te=="object"&&te!==null?(oe=te,te=[]):te=[te]),fe(this,z,te,oe)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(z){b.includes(z)&&(this._binaryType=z,this._receiver&&(this._receiver._binaryType=z))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(z,te,oe){const ie=new g({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:oe.maxPayload,skipUTF8Validation:oe.skipUTF8Validation});this._sender=new v(z,this._extensions,oe.generateMask),this._receiver=ie,this._socket=z,ie[q]=this,z[q]=this,ie.on("conclude",Q),ie.on("drain",ee),ie.on("error",se),ie.on("message",Be),ie.on("ping",cr),ie.on("pong",xe),z.setTimeout(0),z.setNoDelay(),te.length>0&&z.unshift(te),z.on("close",W),z.on("data",H),z.on("end",U),z.on("error",l),this._readyState=F.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=F.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[y.extensionName]&&this._extensions[y.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=F.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(z,te){if(this.readyState!==F.CLOSED){if(this.readyState===F.CONNECTING)return le(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===F.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=F.CLOSING,this._sender.close(z,te,!this._isServer,oe=>{oe||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),he)}}pause(){this.readyState===F.CONNECTING||this.readyState===F.CLOSED||(this._paused=!0,this._socket.pause())}ping(z,te,oe){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof z=="function"?(oe=z,z=te=void 0):typeof te=="function"&&(oe=te,te=void 0),typeof z=="number"&&(z=z.toString()),this.readyState!==F.OPEN){ne(this,z,oe);return}te===void 0&&(te=!this._isServer),this._sender.ping(z||P,te,oe)}pong(z,te,oe){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof z=="function"?(oe=z,z=te=void 0):typeof te=="function"&&(oe=te,te=void 0),typeof z=="number"&&(z=z.toString()),this.readyState!==F.OPEN){ne(this,z,oe);return}te===void 0&&(te=!this._isServer),this._sender.pong(z||P,te,oe)}resume(){this.readyState===F.CONNECTING||this.readyState===F.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(z,te,oe){if(this.readyState===F.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof te=="function"&&(oe=te,te={}),typeof z=="number"&&(z=z.toString()),this.readyState!==F.OPEN){ne(this,z,oe);return}const ie={binary:typeof z!="string",mask:!this._isServer,compress:!0,fin:!0,...te};this._extensions[y.extensionName]||(ie.compress=!1),this._sender.send(z||P,ie,oe)}terminate(){if(this.readyState!==F.CLOSED){if(this.readyState===F.CONNECTING)return le(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=F.CLOSING,this._socket.destroy())}}}Object.defineProperty(F,"CONNECTING",{enumerable:!0,value:M.indexOf("CONNECTING")}),Object.defineProperty(F.prototype,"CONNECTING",{enumerable:!0,value:M.indexOf("CONNECTING")}),Object.defineProperty(F,"OPEN",{enumerable:!0,value:M.indexOf("OPEN")}),Object.defineProperty(F.prototype,"OPEN",{enumerable:!0,value:M.indexOf("OPEN")}),Object.defineProperty(F,"CLOSING",{enumerable:!0,value:M.indexOf("CLOSING")}),Object.defineProperty(F.prototype,"CLOSING",{enumerable:!0,value:M.indexOf("CLOSING")}),Object.defineProperty(F,"CLOSED",{enumerable:!0,value:M.indexOf("CLOSED")}),Object.defineProperty(F.prototype,"CLOSED",{enumerable:!0,value:M.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(w=>{Object.defineProperty(F.prototype,w,{enumerable:!0})}),["open","error","close","message"].forEach(w=>{Object.defineProperty(F.prototype,`on${w}`,{enumerable:!0,get(){for(const z of this.listeners(w))if(z[O])return z[L];return null},set(z){for(const te of this.listeners(w))if(te[O]){this.removeListener(w,te);break}typeof z=="function"&&this.addEventListener(w,z,{[O]:!0})}})}),F.prototype.addEventListener=B,F.prototype.removeEventListener=S,Rc=F;function fe(w,z,te,oe){const ie={protocolVersion:Z[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...oe,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!Z.includes(ie.protocolVersion))throw new RangeError(`Unsupported protocol version: ${ie.protocolVersion} (supported versions: ${Z.join(", ")})`);let _e;if(z instanceof p)_e=z,w._url=z.href;else{try{_e=new p(z)}catch{throw new SyntaxError(`Invalid URL: ${z}`)}w._url=z}const Ne=_e.protocol==="wss:",ct=_e.protocol==="ws+unix:";let Je;if(_e.protocol!=="ws:"&&!Ne&&!ct?Je=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:ct&&!_e.pathname?Je="The URL's pathname is empty":_e.hash&&(Je="The URL contains a fragment identifier"),Je){const me=new SyntaxError(Je);if(w._redirects===0)throw me;_(w,me);return}const it=Ne?443:80,$e=c(16).toString("base64"),Qe=Ne?t.get:r.get,Ke=new Set;let We;if(ie.createConnection=Ne?ce:T,ie.defaultPort=ie.defaultPort||it,ie.port=_e.port||it,ie.host=_e.hostname.startsWith("[")?_e.hostname.slice(1,-1):_e.hostname,ie.headers={"Sec-WebSocket-Version":ie.protocolVersion,"Sec-WebSocket-Key":$e,Connection:"Upgrade",Upgrade:"websocket",...ie.headers},ie.path=_e.pathname+_e.search,ie.timeout=ie.handshakeTimeout,ie.perMessageDeflate&&(We=new y(ie.perMessageDeflate!==!0?ie.perMessageDeflate:{},!1,ie.maxPayload),ie.headers["Sec-WebSocket-Extensions"]=C({[y.extensionName]:We.offer()})),te.length){for(const me of te){if(typeof me!="string"||!ae.test(me)||Ke.has(me))throw new SyntaxError("An invalid or duplicated subprotocol was specified");Ke.add(me)}ie.headers["Sec-WebSocket-Protocol"]=te.join(",")}if(ie.origin&&(ie.protocolVersion<13?ie.headers["Sec-WebSocket-Origin"]=ie.origin:ie.headers.Origin=ie.origin),(_e.username||_e.password)&&(ie.auth=`${_e.username}:${_e.password}`),ct){const me=ie.path.split(":");ie.socketPath=me[0],ie.path=me[1]}if(ie.followRedirects){if(w._redirects===0){w._originalHost=_e.host;const me=oe&&oe.headers;if(oe={...oe,headers:{}},me)for(const[Ie,qe]of Object.entries(me))oe.headers[Ie.toLowerCase()]=qe}else _e.host!==w._originalHost&&(delete ie.headers.authorization,delete ie.headers.cookie,delete ie.headers.host,ie.auth=void 0);ie.auth&&!oe.headers.authorization&&(oe.headers.authorization="Basic "+Buffer.from(ie.auth).toString("base64"))}let Oe=w._req=Qe(ie);ie.timeout&&Oe.on("timeout",()=>{le(w,Oe,"Opening handshake has timed out")}),Oe.on("error",me=>{Oe===null||Oe.aborted||(Oe=w._req=null,_(w,me))}),Oe.on("response",me=>{const Ie=me.headers.location,qe=me.statusCode;if(Ie&&ie.followRedirects&&qe>=300&&qe<400){if(++w._redirects>ie.maxRedirects){le(w,Oe,"Maximum redirects exceeded");return}Oe.abort();let Xe;try{Xe=new p(Ie,z)}catch{const Ge=new SyntaxError(`Invalid URL: ${Ie}`);_(w,Ge);return}fe(w,Xe,te,oe)}else w.emit("unexpected-response",Oe,me)||le(w,Oe,`Unexpected server response: ${me.statusCode}`)}),Oe.on("upgrade",(me,Ie,qe)=>{if(w.emit("upgrade",me),w.readyState!==F.CONNECTING)return;Oe=w._req=null;const Xe=h("sha1").update($e+R).digest("base64");if(me.headers["sec-websocket-accept"]!==Xe){le(w,Ie,"Invalid Sec-WebSocket-Accept header");return}const ke=me.headers["sec-websocket-protocol"];let Ge;if(ke!==void 0?Ke.size?Ke.has(ke)||(Ge="Server sent an invalid subprotocol"):Ge="Server sent a subprotocol but none was requested":Ke.size&&(Ge="Server sent no subprotocol"),Ge){le(w,Ie,Ge);return}ke&&(w._protocol=ke);const yt=me.headers["sec-websocket-extensions"];if(yt!==void 0){if(!We){le(w,Ie,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let xt;try{xt=I(yt)}catch{le(w,Ie,"Invalid Sec-WebSocket-Extensions header");return}const Rt=Object.keys(xt);if(Rt.length!==1||Rt[0]!==y.extensionName){le(w,Ie,"Server indicated an extension that was not requested");return}try{We.accept(xt[y.extensionName])}catch{le(w,Ie,"Invalid Sec-WebSocket-Extensions header");return}w._extensions[y.extensionName]=We}w.setSocket(Ie,qe,{generateMask:ie.generateMask,maxPayload:ie.maxPayload,skipUTF8Validation:ie.skipUTF8Validation})})}function _(w,z){w._readyState=F.CLOSING,w.emit("error",z),w.emitClose()}function T(w){return w.path=w.socketPath,s.connect(w)}function ce(w){return w.path=void 0,!w.servername&&w.servername!==""&&(w.servername=s.isIP(w.host)?"":w.host),o.connect(w)}function le(w,z,te){w._readyState=F.CLOSING;const oe=new Error(te);Error.captureStackTrace(oe,le),z.setHeader?(z.abort(),z.socket&&!z.socket.destroyed&&z.socket.destroy(),z.once("abort",w.emitClose.bind(w)),w.emit("error",oe)):(z.destroy(oe),z.once("error",w.emit.bind(w,"error")),z.once("close",w.emitClose.bind(w)))}function ne(w,z,te){if(z){const oe=A(z).length;w._socket?w._sender._bufferedBytes+=oe:w._bufferedAmount+=oe}if(te){const oe=new Error(`WebSocket is not open: readyState ${w.readyState} (${M[w.readyState]})`);te(oe)}}function Q(w,z){const te=this[q];te._closeFrameReceived=!0,te._closeMessage=z,te._closeCode=w,te._socket[q]!==void 0&&(te._socket.removeListener("data",H),process.nextTick(nt,te._socket),w===1005?te.close():te.close(w,z))}function ee(){const w=this[q];w.isPaused||w._socket.resume()}function se(w){const z=this[q];z._socket[q]!==void 0&&(z._socket.removeListener("data",H),process.nextTick(nt,z._socket),z.close(w[K])),z.emit("error",w)}function ze(){this[q].emitClose()}function Be(w,z){this[q].emit("message",w,z)}function cr(w){const z=this[q];z.pong(w,!z._isServer,$),z.emit("ping",w)}function xe(w){this[q].emit("pong",w)}function nt(w){w.resume()}function W(){const w=this[q];this.removeListener("close",W),this.removeListener("data",H),this.removeListener("end",U),w._readyState=F.CLOSING;let z;!this._readableState.endEmitted&&!w._closeFrameReceived&&!w._receiver._writableState.errorEmitted&&(z=w._socket.read())!==null&&w._receiver.write(z),w._receiver.end(),this[q]=void 0,clearTimeout(w._closeTimer),w._receiver._writableState.finished||w._receiver._writableState.errorEmitted?w.emitClose():(w._receiver.on("error",ze),w._receiver.on("finish",ze))}function H(w){this[q]._receiver.write(w)||this.pause()}function U(){const w=this[q];w._readyState=F.CLOSING,w._receiver.end(),this.end()}function l(){const w=this[q];this.removeListener("error",l),this.on("error",$),w&&(w._readyState=F.CLOSING,this.destroy())}return Rc}var Ac,Wh;function Lb(){if(Wh)return Ac;Wh=1;const{Duplex:i}=ir;function t(c){c.emit("close")}function r(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(c){this.removeListener("error",s),this.destroy(),this.listenerCount("error")===0&&this.emit("error",c)}function o(c,h){let p=!0;const y=new i({...h,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return c.on("message",function(v,b){const P=!b&&y._readableState.objectMode?v.toString():v;y.push(P)||c.pause()}),c.once("error",function(v){y.destroyed||(p=!1,y.destroy(v))}),c.once("close",function(){y.destroyed||y.push(null)}),y._destroy=function(g,v){if(c.readyState===c.CLOSED){v(g),process.nextTick(t,y);return}let b=!1;c.once("error",function(R){b=!0,v(R)}),c.once("close",function(){b||v(g),process.nextTick(t,y)}),p&&c.terminate()},y._final=function(g){if(c.readyState===c.CONNECTING){c.once("open",function(){y._final(g)});return}c._socket!==null&&(c._socket._writableState.finished?(g(),y._readableState.endEmitted&&y.destroy()):(c._socket.once("finish",function(){g()}),c.close()))},y._read=function(){c.isPaused&&c.resume()},y._write=function(g,v,b){if(c.readyState===c.CONNECTING){c.once("open",function(){y._write(g,v,b)});return}c.send(g,b)},y.on("end",r),y.on("error",s),y}return Ac=o,Ac}var Lc,Fh;function jb(){if(Fh)return Lc;Fh=1;const{tokenChars:i}=Ho();function t(r){const s=new Set;let o=-1,c=-1,h=0;for(h;h<r.length;h++){const y=r.charCodeAt(h);if(c===-1&&i[y]===1)o===-1&&(o=h);else if(h!==0&&(y===32||y===9))c===-1&&o!==-1&&(c=h);else if(y===44){if(o===-1)throw new SyntaxError(`Unexpected character at index ${h}`);c===-1&&(c=h);const g=r.slice(o,c);if(s.has(g))throw new SyntaxError(`The "${g}" subprotocol is duplicated`);s.add(g),o=c=-1}else throw new SyntaxError(`Unexpected character at index ${h}`)}if(o===-1||c!==-1)throw new SyntaxError("Unexpected end of input");const p=r.slice(o,h);if(s.has(p))throw new SyntaxError(`The "${p}" subprotocol is duplicated`);return s.add(p),s}return Lc={parse:t},Lc}var jc,Gh;function Db(){if(Gh)return jc;Gh=1;const i=Np(),t=ir,{createHash:r}=ir,s=Lp(),o=Vo(),c=jb(),h=jp(),{GUID:p,kWebSocket:y}=Zn(),g=/^[+/0-9A-Za-z]{22}==$/,v=0,b=1,P=2;class R extends i{constructor(B,S){if(super(),B={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:h,...B},B.port==null&&!B.server&&!B.noServer||B.port!=null&&(B.server||B.noServer)||B.server&&B.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(B.port!=null?(this._server=t.createServer((C,I)=>{const A=t.STATUS_CODES[426];I.writeHead(426,{"Content-Length":A.length,"Content-Type":"text/plain"}),I.end(A)}),this._server.listen(B.port,B.host,B.backlog,S)):B.server&&(this._server=B.server),this._server){const C=this.emit.bind(this,"connection");this._removeListeners=O(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(I,A,M)=>{this.handleUpgrade(I,A,M,C)}})}B.perMessageDeflate===!0&&(B.perMessageDeflate={}),B.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=B,this._state=v}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(B){if(this._state===P){B&&this.once("close",()=>{B(new Error("The server is not running"))}),process.nextTick(L,this);return}if(B&&this.once("close",B),this._state!==b)if(this._state=b,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(L,this):process.nextTick(L,this);else{const S=this._server;this._removeListeners(),this._removeListeners=this._server=null,S.close(()=>{L(this)})}}shouldHandle(B){if(this.options.path){const S=B.url.indexOf("?");if((S!==-1?B.url.slice(0,S):B.url)!==this.options.path)return!1}return!0}handleUpgrade(B,S,C,I){S.on("error",K);const A=B.headers["sec-websocket-key"]!==void 0?B.headers["sec-websocket-key"]:!1,M=+B.headers["sec-websocket-version"];if(B.method!=="GET"||B.headers.upgrade.toLowerCase()!=="websocket"||!A||!g.test(A)||M!==8&&M!==13||!this.shouldHandle(B))return q(S,400);const ae=B.headers["sec-websocket-protocol"];let Z=new Set;if(ae!==void 0)try{Z=c.parse(ae)}catch{return q(S,400)}const he=B.headers["sec-websocket-extensions"],F={};if(this.options.perMessageDeflate&&he!==void 0){const fe=new o(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const _=s.parse(he);_[o.extensionName]&&(fe.accept(_[o.extensionName]),F[o.extensionName]=fe)}catch{return q(S,400)}}if(this.options.verifyClient){const fe={origin:B.headers[`${M===8?"sec-websocket-origin":"origin"}`],secure:!!(B.socket.authorized||B.socket.encrypted),req:B};if(this.options.verifyClient.length===2){this.options.verifyClient(fe,(_,T,ce,le)=>{if(!_)return q(S,T||401,ce,le);this.completeUpgrade(F,A,Z,B,S,C,I)});return}if(!this.options.verifyClient(fe))return q(S,401)}this.completeUpgrade(F,A,Z,B,S,C,I)}completeUpgrade(B,S,C,I,A,M,ae){if(!A.readable||!A.writable)return A.destroy();if(A[y])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>v)return q(A,503);const he=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${r("sha1").update(S+p).digest("base64")}`],F=new this.options.WebSocket(null);if(C.size){const fe=this.options.handleProtocols?this.options.handleProtocols(C,I):C.values().next().value;fe&&(he.push(`Sec-WebSocket-Protocol: ${fe}`),F._protocol=fe)}if(B[o.extensionName]){const fe=B[o.extensionName].params,_=s.format({[o.extensionName]:[fe]});he.push(`Sec-WebSocket-Extensions: ${_}`),F._extensions=B}this.emit("headers",he,I),A.write(he.concat(`\r
`).join(`\r
`)),A.removeListener("error",K),F.setSocket(A,M,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(F),F.on("close",()=>{this.clients.delete(F),this._shouldEmitClose&&!this.clients.size&&process.nextTick(L,this)})),ae(F,I)}}jc=R;function O($,B){for(const S of Object.keys(B))$.on(S,B[S]);return function(){for(const C of Object.keys(B))$.removeListener(C,B[C])}}function L($){$._state=P,$.emit("close")}function K(){this.destroy()}function q($,B,S,C){$.writable&&(S=S||t.STATUS_CODES[B],C={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(S),...C},$.write(`HTTP/1.1 ${B} ${t.STATUS_CODES[B]}\r
`+Object.keys(C).map(I=>`${I}: ${C[I]}`).join(`\r
`)+`\r
\r
`+S)),$.removeListener("error",K),$.destroy()}return jc}var Dc,Yh;function kb(){if(Yh)return Dc;Yh=1;const i=jp();return i.createWebSocketStream=Lb(),i.Server=Db(),i.Receiver=Rp(),i.Sender=Ap(),i.WebSocket=i,i.WebSocketServer=i.Server,Dc=i,Dc}var Ub={};function gu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Dp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Zc(i,t){t||(t=i.reduce((o,c)=>o+c.length,0));const r=Dp(t);let s=0;for(const o of i)r.set(o,s),s+=o.length;return gu(r)}const Jh={...ub,...lb,...hb,...fb,...pb,...db,...gb,...yb,...vb,...mb};function kp(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const Qh=kp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),kc=kp("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=Dp(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),Up={utf8:Qh,"utf-8":Qh,hex:Jh.base16,latin1:kc,ascii:kc,binary:kc,...Jh};function vr(i,t="utf8"){const r=Up[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gu(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function ar(i,t="utf8"){const r=Up[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}var Xh=function(i,t,r){if(r||arguments.length===2)for(var s=0,o=t.length,c;s<o;s++)(c||!(s in t))&&(c||(c=Array.prototype.slice.call(t,0,s)),c[s]=t[s]);return i.concat(c||Array.prototype.slice.call(t))},Mb=function(){function i(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return i}(),qb=function(){function i(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return i}(),$b=function(){function i(t,r,s,o){this.name=t,this.version=r,this.os=s,this.bot=o,this.type="bot-device"}return i}(),zb=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),Bb=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),Kb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Vb=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zh=3,Hb=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Kb]],ef=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Wb(i){return i?tf(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Bb:typeof navigator<"u"?tf(navigator.userAgent):Yb()}function Fb(i){return i!==""&&Hb.reduce(function(t,r){var s=r[0],o=r[1];if(t)return t;var c=o.exec(i);return!!c&&[s,c]},!1)}function tf(i){var t=Fb(i);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new zb;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Zh&&(o=Xh(Xh([],o,!0),Jb(Zh-o.length),!0)):o=[];var c=o.join("."),h=Gb(i),p=Vb.exec(i);return p&&p[1]?new $b(r,c,h,p[1]):new Mb(r,c,h)}function Gb(i){for(var t=0,r=ef.length;t<r;t++){var s=ef[t],o=s[0],c=s[1],h=c.exec(i);if(h)return o}return null}function Yb(){var i=typeof process<"u"&&process.version;return i?new qb(process.version.slice(1)):null}function Jb(i){for(var t=[],r=0;r<i;r++)t.push("0");return t}const Qb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Xb=":";function Zb(i){const[t,r]=i.split(Xb);return{namespace:t,reference:r}}function e0(i,t=[]){const r=[];return Object.keys(i).forEach(s=>{if(t.length&&!t.includes(s))return;const o=i[s];r.push(...o.accounts)}),r}function Mp(i,t){return i.includes(":")?[i]:t.chains||[]}const qp="base10",or="base16",eu="base64pad",yu="utf8",$p=0,ei=1,t0=0,rf=1,tu=12,vu=32;function r0(){const i=Op.generateKeyPair();return{privateKey:ar(i.secretKey,or),publicKey:ar(i.publicKey,or)}}function ru(){const i=Bo.randomBytes(vu);return ar(i,or)}function n0(i,t){const r=Op.sharedKey(vr(i,or),vr(t,or),!0),s=new Eb(pu.SHA256,r).expand(vu);return ar(s,or)}function i0(i){const t=pu.hash(vr(i,or));return ar(t,or)}function Ci(i){const t=pu.hash(vr(i,yu));return ar(t,or)}function s0(i){return vr(`${i}`,qp)}function hs(i){return Number(ar(i,qp))}function o0(i){const t=s0(typeof i.type<"u"?i.type:$p);if(hs(t)===ei&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof i.senderPublicKey<"u"?vr(i.senderPublicKey,or):void 0,s=typeof i.iv<"u"?vr(i.iv,or):Bo.randomBytes(tu),o=new Cp.ChaCha20Poly1305(vr(i.symKey,or)).seal(s,vr(i.message,yu));return c0({type:t,sealed:o,iv:s,senderPublicKey:r})}function a0(i){const t=new Cp.ChaCha20Poly1305(vr(i.symKey,or)),{sealed:r,iv:s}=Uo(i.encoded),o=t.open(s,r);if(o===null)throw new Error("Failed to decrypt");return ar(o,yu)}function c0(i){if(hs(i.type)===ei){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ar(Zc([i.type,i.senderPublicKey,i.iv,i.sealed]),eu)}return ar(Zc([i.type,i.iv,i.sealed]),eu)}function Uo(i){const t=vr(i,eu),r=t.slice(t0,rf),s=rf;if(hs(r)===ei){const p=s+vu,y=p+tu,g=t.slice(s,p),v=t.slice(p,y),b=t.slice(y);return{type:r,sealed:b,iv:v,senderPublicKey:g}}const o=s+tu,c=t.slice(s,o),h=t.slice(o);return{type:r,sealed:h,iv:c}}function u0(i,t){const r=Uo(i);return zp({type:hs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ar(r.senderPublicKey,or):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function zp(i){const t=(i==null?void 0:i.type)||$p;if(t===ei){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function nf(i){return i.type===ei&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var l0=Object.defineProperty,sf=Object.getOwnPropertySymbols,h0=Object.prototype.hasOwnProperty,f0=Object.prototype.propertyIsEnumerable,of=(i,t,r)=>t in i?l0(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,af=(i,t)=>{for(var r in t||(t={}))h0.call(t,r)&&of(i,r,t[r]);if(sf)for(var r of sf(t))f0.call(t,r)&&of(i,r,t[r]);return i};const p0="ReactNative",xr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},d0="js";function mu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ri(){return!Pp()&&!!xp()&&navigator.product===p0}function Ai(){return!mu()&&!!xp()&&!!Pp()}function fs(){return Ri()?xr.reactNative:mu()?xr.node:Ai()?xr.browser:xr.unknown}function g0(){var i;try{return Ri()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function y0(i,t){let r=ko.parse(i);return r=af(af({},r),t),i=ko.stringify(r),i}function v0(){return bb()||{name:"",description:"",url:"",icons:[""]}}function m0(){if(fs()===xr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const i=Wb();if(i===null)return"unknown";const t=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[t,i.name,i.version].join("-"):[t,i.version].join("-")}function _0(){var i;const t=fs();return t===xr.browser?[t,((i=Ib())==null?void 0:i.host)||"unknown"].join(":"):t}function w0(i,t,r){const s=m0(),o=_0();return[[i,t].join("-"),[d0,r].join("-"),s,o].join("/")}function b0({protocol:i,version:t,relayUrl:r,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:h,bundleId:p}){const y=r.split("?"),g=w0(i,t,s),v={auth:o,ua:g,projectId:c,useOnCloseEvent:h||void 0,origin:p||void 0},b=y0(y[1]||"",v);return y[0]+"?"+b}function Qn(i,t){return i.filter(r=>t.includes(r)).length===i.length}function Bp(i){return Object.fromEntries(i.entries())}function Kp(i){return new Map(Object.entries(i))}function Pi(i=ve.FIVE_MINUTES,t){const r=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:h=>{c&&s&&(clearTimeout(c),s(h))},reject:h=>{c&&o&&(clearTimeout(c),o(h))},done:()=>new Promise((h,p)=>{c=setTimeout(()=>{p(new Error(t))},r),s=h,o=p})}}function us(i,t,r){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(r)),t);try{const h=await i;s(h)}catch(h){o(h)}clearTimeout(c)})}function Vp(i,t){if(typeof t=="string"&&t.startsWith(`${i}:`))return t;if(i.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(i.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${i}`)}function E0(i){return Vp("topic",i)}function I0(i){return Vp("id",i)}function Hp(i){const[t,r]=i.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Sr(i,t){return ve.fromMiliseconds((t||Date.now())+ve.toMiliseconds(i))}function An(i){return Date.now()>=ve.toMiliseconds(i)}function Tt(i,t){return`${i}${t?`:${t}`:""}`}function Uc(i=[],t=[]){return[...new Set([...i,...t])]}async function S0({id:i,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${t}`,h=fs();h===xr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):h===xr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function x0(i,t){try{return await i.getItem(t)||(Ai()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const P0="irn";function nu(i){return(i==null?void 0:i.relay)||{protocol:P0}}function Lo(i){const t=Qb[i];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${i}`);return t}var O0=Object.defineProperty,C0=Object.defineProperties,N0=Object.getOwnPropertyDescriptors,cf=Object.getOwnPropertySymbols,T0=Object.prototype.hasOwnProperty,R0=Object.prototype.propertyIsEnumerable,uf=(i,t,r)=>t in i?O0(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,A0=(i,t)=>{for(var r in t||(t={}))T0.call(t,r)&&uf(i,r,t[r]);if(cf)for(var r of cf(t))R0.call(t,r)&&uf(i,r,t[r]);return i},L0=(i,t)=>C0(i,N0(t));function j0(i,t="-"){const r={},s="relay"+t;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),h=i[o];r[c]=h}}),r}function lf(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const t=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,t),o=i.substring(t+1,r).split("@"),c=typeof r<"u"?i.substring(r):"",h=ko.parse(c);return{protocol:s,topic:D0(o[0]),version:parseInt(o[1],10),symKey:h.symKey,relay:j0(h),expiryTimestamp:h.expiryTimestamp?parseInt(h.expiryTimestamp,10):void 0}}function D0(i){return i.startsWith("//")?i.substring(2):i}function k0(i,t="-"){const r="relay",s={};return Object.keys(i).forEach(o=>{const c=r+t+o;i[o]&&(s[c]=i[o])}),s}function U0(i){return`${i.protocol}:${i.topic}@${i.version}?`+ko.stringify(L0(A0({symKey:i.symKey},k0(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function Li(i){const t=[];return i.forEach(r=>{const[s,o]=r.split(":");t.push(`${s}:${o}`)}),t}function M0(i){const t=[];return Object.values(i).forEach(r=>{t.push(...Li(r.accounts))}),t}function q0(i,t){const r=[];return Object.values(i).forEach(s=>{Li(s.accounts).includes(t)&&r.push(...s.methods)}),r}function $0(i,t){const r=[];return Object.values(i).forEach(s=>{Li(s.accounts).includes(t)&&r.push(...s.events)}),r}function _u(i){return i.includes(":")}function ss(i){return _u(i)?i.split(":")[0]:i}const z0={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},B0={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,t){const{message:r,code:s}=B0[i];return{message:t?`${r} ${t}`:r,code:s}}function ft(i,t){const{message:r,code:s}=z0[i];return{message:t?`${r} ${t}`:r,code:s}}function Zr(i,t){return Array.isArray(i)?typeof t<"u"&&i.length?i.every(t):!0:!1}function ls(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function sr(i){return typeof i>"u"}function Vt(i,t){return t&&sr(i)?!0:typeof i=="string"&&!!i.trim().length}function wu(i,t){return t&&sr(i)?!0:typeof i=="number"&&!isNaN(i)}function K0(i,t){const{requiredNamespaces:r}=t,s=Object.keys(i.namespaces),o=Object.keys(r);let c=!0;return Qn(o,s)?(s.forEach(h=>{const{accounts:p,methods:y,events:g}=i.namespaces[h],v=Li(p),b=r[h];(!Qn(Mp(h,b),v)||!Qn(b.methods,y)||!Qn(b.events,g))&&(c=!1)}),c):!1}function Mo(i){return Vt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function V0(i){if(Vt(i,!1)&&i.includes(":")){const t=i.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Mo(r)}}return!1}function H0(i){if(Vt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function W0(i){var t;return(t=i==null?void 0:i.proposer)==null?void 0:t.publicKey}function F0(i){return i==null?void 0:i.topic}function G0(i,t){let r=null;return Vt(i==null?void 0:i.publicKey,!1)||(r=ue("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function hf(i){let t=!0;return Zr(i)?i.length&&(t=i.every(r=>Vt(r,!1))):t=!1,t}function Y0(i,t,r){let s=null;return Zr(t)&&t.length?t.forEach(o=>{s||Mo(o)||(s=ft("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Mo(i)||(s=ft("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function J0(i,t,r){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const h=Y0(o,Mp(o,c),`${t} ${r}`);h&&(s=h)}),s}function Q0(i,t){let r=null;return Zr(i)?i.forEach(s=>{r||V0(s)||(r=ft("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=ft("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function X0(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=Q0(s==null?void 0:s.accounts,`${t} namespace`);o&&(r=o)}),r}function Z0(i,t){let r=null;return hf(i==null?void 0:i.methods)?hf(i==null?void 0:i.events)||(r=ft("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=ft("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Wp(i,t){let r=null;return Object.values(i).forEach(s=>{if(r)return;const o=Z0(s,`${t}, namespace`);o&&(r=o)}),r}function e1(i,t,r){let s=null;if(i&&ls(i)){const o=Wp(i,t);o&&(s=o);const c=J0(i,t,r);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Mc(i,t){let r=null;if(i&&ls(i)){const s=Wp(i,t);s&&(r=s);const o=X0(i,t);o&&(r=o)}else r=ue("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Fp(i){return Vt(i.protocol,!0)}function t1(i,t){let r=!1;return t&&!i?r=!0:i&&Zr(i)&&i.length&&i.forEach(s=>{r=Fp(s)}),r}function r1(i){return typeof i=="number"}function yr(i){return typeof i<"u"&&typeof i!==null}function n1(i){return!(!i||typeof i!="object"||!i.code||!wu(i.code,!1)||!i.message||!Vt(i.message,!1))}function i1(i){return!(sr(i)||!Vt(i.method,!1))}function s1(i){return!(sr(i)||sr(i.result)&&sr(i.error)||!wu(i.id,!1)||!Vt(i.jsonrpc,!1))}function o1(i){return!(sr(i)||!Vt(i.name,!1))}function ff(i,t){return!(!Mo(t)||!M0(i).includes(t))}function a1(i,t,r){return Vt(r,!1)?q0(i,t).includes(r):!1}function c1(i,t,r){return Vt(r,!1)?$0(i,t).includes(r):!1}function pf(i,t,r){let s=null;const o=u1(i),c=l1(t),h=Object.keys(o),p=Object.keys(c),y=df(Object.keys(i)),g=df(Object.keys(t)),v=y.filter(b=>!g.includes(b));return v.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(t).toString()}`)),Qn(h,p)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${p.toString()}`)),Object.keys(t).forEach(b=>{if(!b.includes(":")||s)return;const P=Li(t[b].accounts);P.includes(b)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${b}
        Required: ${b}
        Approved: ${P.toString()}`))}),h.forEach(b=>{s||(Qn(o[b].methods,c[b].methods)?Qn(o[b].events,c[b].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${b}`)):s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${b}`))}),s}function u1(i){const t={};return Object.keys(i).forEach(r=>{var s;r.includes(":")?t[r]=i[r]:(s=i[r].chains)==null||s.forEach(o=>{t[o]={methods:i[r].methods,events:i[r].events}})}),t}function df(i){return[...new Set(i.map(t=>t.includes(":")?t.split(":")[0]:t))]}function l1(i){const t={};return Object.keys(i).forEach(r=>{if(r.includes(":"))t[r]=i[r];else{const s=Li(i[r].accounts);s==null||s.forEach(o=>{t[o]={accounts:i[r].accounts.filter(c=>c.includes(`${o}:`)),methods:i[r].methods,events:i[r].events}})}}),t}function h1(i,t){return wu(i,!1)&&i<=t.max&&i>=t.min}function gf(){const i=fs();return new Promise(t=>{switch(i){case xr.browser:t(f1());break;case xr.reactNative:t(p1());break;case xr.node:t(d1());break;default:t(!0)}})}function f1(){return Ai()&&(navigator==null?void 0:navigator.onLine)}async function p1(){if(Ri()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function d1(){return!0}function g1(i){switch(fs()){case xr.browser:y1(i);break;case xr.reactNative:v1(i);break}}function y1(i){!Ri()&&Ai()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function v1(i){Ri()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>i(t==null?void 0:t.isConnected)))}const qc={};let Oo=class{static get(i){return qc[i]}static set(i,t){qc[i]=t}static delete(i){delete qc[i]}};const m1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,w1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function b1(i,t){if(i==="__proto__"||i==="constructor"&&t&&typeof t=="object"&&"prototype"in t){E1(i);return}return t}function E1(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Co(i,t={}){if(typeof i!="string")return i;const r=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!w1.test(i)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(m1.test(i)||_1.test(i)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,b1)}return JSON.parse(i)}catch(s){if(t.strict)throw s;return i}}function I1(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Kt(i,...t){try{return I1(i(...t))}catch(r){return Promise.reject(r)}}function S1(i){const t=typeof i;return i===null||t!=="object"&&t!=="function"}function x1(i){const t=Object.getPrototypeOf(i);return!t||t.isPrototypeOf(Object)}function jo(i){if(S1(i))return String(i);if(x1(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return jo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Gp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const iu="base64:";function P1(i){if(typeof i=="string")return i;Gp();const t=Buffer.from(i).toString("base64");return iu+t}function O1(i){return typeof i!="string"||!i.startsWith(iu)?i:(Gp(),Buffer.from(i.slice(iu.length),"base64"))}function gr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function C1(...i){return gr(i.join(":"))}function No(i){return i=gr(i),i?i+":":""}const N1="memory",T1=()=>{const i=new Map;return{name:N1,options:{},hasItem(t){return i.has(t)},getItem(t){return i.get(t)??null},getItemRaw(t){return i.get(t)??null},setItem(t,r){i.set(t,r)},setItemRaw(t,r){i.set(t,r)},removeItem(t){i.delete(t)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function R1(i={}){const t={mounts:{"":i.driver||T1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=g=>{for(const v of t.mountpoints)if(g.startsWith(v))return{base:v,relativeKey:g.slice(v.length),driver:t.mounts[v]};return{base:"",relativeKey:g,driver:t.mounts[""]}},s=(g,v)=>t.mountpoints.filter(b=>b.startsWith(g)||v&&g.startsWith(b)).map(b=>({relativeBase:g.length>b.length?g.slice(b.length):void 0,mountpoint:b,driver:t.mounts[b]})),o=(g,v)=>{if(t.watching){v=gr(v);for(const b of t.watchListeners)b(g,v)}},c=async()=>{if(!t.watching){t.watching=!0;for(const g in t.mounts)t.unwatch[g]=await yf(t.mounts[g],o,g)}},h=async()=>{if(t.watching){for(const g in t.unwatch)await t.unwatch[g]();t.unwatch={},t.watching=!1}},p=(g,v,b)=>{const P=new Map,R=O=>{let L=P.get(O.base);return L||(L={driver:O.driver,base:O.base,items:[]},P.set(O.base,L)),L};for(const O of g){const L=typeof O=="string",K=gr(L?O:O.key),q=L?void 0:O.value,$=L||!O.options?v:{...v,...O.options},B=r(K);R(B).items.push({key:K,value:q,relativeKey:B.relativeKey,options:$})}return Promise.all([...P.values()].map(O=>b(O))).then(O=>O.flat())},y={hasItem(g,v={}){g=gr(g);const{relativeKey:b,driver:P}=r(g);return Kt(P.hasItem,b,v)},getItem(g,v={}){g=gr(g);const{relativeKey:b,driver:P}=r(g);return Kt(P.getItem,b,v).then(R=>Co(R))},getItems(g,v){return p(g,v,b=>b.driver.getItems?Kt(b.driver.getItems,b.items.map(P=>({key:P.relativeKey,options:P.options})),v).then(P=>P.map(R=>({key:C1(b.base,R.key),value:Co(R.value)}))):Promise.all(b.items.map(P=>Kt(b.driver.getItem,P.relativeKey,P.options).then(R=>({key:P.key,value:Co(R)})))))},getItemRaw(g,v={}){g=gr(g);const{relativeKey:b,driver:P}=r(g);return P.getItemRaw?Kt(P.getItemRaw,b,v):Kt(P.getItem,b,v).then(R=>O1(R))},async setItem(g,v,b={}){if(v===void 0)return y.removeItem(g);g=gr(g);const{relativeKey:P,driver:R}=r(g);R.setItem&&(await Kt(R.setItem,P,jo(v),b),R.watch||o("update",g))},async setItems(g,v){await p(g,v,async b=>{b.driver.setItems&&await Kt(b.driver.setItems,b.items.map(P=>({key:P.relativeKey,value:jo(P.value),options:P.options})),v),b.driver.setItem&&await Promise.all(b.items.map(P=>Kt(b.driver.setItem,P.relativeKey,jo(P.value),P.options)))})},async setItemRaw(g,v,b={}){if(v===void 0)return y.removeItem(g,b);g=gr(g);const{relativeKey:P,driver:R}=r(g);if(R.setItemRaw)await Kt(R.setItemRaw,P,v,b);else if(R.setItem)await Kt(R.setItem,P,P1(v),b);else return;R.watch||o("update",g)},async removeItem(g,v={}){typeof v=="boolean"&&(v={removeMeta:v}),g=gr(g);const{relativeKey:b,driver:P}=r(g);P.removeItem&&(await Kt(P.removeItem,b,v),(v.removeMeta||v.removeMata)&&await Kt(P.removeItem,b+"$",v),P.watch||o("remove",g))},async getMeta(g,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),g=gr(g);const{relativeKey:b,driver:P}=r(g),R=Object.create(null);if(P.getMeta&&Object.assign(R,await Kt(P.getMeta,b,v)),!v.nativeOnly){const O=await Kt(P.getItem,b+"$",v).then(L=>Co(L));O&&typeof O=="object"&&(typeof O.atime=="string"&&(O.atime=new Date(O.atime)),typeof O.mtime=="string"&&(O.mtime=new Date(O.mtime)),Object.assign(R,O))}return R},setMeta(g,v,b={}){return this.setItem(g+"$",v,b)},removeMeta(g,v={}){return this.removeItem(g+"$",v)},async getKeys(g,v={}){g=No(g);const b=s(g,!0);let P=[];const R=[];for(const O of b){const L=(await Kt(O.driver.getKeys,O.relativeBase,v)).map(K=>O.mountpoint+gr(K)).filter(K=>!P.some(q=>K.startsWith(q)));R.push(...L),P=[O.mountpoint,...P.filter(K=>!K.startsWith(O.mountpoint))]}return g?R.filter(O=>O.startsWith(g)&&!O.endsWith("$")):R.filter(O=>!O.endsWith("$"))},async clear(g,v={}){g=No(g),await Promise.all(s(g,!1).map(async b=>{if(b.driver.clear)return Kt(b.driver.clear,b.relativeBase,v);if(b.driver.removeItem){const P=await b.driver.getKeys(b.relativeBase||"",v);return Promise.all(P.map(R=>b.driver.removeItem(R,v)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(g=>vf(g)))},async watch(g){return await c(),t.watchListeners.push(g),async()=>{t.watchListeners=t.watchListeners.filter(v=>v!==g),t.watchListeners.length===0&&await h()}},async unwatch(){t.watchListeners=[],await h()},mount(g,v){if(g=No(g),g&&t.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(t.mountpoints.push(g),t.mountpoints.sort((b,P)=>P.length-b.length)),t.mounts[g]=v,t.watching&&Promise.resolve(yf(v,o,g)).then(b=>{t.unwatch[g]=b}).catch(console.error),y},async unmount(g,v=!0){g=No(g),!(!g||!t.mounts[g])&&(t.watching&&g in t.unwatch&&(t.unwatch[g](),delete t.unwatch[g]),v&&await vf(t.mounts[g]),t.mountpoints=t.mountpoints.filter(b=>b!==g),delete t.mounts[g])},getMount(g=""){g=gr(g)+":";const v=r(g);return{driver:v.driver,base:v.base}},getMounts(g="",v={}){return g=gr(g),s(g,v.parents).map(b=>({driver:b.driver,base:b.mountpoint}))}};return y}function yf(i,t,r){return i.watch?i.watch((s,o)=>t(s,r+o)):()=>{}}async function vf(i){typeof i.dispose=="function"&&await Kt(i.dispose)}function ti(i){return new Promise((t,r)=>{i.oncomplete=i.onsuccess=()=>t(i.result),i.onabort=i.onerror=()=>r(i.error)})}function Yp(i,t){const r=indexedDB.open(i);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=ti(r);return(o,c)=>s.then(h=>c(h.transaction(t,o).objectStore(t)))}let $c;function ps(){return $c||($c=Yp("keyval-store","keyval")),$c}function mf(i,t=ps()){return t("readonly",r=>ti(r.get(i)))}function A1(i,t,r=ps()){return r("readwrite",s=>(s.put(t,i),ti(s.transaction)))}function L1(i,t=ps()){return t("readwrite",r=>(r.delete(i),ti(r.transaction)))}function j1(i=ps()){return i("readwrite",t=>(t.clear(),ti(t.transaction)))}function D1(i,t){return i.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},ti(i.transaction)}function k1(i=ps()){return i("readonly",t=>{if(t.getAllKeys)return ti(t.getAllKeys());const r=[];return D1(t,s=>r.push(s.key)).then(()=>r)})}const U1=i=>JSON.stringify(i,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),M1=i=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=i.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ds(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return M1(i)}catch{return i}}function Xn(i){return typeof i=="string"?i:U1(i)||""}const q1="idb-keyval";var $1=(i={})=>{const t=i.base&&i.base.length>0?`${i.base}:`:"",r=o=>t+o;let s;return i.dbName&&i.storeName&&(s=Yp(i.dbName,i.storeName)),{name:q1,options:i,async hasItem(o){return!(typeof await mf(r(o),s)>"u")},async getItem(o){return await mf(r(o),s)??null},setItem(o,c){return A1(r(o),c,s)},removeItem(o){return L1(r(o),s)},getKeys(){return k1(s)},clear(){return j1(s)}}};const z1="WALLET_CONNECT_V2_INDEXED_DB",B1="keyvaluestorage";let K1=class{constructor(){this.indexedDb=R1({driver:$1({dbName:z1,storeName:B1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const t=await this.indexedDb.getItem(i);if(t!==null)return t}async setItem(i,t){await this.indexedDb.setItem(i,Xn(t))}async removeItem(i){await this.indexedDb.removeItem(i)}};var zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Do={exports:{}};(function(){let i;function t(){}i=t,i.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},i.prototype.setItem=function(r,s){this[r]=String(s)},i.prototype.removeItem=function(r){delete this[r]},i.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},i.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof zc<"u"&&zc.localStorage?Do.exports=zc.localStorage:typeof window<"u"&&window.localStorage?Do.exports=window.localStorage:Do.exports=new t})();function V1(i){var t;return[i[0],ds((t=i[1])!=null?t:"")]}class H1{constructor(){this.localStorage=Do.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(V1)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ds(r)}async setItem(t,r){this.localStorage.setItem(t,Xn(r))}async removeItem(t){this.localStorage.removeItem(t)}}const W1="wc_storage_version",_f=1,F1=async(i,t,r)=>{const s=W1,o=await t.getItem(s);if(o&&o>=_f){r(t);return}const c=await i.getKeys();if(!c.length){r(t);return}const h=[];for(;c.length;){const p=c.shift();if(!p)continue;const y=p.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const g=await i.getItem(p);await t.setItem(p,g),h.push(p)}}await t.setItem(s,_f),r(t),G1(i,h)},G1=async(i,t)=>{t.length&&t.forEach(async r=>{await i.removeItem(r)})};let Y1=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const i=new H1;this.storage=i;try{const t=new K1;F1(i,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,t){return await this.initialize(),this.storage.setItem(i,t)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),i())},20)})}};var ji={},es={},wf={},ts={};let ri=class{};const J1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ri},Symbol.toStringTag,{value:"Module"})),Q1=Ip(J1);var bf;function X1(){if(bf)return ts;bf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IHeartBeat=void 0;const i=Q1;class t extends i.IEvents{constructor(s){super()}}return ts.IHeartBeat=t,ts}var Ef;function Jp(){return Ef||(Ef=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ti.__exportStar(X1(),i)}(wf)),wf}var If={},Jn={},Sf;function Z1(){if(Sf)return Jn;Sf=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.HEARTBEAT_EVENTS=Jn.HEARTBEAT_INTERVAL=void 0;const i=ve;return Jn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Jn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Jn}var xf;function Qp(){return xf||(xf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ti.__exportStar(Z1(),i)}(If)),If}var Pf;function eE(){if(Pf)return es;Pf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.HeartBeat=void 0;const i=Ti,t=kr,r=ve,s=Jp(),o=Qp();class c extends s.IHeartBeat{constructor(p){super(p),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||o.HEARTBEAT_INTERVAL}static init(p){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(p);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,y){this.events.on(p,y)}once(p,y){this.events.once(p,y)}off(p,y){this.events.off(p,y)}removeListener(p,y){this.events.removeListener(p,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return es.HeartBeat=c,es}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ti;t.__exportStar(eE(),i),t.__exportStar(Jp(),i),t.__exportStar(Qp(),i)})(ji);var De={},Bc,Of;function tE(){if(Of)return Bc;Of=1;function i(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Bc=t;function t(r,s,o){var c=o&&o.stringify||i,h=1;if(typeof r=="object"&&r!==null){var p=s.length+h;if(p===1)return r;var y=new Array(p);y[0]=c(r);for(var g=1;g<p;g++)y[g]=c(s[g]);return y.join(" ")}if(typeof r!="string")return r;var v=s.length;if(v===0)return r;for(var b="",P=1-h,R=-1,O=r&&r.length||0,L=0;L<O;){if(r.charCodeAt(L)===37&&L+1<O){switch(R=R>-1?R:0,r.charCodeAt(L+1)){case 100:case 102:if(P>=v||s[P]==null)break;R<L&&(b+=r.slice(R,L)),b+=Number(s[P]),R=L+2,L++;break;case 105:if(P>=v||s[P]==null)break;R<L&&(b+=r.slice(R,L)),b+=Math.floor(Number(s[P])),R=L+2,L++;break;case 79:case 111:case 106:if(P>=v||s[P]===void 0)break;R<L&&(b+=r.slice(R,L));var K=typeof s[P];if(K==="string"){b+="'"+s[P]+"'",R=L+2,L++;break}if(K==="function"){b+=s[P].name||"<anonymous>",R=L+2,L++;break}b+=c(s[P]),R=L+2,L++;break;case 115:if(P>=v)break;R<L&&(b+=r.slice(R,L)),b+=String(s[P]),R=L+2,L++;break;case 37:R<L&&(b+=r.slice(R,L)),b+="%",R=L+2,L++,P--;break}++P}++L}return R===-1?r:(R<O&&(b+=r.slice(R)),b)}return Bc}var Kc,Cf;function rE(){if(Cf)return Kc;Cf=1;const i=tE();Kc=o;const t=C().console||{},r={mapHttpRequest:O,mapHttpResponse:O,wrapRequestSerializer:L,wrapResponseSerializer:L,wrapErrorSerializer:L,req:O,res:O,err:P};function s(I,A){return Array.isArray(I)?I.filter(function(M){return M!=="!stdSerializers.err"}):I===!0?Object.keys(A):!1}function o(I){I=I||{},I.browser=I.browser||{};const A=I.browser.transmit;if(A&&typeof A.send!="function")throw Error("pino: transmit option must have a send function");const M=I.browser.write||t;I.browser.write&&(I.browser.asObject=!0);const ae=I.serializers||{},Z=s(I.browser.serialize,ae);let he=I.browser.serialize;Array.isArray(I.browser.serialize)&&I.browser.serialize.indexOf("!stdSerializers.err")>-1&&(he=!1);const F=["error","fatal","warn","info","debug","trace"];typeof M=="function"&&(M.error=M.fatal=M.warn=M.info=M.debug=M.trace=M),I.enabled===!1&&(I.level="silent");const fe=I.level||"info",_=Object.create(M);_.log||(_.log=K),Object.defineProperty(_,"levelVal",{get:ce}),Object.defineProperty(_,"level",{get:le,set:ne});const T={transmit:A,serialize:Z,asObject:I.browser.asObject,levels:F,timestamp:R(I)};_.levels=o.levels,_.level=fe,_.setMaxListeners=_.getMaxListeners=_.emit=_.addListener=_.on=_.prependListener=_.once=_.prependOnceListener=_.removeListener=_.removeAllListeners=_.listeners=_.listenerCount=_.eventNames=_.write=_.flush=K,_.serializers=ae,_._serialize=Z,_._stdErrSerialize=he,_.child=Q,A&&(_._logEvent=b());function ce(){return this.level==="silent"?1/0:this.levels.values[this.level]}function le(){return this._level}function ne(ee){if(ee!=="silent"&&!this.levels.values[ee])throw Error("unknown level "+ee);this._level=ee,c(T,_,"error","log"),c(T,_,"fatal","error"),c(T,_,"warn","error"),c(T,_,"info","log"),c(T,_,"debug","log"),c(T,_,"trace","log")}function Q(ee,se){if(!ee)throw new Error("missing bindings for child Pino");se=se||{},Z&&ee.serializers&&(se.serializers=ee.serializers);const ze=se.serializers;if(Z&&ze){var Be=Object.assign({},ae,ze),cr=I.browser.serialize===!0?Object.keys(Be):Z;delete ee.serializers,y([ee],cr,Be,this._stdErrSerialize)}function xe(nt){this._childLevel=(nt._childLevel|0)+1,this.error=g(nt,ee,"error"),this.fatal=g(nt,ee,"fatal"),this.warn=g(nt,ee,"warn"),this.info=g(nt,ee,"info"),this.debug=g(nt,ee,"debug"),this.trace=g(nt,ee,"trace"),Be&&(this.serializers=Be,this._serialize=cr),A&&(this._logEvent=b([].concat(nt._logEvent.bindings,ee)))}return xe.prototype=this,new xe(this)}return _}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:q,epochTime:$,unixTime:B,isoTime:S});function c(I,A,M,ae){const Z=Object.getPrototypeOf(A);A[M]=A.levelVal>A.levels.values[M]?K:Z[M]?Z[M]:t[M]||t[ae]||K,h(I,A,M)}function h(I,A,M){!I.transmit&&A[M]===K||(A[M]=function(ae){return function(){const Z=I.timestamp(),he=new Array(arguments.length),F=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var fe=0;fe<he.length;fe++)he[fe]=arguments[fe];if(I.serialize&&!I.asObject&&y(he,this._serialize,this.serializers,this._stdErrSerialize),I.asObject?ae.call(F,p(this,M,he,Z)):ae.apply(F,he),I.transmit){const _=I.transmit.level||A.level,T=o.levels.values[_],ce=o.levels.values[M];if(ce<T)return;v(this,{ts:Z,methodLevel:M,methodValue:ce,transmitLevel:_,transmitValue:o.levels.values[I.transmit.level||A.level],send:I.transmit.send,val:A.levelVal},he)}}}(A[M]))}function p(I,A,M,ae){I._serialize&&y(M,I._serialize,I.serializers,I._stdErrSerialize);const Z=M.slice();let he=Z[0];const F={};ae&&(F.time=ae),F.level=o.levels.values[A];let fe=(I._childLevel|0)+1;if(fe<1&&(fe=1),he!==null&&typeof he=="object"){for(;fe--&&typeof Z[0]=="object";)Object.assign(F,Z.shift());he=Z.length?i(Z.shift(),Z):void 0}else typeof he=="string"&&(he=i(Z.shift(),Z));return he!==void 0&&(F.msg=he),F}function y(I,A,M,ae){for(const Z in I)if(ae&&I[Z]instanceof Error)I[Z]=o.stdSerializers.err(I[Z]);else if(typeof I[Z]=="object"&&!Array.isArray(I[Z]))for(const he in I[Z])A&&A.indexOf(he)>-1&&he in M&&(I[Z][he]=M[he](I[Z][he]))}function g(I,A,M){return function(){const ae=new Array(1+arguments.length);ae[0]=A;for(var Z=1;Z<ae.length;Z++)ae[Z]=arguments[Z-1];return I[M].apply(this,ae)}}function v(I,A,M){const ae=A.send,Z=A.ts,he=A.methodLevel,F=A.methodValue,fe=A.val,_=I._logEvent.bindings;y(M,I._serialize||Object.keys(I.serializers),I.serializers,I._stdErrSerialize===void 0?!0:I._stdErrSerialize),I._logEvent.ts=Z,I._logEvent.messages=M.filter(function(T){return _.indexOf(T)===-1}),I._logEvent.level.label=he,I._logEvent.level.value=F,ae(he,I._logEvent,fe),I._logEvent=b(_)}function b(I){return{ts:0,messages:[],bindings:I||[],level:{label:"",value:0}}}function P(I){const A={type:I.constructor.name,msg:I.message,stack:I.stack};for(const M in I)A[M]===void 0&&(A[M]=I[M]);return A}function R(I){return typeof I.timestamp=="function"?I.timestamp:I.timestamp===!1?q:$}function O(){return{}}function L(I){return I}function K(){}function q(){return!1}function $(){return Date.now()}function B(){return Math.round(Date.now()/1e3)}function S(){return new Date(Date.now()).toISOString()}function C(){function I(A){return typeof A<"u"&&A}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return I(self)||I(window)||I(this)||{}}}return Kc}var Si={},Nf;function Xp(){return Nf||(Nf=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.PINO_CUSTOM_CONTEXT_KEY=Si.PINO_LOGGER_DEFAULTS=void 0,Si.PINO_LOGGER_DEFAULTS={level:"info"},Si.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Si}var rr={},Tf;function nE(){if(Tf)return rr;Tf=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const i=Xp();function t(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||i.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function r(p,y=i.PINO_CUSTOM_CONTEXT_KEY){return p[y]||""}rr.getBrowserLoggerContext=r;function s(p,y,g=i.PINO_CUSTOM_CONTEXT_KEY){return p[g]=y,p}rr.setBrowserLoggerContext=s;function o(p,y=i.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof p.bindings>"u"?g=r(p,y):g=p.bindings().context||"",g}rr.getLoggerContext=o;function c(p,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const v=o(p,g);return v.trim()?`${v}/${y}`:y}rr.formatChildLoggerContext=c;function h(p,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const v=c(p,y,g),b=p.child({context:v});return s(b,v,g)}return rr.generateChildLogger=h,rr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const t=Ti,r=t.__importDefault(rE());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Xp(),i),t.__exportStar(nE(),i)})(De);class iE extends ri{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let sE=class extends ri{constructor(i,t){super(),this.core=i,this.logger=t,this.records=new Map}},oE=class{constructor(i,t){this.logger=i,this.core=t}},aE=class extends ri{constructor(i,t){super(),this.relayer=i,this.logger=t}},cE=class extends ri{constructor(i){super()}},uE=class{constructor(i,t,r,s){this.core=i,this.logger=t,this.name=r}};class lE extends ri{constructor(t,r){super(),this.relayer=t,this.logger=r}}let hE=class extends ri{constructor(i,t){super(),this.core=i,this.logger=t}},fE=class{constructor(i,t){this.projectId=i,this.logger=t}},pE=class{constructor(i,t){this.projectId=i,this.logger=t}},dE=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},gE=class{constructor(i){this.client=i}};var bu={},Zp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=wb,r=Sp;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function p(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},p.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=y[v++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,v,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[v++],g--;return this},p.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,v=this._bufferLength,b=g/536870912|0,P=g<<3,R=g%128<112?128:256;this._buffer[v]=128;for(var O=v+1;O<R-8;O++)this._buffer[O]=0;t.writeUint32BE(b,this._buffer,R-8),t.writeUint32BE(P,this._buffer,R-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,R),this._finished=!0}for(var O=0;O<this.digestLength/8;O++)t.writeUint32BE(this._stateHi[O],y,O*8),t.writeUint32BE(this._stateLo[O],y,O*8+4);return this},p.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(y){r.wipe(y.stateHi),r.wipe(y.stateLo),y.buffer&&r.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},p}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(p,y,g,v,b,P,R){for(var O=g[0],L=g[1],K=g[2],q=g[3],$=g[4],B=g[5],S=g[6],C=g[7],I=v[0],A=v[1],M=v[2],ae=v[3],Z=v[4],he=v[5],F=v[6],fe=v[7],_,T,ce,le,ne,Q,ee,se;R>=128;){for(var ze=0;ze<16;ze++){var Be=8*ze+P;p[ze]=t.readUint32BE(b,Be),y[ze]=t.readUint32BE(b,Be+4)}for(var ze=0;ze<80;ze++){var cr=O,xe=L,nt=K,W=q,H=$,U=B,l=S,w=C,z=I,te=A,oe=M,ie=ae,_e=Z,Ne=he,ct=F,Je=fe;if(_=C,T=fe,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=($>>>14|Z<<18)^($>>>18|Z<<14)^(Z>>>9|$<<23),T=(Z>>>14|$<<18)^(Z>>>18|$<<14)^($>>>9|Z<<23),ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,_=$&B^~$&S,T=Z&he^~Z&F,ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,_=o[ze*2],T=o[ze*2+1],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,_=p[ze%16],T=y[ze%16],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,ce=ee&65535|se<<16,le=ne&65535|Q<<16,_=ce,T=le,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=(O>>>28|I<<4)^(I>>>2|O<<30)^(I>>>7|O<<25),T=(I>>>28|O<<4)^(O>>>2|I<<30)^(O>>>7|I<<25),ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,_=O&L^O&K^L&K,T=I&A^I&M^A&M,ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,w=ee&65535|se<<16,Je=ne&65535|Q<<16,_=W,T=ie,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=ce,T=le,ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,W=ee&65535|se<<16,ie=ne&65535|Q<<16,L=cr,K=xe,q=nt,$=W,B=H,S=U,C=l,O=w,A=z,M=te,ae=oe,Z=ie,he=_e,F=Ne,fe=ct,I=Je,ze%16===15)for(var Be=0;Be<16;Be++)_=p[Be],T=y[Be],ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=p[(Be+9)%16],T=y[(Be+9)%16],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,ce=p[(Be+1)%16],le=y[(Be+1)%16],_=(ce>>>1|le<<31)^(ce>>>8|le<<24)^ce>>>7,T=(le>>>1|ce<<31)^(le>>>8|ce<<24)^(le>>>7|ce<<25),ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,ce=p[(Be+14)%16],le=y[(Be+14)%16],_=(ce>>>19|le<<13)^(le>>>29|ce<<3)^ce>>>6,T=(le>>>19|ce<<13)^(ce>>>29|le<<3)^(le>>>6|ce<<26),ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,p[Be]=ee&65535|se<<16,y[Be]=ne&65535|Q<<16}_=O,T=I,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[0],T=v[0],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[0]=O=ee&65535|se<<16,v[0]=I=ne&65535|Q<<16,_=L,T=A,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[1],T=v[1],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[1]=L=ee&65535|se<<16,v[1]=A=ne&65535|Q<<16,_=K,T=M,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[2],T=v[2],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[2]=K=ee&65535|se<<16,v[2]=M=ne&65535|Q<<16,_=q,T=ae,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[3],T=v[3],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[3]=q=ee&65535|se<<16,v[3]=ae=ne&65535|Q<<16,_=$,T=Z,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[4],T=v[4],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[4]=$=ee&65535|se<<16,v[4]=Z=ne&65535|Q<<16,_=B,T=he,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[5],T=v[5],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[5]=B=ee&65535|se<<16,v[5]=he=ne&65535|Q<<16,_=S,T=F,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[6],T=v[6],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[6]=S=ee&65535|se<<16,v[6]=F=ne&65535|Q<<16,_=C,T=fe,ne=T&65535,Q=T>>>16,ee=_&65535,se=_>>>16,_=g[7],T=v[7],ne+=T&65535,Q+=T>>>16,ee+=_&65535,se+=_>>>16,Q+=ne>>>16,ee+=Q>>>16,se+=ee>>>16,g[7]=C=ee&65535|se<<16,v[7]=fe=ne&65535|Q<<16,P+=128,R-=128}return P}function h(p){var y=new s;y.update(p);var g=y.digest();return y.clean(),g}i.hash=h})(Zp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const t=Bo,r=Zp,s=Sp;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(W){const H=new Float64Array(16);if(W)for(let U=0;U<W.length;U++)H[U]=W[U];return H}const c=new Uint8Array(32);c[0]=9;const h=o(),p=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),b=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),P=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(W,H){for(let U=0;U<16;U++)W[U]=H[U]|0}function O(W){let H=1;for(let U=0;U<16;U++){let l=W[U]+H+65535;H=Math.floor(l/65536),W[U]=l-H*65536}W[0]+=H-1+37*(H-1)}function L(W,H,U){const l=~(U-1);for(let w=0;w<16;w++){const z=l&(W[w]^H[w]);W[w]^=z,H[w]^=z}}function K(W,H){const U=o(),l=o();for(let w=0;w<16;w++)l[w]=H[w];O(l),O(l),O(l);for(let w=0;w<2;w++){U[0]=l[0]-65517;for(let te=1;te<15;te++)U[te]=l[te]-65535-(U[te-1]>>16&1),U[te-1]&=65535;U[15]=l[15]-32767-(U[14]>>16&1);const z=U[15]>>16&1;U[14]&=65535,L(l,U,1-z)}for(let w=0;w<16;w++)W[2*w]=l[w]&255,W[2*w+1]=l[w]>>8}function q(W,H){let U=0;for(let l=0;l<32;l++)U|=W[l]^H[l];return(1&U-1>>>8)-1}function $(W,H){const U=new Uint8Array(32),l=new Uint8Array(32);return K(U,W),K(l,H),q(U,l)}function B(W){const H=new Uint8Array(32);return K(H,W),H[0]&1}function S(W,H){for(let U=0;U<16;U++)W[U]=H[2*U]+(H[2*U+1]<<8);W[15]&=32767}function C(W,H,U){for(let l=0;l<16;l++)W[l]=H[l]+U[l]}function I(W,H,U){for(let l=0;l<16;l++)W[l]=H[l]-U[l]}function A(W,H,U){let l,w,z=0,te=0,oe=0,ie=0,_e=0,Ne=0,ct=0,Je=0,it=0,$e=0,Qe=0,Ke=0,We=0,Oe=0,me=0,Ie=0,qe=0,Xe=0,ke=0,Ge=0,yt=0,xt=0,Rt=0,vt=0,Ht=0,ur=0,Wr=0,Qt=0,en=0,bn=0,kn=0,mt=U[0],ut=U[1],_t=U[2],wt=U[3],dt=U[4],lt=U[5],At=U[6],Lt=U[7],bt=U[8],jt=U[9],Et=U[10],Pt=U[11],It=U[12],st=U[13],Dt=U[14],kt=U[15];l=H[0],z+=l*mt,te+=l*ut,oe+=l*_t,ie+=l*wt,_e+=l*dt,Ne+=l*lt,ct+=l*At,Je+=l*Lt,it+=l*bt,$e+=l*jt,Qe+=l*Et,Ke+=l*Pt,We+=l*It,Oe+=l*st,me+=l*Dt,Ie+=l*kt,l=H[1],te+=l*mt,oe+=l*ut,ie+=l*_t,_e+=l*wt,Ne+=l*dt,ct+=l*lt,Je+=l*At,it+=l*Lt,$e+=l*bt,Qe+=l*jt,Ke+=l*Et,We+=l*Pt,Oe+=l*It,me+=l*st,Ie+=l*Dt,qe+=l*kt,l=H[2],oe+=l*mt,ie+=l*ut,_e+=l*_t,Ne+=l*wt,ct+=l*dt,Je+=l*lt,it+=l*At,$e+=l*Lt,Qe+=l*bt,Ke+=l*jt,We+=l*Et,Oe+=l*Pt,me+=l*It,Ie+=l*st,qe+=l*Dt,Xe+=l*kt,l=H[3],ie+=l*mt,_e+=l*ut,Ne+=l*_t,ct+=l*wt,Je+=l*dt,it+=l*lt,$e+=l*At,Qe+=l*Lt,Ke+=l*bt,We+=l*jt,Oe+=l*Et,me+=l*Pt,Ie+=l*It,qe+=l*st,Xe+=l*Dt,ke+=l*kt,l=H[4],_e+=l*mt,Ne+=l*ut,ct+=l*_t,Je+=l*wt,it+=l*dt,$e+=l*lt,Qe+=l*At,Ke+=l*Lt,We+=l*bt,Oe+=l*jt,me+=l*Et,Ie+=l*Pt,qe+=l*It,Xe+=l*st,ke+=l*Dt,Ge+=l*kt,l=H[5],Ne+=l*mt,ct+=l*ut,Je+=l*_t,it+=l*wt,$e+=l*dt,Qe+=l*lt,Ke+=l*At,We+=l*Lt,Oe+=l*bt,me+=l*jt,Ie+=l*Et,qe+=l*Pt,Xe+=l*It,ke+=l*st,Ge+=l*Dt,yt+=l*kt,l=H[6],ct+=l*mt,Je+=l*ut,it+=l*_t,$e+=l*wt,Qe+=l*dt,Ke+=l*lt,We+=l*At,Oe+=l*Lt,me+=l*bt,Ie+=l*jt,qe+=l*Et,Xe+=l*Pt,ke+=l*It,Ge+=l*st,yt+=l*Dt,xt+=l*kt,l=H[7],Je+=l*mt,it+=l*ut,$e+=l*_t,Qe+=l*wt,Ke+=l*dt,We+=l*lt,Oe+=l*At,me+=l*Lt,Ie+=l*bt,qe+=l*jt,Xe+=l*Et,ke+=l*Pt,Ge+=l*It,yt+=l*st,xt+=l*Dt,Rt+=l*kt,l=H[8],it+=l*mt,$e+=l*ut,Qe+=l*_t,Ke+=l*wt,We+=l*dt,Oe+=l*lt,me+=l*At,Ie+=l*Lt,qe+=l*bt,Xe+=l*jt,ke+=l*Et,Ge+=l*Pt,yt+=l*It,xt+=l*st,Rt+=l*Dt,vt+=l*kt,l=H[9],$e+=l*mt,Qe+=l*ut,Ke+=l*_t,We+=l*wt,Oe+=l*dt,me+=l*lt,Ie+=l*At,qe+=l*Lt,Xe+=l*bt,ke+=l*jt,Ge+=l*Et,yt+=l*Pt,xt+=l*It,Rt+=l*st,vt+=l*Dt,Ht+=l*kt,l=H[10],Qe+=l*mt,Ke+=l*ut,We+=l*_t,Oe+=l*wt,me+=l*dt,Ie+=l*lt,qe+=l*At,Xe+=l*Lt,ke+=l*bt,Ge+=l*jt,yt+=l*Et,xt+=l*Pt,Rt+=l*It,vt+=l*st,Ht+=l*Dt,ur+=l*kt,l=H[11],Ke+=l*mt,We+=l*ut,Oe+=l*_t,me+=l*wt,Ie+=l*dt,qe+=l*lt,Xe+=l*At,ke+=l*Lt,Ge+=l*bt,yt+=l*jt,xt+=l*Et,Rt+=l*Pt,vt+=l*It,Ht+=l*st,ur+=l*Dt,Wr+=l*kt,l=H[12],We+=l*mt,Oe+=l*ut,me+=l*_t,Ie+=l*wt,qe+=l*dt,Xe+=l*lt,ke+=l*At,Ge+=l*Lt,yt+=l*bt,xt+=l*jt,Rt+=l*Et,vt+=l*Pt,Ht+=l*It,ur+=l*st,Wr+=l*Dt,Qt+=l*kt,l=H[13],Oe+=l*mt,me+=l*ut,Ie+=l*_t,qe+=l*wt,Xe+=l*dt,ke+=l*lt,Ge+=l*At,yt+=l*Lt,xt+=l*bt,Rt+=l*jt,vt+=l*Et,Ht+=l*Pt,ur+=l*It,Wr+=l*st,Qt+=l*Dt,en+=l*kt,l=H[14],me+=l*mt,Ie+=l*ut,qe+=l*_t,Xe+=l*wt,ke+=l*dt,Ge+=l*lt,yt+=l*At,xt+=l*Lt,Rt+=l*bt,vt+=l*jt,Ht+=l*Et,ur+=l*Pt,Wr+=l*It,Qt+=l*st,en+=l*Dt,bn+=l*kt,l=H[15],Ie+=l*mt,qe+=l*ut,Xe+=l*_t,ke+=l*wt,Ge+=l*dt,yt+=l*lt,xt+=l*At,Rt+=l*Lt,vt+=l*bt,Ht+=l*jt,ur+=l*Et,Wr+=l*Pt,Qt+=l*It,en+=l*st,bn+=l*Dt,kn+=l*kt,z+=38*qe,te+=38*Xe,oe+=38*ke,ie+=38*Ge,_e+=38*yt,Ne+=38*xt,ct+=38*Rt,Je+=38*vt,it+=38*Ht,$e+=38*ur,Qe+=38*Wr,Ke+=38*Qt,We+=38*en,Oe+=38*bn,me+=38*kn,w=1,l=z+w+65535,w=Math.floor(l/65536),z=l-w*65536,l=te+w+65535,w=Math.floor(l/65536),te=l-w*65536,l=oe+w+65535,w=Math.floor(l/65536),oe=l-w*65536,l=ie+w+65535,w=Math.floor(l/65536),ie=l-w*65536,l=_e+w+65535,w=Math.floor(l/65536),_e=l-w*65536,l=Ne+w+65535,w=Math.floor(l/65536),Ne=l-w*65536,l=ct+w+65535,w=Math.floor(l/65536),ct=l-w*65536,l=Je+w+65535,w=Math.floor(l/65536),Je=l-w*65536,l=it+w+65535,w=Math.floor(l/65536),it=l-w*65536,l=$e+w+65535,w=Math.floor(l/65536),$e=l-w*65536,l=Qe+w+65535,w=Math.floor(l/65536),Qe=l-w*65536,l=Ke+w+65535,w=Math.floor(l/65536),Ke=l-w*65536,l=We+w+65535,w=Math.floor(l/65536),We=l-w*65536,l=Oe+w+65535,w=Math.floor(l/65536),Oe=l-w*65536,l=me+w+65535,w=Math.floor(l/65536),me=l-w*65536,l=Ie+w+65535,w=Math.floor(l/65536),Ie=l-w*65536,z+=w-1+37*(w-1),w=1,l=z+w+65535,w=Math.floor(l/65536),z=l-w*65536,l=te+w+65535,w=Math.floor(l/65536),te=l-w*65536,l=oe+w+65535,w=Math.floor(l/65536),oe=l-w*65536,l=ie+w+65535,w=Math.floor(l/65536),ie=l-w*65536,l=_e+w+65535,w=Math.floor(l/65536),_e=l-w*65536,l=Ne+w+65535,w=Math.floor(l/65536),Ne=l-w*65536,l=ct+w+65535,w=Math.floor(l/65536),ct=l-w*65536,l=Je+w+65535,w=Math.floor(l/65536),Je=l-w*65536,l=it+w+65535,w=Math.floor(l/65536),it=l-w*65536,l=$e+w+65535,w=Math.floor(l/65536),$e=l-w*65536,l=Qe+w+65535,w=Math.floor(l/65536),Qe=l-w*65536,l=Ke+w+65535,w=Math.floor(l/65536),Ke=l-w*65536,l=We+w+65535,w=Math.floor(l/65536),We=l-w*65536,l=Oe+w+65535,w=Math.floor(l/65536),Oe=l-w*65536,l=me+w+65535,w=Math.floor(l/65536),me=l-w*65536,l=Ie+w+65535,w=Math.floor(l/65536),Ie=l-w*65536,z+=w-1+37*(w-1),W[0]=z,W[1]=te,W[2]=oe,W[3]=ie,W[4]=_e,W[5]=Ne,W[6]=ct,W[7]=Je,W[8]=it,W[9]=$e,W[10]=Qe,W[11]=Ke,W[12]=We,W[13]=Oe,W[14]=me,W[15]=Ie}function M(W,H){A(W,H,H)}function ae(W,H){const U=o();let l;for(l=0;l<16;l++)U[l]=H[l];for(l=253;l>=0;l--)M(U,U),l!==2&&l!==4&&A(U,U,H);for(l=0;l<16;l++)W[l]=U[l]}function Z(W,H){const U=o();let l;for(l=0;l<16;l++)U[l]=H[l];for(l=250;l>=0;l--)M(U,U),l!==1&&A(U,U,H);for(l=0;l<16;l++)W[l]=U[l]}function he(W,H){const U=o(),l=o(),w=o(),z=o(),te=o(),oe=o(),ie=o(),_e=o(),Ne=o();I(U,W[1],W[0]),I(Ne,H[1],H[0]),A(U,U,Ne),C(l,W[0],W[1]),C(Ne,H[0],H[1]),A(l,l,Ne),A(w,W[3],H[3]),A(w,w,g),A(z,W[2],H[2]),C(z,z,z),I(te,l,U),I(oe,z,w),C(ie,z,w),C(_e,l,U),A(W[0],te,oe),A(W[1],_e,ie),A(W[2],ie,oe),A(W[3],te,_e)}function F(W,H,U){for(let l=0;l<4;l++)L(W[l],H[l],U)}function fe(W,H){const U=o(),l=o(),w=o();ae(w,H[2]),A(U,H[0],w),A(l,H[1],w),K(W,l),W[31]^=B(U)<<7}function _(W,H,U){R(W[0],h),R(W[1],p),R(W[2],p),R(W[3],h);for(let l=255;l>=0;--l){const w=U[l/8|0]>>(l&7)&1;F(W,H,w),he(H,W),he(W,W),F(W,H,w)}}function T(W,H){const U=[o(),o(),o(),o()];R(U[0],v),R(U[1],b),R(U[2],p),A(U[3],v,b),_(W,U,H)}function ce(W){if(W.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const H=(0,r.hash)(W);H[0]&=248,H[31]&=127,H[31]|=64;const U=new Uint8Array(32),l=[o(),o(),o(),o()];T(l,H),fe(U,l);const w=new Uint8Array(64);return w.set(W),w.set(U,32),{publicKey:U,secretKey:w}}i.generateKeyPairFromSeed=ce;function le(W){const H=(0,t.randomBytes)(32,W),U=ce(H);return(0,s.wipe)(H),U}i.generateKeyPair=le;function ne(W){if(W.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(W.subarray(32))}i.extractPublicKeyFromSecretKey=ne;const Q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ee(W,H){let U,l,w,z;for(l=63;l>=32;--l){for(U=0,w=l-32,z=l-12;w<z;++w)H[w]+=U-16*H[l]*Q[w-(l-32)],U=Math.floor((H[w]+128)/256),H[w]-=U*256;H[w]+=U,H[l]=0}for(U=0,w=0;w<32;w++)H[w]+=U-(H[31]>>4)*Q[w],U=H[w]>>8,H[w]&=255;for(w=0;w<32;w++)H[w]-=U*Q[w];for(l=0;l<32;l++)H[l+1]+=H[l]>>8,W[l]=H[l]&255}function se(W){const H=new Float64Array(64);for(let U=0;U<64;U++)H[U]=W[U];for(let U=0;U<64;U++)W[U]=0;ee(W,H)}function ze(W,H){const U=new Float64Array(64),l=[o(),o(),o(),o()],w=(0,r.hash)(W.subarray(0,32));w[0]&=248,w[31]&=127,w[31]|=64;const z=new Uint8Array(64);z.set(w.subarray(32),32);const te=new r.SHA512;te.update(z.subarray(32)),te.update(H);const oe=te.digest();te.clean(),se(oe),T(l,oe),fe(z,l),te.reset(),te.update(z.subarray(0,32)),te.update(W.subarray(32)),te.update(H);const ie=te.digest();se(ie);for(let _e=0;_e<32;_e++)U[_e]=oe[_e];for(let _e=0;_e<32;_e++)for(let Ne=0;Ne<32;Ne++)U[_e+Ne]+=ie[_e]*w[Ne];return ee(z.subarray(32),U),z}i.sign=ze;function Be(W,H){const U=o(),l=o(),w=o(),z=o(),te=o(),oe=o(),ie=o();return R(W[2],p),S(W[1],H),M(w,W[1]),A(z,w,y),I(w,w,W[2]),C(z,W[2],z),M(te,z),M(oe,te),A(ie,oe,te),A(U,ie,w),A(U,U,z),Z(U,U),A(U,U,w),A(U,U,z),A(U,U,z),A(W[0],U,z),M(l,W[0]),A(l,l,z),$(l,w)&&A(W[0],W[0],P),M(l,W[0]),A(l,l,z),$(l,w)?-1:(B(W[0])===H[31]>>7&&I(W[0],h,W[0]),A(W[3],W[0],W[1]),0)}function cr(W,H,U){const l=new Uint8Array(32),w=[o(),o(),o(),o()],z=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(Be(z,W))return!1;const te=new r.SHA512;te.update(U.subarray(0,32)),te.update(W),te.update(H);const oe=te.digest();return se(oe),_(w,z,oe),T(z,U.subarray(32)),he(w,z),fe(l,w),!q(U,l)}i.verify=cr;function xe(W){let H=[o(),o(),o(),o()];if(Be(H,W))throw new Error("Ed25519: invalid public key");let U=o(),l=o(),w=H[1];C(U,p,w),I(l,p,w),ae(l,l),A(U,U,l);let z=new Uint8Array(32);return K(z,U),z}i.convertPublicKeyToX25519=xe;function nt(W){const H=(0,r.hash)(W.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const U=new Uint8Array(H.subarray(0,32));return(0,s.wipe)(H),U}i.convertSecretKeyToX25519=nt})(bu);const yE="EdDSA",vE="JWT",ed=".",td="base64url",mE="utf8",_E="utf8",wE=":",bE="did",EE="key",Rf="base58btc",IE="z",SE="K36",xE=32;function qo(i){return ar(vr(Xn(i),mE),td)}function rd(i){const t=vr(SE,Rf),r=IE+ar(Zc([t,i]),Rf);return[bE,EE,r].join(wE)}function PE(i){return ar(i,td)}function OE(i){return vr([qo(i.header),qo(i.payload)].join(ed),_E)}function CE(i){return[qo(i.header),qo(i.payload),PE(i.signature)].join(ed)}function Af(i=Bo.randomBytes(xE)){return bu.generateKeyPairFromSeed(i)}async function NE(i,t,r,s,o=ve.fromMiliseconds(Date.now())){const c={alg:yE,typ:vE},h=rd(s.publicKey),p=o+r,y={iss:h,sub:i,aud:t,iat:o,exp:p},g=OE({header:c,payload:y}),v=bu.sign(s.secretKey,g);return CE({header:c,payload:y,signature:v})}const TE="PARSE_ERROR",RE="INVALID_REQUEST",AE="METHOD_NOT_FOUND",LE="INVALID_PARAMS",nd="INTERNAL_ERROR",Eu="SERVER_ERROR",jE=[-32700,-32600,-32601,-32602,-32603],cs={[TE]:{code:-32700,message:"Parse error"},[RE]:{code:-32600,message:"Invalid Request"},[AE]:{code:-32601,message:"Method not found"},[LE]:{code:-32602,message:"Invalid params"},[nd]:{code:-32603,message:"Internal error"},[Eu]:{code:-32e3,message:"Server error"}},id=Eu;function DE(i){return jE.includes(i)}function Lf(i){return Object.keys(cs).includes(i)?cs[i]:cs[id]}function kE(i){return Object.values(cs).find(r=>r.code===i)||cs[id]}function sd(i,t,r){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):i}var od={},pn={},jf;function UE(){if(jf)return pn;jf=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.isBrowserCryptoAvailable=pn.getSubtleCrypto=pn.getBrowerCrypto=void 0;function i(){return(Hr===null||Hr===void 0?void 0:Hr.crypto)||(Hr===null||Hr===void 0?void 0:Hr.msCrypto)||{}}pn.getBrowerCrypto=i;function t(){const s=i();return s.subtle||s.webkitSubtle}pn.getSubtleCrypto=t;function r(){return!!i()&&!!t()}return pn.isBrowserCryptoAvailable=r,pn}var dn={},Df;function ME(){if(Df)return dn;Df=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.isBrowser=dn.isNode=dn.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}dn.isReactNative=i;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}dn.isNode=t;function r(){return!i()&&!t()}return dn.isBrowser=r,dn}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const t=Ti;t.__exportStar(UE(),i),t.__exportStar(ME(),i)})(od);function Iu(i=3){const t=Date.now()*Math.pow(10,i),r=Math.floor(Math.random()*Math.pow(10,i));return t+r}function ad(i=6){return BigInt(Iu(i))}function Ni(i,t,r){return{id:r||Iu(),jsonrpc:"2.0",method:i,params:t}}function Wo(i,t){return{id:i,jsonrpc:"2.0",result:t}}function Fo(i,t,r){return{id:i,jsonrpc:"2.0",error:qE(t,r)}}function qE(i,t){return typeof i>"u"?Lf(nd):(typeof i=="string"&&(i=Object.assign(Object.assign({},Lf(Eu)),{message:i})),typeof t<"u"&&(i.data=t),DE(i.code)&&(i=kE(i.code)),i)}class $E{}class zE extends $E{constructor(){super()}}class BE extends zE{constructor(t){super()}}const KE="^https?:",VE="^wss?:";function HE(i){const t=i.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function cd(i,t){const r=HE(i);return typeof r>"u"?!1:new RegExp(t).test(r)}function kf(i){return cd(i,KE)}function Uf(i){return cd(i,VE)}function WE(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function ud(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Su(i){return ud(i)&&"method"in i}function Go(i){return ud(i)&&(mn(i)||Vr(i))}function mn(i){return"result"in i}function Vr(i){return"error"in i}class _n extends BE{constructor(t){super(t),this.events=new kr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ni(t.method,t.params||[],t.id||ad().toString()),r)}async requestStrict(t,r){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Vr(c)?o(c.error):s(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Go(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const FE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:kb(),GE=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Mf=i=>i.split("?")[0],qf=10,YE=FE();let JE=class{constructor(i){if(this.url=i,this.events=new kr.EventEmitter,this.registering=!1,!Uf(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,t){this.events.on(i,t)}once(i,t){this.events.once(i,t)}off(i,t){this.events.off(i,t)}removeListener(i,t){this.events.removeListener(i,t)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),i()},this.socket.close()})}async send(i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Xn(i))}catch(t){this.onError(i.id,t)}}register(i=this.url){if(!Uf(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((r,s)=>{this.events.once("register_error",o=>{this.resetMaxListeners(),s(o)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=i,this.registering=!0,new Promise((t,r)=>{const s=new URLSearchParams(i).get("origin"),o=od.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!WE(i)},c=new YE(i,[],o);GE()?c.onerror=h=>{const p=h;r(this.emitError(p.error))}:c.on("error",h=>{r(this.emitError(h))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(i){i.onmessage=t=>this.onPayload(t),i.onclose=t=>this.onClose(t),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const t=typeof i.data=="string"?ds(i.data):i.data;this.events.emit("payload",t)}onError(i,t){const r=this.parseError(t),s=r.message||r.toString(),o=Fo(i,s);this.events.emit("payload",o)}parseError(i,t=this.url){return sd(i,Mf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>qf&&this.events.setMaxListeners(qf)}emitError(i){const t=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${Mf(this.url)}`));return this.events.emit("register_error",t),t}};var $o={exports:{}};$o.exports;(function(i,t){var r=200,s="__lodash_hash_undefined__",o=1,c=2,h=9007199254740991,p="[object Arguments]",y="[object Array]",g="[object AsyncFunction]",v="[object Boolean]",b="[object Date]",P="[object Error]",R="[object Function]",O="[object GeneratorFunction]",L="[object Map]",K="[object Number]",q="[object Null]",$="[object Object]",B="[object Promise]",S="[object Proxy]",C="[object RegExp]",I="[object Set]",A="[object String]",M="[object Symbol]",ae="[object Undefined]",Z="[object WeakMap]",he="[object ArrayBuffer]",F="[object DataView]",fe="[object Float32Array]",_="[object Float64Array]",T="[object Int8Array]",ce="[object Int16Array]",le="[object Int32Array]",ne="[object Uint8Array]",Q="[object Uint8ClampedArray]",ee="[object Uint16Array]",se="[object Uint32Array]",ze=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,cr=/^(?:0|[1-9]\d*)$/,xe={};xe[fe]=xe[_]=xe[T]=xe[ce]=xe[le]=xe[ne]=xe[Q]=xe[ee]=xe[se]=!0,xe[p]=xe[y]=xe[he]=xe[v]=xe[F]=xe[b]=xe[P]=xe[R]=xe[L]=xe[K]=xe[$]=xe[C]=xe[I]=xe[A]=xe[Z]=!1;var nt=typeof Hr=="object"&&Hr&&Hr.Object===Object&&Hr,W=typeof self=="object"&&self&&self.Object===Object&&self,H=nt||W||Function("return this")(),U=t&&!t.nodeType&&t,l=U&&!0&&i&&!i.nodeType&&i,w=l&&l.exports===U,z=w&&nt.process,te=function(){try{return z&&z.binding&&z.binding("util")}catch{}}(),oe=te&&te.isTypedArray;function ie(E,D){for(var X=-1,de=E==null?0:E.length,et=0,Ce=[];++X<de;){var ot=E[X];D(ot,X,E)&&(Ce[et++]=ot)}return Ce}function _e(E,D){for(var X=-1,de=D.length,et=E.length;++X<de;)E[et+X]=D[X];return E}function Ne(E,D){for(var X=-1,de=E==null?0:E.length;++X<de;)if(D(E[X],X,E))return!0;return!1}function ct(E,D){for(var X=-1,de=Array(E);++X<E;)de[X]=D(X);return de}function Je(E){return function(D){return E(D)}}function it(E,D){return E.has(D)}function $e(E,D){return E==null?void 0:E[D]}function Qe(E){var D=-1,X=Array(E.size);return E.forEach(function(de,et){X[++D]=[et,de]}),X}function Ke(E,D){return function(X){return E(D(X))}}function We(E){var D=-1,X=Array(E.size);return E.forEach(function(de){X[++D]=de}),X}var Oe=Array.prototype,me=Function.prototype,Ie=Object.prototype,qe=H["__core-js_shared__"],Xe=me.toString,ke=Ie.hasOwnProperty,Ge=function(){var E=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),yt=Ie.toString,xt=RegExp("^"+Xe.call(ke).replace(ze,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rt=w?H.Buffer:void 0,vt=H.Symbol,Ht=H.Uint8Array,ur=Ie.propertyIsEnumerable,Wr=Oe.splice,Qt=vt?vt.toStringTag:void 0,en=Object.getOwnPropertySymbols,bn=Rt?Rt.isBuffer:void 0,kn=Ke(Object.keys,Object),mt=mr(H,"DataView"),ut=mr(H,"Map"),_t=mr(H,"Promise"),wt=mr(H,"Set"),dt=mr(H,"WeakMap"),lt=mr(Object,"create"),At=rn(mt),Lt=rn(ut),bt=rn(_t),jt=rn(wt),Et=rn(dt),Pt=vt?vt.prototype:void 0,It=Pt?Pt.valueOf:void 0;function st(E){var D=-1,X=E==null?0:E.length;for(this.clear();++D<X;){var de=E[D];this.set(de[0],de[1])}}function Dt(){this.__data__=lt?lt(null):{},this.size=0}function kt(E){var D=this.has(E)&&delete this.__data__[E];return this.size-=D?1:0,D}function Qo(E){var D=this.__data__;if(lt){var X=D[E];return X===s?void 0:X}return ke.call(D,E)?D[E]:void 0}function Xo(E){var D=this.__data__;return lt?D[E]!==void 0:ke.call(D,E)}function Zo(E,D){var X=this.__data__;return this.size+=this.has(E)?0:1,X[E]=lt&&D===void 0?s:D,this}st.prototype.clear=Dt,st.prototype.delete=kt,st.prototype.get=Qo,st.prototype.has=Xo,st.prototype.set=Zo;function Pr(E){var D=-1,X=E==null?0:E.length;for(this.clear();++D<X;){var de=E[D];this.set(de[0],de[1])}}function ea(){this.__data__=[],this.size=0}function ta(E){var D=this.__data__,X=Un(D,E);if(X<0)return!1;var de=D.length-1;return X==de?D.pop():Wr.call(D,X,1),--this.size,!0}function ra(E){var D=this.__data__,X=Un(D,E);return X<0?void 0:D[X][1]}function na(E){return Un(this.__data__,E)>-1}function ia(E,D){var X=this.__data__,de=Un(X,E);return de<0?(++this.size,X.push([E,D])):X[de][1]=D,this}Pr.prototype.clear=ea,Pr.prototype.delete=ta,Pr.prototype.get=ra,Pr.prototype.has=na,Pr.prototype.set=ia;function tn(E){var D=-1,X=E==null?0:E.length;for(this.clear();++D<X;){var de=E[D];this.set(de[0],de[1])}}function ii(){this.size=0,this.__data__={hash:new st,map:new(ut||Pr),string:new st}}function sa(E){var D=En(this,E).delete(E);return this.size-=D?1:0,D}function si(E){return En(this,E).get(E)}function oa(E){return En(this,E).has(E)}function aa(E,D){var X=En(this,E),de=X.size;return X.set(E,D),this.size+=X.size==de?0:1,this}tn.prototype.clear=ii,tn.prototype.delete=sa,tn.prototype.get=si,tn.prototype.has=oa,tn.prototype.set=aa;function oi(E){var D=-1,X=E==null?0:E.length;for(this.__data__=new tn;++D<X;)this.add(E[D])}function ys(E){return this.__data__.set(E,s),this}function vs(E){return this.__data__.has(E)}oi.prototype.add=oi.prototype.push=ys,oi.prototype.has=vs;function Ur(E){var D=this.__data__=new Pr(E);this.size=D.size}function ca(){this.__data__=new Pr,this.size=0}function ua(E){var D=this.__data__,X=D.delete(E);return this.size=D.size,X}function la(E){return this.__data__.get(E)}function ha(E){return this.__data__.has(E)}function ms(E,D){var X=this.__data__;if(X instanceof Pr){var de=X.__data__;if(!ut||de.length<r-1)return de.push([E,D]),this.size=++X.size,this;X=this.__data__=new tn(de)}return X.set(E,D),this.size=X.size,this}Ur.prototype.clear=ca,Ur.prototype.delete=ua,Ur.prototype.get=la,Ur.prototype.has=ha,Ur.prototype.set=ms;function _s(E,D){var X=ui(E),de=!X&&Rs(E),et=!X&&!de&&Ui(E),Ce=!X&&!de&&!et&&js(E),ot=X||de||et||Ce,Ut=ot?ct(E.length,String):[],Ue=Ut.length;for(var tt in E)(D||ke.call(E,tt))&&!(ot&&(tt=="length"||et&&(tt=="offset"||tt=="parent")||Ce&&(tt=="buffer"||tt=="byteLength"||tt=="byteOffset")||Ps(tt,Ue)))&&Ut.push(tt);return Ut}function Un(E,D){for(var X=E.length;X--;)if(Ts(E[X][0],D))return X;return-1}function Di(E,D,X){var de=D(E);return ui(E)?de:_e(de,X(E))}function Mn(E){return E==null?E===void 0?ae:q:Qt&&Qt in Object(E)?Ss(E):da(E)}function ki(E){return $n(E)&&Mn(E)==p}function qn(E,D,X,de,et){return E===D?!0:E==null||D==null||!$n(E)&&!$n(D)?E!==E&&D!==D:ws(E,D,X,de,qn,et)}function ws(E,D,X,de,et,Ce){var ot=ui(E),Ut=ui(D),Ue=ot?y:Fr(E),tt=Ut?y:Fr(D);Ue=Ue==p?$:Ue,tt=tt==p?$:tt;var Ot=Ue==$,lr=tt==$,Mt=Ue==tt;if(Mt&&Ui(E)){if(!Ui(D))return!1;ot=!0,Ot=!1}if(Mt&&!Ot)return Ce||(Ce=new Ur),ot||js(E)?ai(E,D,X,de,et,Ce):pa(E,D,Ue,X,de,et,Ce);if(!(X&o)){var at=Ot&&ke.call(E,"__wrapped__"),Xt=lr&&ke.call(D,"__wrapped__");if(at||Xt){var Mr=at?E.value():E,Or=Xt?D.value():D;return Ce||(Ce=new Ur),et(Mr,Or,X,de,Ce)}}return Mt?(Ce||(Ce=new Ur),Is(E,D,X,de,et,Ce)):!1}function fa(E){if(!Ls(E)||Cs(E))return!1;var D=li(E)?xt:Be;return D.test(rn(E))}function bs(E){return $n(E)&&As(E.length)&&!!xe[Mn(E)]}function Es(E){if(!Ns(E))return kn(E);var D=[];for(var X in Object(E))ke.call(E,X)&&X!="constructor"&&D.push(X);return D}function ai(E,D,X,de,et,Ce){var ot=X&o,Ut=E.length,Ue=D.length;if(Ut!=Ue&&!(ot&&Ue>Ut))return!1;var tt=Ce.get(E);if(tt&&Ce.get(D))return tt==D;var Ot=-1,lr=!0,Mt=X&c?new oi:void 0;for(Ce.set(E,D),Ce.set(D,E);++Ot<Ut;){var at=E[Ot],Xt=D[Ot];if(de)var Mr=ot?de(Xt,at,Ot,D,E,Ce):de(at,Xt,Ot,E,D,Ce);if(Mr!==void 0){if(Mr)continue;lr=!1;break}if(Mt){if(!Ne(D,function(Or,Gr){if(!it(Mt,Gr)&&(at===Or||et(at,Or,X,de,Ce)))return Mt.push(Gr)})){lr=!1;break}}else if(!(at===Xt||et(at,Xt,X,de,Ce))){lr=!1;break}}return Ce.delete(E),Ce.delete(D),lr}function pa(E,D,X,de,et,Ce,ot){switch(X){case F:if(E.byteLength!=D.byteLength||E.byteOffset!=D.byteOffset)return!1;E=E.buffer,D=D.buffer;case he:return!(E.byteLength!=D.byteLength||!Ce(new Ht(E),new Ht(D)));case v:case b:case K:return Ts(+E,+D);case P:return E.name==D.name&&E.message==D.message;case C:case A:return E==D+"";case L:var Ut=Qe;case I:var Ue=de&o;if(Ut||(Ut=We),E.size!=D.size&&!Ue)return!1;var tt=ot.get(E);if(tt)return tt==D;de|=c,ot.set(E,D);var Ot=ai(Ut(E),Ut(D),de,et,Ce,ot);return ot.delete(E),Ot;case M:if(It)return It.call(E)==It.call(D)}return!1}function Is(E,D,X,de,et,Ce){var ot=X&o,Ut=ci(E),Ue=Ut.length,tt=ci(D),Ot=tt.length;if(Ue!=Ot&&!ot)return!1;for(var lr=Ue;lr--;){var Mt=Ut[lr];if(!(ot?Mt in D:ke.call(D,Mt)))return!1}var at=Ce.get(E);if(at&&Ce.get(D))return at==D;var Xt=!0;Ce.set(E,D),Ce.set(D,E);for(var Mr=ot;++lr<Ue;){Mt=Ut[lr];var Or=E[Mt],Gr=D[Mt];if(de)var Mi=ot?de(Gr,Or,Mt,D,E,Ce):de(Or,Gr,Mt,E,D,Ce);if(!(Mi===void 0?Or===Gr||et(Or,Gr,X,de,Ce):Mi)){Xt=!1;break}Mr||(Mr=Mt=="constructor")}if(Xt&&!Mr){var zn=E.constructor,zt=D.constructor;zn!=zt&&"constructor"in E&&"constructor"in D&&!(typeof zn=="function"&&zn instanceof zn&&typeof zt=="function"&&zt instanceof zt)&&(Xt=!1)}return Ce.delete(E),Ce.delete(D),Xt}function ci(E){return Di(E,va,xs)}function En(E,D){var X=E.__data__;return Os(D)?X[typeof D=="string"?"string":"hash"]:X.map}function mr(E,D){var X=$e(E,D);return fa(X)?X:void 0}function Ss(E){var D=ke.call(E,Qt),X=E[Qt];try{E[Qt]=void 0;var de=!0}catch{}var et=yt.call(E);return de&&(D?E[Qt]=X:delete E[Qt]),et}var xs=en?function(E){return E==null?[]:(E=Object(E),ie(en(E),function(D){return ur.call(E,D)}))}:Ze,Fr=Mn;(mt&&Fr(new mt(new ArrayBuffer(1)))!=F||ut&&Fr(new ut)!=L||_t&&Fr(_t.resolve())!=B||wt&&Fr(new wt)!=I||dt&&Fr(new dt)!=Z)&&(Fr=function(E){var D=Mn(E),X=D==$?E.constructor:void 0,de=X?rn(X):"";if(de)switch(de){case At:return F;case Lt:return L;case bt:return B;case jt:return I;case Et:return Z}return D});function Ps(E,D){return D=D??h,!!D&&(typeof E=="number"||cr.test(E))&&E>-1&&E%1==0&&E<D}function Os(E){var D=typeof E;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?E!=="__proto__":E===null}function Cs(E){return!!Ge&&Ge in E}function Ns(E){var D=E&&E.constructor,X=typeof D=="function"&&D.prototype||Ie;return E===X}function da(E){return yt.call(E)}function rn(E){if(E!=null){try{return Xe.call(E)}catch{}try{return E+""}catch{}}return""}function Ts(E,D){return E===D||E!==E&&D!==D}var Rs=ki(function(){return arguments}())?ki:function(E){return $n(E)&&ke.call(E,"callee")&&!ur.call(E,"callee")},ui=Array.isArray;function ga(E){return E!=null&&As(E.length)&&!li(E)}var Ui=bn||Ye;function ya(E,D){return qn(E,D)}function li(E){if(!Ls(E))return!1;var D=Mn(E);return D==R||D==O||D==g||D==S}function As(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=h}function Ls(E){var D=typeof E;return E!=null&&(D=="object"||D=="function")}function $n(E){return E!=null&&typeof E=="object"}var js=oe?Je(oe):bs;function va(E){return ga(E)?_s(E):Es(E)}function Ze(){return[]}function Ye(){return!1}i.exports=ya})($o,$o.exports);var QE=$o.exports;const XE=du(QE);function ZE(i,t){return t=t||{},new Promise(function(r,s){var o=new XMLHttpRequest,c=[],h=[],p={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return h},get:function(v){return p[v.toLowerCase()]},has:function(v){return v.toLowerCase()in p}}}};for(var g in o.open(t.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,b,P){c.push(b=b.toLowerCase()),h.push([b,P]),p[b]=p[b]?p[b]+","+P:P}),r(y())},o.onerror=s,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(g,t.headers[g]);o.send(t.body||null)})}const eI=Object.freeze(Object.defineProperty({__proto__:null,default:ZE},Symbol.toStringTag,{value:"Module"})),$f=Ip(eI);var tI=self.fetch||(self.fetch=$f.default||$f);const rI=du(tI);function nI(i,t){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),h=c.charCodeAt(0);if(r[h]!==255)throw new TypeError(c+" is ambiguous");r[h]=o}var p=i.length,y=i.charAt(0),g=Math.log(p)/Math.log(256),v=Math.log(256)/Math.log(p);function b(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var L=0,K=0,q=0,$=O.length;q!==$&&O[q]===0;)q++,L++;for(var B=($-q)*v+1>>>0,S=new Uint8Array(B);q!==$;){for(var C=O[q],I=0,A=B-1;(C!==0||I<K)&&A!==-1;A--,I++)C+=256*S[A]>>>0,S[A]=C%p>>>0,C=C/p>>>0;if(C!==0)throw new Error("Non-zero carry");K=I,q++}for(var M=B-K;M!==B&&S[M]===0;)M++;for(var ae=y.repeat(L);M<B;++M)ae+=i.charAt(S[M]);return ae}function P(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var L=0;if(O[L]!==" "){for(var K=0,q=0;O[L]===y;)K++,L++;for(var $=(O.length-L)*g+1>>>0,B=new Uint8Array($);O[L];){var S=r[O.charCodeAt(L)];if(S===255)return;for(var C=0,I=$-1;(S!==0||C<q)&&I!==-1;I--,C++)S+=p*B[I]>>>0,B[I]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");q=C,L++}if(O[L]!==" "){for(var A=$-q;A!==$&&B[A]===0;)A++;for(var M=new Uint8Array(K+($-A)),ae=K;A!==$;)M[ae++]=B[A++];return M}}}function R(O){var L=P(O);if(L)return L;throw new Error(`Non-${t} character`)}return{encode:b,decodeUnsafe:P,decode:R}}var iI=nI,sI=iI;const ld=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},oI=i=>new TextEncoder().encode(i),aI=i=>new TextDecoder().decode(i);class cI{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class uI{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return hd(this,t)}}class lI{constructor(t){this.decoders=t}or(t){return hd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hd=(i,t)=>new lI({...i.decoders||{[i.prefix]:i},...t.decoders||{[t.prefix]:t}});class hI{constructor(t,r,s,o){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=o,this.encoder=new cI(t,r,s),this.decoder=new uI(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Yo=({name:i,prefix:t,encode:r,decode:s})=>new hI(i,t,r,s),gs=({prefix:i,name:t,alphabet:r})=>{const{encode:s,decode:o}=sI(r,t);return Yo({prefix:i,name:t,encode:s,decode:c=>ld(o(c))})},fI=(i,t,r,s)=>{const o={};for(let v=0;v<t.length;++v)o[t[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const h=new Uint8Array(c*r/8|0);let p=0,y=0,g=0;for(let v=0;v<c;++v){const b=o[i[v]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<r|b,p+=r,p>=8&&(p-=8,h[g++]=255&y>>p)}if(p>=r||255&y<<8-p)throw new SyntaxError("Unexpected end of data");return h},pI=(i,t,r)=>{const s=t[t.length-1]==="=",o=(1<<r)-1;let c="",h=0,p=0;for(let y=0;y<i.length;++y)for(p=p<<8|i[y],h+=8;h>r;)h-=r,c+=t[o&p>>h];if(h&&(c+=t[o&p<<r-h]),s)for(;c.length*r&7;)c+="=";return c},Ft=({name:i,prefix:t,bitsPerChar:r,alphabet:s})=>Yo({prefix:t,name:i,encode(o){return pI(o,s,r)},decode(o){return fI(o,s,r,i)}}),dI=Yo({prefix:"\0",name:"identity",encode:i=>aI(i),decode:i=>oI(i)});var gI=Object.freeze({__proto__:null,identity:dI});const yI=Ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var vI=Object.freeze({__proto__:null,base2:yI});const mI=Ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var _I=Object.freeze({__proto__:null,base8:mI});const wI=gs({prefix:"9",name:"base10",alphabet:"0123456789"});var bI=Object.freeze({__proto__:null,base10:wI});const EI=Ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),II=Ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var SI=Object.freeze({__proto__:null,base16:EI,base16upper:II});const xI=Ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),PI=Ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),OI=Ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),CI=Ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),NI=Ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),TI=Ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),RI=Ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),AI=Ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),LI=Ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var jI=Object.freeze({__proto__:null,base32:xI,base32upper:PI,base32pad:OI,base32padupper:CI,base32hex:NI,base32hexupper:TI,base32hexpad:RI,base32hexpadupper:AI,base32z:LI});const DI=gs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kI=gs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var UI=Object.freeze({__proto__:null,base36:DI,base36upper:kI});const MI=gs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qI=gs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var $I=Object.freeze({__proto__:null,base58btc:MI,base58flickr:qI});const zI=Ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),BI=Ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),KI=Ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),VI=Ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var HI=Object.freeze({__proto__:null,base64:zI,base64pad:BI,base64url:KI,base64urlpad:VI});const fd=Array.from(""),WI=fd.reduce((i,t,r)=>(i[r]=t,i),[]),FI=fd.reduce((i,t,r)=>(i[t.codePointAt(0)]=r,i),[]);function GI(i){return i.reduce((t,r)=>(t+=WI[r],t),"")}function YI(i){const t=[];for(const r of i){const s=FI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const JI=Yo({prefix:"",name:"base256emoji",encode:GI,decode:YI});var QI=Object.freeze({__proto__:null,base256emoji:JI}),XI=pd,zf=128,ZI=127,eS=~ZI,tS=Math.pow(2,31);function pd(i,t,r){t=t||[],r=r||0;for(var s=r;i>=tS;)t[r++]=i&255|zf,i/=128;for(;i&eS;)t[r++]=i&255|zf,i>>>=7;return t[r]=i|0,pd.bytes=r-s+1,t}var rS=su,nS=128,Bf=127;function su(i,s){var r=0,s=s||0,o=0,c=s,h,p=i.length;do{if(c>=p)throw su.bytes=0,new RangeError("Could not decode varint");h=i[c++],r+=o<28?(h&Bf)<<o:(h&Bf)*Math.pow(2,o),o+=7}while(h>=nS);return su.bytes=c-s,r}var iS=Math.pow(2,7),sS=Math.pow(2,14),oS=Math.pow(2,21),aS=Math.pow(2,28),cS=Math.pow(2,35),uS=Math.pow(2,42),lS=Math.pow(2,49),hS=Math.pow(2,56),fS=Math.pow(2,63),pS=function(i){return i<iS?1:i<sS?2:i<oS?3:i<aS?4:i<cS?5:i<uS?6:i<lS?7:i<hS?8:i<fS?9:10},dS={encode:XI,decode:rS,encodingLength:pS},dd=dS;const Kf=(i,t,r=0)=>(dd.encode(i,t,r),t),Vf=i=>dd.encodingLength(i),ou=(i,t)=>{const r=t.byteLength,s=Vf(i),o=s+Vf(r),c=new Uint8Array(o+r);return Kf(i,c,0),Kf(r,c,s),c.set(t,o),new gS(i,r,t,c)};class gS{constructor(t,r,s,o){this.code=t,this.size=r,this.digest=s,this.bytes=o}}const gd=({name:i,code:t,encode:r})=>new yS(i,t,r);class yS{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?ou(this.code,r):r.then(s=>ou(this.code,s))}else throw Error("Unknown type, must be binary type")}}const yd=i=>async t=>new Uint8Array(await crypto.subtle.digest(i,t)),vS=gd({name:"sha2-256",code:18,encode:yd("SHA-256")}),mS=gd({name:"sha2-512",code:19,encode:yd("SHA-512")});var _S=Object.freeze({__proto__:null,sha256:vS,sha512:mS});const vd=0,wS="identity",md=ld,bS=i=>ou(vd,md(i)),ES={code:vd,name:wS,encode:md,digest:bS};var IS=Object.freeze({__proto__:null,identity:ES});new TextEncoder,new TextDecoder;const Hf={...gI,...vI,..._I,...bI,...SI,...jI,...UI,...$I,...HI,...QI};({..._S,...IS});function _d(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function SS(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?_d(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function wd(i,t,r,s){return{name:i,prefix:t,encoder:{name:i,prefix:t,encode:r},decoder:{decode:s}}}const Wf=wd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Vc=wd("ascii","a",i=>{let t="a";for(let r=0;r<i.length;r++)t+=String.fromCharCode(i[r]);return t},i=>{i=i.substring(1);const t=SS(i.length);for(let r=0;r<i.length;r++)t[r]=i.charCodeAt(r);return t}),xS={utf8:Wf,"utf-8":Wf,hex:Hf.base16,latin1:Vc,ascii:Vc,binary:Vc,...Hf};function PS(i,t="utf8"){const r=xS[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?_d(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}const bd="wc",OS=2,xu="core",Ln=`${bd}@2:${xu}:`,CS={name:xu,logger:"error"},NS={database:":memory:"},TS="crypto",Ff="client_ed25519_seed",RS=ve.ONE_DAY,AS="keychain",LS="0.3",jS="messages",DS="0.3",kS=ve.SIX_HOURS,US="publisher",Ed="irn",MS="error",Id="wss://relay.walletconnect.com",Gf="wss://relay.walletconnect.org",qS="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},$S="_subscription",gn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},zS=ve.ONE_SECOND,BS="2.11.1",KS=1e4,VS="0.3",HS="WALLETCONNECT_CLIENT_ID",Kr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},WS="subscription",FS="0.3",GS=ve.FIVE_SECONDS*1e3,YS="pairing",JS="0.3",rs={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},os={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},QS="history",XS="0.3",ZS="expirer",Dr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ex="0.3",Hc="verify-api",Oi="https://verify.walletconnect.com",au="https://verify.walletconnect.org",tx=[Oi,au],rx="echo",nx="https://echo.walletconnect.com";class ix{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=AS,this.version=LS,this.initialized=!1,this.storagePrefix=Ln,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Bp(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Kp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class sx{constructor(t,r,s){this.core=t,this.logger=r,this.name=TS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Af(o);return rd(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=r0();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),h=Af(c),p=ru();return await NE(p,o,RS,h)},this.generateSharedKey=(o,c,h)=>{this.isInitialized();const p=this.getPrivateKey(o),y=n0(p,c);return this.setSymKey(y,h)},this.setSymKey=async(o,c)=>{this.isInitialized();const h=c||i0(o);return await this.keychain.set(h,o),h},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,h)=>{this.isInitialized();const p=zp(h),y=Xn(c);if(nf(p)){const P=p.senderPublicKey,R=p.receiverPublicKey;o=await this.generateSharedKey(P,R)}const g=this.getSymKey(o),{type:v,senderPublicKey:b}=p;return o0({type:v,symKey:g,message:y,senderPublicKey:b})},this.decode=async(o,c,h)=>{this.isInitialized();const p=u0(c,h);if(nf(p)){const y=p.receiverPublicKey,g=p.senderPublicKey;o=await this.generateSharedKey(y,g)}try{const y=this.getSymKey(o),g=a0({symKey:y,encoded:c});return ds(g)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Uo(o);return hs(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Uo(o);return c.senderPublicKey?ar(c.senderPublicKey,or):void 0},this.core=t,this.logger=De.generateChildLogger(r,this.name),this.keychain=s||new ix(this.core,this.logger)}get context(){return De.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ff)}catch{t=ru(),await this.keychain.set(Ff,t)}return PS(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ox extends oE{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=jS,this.version=DS,this.initialized=!1,this.storagePrefix=Ln,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Ci(o);let h=this.messages.get(s);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(s,h),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),h=Ci(o);return typeof c[h]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=De.generateChildLogger(t,this.name),this.core=r}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Bp(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Kp(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ax extends aE{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new kr.EventEmitter,this.name=US,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const p=(c==null?void 0:c.ttl)||kS,y=nu(c),g=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,b=(c==null?void 0:c.id)||ad().toString(),P={topic:s,message:o,opts:{ttl:p,relay:y,prompt:g,tag:v,id:b}},R=setTimeout(()=>this.queue.set(b,P),this.publishTimeout);try{await await us(this.rpcPublish(s,o,p,y,g,v,b),this.publishTimeout,`Failed to publish payload, please try again. id:${b} tag:${v}`),this.removeRequestFromQueue(b),this.relayer.events.emit(Jt.publish,P)}catch(O){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=c==null?void 0:c.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(b),O;return}finally{clearTimeout(R)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=De.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return De.getLoggerContext(this.logger)}rpcPublish(t,r,s,o,c,h,p){var y,g,v,b;const P={method:Lo(o.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:c,tag:h},id:p};return sr((y=P.params)==null?void 0:y.prompt)&&((g=P.params)==null||delete g.prompt),sr((v=P.params)==null?void 0:v.tag)&&((b=P.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:o}=t;await this.publish(r,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ji.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class cx{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const o=s.filter(c=>c!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var ux=Object.defineProperty,lx=Object.defineProperties,hx=Object.getOwnPropertyDescriptors,Yf=Object.getOwnPropertySymbols,fx=Object.prototype.hasOwnProperty,px=Object.prototype.propertyIsEnumerable,Jf=(i,t,r)=>t in i?ux(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,ns=(i,t)=>{for(var r in t||(t={}))fx.call(t,r)&&Jf(i,r,t[r]);if(Yf)for(var r of Yf(t))px.call(t,r)&&Jf(i,r,t[r]);return i},Wc=(i,t)=>lx(i,hx(t));class dx extends lE{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new cx,this.events=new kr.EventEmitter,this.name=WS,this.version=FS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ln,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=nu(o),h={topic:s,relay:c};this.pending.set(s,h);const p=await this.rpcSubscribe(s,c);return this.onSubscribe(p,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,h)=>{const p=new ve.Watch;p.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),p.stop(o),c(!0)),p.elapsed(o)>=GS&&(clearInterval(y),p.stop(o),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=De.generateChildLogger(r,this.name),this.clientId=""}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const o=nu(s);await this.rpcUnsubscribe(t,r,o);const c=ft("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const s={method:Lo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await us(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return Ci(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Lo(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await us(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,s){const o={method:Lo(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,Wc(ns({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ns({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ns({},r)),this.topicMap.set(r.topic,t),this.events.emit(Kr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Kr.deleted,Wc(ns({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Kr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Kr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Zr(r)&&this.onBatchSubscribe(r.map((s,o)=>Wc(ns({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ji.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(Kr.created,async t=>{const r=Kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Kr.deleted,async t=>{const r=Kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var gx=Object.defineProperty,Qf=Object.getOwnPropertySymbols,yx=Object.prototype.hasOwnProperty,vx=Object.prototype.propertyIsEnumerable,Xf=(i,t,r)=>t in i?gx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,mx=(i,t)=>{for(var r in t||(t={}))yx.call(t,r)&&Xf(i,r,t[r]);if(Qf)for(var r of Qf(t))vx.call(t,r)&&Xf(i,r,t[r]);return i};class _x extends cE{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new kr.EventEmitter,this.name=qS,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async r=>{this.logger.debug("Publishing Request Payload");const s=r.id,o=this.provider.request(r);this.requestsInFlight.set(s,{promise:o,request:r});try{return await this.toEstablishConnection(),await o}catch(c){throw this.logger.debug("Failed to Publish Request"),this.logger.error(c),c}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(gn.payload,this.onPayloadHandler),this.provider.on(gn.connect,this.onConnectHandler),this.provider.on(gn.disconnect,this.onDisconnectHandler),this.provider.on(gn.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?De.generateChildLogger(t.logger,this.name):De.pino(De.getDefaultLoggerOptions({level:t.logger||MS})),this.messages=new ox(this.logger,t.core),this.subscriber=new dx(this,this.logger),this.publisher=new ax(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Id,this.projectId=t.projectId,this.bundleId=g0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Gf}...`),await this.restartTransport(Gf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},KS)}get context(){return De.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(o)return o;let c;const h=p=>{p.topic===t&&(this.subscriber.off(Kr.created,h),c())};return await Promise.all([new Promise(p=>{c=p,this.subscriber.on(Kr.created,h)}),new Promise(async p=>{o=await this.subscriber.subscribe(t,r),p()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async t=>{await t.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await us(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Kr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await us(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(gn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await gf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new _n(new JE(b0({sdkVersion:BS,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Su(t)){if(!t.method.endsWith($S))return;const r=t.params,{topic:s,message:o,publishedAt:c}=r.data,h={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(mx({type:"event",event:r.id},h)),this.events.emit(r.id,h),await this.acknowledgePayload(t),await this.onMessageEvent(h)}else Go(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Wo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(gn.payload,this.onPayloadHandler),this.provider.off(gn.connect,this.onConnectHandler),this.provider.off(gn.disconnect,this.onDisconnectHandler),this.provider.off(gn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await gf();g1(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ve.toMiliseconds(zS)))}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var wx=Object.defineProperty,Zf=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,Ex=Object.prototype.propertyIsEnumerable,ep=(i,t,r)=>t in i?wx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,tp=(i,t)=>{for(var r in t||(t={}))bx.call(t,r)&&ep(i,r,t[r]);if(Zf)for(var r of Zf(t))Ex.call(t,r)&&ep(i,r,t[r]);return i};class Jo extends uE{constructor(t,r,s,o=Ln,c=void 0){super(t,r,s,o),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=VS,this.cached=[],this.initialized=!1,this.storagePrefix=Ln,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!sr(h)?this.map.set(this.getKey(h),h):W0(h)?this.map.set(h.id,h):F0(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,p)=>{this.isInitialized(),this.map.has(h)?await this.update(h,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:p}),this.map.set(h,p),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(p=>Object.keys(h).every(y=>XE(p[y],h[y]))):this.values),this.update=async(h,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:p});const y=tp(tp({},this.getData(h)),p);this.map.set(h,y),await this.persist()},this.delete=async(h,p)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:p}),this.map.delete(h),await this.persist())},this.logger=De.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ix{constructor(t,r){this.core=t,this.logger=r,this.name=YS,this.version=JS,this.events=new fu,this.initialized=!1,this.storagePrefix=Ln,this.ignoredPayloadTypes=[ei],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=ru(),o=await this.core.crypto.setSymKey(s),c=Sr(ve.FIVE_MINUTES),h={protocol:Ed},p={topic:o,expiry:c,relay:h,active:!1},y=U0({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:h,expiryTimestamp:c});return await this.pairings.set(o,p),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:h,expiryTimestamp:p}=lf(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=p||Sr(ve.FIVE_MINUTES),v={topic:o,relay:h,expiry:g,active:!1};return await this.pairings.set(o,v),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),this.events.emit(os.create,v),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:h})),v},this.activate=async({topic:s})=>{this.isInitialized();const o=Sr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:p,reject:y}=Pi();this.events.once(Tt("pairing_ping",c),({error:g})=>{g?y(g):p()}),await h()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",ft("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const h=Ni(o,c),p=await this.core.crypto.encode(s,h),y=rs[o].req;return this.core.history.set(s,h),this.core.relayer.publish(s,p,y),h.id},this.sendResult=async(s,o,c)=>{const h=Wo(s,c),p=await this.core.crypto.encode(o,h),y=await this.core.history.get(o,s),g=rs[y.request.method].res;await this.core.relayer.publish(o,p,g),await this.core.history.resolve(h)},this.sendError=async(s,o,c)=>{const h=Fo(s,c),p=await this.core.crypto.encode(o,h),y=await this.core.history.get(o,s),g=rs[y.request.method]?rs[y.request.method].res:rs.unregistered_method.res;await this.core.relayer.publish(o,p,g),await this.core.history.resolve(h)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,ft("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>An(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,h=(await this.core.history.get(o,c.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(os.ping,{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{mn(o)?this.events.emit(Tt("pairing_ping",c),{}):Vr(o)&&this.events.emit(Tt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(os.delete,{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;const p=ft("WC_METHOD_UNSUPPORTED",h);await this.sendError(c,s,p),this.logger.error(p)}catch(p){await this.sendError(c,s,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(ft("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!yr(s)){const{message:h}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(h)}if(!H0(s.uri)){const{message:h}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(h)}const c=lf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:h}=ue("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(h)}if(!(c!=null&&c.symKey)){const{message:h}=ue("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(h)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:h}=ue("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(h)}},this.isValidPing=async s=>{if(!yr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(An(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=De.generateChildLogger(r,this.name),this.pairings=new Jo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return De.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(r,s);try{Su(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Go(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Dr.expired,async t=>{const{topic:r}=Hp(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(os.expire,{topic:r}))})}}class Sx extends sE{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new kr.EventEmitter,this.name=QS,this.version=XS,this.cached=[],this.initialized=!1,this.storagePrefix=Ln,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const h={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Sr(ve.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(Xr.created,h)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Vr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Xr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Xr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Ni(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Xr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Xr.created,t=>{const r=Xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.updated,t=>{const r=Xr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.deleted,t=>{const r=Xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(ji.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ve.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xx extends hE{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new kr.EventEmitter,this.name=ZS,this.version=ex,this.cached=[],this.initialized=!1,this.storagePrefix=Ln,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(Dr.created,{target:c,expiration:h})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Dr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=De.generateChildLogger(r,this.name)}get context(){return De.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return E0(t);if(typeof t=="number")return I0(t);const{message:r}=ue("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Dr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Dr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ji.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Dr.created,t=>{const r=Dr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Dr.expired,t=>{const r=Dr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Dr.deleted,t=>{const r=Dr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Px extends fE{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Hc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Ri()||!Ai())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=au;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(h){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(h),c=await this.fetchAttestation(s.attestationId,au)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),h=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?await h.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Hc))return c();window.addEventListener("message",o);const h=document.createElement("iframe");h.id=Hc,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,s=c}),new Promise((c,h)=>setTimeout(()=>{window.removeEventListener("message",o),h("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Oi;return tx.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Oi}`),o=Oi),o},this.logger=De.generateChildLogger(r,this.name),this.verifyUrl=Oi,this.abortController=new AbortController,this.isDevEnv=mu()&&Ub.IS_VITEST}get context(){return De.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(t))}}class Ox extends pE{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=rx,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:h,enableEncrypted:p=!1}=s,y=`${nx}/${this.projectId}/clients`;await rI(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:h,token:c,always_raw:p})})},this.logger=De.generateChildLogger(r,this.context)}}var Cx=Object.defineProperty,rp=Object.getOwnPropertySymbols,Nx=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,np=(i,t,r)=>t in i?Cx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,ip=(i,t)=>{for(var r in t||(t={}))Nx.call(t,r)&&np(i,r,t[r]);if(rp)for(var r of rp(t))Tx.call(t,r)&&np(i,r,t[r]);return i};class Pu extends iE{constructor(t){super(t),this.protocol=bd,this.version=OS,this.name=xu,this.events=new kr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Id,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:De.pino(De.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||CS.logger}));this.logger=De.generateChildLogger(r,this.name),this.heartbeat=new ji.HeartBeat,this.crypto=new sx(this,this.logger,t==null?void 0:t.keychain),this.history=new Sx(this,this.logger),this.expirer=new xx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Y1(ip(ip({},NS),t==null?void 0:t.storageOptions)),this.relayer=new _x({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ix(this,this.logger),this.verify=new Px(this.projectId||"",this.logger),this.echoClient=new Ox(this.projectId||"",this.logger)}static async init(t){const r=new Pu(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(HS,s),r}get context(){return De.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const Rx=Pu,Sd="wc",xd=2,Pd="client",Ou=`${Sd}@${xd}:${Pd}:`,Fc={name:Pd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},sp="WALLETCONNECT_DEEPLINK_CHOICE",Ax="proposal",Od="Proposal expired",Lx="session",To=ve.SEVEN_DAYS,jx="engine",yn={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},Gc={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},vn={idle:"IDLE",active:"ACTIVE"},Dx="request",kx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Ux=Object.defineProperty,Mx=Object.defineProperties,qx=Object.getOwnPropertyDescriptors,op=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,zx=Object.prototype.propertyIsEnumerable,ap=(i,t,r)=>t in i?Ux(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,nr=(i,t)=>{for(var r in t||(t={}))$x.call(t,r)&&ap(i,r,t[r]);if(op)for(var r of op(t))zx.call(t,r)&&ap(i,r,t[r]);return i},xi=(i,t)=>Mx(i,qx(t));class Bx extends gE{constructor(t){super(t),this.name=jx,this.events=new fu,this.initialized=!1,this.ignoredPayloadTypes=[ei],this.requestQueue={state:vn.idle,queue:[]},this.sessionRequestQueue={state:vn.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(yn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=xi(nr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:p,relays:y}=s;let g=o,v,b=!1;if(g&&(b=this.client.core.pairing.pairings.get(g).active),!g||!b){const{topic:S,uri:C}=await this.client.core.pairing.create();g=S,v=C}const P=await this.client.core.crypto.generateKeyPair(),R=yn.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,O=Sr(R),L=nr({requiredNamespaces:c,optionalNamespaces:h,relays:y??[{protocol:Ed}],proposer:{publicKey:P,metadata:this.client.metadata},expiryTimestamp:O},p&&{sessionProperties:p}),{reject:K,resolve:q,done:$}=Pi(R,Od);if(this.events.once(Tt("session_connect"),async({error:S,session:C})=>{if(S)K(S);else if(C){C.self.publicKey=P;const I=xi(nr({},C),{requiredNamespaces:L.requiredNamespaces,optionalNamespaces:L.optionalNamespaces});await this.client.session.set(C.topic,I),await this.setExpiry(C.topic,C.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:C.peer.metadata}),q(I)}}),!g){const{message:S}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(S)}const B=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:L,throwOnFailedPublish:!0});return await this.setProposal(B,nr({id:B},L)),{uri:v,approval:$}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:h}=r,p=this.client.proposal.get(s);let{pairingTopic:y,proposer:g,requiredNamespaces:v,optionalNamespaces:b}=p;y=y||"";const P=await this.client.core.crypto.generateKeyPair(),R=g.publicKey,O=await this.client.core.crypto.generateSharedKey(P,R);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:P}}),await this.client.proposal.delete(s,ft("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const L=nr({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:P,metadata:this.client.metadata},expiry:Sr(To)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(O);const K=xi(nr({},L),{topic:O,requiredNamespaces:v,optionalNamespaces:b,pairingTopic:y,acknowledged:!1,self:L.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:P});await this.client.session.set(O,K);try{await this.sendRequest({topic:O,method:"wc_sessionSettle",params:L,throwOnFailedPublish:!0})}catch(q){throw this.client.logger.error(q),this.client.session.delete(O,ft("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),q}return await this.setExpiry(O,Sr(To)),{topic:O,acknowledged:()=>new Promise(q=>setTimeout(()=>q(this.client.session.get(O)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,ft("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:o}=r,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:h,resolve:p,reject:y}=Pi();return this.events.once(Tt("session_update",c),({error:g})=>{g?y(g):p()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:h}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:h,reject:p}=Pi();return this.events.once(Tt("session_extend",o),({error:y})=>{y?p(y):h()}),await this.setExpiry(s,Sr(To)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:o,topic:c,expiry:h=yn.wc_sessionRequest.req.ttl}=r,p=Iu(),{done:y,resolve:g,reject:v}=Pi(h,"Request expired. Please try again.");return this.events.once(Tt("session_request",p),({error:b,result:P})=>{b?v(b):g(P)}),await Promise.all([new Promise(async b=>{await this.sendRequest({clientRpcId:p,topic:c,method:"wc_sessionRequest",params:{request:xi(nr({},o),{expiryTimestamp:Sr(h)}),chainId:s},expiry:h,throwOnFailedPublish:!0}).catch(P=>v(P)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:p}),b()}),new Promise(async b=>{const P=await x0(this.client.core.storage,sp);S0({id:p,topic:c,wcDeepLink:P}),b()}),y()]).then(b=>b[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:o}=r,{id:c}=o;mn(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Vr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:h,reject:p}=Pi();this.events.once(Tt("session_ping",o),({error:y})=>{y?p(y):h()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:o,chainId:c}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:ft("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ue("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>K0(s,r))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,p;return((h=c.peerMetadata)==null?void 0:h.url)&&((p=c.peerMetadata)==null?void 0:p.url)===r.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async r=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:h=0}=r,{self:p}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,ft("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(p.publicKey)&&await this.client.core.crypto.deleteKeyPair(p.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(sp).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,ft("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:h,topic:s})},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,ft("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=vn.idle,this.client.events.emit("session_request_expire",{id:r}))},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,Sr(yn.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async r=>{const{id:s,topic:o,params:c,verifyContext:h}=r,p=c.request.expiryTimestamp||Sr(yn.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:h}),p&&this.client.core.expirer.set(s,p)},this.sendRequest=async r=>{const{topic:s,method:o,params:c,expiry:h,relayRpcId:p,clientRpcId:y,throwOnFailedPublish:g}=r,v=Ni(o,c,y);if(Ai()&&kx.includes(o)){const R=Ci(JSON.stringify(v));this.client.core.verify.register({attestationId:R})}const b=await this.client.core.crypto.encode(s,v),P=yn[o].req;return h&&(P.ttl=h),p&&(P.id=p),this.client.core.history.set(s,v),g?(P.internal=xi(nr({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,b,P)):this.client.core.relayer.publish(s,b,P).catch(R=>this.client.logger.error(R)),v.id},this.sendResult=async r=>{const{id:s,topic:o,result:c,throwOnFailedPublish:h}=r,p=Wo(s,c),y=await this.client.core.crypto.encode(o,p),g=await this.client.core.history.get(o,s),v=yn[g.request.method].res;h?(v.internal=xi(nr({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,v)):this.client.core.relayer.publish(o,y,v).catch(b=>this.client.logger.error(b)),await this.client.core.history.resolve(p)},this.sendError=async(r,s,o)=>{const c=Fo(r,o),h=await this.client.core.crypto.encode(s,c),p=await this.client.core.history.get(s,r),y=yn[p.request.method].res;this.client.core.relayer.publish(s,h,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;An(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{An(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===vn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=vn.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=vn.idle},this.processRequest=r=>{const{topic:s,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:o}=r,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(nr({},s.params));const h=o.expiryTimestamp||Sr(yn.wc_sessionPropose.req.ttl),p=nr({id:c,pairingTopic:r,expiryTimestamp:h},o);await this.setProposal(c,p);const y=Ci(JSON.stringify(s)),g=await this.getVerifyContext(y,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:g})}catch(h){await this.sendError(c,r,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(r,s)=>{const{id:o}=s;if(mn(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const p=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const g=await this.client.core.crypto.generateSharedKey(p,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const v=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:r})}else Vr(s)&&(await this.client.proposal.delete(o,ft("USER_DISCONNECTED")),this.events.emit(Tt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:h,controller:p,expiry:y,namespaces:g,sessionProperties:v,pairingTopic:b}=s.params,P=nr({topic:r,relay:h,expiry:y,namespaces:g,acknowledged:!0,pairingTopic:b,requiredNamespaces:{},optionalNamespaces:{},controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},v&&{sessionProperties:v});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Tt("session_connect"),{session:P}),this.cleanupDuplicatePairings(P)}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(r,s)=>{const{id:o}=s;mn(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Tt("session_approve",o),{})):Vr(s)&&(await this.client.session.delete(r,ft("USER_DISCONNECTED")),this.events.emit(Tt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:o,id:c}=s;try{const h=`${r}_session_update`,p=Oo.get(h);if(p&&this.isRequestOutOfSync(p,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(nr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),Oo.set(h,c)}catch(h){await this.sendError(c,r,h),this.client.logger.error(h)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:o}=s;mn(s)?this.events.emit(Tt("session_update",o),{}):Vr(s)&&this.events.emit(Tt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:o}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Sr(To)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,s)=>{const{id:o}=s;mn(s)?this.events.emit(Tt("session_extend",o),{}):Vr(s)&&this.events.emit(Tt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:o}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,s)=>{const{id:o}=s;setTimeout(()=>{mn(s)?this.events.emit(Tt("session_ping",o),{}):Vr(s)&&this.events.emit(Tt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Jt.publish,async()=>{c(await this.deleteSession({topic:r,id:o}))})}),this.sendResult({id:o,topic:r,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:ft("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(nr({topic:r},c));const h=Ci(JSON.stringify(Ni("wc_sessionRequest",c,o))),p=this.client.session.get(r),y=await this.getVerifyContext(h,p.peer.metadata),g={id:o,topic:r,params:c,verifyContext:y};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(r,s)=>{const{id:o}=s;mn(s)?this.events.emit(Tt("session_request",o),{result:s.result}):Vr(s)&&this.events.emit(Tt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:o,params:c}=s;try{const h=`${r}_session_event_${c.event.name}`,p=Oo.get(h);if(p&&this.isRequestOutOfSync(p,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(nr({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),Oo.set(h,o)}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=vn.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:r,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===r&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Tt("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===vn.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=vn.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Ni("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!yr(r)){const{message:y}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:p}=r;if(sr(s)||await this.isValidPairingTopic(s),!t1(p,!0)){const{message:y}=ue("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(y)}!sr(o)&&ls(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!sr(c)&&ls(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),sr(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(r,s)=>{const o=e1(r,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!yr(r))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:h}=r;await this.isValidProposalId(s);const p=this.client.proposal.get(s),y=Mc(o,"approve()");if(y)throw new Error(y.message);const g=pf(p.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Vt(c,!0)){const{message:v}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}sr(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async r=>{if(!yr(r)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:s,reason:o}=r;if(await this.isValidProposalId(s),!n1(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!yr(r)){const{message:g}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:h}=r;if(!Fp(s)){const{message:g}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const p=G0(o,"onSessionSettleRequest()");if(p)throw new Error(p.message);const y=Mc(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(An(h)){const{message:g}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async r=>{if(!yr(r)){const{message:y}=ue("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(y)}const{topic:s,namespaces:o}=r;await this.isValidSessionTopic(s);const c=this.client.session.get(s),h=Mc(o,"update()");if(h)throw new Error(h.message);const p=pf(c.requiredNamespaces,o,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async r=>{if(!yr(r)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!yr(r)){const{message:y}=ue("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:h}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!ff(p,c)){const{message:y}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!i1(o)){const{message:y}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!a1(p,c,o.method)){const{message:y}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(h&&!h1(h,Gc)){const{message:y}=ue("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Gc.min} and ${Gc.max}`);throw new Error(y)}},this.isValidRespond=async r=>{var s;if(!yr(r)){const{message:h}=ue("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:o,response:c}=r;try{await this.isValidSessionTopic(o)}catch(h){throw(s=r==null?void 0:r.response)!=null&&s.id&&this.cleanupAfterResponse(r),h}if(!s1(c)){const{message:h}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!yr(r)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!yr(r)){const{message:p}=ue("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(p)}const{topic:s,event:o,chainId:c}=r;await this.isValidSessionTopic(s);const{namespaces:h}=this.client.session.get(s);if(!ff(h,c)){const{message:p}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!o1(o)){const{message:p}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}if(!c1(h,c,o.name)){const{message:p}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidDisconnect=async r=>{if(!yr(r)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Oi,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(o=>{if(!Vt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ue("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(r,s);try{Su(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Go(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Dr.expired,async t=>{const{topic:r,id:s}=Hp(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(os.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Vt(t,!1)){const{message:r}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ue("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Vt(t,!1)){const{message:r}=ue("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:r}=ue("EXPIRED",`session topic: ${t}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(t)){const{message:r}=ue("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Vt(t,!1)){const{message:r}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!r1(t)){const{message:r}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(An(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:r}=ue("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Kx extends Jo{constructor(t,r){super(t,r,Ax,Ou),this.core=t,this.logger=r}}let Vx=class extends Jo{constructor(i,t){super(i,t,Lx,Ou),this.core=i,this.logger=t}};class Hx extends Jo{constructor(t,r){super(t,r,Dx,Ou,s=>s.id),this.core=t,this.logger=r}}let Wx=class Cd extends dE{constructor(t){super(t),this.protocol=Sd,this.version=xd,this.name=Fc.name,this.events=new kr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Fc.name,this.metadata=(t==null?void 0:t.metadata)||v0();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:De.pino(De.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Fc.logger}));this.core=(t==null?void 0:t.core)||new Rx(t),this.logger=De.generateChildLogger(r,this.name),this.session=new Vx(this.core,this.logger),this.proposal=new Kx(this.core,this.logger),this.pendingRequest=new Hx(this.core,this.logger),this.engine=new Bx(this)}static async init(t){const r=new Cd(t);return await r.initialize(),r}get context(){return De.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var cu={exports:{}};(function(i,t){var r=typeof self<"u"?self:Hr,s=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(h){var p={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(_){return _&&DataView.prototype.isPrototypeOf(_)}if(p.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(_){return _&&g.indexOf(Object.prototype.toString.call(_))>-1};function b(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function P(_){return typeof _!="string"&&(_=String(_)),_}function R(_){var T={next:function(){var ce=_.shift();return{done:ce===void 0,value:ce}}};return p.iterable&&(T[Symbol.iterator]=function(){return T}),T}function O(_){this.map={},_ instanceof O?_.forEach(function(T,ce){this.append(ce,T)},this):Array.isArray(_)?_.forEach(function(T){this.append(T[0],T[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(T){this.append(T,_[T])},this)}O.prototype.append=function(_,T){_=b(_),T=P(T);var ce=this.map[_];this.map[_]=ce?ce+", "+T:T},O.prototype.delete=function(_){delete this.map[b(_)]},O.prototype.get=function(_){return _=b(_),this.has(_)?this.map[_]:null},O.prototype.has=function(_){return this.map.hasOwnProperty(b(_))},O.prototype.set=function(_,T){this.map[b(_)]=P(T)},O.prototype.forEach=function(_,T){for(var ce in this.map)this.map.hasOwnProperty(ce)&&_.call(T,this.map[ce],ce,this)},O.prototype.keys=function(){var _=[];return this.forEach(function(T,ce){_.push(ce)}),R(_)},O.prototype.values=function(){var _=[];return this.forEach(function(T){_.push(T)}),R(_)},O.prototype.entries=function(){var _=[];return this.forEach(function(T,ce){_.push([ce,T])}),R(_)},p.iterable&&(O.prototype[Symbol.iterator]=O.prototype.entries);function L(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function K(_){return new Promise(function(T,ce){_.onload=function(){T(_.result)},_.onerror=function(){ce(_.error)}})}function q(_){var T=new FileReader,ce=K(T);return T.readAsArrayBuffer(_),ce}function $(_){var T=new FileReader,ce=K(T);return T.readAsText(_),ce}function B(_){for(var T=new Uint8Array(_),ce=new Array(T.length),le=0;le<T.length;le++)ce[le]=String.fromCharCode(T[le]);return ce.join("")}function S(_){if(_.slice)return _.slice(0);var T=new Uint8Array(_.byteLength);return T.set(new Uint8Array(_)),T.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:p.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:p.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():p.arrayBuffer&&p.blob&&y(_)?(this._bodyArrayBuffer=S(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||v(_))?this._bodyArrayBuffer=S(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var _=L(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?L(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(q)}),this.text=function(){var _=L(this);if(_)return _;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(B(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ae)}),this.json=function(){return this.text().then(JSON.parse)},this}var I=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function A(_){var T=_.toUpperCase();return I.indexOf(T)>-1?T:_}function M(_,T){T=T||{};var ce=T.body;if(_ instanceof M){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,T.headers||(this.headers=new O(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!ce&&_._bodyInit!=null&&(ce=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=T.credentials||this.credentials||"same-origin",(T.headers||!this.headers)&&(this.headers=new O(T.headers)),this.method=A(T.method||this.method||"GET"),this.mode=T.mode||this.mode||null,this.signal=T.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ce)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ce)}M.prototype.clone=function(){return new M(this,{body:this._bodyInit})};function ae(_){var T=new FormData;return _.trim().split("&").forEach(function(ce){if(ce){var le=ce.split("="),ne=le.shift().replace(/\+/g," "),Q=le.join("=").replace(/\+/g," ");T.append(decodeURIComponent(ne),decodeURIComponent(Q))}}),T}function Z(_){var T=new O,ce=_.replace(/\r?\n[\t ]+/g," ");return ce.split(/\r?\n/).forEach(function(le){var ne=le.split(":"),Q=ne.shift().trim();if(Q){var ee=ne.join(":").trim();T.append(Q,ee)}}),T}C.call(M.prototype);function he(_,T){T||(T={}),this.type="default",this.status=T.status===void 0?200:T.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in T?T.statusText:"OK",this.headers=new O(T.headers),this.url=T.url||"",this._initBody(_)}C.call(he.prototype),he.prototype.clone=function(){return new he(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new O(this.headers),url:this.url})},he.error=function(){var _=new he(null,{status:0,statusText:""});return _.type="error",_};var F=[301,302,303,307,308];he.redirect=function(_,T){if(F.indexOf(T)===-1)throw new RangeError("Invalid status code");return new he(null,{status:T,headers:{location:_}})},h.DOMException=c.DOMException;try{new h.DOMException}catch{h.DOMException=function(_,T){this.message=_,this.name=T;var ce=Error(_);this.stack=ce.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function fe(_,T){return new Promise(function(ce,le){var ne=new M(_,T);if(ne.signal&&ne.signal.aborted)return le(new h.DOMException("Aborted","AbortError"));var Q=new XMLHttpRequest;function ee(){Q.abort()}Q.onload=function(){var se={status:Q.status,statusText:Q.statusText,headers:Z(Q.getAllResponseHeaders()||"")};se.url="responseURL"in Q?Q.responseURL:se.headers.get("X-Request-URL");var ze="response"in Q?Q.response:Q.responseText;ce(new he(ze,se))},Q.onerror=function(){le(new TypeError("Network request failed"))},Q.ontimeout=function(){le(new TypeError("Network request failed"))},Q.onabort=function(){le(new h.DOMException("Aborted","AbortError"))},Q.open(ne.method,ne.url,!0),ne.credentials==="include"?Q.withCredentials=!0:ne.credentials==="omit"&&(Q.withCredentials=!1),"responseType"in Q&&p.blob&&(Q.responseType="blob"),ne.headers.forEach(function(se,ze){Q.setRequestHeader(ze,se)}),ne.signal&&(ne.signal.addEventListener("abort",ee),Q.onreadystatechange=function(){Q.readyState===4&&ne.signal.removeEventListener("abort",ee)}),Q.send(typeof ne._bodyInit>"u"?null:ne._bodyInit)})}return fe.polyfill=!0,c.fetch||(c.fetch=fe,c.Headers=O,c.Request=M,c.Response=he),h.Headers=O,h.Request=M,h.Response=he,h.fetch=fe,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,i.exports=t})(cu,cu.exports);var Fx=cu.exports;const cp=du(Fx),Gx={Accept:"application/json","Content-Type":"application/json"},Yx="POST",up={headers:Gx,method:Yx},lp=10;class Dn{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new kr.EventEmitter,this.isAvailable=!1,this.registering=!1,!kf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Xn(t),o=await(await cp(this.url,Object.assign(Object.assign({},up),{body:s}))).json();this.onPayload({data:o})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!kf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Xn({id:1,jsonrpc:"2.0",method:"test",params:[]});await cp(t,Object.assign(Object.assign({},up),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ds(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),o=s.message||s.toString(),c=Fo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return sd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>lp&&this.events.setMaxListeners(lp)}}const hp="error",Jx="wss://relay.walletconnect.com",Qx="wc",Xx="universal_provider",fp=`${Qx}@2:${Xx}:`,Zx="https://rpc.walletconnect.com/v1/",wn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,t){(function(){var r,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",p="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",g=500,v="__lodash_placeholder__",b=1,P=2,R=4,O=1,L=2,K=1,q=2,$=4,B=8,S=16,C=32,I=64,A=128,M=256,ae=512,Z=30,he="...",F=800,fe=16,_=1,T=2,ce=3,le=1/0,ne=9007199254740991,Q=17976931348623157e292,ee=NaN,se=4294967295,ze=se-1,Be=se>>>1,cr=[["ary",A],["bind",K],["bindKey",q],["curry",B],["curryRight",S],["flip",ae],["partial",C],["partialRight",I],["rearg",M]],xe="[object Arguments]",nt="[object Array]",W="[object AsyncFunction]",H="[object Boolean]",U="[object Date]",l="[object DOMException]",w="[object Error]",z="[object Function]",te="[object GeneratorFunction]",oe="[object Map]",ie="[object Number]",_e="[object Null]",Ne="[object Object]",ct="[object Promise]",Je="[object Proxy]",it="[object RegExp]",$e="[object Set]",Qe="[object String]",Ke="[object Symbol]",We="[object Undefined]",Oe="[object WeakMap]",me="[object WeakSet]",Ie="[object ArrayBuffer]",qe="[object DataView]",Xe="[object Float32Array]",ke="[object Float64Array]",Ge="[object Int8Array]",yt="[object Int16Array]",xt="[object Int32Array]",Rt="[object Uint8Array]",vt="[object Uint8ClampedArray]",Ht="[object Uint16Array]",ur="[object Uint32Array]",Wr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,en=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bn=/&(?:amp|lt|gt|quot|#39);/g,kn=/[&<>"']/g,mt=RegExp(bn.source),ut=RegExp(kn.source),_t=/<%-([\s\S]+?)%>/g,wt=/<%([\s\S]+?)%>/g,dt=/<%=([\s\S]+?)%>/g,lt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bt=/[\\^$.*+?()[\]{}|]/g,jt=RegExp(bt.source),Et=/^\s+/,Pt=/\s/,It=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,Dt=/,? & /,kt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Qo=/[()=,{}\[\]\/\s]/,Xo=/\\(\\)?/g,Zo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pr=/\w*$/,ea=/^[-+]0x[0-9a-f]+$/i,ta=/^0b[01]+$/i,ra=/^\[object .+?Constructor\]$/,na=/^0o[0-7]+$/i,ia=/^(?:0|[1-9]\d*)$/,tn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ii=/($^)/,sa=/['\n\r\u2028\u2029\\]/g,si="\\ud800-\\udfff",oa="\\u0300-\\u036f",aa="\\ufe20-\\ufe2f",oi="\\u20d0-\\u20ff",ys=oa+aa+oi,vs="\\u2700-\\u27bf",Ur="a-z\\xdf-\\xf6\\xf8-\\xff",ca="\\xac\\xb1\\xd7\\xf7",ua="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",la="\\u2000-\\u206f",ha=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ms="A-Z\\xc0-\\xd6\\xd8-\\xde",_s="\\ufe0e\\ufe0f",Un=ca+ua+la+ha,Di="[']",Mn="["+si+"]",ki="["+Un+"]",qn="["+ys+"]",ws="\\d+",fa="["+vs+"]",bs="["+Ur+"]",Es="[^"+si+Un+ws+vs+Ur+ms+"]",ai="\\ud83c[\\udffb-\\udfff]",pa="(?:"+qn+"|"+ai+")",Is="[^"+si+"]",ci="(?:\\ud83c[\\udde6-\\uddff]){2}",En="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="["+ms+"]",Ss="\\u200d",xs="(?:"+bs+"|"+Es+")",Fr="(?:"+mr+"|"+Es+")",Ps="(?:"+Di+"(?:d|ll|m|re|s|t|ve))?",Os="(?:"+Di+"(?:D|LL|M|RE|S|T|VE))?",Cs=pa+"?",Ns="["+_s+"]?",da="(?:"+Ss+"(?:"+[Is,ci,En].join("|")+")"+Ns+Cs+")*",rn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ts="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rs=Ns+Cs+da,ui="(?:"+[fa,ci,En].join("|")+")"+Rs,ga="(?:"+[Is+qn+"?",qn,ci,En,Mn].join("|")+")",Ui=RegExp(Di,"g"),ya=RegExp(qn,"g"),li=RegExp(ai+"(?="+ai+")|"+ga+Rs,"g"),As=RegExp([mr+"?"+bs+"+"+Ps+"(?="+[ki,mr,"$"].join("|")+")",Fr+"+"+Os+"(?="+[ki,mr+xs,"$"].join("|")+")",mr+"?"+xs+"+"+Ps,mr+"+"+Os,Ts,rn,ws,ui].join("|"),"g"),Ls=RegExp("["+Ss+si+ys+_s+"]"),$n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,js=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],va=-1,Ze={};Ze[Xe]=Ze[ke]=Ze[Ge]=Ze[yt]=Ze[xt]=Ze[Rt]=Ze[vt]=Ze[Ht]=Ze[ur]=!0,Ze[xe]=Ze[nt]=Ze[Ie]=Ze[H]=Ze[qe]=Ze[U]=Ze[w]=Ze[z]=Ze[oe]=Ze[ie]=Ze[Ne]=Ze[it]=Ze[$e]=Ze[Qe]=Ze[Oe]=!1;var Ye={};Ye[xe]=Ye[nt]=Ye[Ie]=Ye[qe]=Ye[H]=Ye[U]=Ye[Xe]=Ye[ke]=Ye[Ge]=Ye[yt]=Ye[xt]=Ye[oe]=Ye[ie]=Ye[Ne]=Ye[it]=Ye[$e]=Ye[Qe]=Ye[Ke]=Ye[Rt]=Ye[vt]=Ye[Ht]=Ye[ur]=!0,Ye[w]=Ye[z]=Ye[Oe]=!1;var E={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},et=parseFloat,Ce=parseInt,ot=typeof is=="object"&&is&&is.Object===Object&&is,Ut=typeof self=="object"&&self&&self.Object===Object&&self,Ue=ot||Ut||Function("return this")(),tt=t&&!t.nodeType&&t,Ot=tt&&!0&&i&&!i.nodeType&&i,lr=Ot&&Ot.exports===tt,Mt=lr&&ot.process,at=function(){try{var j=Ot&&Ot.require&&Ot.require("util").types;return j||Mt&&Mt.binding&&Mt.binding("util")}catch{}}(),Xt=at&&at.isArrayBuffer,Mr=at&&at.isDate,Or=at&&at.isMap,Gr=at&&at.isRegExp,Mi=at&&at.isSet,zn=at&&at.isTypedArray;function zt(j,G,V){switch(V.length){case 0:return j.call(G);case 1:return j.call(G,V[0]);case 2:return j.call(G,V[0],V[1]);case 3:return j.call(G,V[0],V[1],V[2])}return j.apply(G,V)}function Rd(j,G,V,ge){for(var Se=-1,Ve=j==null?0:j.length;++Se<Ve;){var qt=j[Se];G(ge,qt,V(qt),j)}return ge}function Cr(j,G){for(var V=-1,ge=j==null?0:j.length;++V<ge&&G(j[V],V,j)!==!1;);return j}function Ad(j,G){for(var V=j==null?0:j.length;V--&&G(j[V],V,j)!==!1;);return j}function Tu(j,G){for(var V=-1,ge=j==null?0:j.length;++V<ge;)if(!G(j[V],V,j))return!1;return!0}function In(j,G){for(var V=-1,ge=j==null?0:j.length,Se=0,Ve=[];++V<ge;){var qt=j[V];G(qt,V,j)&&(Ve[Se++]=qt)}return Ve}function Ds(j,G){var V=j==null?0:j.length;return!!V&&hi(j,G,0)>-1}function ma(j,G,V){for(var ge=-1,Se=j==null?0:j.length;++ge<Se;)if(V(G,j[ge]))return!0;return!1}function ht(j,G){for(var V=-1,ge=j==null?0:j.length,Se=Array(ge);++V<ge;)Se[V]=G(j[V],V,j);return Se}function Sn(j,G){for(var V=-1,ge=G.length,Se=j.length;++V<ge;)j[Se+V]=G[V];return j}function _a(j,G,V,ge){var Se=-1,Ve=j==null?0:j.length;for(ge&&Ve&&(V=j[++Se]);++Se<Ve;)V=G(V,j[Se],Se,j);return V}function Ld(j,G,V,ge){var Se=j==null?0:j.length;for(ge&&Se&&(V=j[--Se]);Se--;)V=G(V,j[Se],Se,j);return V}function wa(j,G){for(var V=-1,ge=j==null?0:j.length;++V<ge;)if(G(j[V],V,j))return!0;return!1}var jd=ba("length");function Dd(j){return j.split("")}function kd(j){return j.match(kt)||[]}function Ru(j,G,V){var ge;return V(j,function(Se,Ve,qt){if(G(Se,Ve,qt))return ge=Ve,!1}),ge}function ks(j,G,V,ge){for(var Se=j.length,Ve=V+(ge?1:-1);ge?Ve--:++Ve<Se;)if(G(j[Ve],Ve,j))return Ve;return-1}function hi(j,G,V){return G===G?Gd(j,G,V):ks(j,Au,V)}function Ud(j,G,V,ge){for(var Se=V-1,Ve=j.length;++Se<Ve;)if(ge(j[Se],G))return Se;return-1}function Au(j){return j!==j}function Lu(j,G){var V=j==null?0:j.length;return V?Ia(j,G)/V:ee}function ba(j){return function(G){return G==null?r:G[j]}}function Ea(j){return function(G){return j==null?r:j[G]}}function ju(j,G,V,ge,Se){return Se(j,function(Ve,qt,rt){V=ge?(ge=!1,Ve):G(V,Ve,qt,rt)}),V}function Md(j,G){var V=j.length;for(j.sort(G);V--;)j[V]=j[V].value;return j}function Ia(j,G){for(var V,ge=-1,Se=j.length;++ge<Se;){var Ve=G(j[ge]);Ve!==r&&(V=V===r?Ve:V+Ve)}return V}function Sa(j,G){for(var V=-1,ge=Array(j);++V<j;)ge[V]=G(V);return ge}function qd(j,G){return ht(G,function(V){return[V,j[V]]})}function Du(j){return j&&j.slice(0,qu(j)+1).replace(Et,"")}function _r(j){return function(G){return j(G)}}function xa(j,G){return ht(G,function(V){return j[V]})}function qi(j,G){return j.has(G)}function ku(j,G){for(var V=-1,ge=j.length;++V<ge&&hi(G,j[V],0)>-1;);return V}function Uu(j,G){for(var V=j.length;V--&&hi(G,j[V],0)>-1;);return V}function $d(j,G){for(var V=j.length,ge=0;V--;)j[V]===G&&++ge;return ge}var zd=Ea(E),Bd=Ea(D);function Kd(j){return"\\"+de[j]}function Vd(j,G){return j==null?r:j[G]}function fi(j){return Ls.test(j)}function Hd(j){return $n.test(j)}function Wd(j){for(var G,V=[];!(G=j.next()).done;)V.push(G.value);return V}function Pa(j){var G=-1,V=Array(j.size);return j.forEach(function(ge,Se){V[++G]=[Se,ge]}),V}function Mu(j,G){return function(V){return j(G(V))}}function xn(j,G){for(var V=-1,ge=j.length,Se=0,Ve=[];++V<ge;){var qt=j[V];(qt===G||qt===v)&&(j[V]=v,Ve[Se++]=V)}return Ve}function Us(j){var G=-1,V=Array(j.size);return j.forEach(function(ge){V[++G]=ge}),V}function Fd(j){var G=-1,V=Array(j.size);return j.forEach(function(ge){V[++G]=[ge,ge]}),V}function Gd(j,G,V){for(var ge=V-1,Se=j.length;++ge<Se;)if(j[ge]===G)return ge;return-1}function Yd(j,G,V){for(var ge=V+1;ge--;)if(j[ge]===G)return ge;return ge}function pi(j){return fi(j)?Qd(j):jd(j)}function qr(j){return fi(j)?Xd(j):Dd(j)}function qu(j){for(var G=j.length;G--&&Pt.test(j.charAt(G)););return G}var Jd=Ea(X);function Qd(j){for(var G=li.lastIndex=0;li.test(j);)++G;return G}function Xd(j){return j.match(li)||[]}function Zd(j){return j.match(As)||[]}var eg=function j(G){G=G==null?Ue:di.defaults(Ue.Object(),G,di.pick(Ue,js));var V=G.Array,ge=G.Date,Se=G.Error,Ve=G.Function,qt=G.Math,rt=G.Object,Oa=G.RegExp,tg=G.String,Nr=G.TypeError,Ms=V.prototype,rg=Ve.prototype,gi=rt.prototype,qs=G["__core-js_shared__"],$s=rg.toString,Fe=gi.hasOwnProperty,ng=0,$u=function(){var e=/[^.]+$/.exec(qs&&qs.keys&&qs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),zs=gi.toString,ig=$s.call(rt),sg=Ue._,og=Oa("^"+$s.call(Fe).replace(bt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=lr?G.Buffer:r,Pn=G.Symbol,Ks=G.Uint8Array,zu=Bs?Bs.allocUnsafe:r,Vs=Mu(rt.getPrototypeOf,rt),Bu=rt.create,Ku=gi.propertyIsEnumerable,Hs=Ms.splice,Vu=Pn?Pn.isConcatSpreadable:r,$i=Pn?Pn.iterator:r,Bn=Pn?Pn.toStringTag:r,Ws=function(){try{var e=Fn(rt,"defineProperty");return e({},"",{}),e}catch{}}(),ag=G.clearTimeout!==Ue.clearTimeout&&G.clearTimeout,cg=ge&&ge.now!==Ue.Date.now&&ge.now,ug=G.setTimeout!==Ue.setTimeout&&G.setTimeout,Fs=qt.ceil,Gs=qt.floor,Ca=rt.getOwnPropertySymbols,lg=Bs?Bs.isBuffer:r,Hu=G.isFinite,hg=Ms.join,fg=Mu(rt.keys,rt),$t=qt.max,Gt=qt.min,pg=ge.now,dg=G.parseInt,Wu=qt.random,gg=Ms.reverse,Na=Fn(G,"DataView"),zi=Fn(G,"Map"),Ta=Fn(G,"Promise"),yi=Fn(G,"Set"),Bi=Fn(G,"WeakMap"),Ki=Fn(rt,"create"),Ys=Bi&&new Bi,vi={},yg=Gn(Na),vg=Gn(zi),mg=Gn(Ta),_g=Gn(yi),wg=Gn(Bi),Js=Pn?Pn.prototype:r,Vi=Js?Js.valueOf:r,Fu=Js?Js.toString:r;function d(e){if(St(e)&&!Pe(e)&&!(e instanceof je)){if(e instanceof Tr)return e;if(Fe.call(e,"__wrapped__"))return Gl(e)}return new Tr(e)}var mi=function(){function e(){}return function(n){if(!gt(n))return{};if(Bu)return Bu(n);e.prototype=n;var a=new e;return e.prototype=r,a}}();function Qs(){}function Tr(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}d.templateSettings={escape:_t,evaluate:wt,interpolate:dt,variable:"",imports:{_:d}},d.prototype=Qs.prototype,d.prototype.constructor=d,Tr.prototype=mi(Qs.prototype),Tr.prototype.constructor=Tr;function je(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function bg(){var e=new je(this.__wrapped__);return e.__actions__=hr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=hr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=hr(this.__views__),e}function Eg(){if(this.__filtered__){var e=new je(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ig(){var e=this.__wrapped__.value(),n=this.__dir__,a=Pe(e),u=n<0,f=a?e.length:0,m=Dy(0,f,this.__views__),x=m.start,N=m.end,k=N-x,Y=u?N:x-1,J=this.__iteratees__,re=J.length,pe=0,ye=Gt(k,this.__takeCount__);if(!a||!u&&f==k&&ye==k)return vl(e,this.__actions__);var be=[];e:for(;k--&&pe<ye;){Y+=n;for(var Re=-1,Ee=e[Y];++Re<re;){var Le=J[Re],Me=Le.iteratee,Er=Le.type,tr=Me(Ee);if(Er==T)Ee=tr;else if(!tr){if(Er==_)continue e;break e}}be[pe++]=Ee}return be}je.prototype=mi(Qs.prototype),je.prototype.constructor=je;function Kn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function Sg(){this.__data__=Ki?Ki(null):{},this.size=0}function xg(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}function Pg(e){var n=this.__data__;if(Ki){var a=n[e];return a===y?r:a}return Fe.call(n,e)?n[e]:r}function Og(e){var n=this.__data__;return Ki?n[e]!==r:Fe.call(n,e)}function Cg(e,n){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Ki&&n===r?y:n,this}Kn.prototype.clear=Sg,Kn.prototype.delete=xg,Kn.prototype.get=Pg,Kn.prototype.has=Og,Kn.prototype.set=Cg;function nn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function Ng(){this.__data__=[],this.size=0}function Tg(e){var n=this.__data__,a=Xs(n,e);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():Hs.call(n,a,1),--this.size,!0}function Rg(e){var n=this.__data__,a=Xs(n,e);return a<0?r:n[a][1]}function Ag(e){return Xs(this.__data__,e)>-1}function Lg(e,n){var a=this.__data__,u=Xs(a,e);return u<0?(++this.size,a.push([e,n])):a[u][1]=n,this}nn.prototype.clear=Ng,nn.prototype.delete=Tg,nn.prototype.get=Rg,nn.prototype.has=Ag,nn.prototype.set=Lg;function sn(e){var n=-1,a=e==null?0:e.length;for(this.clear();++n<a;){var u=e[n];this.set(u[0],u[1])}}function jg(){this.size=0,this.__data__={hash:new Kn,map:new(zi||nn),string:new Kn}}function Dg(e){var n=lo(this,e).delete(e);return this.size-=n?1:0,n}function kg(e){return lo(this,e).get(e)}function Ug(e){return lo(this,e).has(e)}function Mg(e,n){var a=lo(this,e),u=a.size;return a.set(e,n),this.size+=a.size==u?0:1,this}sn.prototype.clear=jg,sn.prototype.delete=Dg,sn.prototype.get=kg,sn.prototype.has=Ug,sn.prototype.set=Mg;function Vn(e){var n=-1,a=e==null?0:e.length;for(this.__data__=new sn;++n<a;)this.add(e[n])}function qg(e){return this.__data__.set(e,y),this}function $g(e){return this.__data__.has(e)}Vn.prototype.add=Vn.prototype.push=qg,Vn.prototype.has=$g;function $r(e){var n=this.__data__=new nn(e);this.size=n.size}function zg(){this.__data__=new nn,this.size=0}function Bg(e){var n=this.__data__,a=n.delete(e);return this.size=n.size,a}function Kg(e){return this.__data__.get(e)}function Vg(e){return this.__data__.has(e)}function Hg(e,n){var a=this.__data__;if(a instanceof nn){var u=a.__data__;if(!zi||u.length<o-1)return u.push([e,n]),this.size=++a.size,this;a=this.__data__=new sn(u)}return a.set(e,n),this.size=a.size,this}$r.prototype.clear=zg,$r.prototype.delete=Bg,$r.prototype.get=Kg,$r.prototype.has=Vg,$r.prototype.set=Hg;function Gu(e,n){var a=Pe(e),u=!a&&Yn(e),f=!a&&!u&&Rn(e),m=!a&&!u&&!f&&Ei(e),x=a||u||f||m,N=x?Sa(e.length,tg):[],k=N.length;for(var Y in e)(n||Fe.call(e,Y))&&!(x&&(Y=="length"||f&&(Y=="offset"||Y=="parent")||m&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||un(Y,k)))&&N.push(Y);return N}function Yu(e){var n=e.length;return n?e[za(0,n-1)]:r}function Wg(e,n){return ho(hr(e),Hn(n,0,e.length))}function Fg(e){return ho(hr(e))}function Ra(e,n,a){(a!==r&&!zr(e[n],a)||a===r&&!(n in e))&&on(e,n,a)}function Hi(e,n,a){var u=e[n];(!(Fe.call(e,n)&&zr(u,a))||a===r&&!(n in e))&&on(e,n,a)}function Xs(e,n){for(var a=e.length;a--;)if(zr(e[a][0],n))return a;return-1}function Gg(e,n,a,u){return On(e,function(f,m,x){n(u,f,a(f),x)}),u}function Ju(e,n){return e&&Jr(n,Bt(n),e)}function Yg(e,n){return e&&Jr(n,pr(n),e)}function on(e,n,a){n=="__proto__"&&Ws?Ws(e,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[n]=a}function Aa(e,n){for(var a=-1,u=n.length,f=V(u),m=e==null;++a<u;)f[a]=m?r:fc(e,n[a]);return f}function Hn(e,n,a){return e===e&&(a!==r&&(e=e<=a?e:a),n!==r&&(e=e>=n?e:n)),e}function Rr(e,n,a,u,f,m){var x,N=n&b,k=n&P,Y=n&R;if(a&&(x=f?a(e,u,f,m):a(e)),x!==r)return x;if(!gt(e))return e;var J=Pe(e);if(J){if(x=Uy(e),!N)return hr(e,x)}else{var re=Yt(e),pe=re==z||re==te;if(Rn(e))return wl(e,N);if(re==Ne||re==xe||pe&&!f){if(x=k||pe?{}:ql(e),!N)return k?Py(e,Yg(x,e)):xy(e,Ju(x,e))}else{if(!Ye[re])return f?e:{};x=My(e,re,N)}}m||(m=new $r);var ye=m.get(e);if(ye)return ye;m.set(e,x),dh(e)?e.forEach(function(Ee){x.add(Rr(Ee,n,a,Ee,e,m))}):fh(e)&&e.forEach(function(Ee,Le){x.set(Le,Rr(Ee,n,a,Le,e,m))});var be=Y?k?Xa:Qa:k?pr:Bt,Re=J?r:be(e);return Cr(Re||e,function(Ee,Le){Re&&(Le=Ee,Ee=e[Le]),Hi(x,Le,Rr(Ee,n,a,Le,e,m))}),x}function Jg(e){var n=Bt(e);return function(a){return Qu(a,e,n)}}function Qu(e,n,a){var u=a.length;if(e==null)return!u;for(e=rt(e);u--;){var f=a[u],m=n[f],x=e[f];if(x===r&&!(f in e)||!m(x))return!1}return!0}function Xu(e,n,a){if(typeof e!="function")throw new Nr(h);return Xi(function(){e.apply(r,a)},n)}function Wi(e,n,a,u){var f=-1,m=Ds,x=!0,N=e.length,k=[],Y=n.length;if(!N)return k;a&&(n=ht(n,_r(a))),u?(m=ma,x=!1):n.length>=o&&(m=qi,x=!1,n=new Vn(n));e:for(;++f<N;){var J=e[f],re=a==null?J:a(J);if(J=u||J!==0?J:0,x&&re===re){for(var pe=Y;pe--;)if(n[pe]===re)continue e;k.push(J)}else m(n,re,u)||k.push(J)}return k}var On=xl(Yr),Zu=xl(ja,!0);function Qg(e,n){var a=!0;return On(e,function(u,f,m){return a=!!n(u,f,m),a}),a}function Zs(e,n,a){for(var u=-1,f=e.length;++u<f;){var m=e[u],x=n(m);if(x!=null&&(N===r?x===x&&!br(x):a(x,N)))var N=x,k=m}return k}function Xg(e,n,a,u){var f=e.length;for(a=Te(a),a<0&&(a=-a>f?0:f+a),u=u===r||u>f?f:Te(u),u<0&&(u+=f),u=a>u?0:yh(u);a<u;)e[a++]=n;return e}function el(e,n){var a=[];return On(e,function(u,f,m){n(u,f,m)&&a.push(u)}),a}function Wt(e,n,a,u,f){var m=-1,x=e.length;for(a||(a=$y),f||(f=[]);++m<x;){var N=e[m];n>0&&a(N)?n>1?Wt(N,n-1,a,u,f):Sn(f,N):u||(f[f.length]=N)}return f}var La=Pl(),tl=Pl(!0);function Yr(e,n){return e&&La(e,n,Bt)}function ja(e,n){return e&&tl(e,n,Bt)}function eo(e,n){return In(n,function(a){return ln(e[a])})}function Wn(e,n){n=Nn(n,e);for(var a=0,u=n.length;e!=null&&a<u;)e=e[Qr(n[a++])];return a&&a==u?e:r}function rl(e,n,a){var u=n(e);return Pe(e)?u:Sn(u,a(e))}function Zt(e){return e==null?e===r?We:_e:Bn&&Bn in rt(e)?jy(e):Fy(e)}function Da(e,n){return e>n}function Zg(e,n){return e!=null&&Fe.call(e,n)}function ey(e,n){return e!=null&&n in rt(e)}function ty(e,n,a){return e>=Gt(n,a)&&e<$t(n,a)}function ka(e,n,a){for(var u=a?ma:Ds,f=e[0].length,m=e.length,x=m,N=V(m),k=1/0,Y=[];x--;){var J=e[x];x&&n&&(J=ht(J,_r(n))),k=Gt(J.length,k),N[x]=!a&&(n||f>=120&&J.length>=120)?new Vn(x&&J):r}J=e[0];var re=-1,pe=N[0];e:for(;++re<f&&Y.length<k;){var ye=J[re],be=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(pe?qi(pe,be):u(Y,be,a))){for(x=m;--x;){var Re=N[x];if(!(Re?qi(Re,be):u(e[x],be,a)))continue e}pe&&pe.push(be),Y.push(ye)}}return Y}function ry(e,n,a,u){return Yr(e,function(f,m,x){n(u,a(f),m,x)}),u}function Fi(e,n,a){n=Nn(n,e),e=Kl(e,n);var u=e==null?e:e[Qr(Lr(n))];return u==null?r:zt(u,e,a)}function nl(e){return St(e)&&Zt(e)==xe}function ny(e){return St(e)&&Zt(e)==Ie}function iy(e){return St(e)&&Zt(e)==U}function Gi(e,n,a,u,f){return e===n?!0:e==null||n==null||!St(e)&&!St(n)?e!==e&&n!==n:sy(e,n,a,u,Gi,f)}function sy(e,n,a,u,f,m){var x=Pe(e),N=Pe(n),k=x?nt:Yt(e),Y=N?nt:Yt(n);k=k==xe?Ne:k,Y=Y==xe?Ne:Y;var J=k==Ne,re=Y==Ne,pe=k==Y;if(pe&&Rn(e)){if(!Rn(n))return!1;x=!0,J=!1}if(pe&&!J)return m||(m=new $r),x||Ei(e)?kl(e,n,a,u,f,m):Ay(e,n,k,a,u,f,m);if(!(a&O)){var ye=J&&Fe.call(e,"__wrapped__"),be=re&&Fe.call(n,"__wrapped__");if(ye||be){var Re=ye?e.value():e,Ee=be?n.value():n;return m||(m=new $r),f(Re,Ee,a,u,m)}}return pe?(m||(m=new $r),Ly(e,n,a,u,f,m)):!1}function oy(e){return St(e)&&Yt(e)==oe}function Ua(e,n,a,u){var f=a.length,m=f,x=!u;if(e==null)return!m;for(e=rt(e);f--;){var N=a[f];if(x&&N[2]?N[1]!==e[N[0]]:!(N[0]in e))return!1}for(;++f<m;){N=a[f];var k=N[0],Y=e[k],J=N[1];if(x&&N[2]){if(Y===r&&!(k in e))return!1}else{var re=new $r;if(u)var pe=u(Y,J,k,e,n,re);if(!(pe===r?Gi(J,Y,O|L,u,re):pe))return!1}}return!0}function il(e){if(!gt(e)||By(e))return!1;var n=ln(e)?og:ra;return n.test(Gn(e))}function ay(e){return St(e)&&Zt(e)==it}function cy(e){return St(e)&&Yt(e)==$e}function uy(e){return St(e)&&mo(e.length)&&!!Ze[Zt(e)]}function sl(e){return typeof e=="function"?e:e==null?dr:typeof e=="object"?Pe(e)?cl(e[0],e[1]):al(e):Oh(e)}function Ma(e){if(!Qi(e))return fg(e);var n=[];for(var a in rt(e))Fe.call(e,a)&&a!="constructor"&&n.push(a);return n}function ly(e){if(!gt(e))return Wy(e);var n=Qi(e),a=[];for(var u in e)u=="constructor"&&(n||!Fe.call(e,u))||a.push(u);return a}function qa(e,n){return e<n}function ol(e,n){var a=-1,u=fr(e)?V(e.length):[];return On(e,function(f,m,x){u[++a]=n(f,m,x)}),u}function al(e){var n=ec(e);return n.length==1&&n[0][2]?zl(n[0][0],n[0][1]):function(a){return a===e||Ua(a,e,n)}}function cl(e,n){return rc(e)&&$l(n)?zl(Qr(e),n):function(a){var u=fc(a,e);return u===r&&u===n?pc(a,e):Gi(n,u,O|L)}}function to(e,n,a,u,f){e!==n&&La(n,function(m,x){if(f||(f=new $r),gt(m))hy(e,n,x,a,to,u,f);else{var N=u?u(ic(e,x),m,x+"",e,n,f):r;N===r&&(N=m),Ra(e,x,N)}},pr)}function hy(e,n,a,u,f,m,x){var N=ic(e,a),k=ic(n,a),Y=x.get(k);if(Y){Ra(e,a,Y);return}var J=m?m(N,k,a+"",e,n,x):r,re=J===r;if(re){var pe=Pe(k),ye=!pe&&Rn(k),be=!pe&&!ye&&Ei(k);J=k,pe||ye||be?Pe(N)?J=N:Ct(N)?J=hr(N):ye?(re=!1,J=wl(k,!0)):be?(re=!1,J=bl(k,!0)):J=[]:Zi(k)||Yn(k)?(J=N,Yn(N)?J=vh(N):(!gt(N)||ln(N))&&(J=ql(k))):re=!1}re&&(x.set(k,J),f(J,k,u,m,x),x.delete(k)),Ra(e,a,J)}function ul(e,n){var a=e.length;if(a)return n+=n<0?a:0,un(n,a)?e[n]:r}function ll(e,n,a){n.length?n=ht(n,function(m){return Pe(m)?function(x){return Wn(x,m.length===1?m[0]:m)}:m}):n=[dr];var u=-1;n=ht(n,_r(we()));var f=ol(e,function(m,x,N){var k=ht(n,function(Y){return Y(m)});return{criteria:k,index:++u,value:m}});return Md(f,function(m,x){return Sy(m,x,a)})}function fy(e,n){return hl(e,n,function(a,u){return pc(e,u)})}function hl(e,n,a){for(var u=-1,f=n.length,m={};++u<f;){var x=n[u],N=Wn(e,x);a(N,x)&&Yi(m,Nn(x,e),N)}return m}function py(e){return function(n){return Wn(n,e)}}function $a(e,n,a,u){var f=u?Ud:hi,m=-1,x=n.length,N=e;for(e===n&&(n=hr(n)),a&&(N=ht(e,_r(a)));++m<x;)for(var k=0,Y=n[m],J=a?a(Y):Y;(k=f(N,J,k,u))>-1;)N!==e&&Hs.call(N,k,1),Hs.call(e,k,1);return e}function fl(e,n){for(var a=e?n.length:0,u=a-1;a--;){var f=n[a];if(a==u||f!==m){var m=f;un(f)?Hs.call(e,f,1):Va(e,f)}}return e}function za(e,n){return e+Gs(Wu()*(n-e+1))}function dy(e,n,a,u){for(var f=-1,m=$t(Fs((n-e)/(a||1)),0),x=V(m);m--;)x[u?m:++f]=e,e+=a;return x}function Ba(e,n){var a="";if(!e||n<1||n>ne)return a;do n%2&&(a+=e),n=Gs(n/2),n&&(e+=e);while(n);return a}function Ae(e,n){return sc(Bl(e,n,dr),e+"")}function gy(e){return Yu(Ii(e))}function yy(e,n){var a=Ii(e);return ho(a,Hn(n,0,a.length))}function Yi(e,n,a,u){if(!gt(e))return e;n=Nn(n,e);for(var f=-1,m=n.length,x=m-1,N=e;N!=null&&++f<m;){var k=Qr(n[f]),Y=a;if(k==="__proto__"||k==="constructor"||k==="prototype")return e;if(f!=x){var J=N[k];Y=u?u(J,k,N):r,Y===r&&(Y=gt(J)?J:un(n[f+1])?[]:{})}Hi(N,k,Y),N=N[k]}return e}var pl=Ys?function(e,n){return Ys.set(e,n),e}:dr,vy=Ws?function(e,n){return Ws(e,"toString",{configurable:!0,enumerable:!1,value:gc(n),writable:!0})}:dr;function my(e){return ho(Ii(e))}function Ar(e,n,a){var u=-1,f=e.length;n<0&&(n=-n>f?0:f+n),a=a>f?f:a,a<0&&(a+=f),f=n>a?0:a-n>>>0,n>>>=0;for(var m=V(f);++u<f;)m[u]=e[u+n];return m}function _y(e,n){var a;return On(e,function(u,f,m){return a=n(u,f,m),!a}),!!a}function ro(e,n,a){var u=0,f=e==null?u:e.length;if(typeof n=="number"&&n===n&&f<=Be){for(;u<f;){var m=u+f>>>1,x=e[m];x!==null&&!br(x)&&(a?x<=n:x<n)?u=m+1:f=m}return f}return Ka(e,n,dr,a)}function Ka(e,n,a,u){var f=0,m=e==null?0:e.length;if(m===0)return 0;n=a(n);for(var x=n!==n,N=n===null,k=br(n),Y=n===r;f<m;){var J=Gs((f+m)/2),re=a(e[J]),pe=re!==r,ye=re===null,be=re===re,Re=br(re);if(x)var Ee=u||be;else Y?Ee=be&&(u||pe):N?Ee=be&&pe&&(u||!ye):k?Ee=be&&pe&&!ye&&(u||!Re):ye||Re?Ee=!1:Ee=u?re<=n:re<n;Ee?f=J+1:m=J}return Gt(m,ze)}function dl(e,n){for(var a=-1,u=e.length,f=0,m=[];++a<u;){var x=e[a],N=n?n(x):x;if(!a||!zr(N,k)){var k=N;m[f++]=x===0?0:x}}return m}function gl(e){return typeof e=="number"?e:br(e)?ee:+e}function wr(e){if(typeof e=="string")return e;if(Pe(e))return ht(e,wr)+"";if(br(e))return Fu?Fu.call(e):"";var n=e+"";return n=="0"&&1/e==-le?"-0":n}function Cn(e,n,a){var u=-1,f=Ds,m=e.length,x=!0,N=[],k=N;if(a)x=!1,f=ma;else if(m>=o){var Y=n?null:Ty(e);if(Y)return Us(Y);x=!1,f=qi,k=new Vn}else k=n?[]:N;e:for(;++u<m;){var J=e[u],re=n?n(J):J;if(J=a||J!==0?J:0,x&&re===re){for(var pe=k.length;pe--;)if(k[pe]===re)continue e;n&&k.push(re),N.push(J)}else f(k,re,a)||(k!==N&&k.push(re),N.push(J))}return N}function Va(e,n){return n=Nn(n,e),e=Kl(e,n),e==null||delete e[Qr(Lr(n))]}function yl(e,n,a,u){return Yi(e,n,a(Wn(e,n)),u)}function no(e,n,a,u){for(var f=e.length,m=u?f:-1;(u?m--:++m<f)&&n(e[m],m,e););return a?Ar(e,u?0:m,u?m+1:f):Ar(e,u?m+1:0,u?f:m)}function vl(e,n){var a=e;return a instanceof je&&(a=a.value()),_a(n,function(u,f){return f.func.apply(f.thisArg,Sn([u],f.args))},a)}function Ha(e,n,a){var u=e.length;if(u<2)return u?Cn(e[0]):[];for(var f=-1,m=V(u);++f<u;)for(var x=e[f],N=-1;++N<u;)N!=f&&(m[f]=Wi(m[f]||x,e[N],n,a));return Cn(Wt(m,1),n,a)}function ml(e,n,a){for(var u=-1,f=e.length,m=n.length,x={};++u<f;){var N=u<m?n[u]:r;a(x,e[u],N)}return x}function Wa(e){return Ct(e)?e:[]}function Fa(e){return typeof e=="function"?e:dr}function Nn(e,n){return Pe(e)?e:rc(e,n)?[e]:Fl(He(e))}var wy=Ae;function Tn(e,n,a){var u=e.length;return a=a===r?u:a,!n&&a>=u?e:Ar(e,n,a)}var _l=ag||function(e){return Ue.clearTimeout(e)};function wl(e,n){if(n)return e.slice();var a=e.length,u=zu?zu(a):new e.constructor(a);return e.copy(u),u}function Ga(e){var n=new e.constructor(e.byteLength);return new Ks(n).set(new Ks(e)),n}function by(e,n){var a=n?Ga(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function Ey(e){var n=new e.constructor(e.source,Pr.exec(e));return n.lastIndex=e.lastIndex,n}function Iy(e){return Vi?rt(Vi.call(e)):{}}function bl(e,n){var a=n?Ga(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function El(e,n){if(e!==n){var a=e!==r,u=e===null,f=e===e,m=br(e),x=n!==r,N=n===null,k=n===n,Y=br(n);if(!N&&!Y&&!m&&e>n||m&&x&&k&&!N&&!Y||u&&x&&k||!a&&k||!f)return 1;if(!u&&!m&&!Y&&e<n||Y&&a&&f&&!u&&!m||N&&a&&f||!x&&f||!k)return-1}return 0}function Sy(e,n,a){for(var u=-1,f=e.criteria,m=n.criteria,x=f.length,N=a.length;++u<x;){var k=El(f[u],m[u]);if(k){if(u>=N)return k;var Y=a[u];return k*(Y=="desc"?-1:1)}}return e.index-n.index}function Il(e,n,a,u){for(var f=-1,m=e.length,x=a.length,N=-1,k=n.length,Y=$t(m-x,0),J=V(k+Y),re=!u;++N<k;)J[N]=n[N];for(;++f<x;)(re||f<m)&&(J[a[f]]=e[f]);for(;Y--;)J[N++]=e[f++];return J}function Sl(e,n,a,u){for(var f=-1,m=e.length,x=-1,N=a.length,k=-1,Y=n.length,J=$t(m-N,0),re=V(J+Y),pe=!u;++f<J;)re[f]=e[f];for(var ye=f;++k<Y;)re[ye+k]=n[k];for(;++x<N;)(pe||f<m)&&(re[ye+a[x]]=e[f++]);return re}function hr(e,n){var a=-1,u=e.length;for(n||(n=V(u));++a<u;)n[a]=e[a];return n}function Jr(e,n,a,u){var f=!a;a||(a={});for(var m=-1,x=n.length;++m<x;){var N=n[m],k=u?u(a[N],e[N],N,a,e):r;k===r&&(k=e[N]),f?on(a,N,k):Hi(a,N,k)}return a}function xy(e,n){return Jr(e,tc(e),n)}function Py(e,n){return Jr(e,Ul(e),n)}function io(e,n){return function(a,u){var f=Pe(a)?Rd:Gg,m=n?n():{};return f(a,e,we(u,2),m)}}function _i(e){return Ae(function(n,a){var u=-1,f=a.length,m=f>1?a[f-1]:r,x=f>2?a[2]:r;for(m=e.length>3&&typeof m=="function"?(f--,m):r,x&&er(a[0],a[1],x)&&(m=f<3?r:m,f=1),n=rt(n);++u<f;){var N=a[u];N&&e(n,N,u,m)}return n})}function xl(e,n){return function(a,u){if(a==null)return a;if(!fr(a))return e(a,u);for(var f=a.length,m=n?f:-1,x=rt(a);(n?m--:++m<f)&&u(x[m],m,x)!==!1;);return a}}function Pl(e){return function(n,a,u){for(var f=-1,m=rt(n),x=u(n),N=x.length;N--;){var k=x[e?N:++f];if(a(m[k],k,m)===!1)break}return n}}function Oy(e,n,a){var u=n&K,f=Ji(e);function m(){var x=this&&this!==Ue&&this instanceof m?f:e;return x.apply(u?a:this,arguments)}return m}function Ol(e){return function(n){n=He(n);var a=fi(n)?qr(n):r,u=a?a[0]:n.charAt(0),f=a?Tn(a,1).join(""):n.slice(1);return u[e]()+f}}function wi(e){return function(n){return _a(xh(Sh(n).replace(Ui,"")),e,"")}}function Ji(e){return function(){var n=arguments;switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3]);case 5:return new e(n[0],n[1],n[2],n[3],n[4]);case 6:return new e(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=mi(e.prototype),u=e.apply(a,n);return gt(u)?u:a}}function Cy(e,n,a){var u=Ji(e);function f(){for(var m=arguments.length,x=V(m),N=m,k=bi(f);N--;)x[N]=arguments[N];var Y=m<3&&x[0]!==k&&x[m-1]!==k?[]:xn(x,k);if(m-=Y.length,m<a)return Al(e,n,so,f.placeholder,r,x,Y,r,r,a-m);var J=this&&this!==Ue&&this instanceof f?u:e;return zt(J,this,x)}return f}function Cl(e){return function(n,a,u){var f=rt(n);if(!fr(n)){var m=we(a,3);n=Bt(n),a=function(N){return m(f[N],N,f)}}var x=e(n,a,u);return x>-1?f[m?n[x]:x]:r}}function Nl(e){return cn(function(n){var a=n.length,u=a,f=Tr.prototype.thru;for(e&&n.reverse();u--;){var m=n[u];if(typeof m!="function")throw new Nr(h);if(f&&!x&&uo(m)=="wrapper")var x=new Tr([],!0)}for(u=x?u:a;++u<a;){m=n[u];var N=uo(m),k=N=="wrapper"?Za(m):r;k&&nc(k[0])&&k[1]==(A|B|C|M)&&!k[4].length&&k[9]==1?x=x[uo(k[0])].apply(x,k[3]):x=m.length==1&&nc(m)?x[N]():x.thru(m)}return function(){var Y=arguments,J=Y[0];if(x&&Y.length==1&&Pe(J))return x.plant(J).value();for(var re=0,pe=a?n[re].apply(this,Y):J;++re<a;)pe=n[re].call(this,pe);return pe}})}function so(e,n,a,u,f,m,x,N,k,Y){var J=n&A,re=n&K,pe=n&q,ye=n&(B|S),be=n&ae,Re=pe?r:Ji(e);function Ee(){for(var Le=arguments.length,Me=V(Le),Er=Le;Er--;)Me[Er]=arguments[Er];if(ye)var tr=bi(Ee),Ir=$d(Me,tr);if(u&&(Me=Il(Me,u,f,ye)),m&&(Me=Sl(Me,m,x,ye)),Le-=Ir,ye&&Le<Y){var Nt=xn(Me,tr);return Al(e,n,so,Ee.placeholder,a,Me,Nt,N,k,Y-Le)}var Br=re?a:this,fn=pe?Br[e]:e;return Le=Me.length,N?Me=Gy(Me,N):be&&Le>1&&Me.reverse(),J&&k<Le&&(Me.length=k),this&&this!==Ue&&this instanceof Ee&&(fn=Re||Ji(fn)),fn.apply(Br,Me)}return Ee}function Tl(e,n){return function(a,u){return ry(a,e,n(u),{})}}function oo(e,n){return function(a,u){var f;if(a===r&&u===r)return n;if(a!==r&&(f=a),u!==r){if(f===r)return u;typeof a=="string"||typeof u=="string"?(a=wr(a),u=wr(u)):(a=gl(a),u=gl(u)),f=e(a,u)}return f}}function Ya(e){return cn(function(n){return n=ht(n,_r(we())),Ae(function(a){var u=this;return e(n,function(f){return zt(f,u,a)})})})}function ao(e,n){n=n===r?" ":wr(n);var a=n.length;if(a<2)return a?Ba(n,e):n;var u=Ba(n,Fs(e/pi(n)));return fi(n)?Tn(qr(u),0,e).join(""):u.slice(0,e)}function Ny(e,n,a,u){var f=n&K,m=Ji(e);function x(){for(var N=-1,k=arguments.length,Y=-1,J=u.length,re=V(J+k),pe=this&&this!==Ue&&this instanceof x?m:e;++Y<J;)re[Y]=u[Y];for(;k--;)re[Y++]=arguments[++N];return zt(pe,f?a:this,re)}return x}function Rl(e){return function(n,a,u){return u&&typeof u!="number"&&er(n,a,u)&&(a=u=r),n=hn(n),a===r?(a=n,n=0):a=hn(a),u=u===r?n<a?1:-1:hn(u),dy(n,a,u,e)}}function co(e){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=jr(n),a=jr(a)),e(n,a)}}function Al(e,n,a,u,f,m,x,N,k,Y){var J=n&B,re=J?x:r,pe=J?r:x,ye=J?m:r,be=J?r:m;n|=J?C:I,n&=~(J?I:C),n&$||(n&=~(K|q));var Re=[e,n,f,ye,re,be,pe,N,k,Y],Ee=a.apply(r,Re);return nc(e)&&Vl(Ee,Re),Ee.placeholder=u,Hl(Ee,e,n)}function Ja(e){var n=qt[e];return function(a,u){if(a=jr(a),u=u==null?0:Gt(Te(u),292),u&&Hu(a)){var f=(He(a)+"e").split("e"),m=n(f[0]+"e"+(+f[1]+u));return f=(He(m)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return n(a)}}var Ty=yi&&1/Us(new yi([,-0]))[1]==le?function(e){return new yi(e)}:mc;function Ll(e){return function(n){var a=Yt(n);return a==oe?Pa(n):a==$e?Fd(n):qd(n,e(n))}}function an(e,n,a,u,f,m,x,N){var k=n&q;if(!k&&typeof e!="function")throw new Nr(h);var Y=u?u.length:0;if(Y||(n&=~(C|I),u=f=r),x=x===r?x:$t(Te(x),0),N=N===r?N:Te(N),Y-=f?f.length:0,n&I){var J=u,re=f;u=f=r}var pe=k?r:Za(e),ye=[e,n,a,u,f,J,re,m,x,N];if(pe&&Hy(ye,pe),e=ye[0],n=ye[1],a=ye[2],u=ye[3],f=ye[4],N=ye[9]=ye[9]===r?k?0:e.length:$t(ye[9]-Y,0),!N&&n&(B|S)&&(n&=~(B|S)),!n||n==K)var be=Oy(e,n,a);else n==B||n==S?be=Cy(e,n,N):(n==C||n==(K|C))&&!f.length?be=Ny(e,n,a,u):be=so.apply(r,ye);var Re=pe?pl:Vl;return Hl(Re(be,ye),e,n)}function jl(e,n,a,u){return e===r||zr(e,gi[a])&&!Fe.call(u,a)?n:e}function Dl(e,n,a,u,f,m){return gt(e)&&gt(n)&&(m.set(n,e),to(e,n,r,Dl,m),m.delete(n)),e}function Ry(e){return Zi(e)?r:e}function kl(e,n,a,u,f,m){var x=a&O,N=e.length,k=n.length;if(N!=k&&!(x&&k>N))return!1;var Y=m.get(e),J=m.get(n);if(Y&&J)return Y==n&&J==e;var re=-1,pe=!0,ye=a&L?new Vn:r;for(m.set(e,n),m.set(n,e);++re<N;){var be=e[re],Re=n[re];if(u)var Ee=x?u(Re,be,re,n,e,m):u(be,Re,re,e,n,m);if(Ee!==r){if(Ee)continue;pe=!1;break}if(ye){if(!wa(n,function(Le,Me){if(!qi(ye,Me)&&(be===Le||f(be,Le,a,u,m)))return ye.push(Me)})){pe=!1;break}}else if(!(be===Re||f(be,Re,a,u,m))){pe=!1;break}}return m.delete(e),m.delete(n),pe}function Ay(e,n,a,u,f,m,x){switch(a){case qe:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case Ie:return!(e.byteLength!=n.byteLength||!m(new Ks(e),new Ks(n)));case H:case U:case ie:return zr(+e,+n);case w:return e.name==n.name&&e.message==n.message;case it:case Qe:return e==n+"";case oe:var N=Pa;case $e:var k=u&O;if(N||(N=Us),e.size!=n.size&&!k)return!1;var Y=x.get(e);if(Y)return Y==n;u|=L,x.set(e,n);var J=kl(N(e),N(n),u,f,m,x);return x.delete(e),J;case Ke:if(Vi)return Vi.call(e)==Vi.call(n)}return!1}function Ly(e,n,a,u,f,m){var x=a&O,N=Qa(e),k=N.length,Y=Qa(n),J=Y.length;if(k!=J&&!x)return!1;for(var re=k;re--;){var pe=N[re];if(!(x?pe in n:Fe.call(n,pe)))return!1}var ye=m.get(e),be=m.get(n);if(ye&&be)return ye==n&&be==e;var Re=!0;m.set(e,n),m.set(n,e);for(var Ee=x;++re<k;){pe=N[re];var Le=e[pe],Me=n[pe];if(u)var Er=x?u(Me,Le,pe,n,e,m):u(Le,Me,pe,e,n,m);if(!(Er===r?Le===Me||f(Le,Me,a,u,m):Er)){Re=!1;break}Ee||(Ee=pe=="constructor")}if(Re&&!Ee){var tr=e.constructor,Ir=n.constructor;tr!=Ir&&"constructor"in e&&"constructor"in n&&!(typeof tr=="function"&&tr instanceof tr&&typeof Ir=="function"&&Ir instanceof Ir)&&(Re=!1)}return m.delete(e),m.delete(n),Re}function cn(e){return sc(Bl(e,r,Ql),e+"")}function Qa(e){return rl(e,Bt,tc)}function Xa(e){return rl(e,pr,Ul)}var Za=Ys?function(e){return Ys.get(e)}:mc;function uo(e){for(var n=e.name+"",a=vi[n],u=Fe.call(vi,n)?a.length:0;u--;){var f=a[u],m=f.func;if(m==null||m==e)return f.name}return n}function bi(e){var n=Fe.call(d,"placeholder")?d:e;return n.placeholder}function we(){var e=d.iteratee||yc;return e=e===yc?sl:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,n){var a=e.__data__;return zy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ec(e){for(var n=Bt(e),a=n.length;a--;){var u=n[a],f=e[u];n[a]=[u,f,$l(f)]}return n}function Fn(e,n){var a=Vd(e,n);return il(a)?a:r}function jy(e){var n=Fe.call(e,Bn),a=e[Bn];try{e[Bn]=r;var u=!0}catch{}var f=zs.call(e);return u&&(n?e[Bn]=a:delete e[Bn]),f}var tc=Ca?function(e){return e==null?[]:(e=rt(e),In(Ca(e),function(n){return Ku.call(e,n)}))}:_c,Ul=Ca?function(e){for(var n=[];e;)Sn(n,tc(e)),e=Vs(e);return n}:_c,Yt=Zt;(Na&&Yt(new Na(new ArrayBuffer(1)))!=qe||zi&&Yt(new zi)!=oe||Ta&&Yt(Ta.resolve())!=ct||yi&&Yt(new yi)!=$e||Bi&&Yt(new Bi)!=Oe)&&(Yt=function(e){var n=Zt(e),a=n==Ne?e.constructor:r,u=a?Gn(a):"";if(u)switch(u){case yg:return qe;case vg:return oe;case mg:return ct;case _g:return $e;case wg:return Oe}return n});function Dy(e,n,a){for(var u=-1,f=a.length;++u<f;){var m=a[u],x=m.size;switch(m.type){case"drop":e+=x;break;case"dropRight":n-=x;break;case"take":n=Gt(n,e+x);break;case"takeRight":e=$t(e,n-x);break}}return{start:e,end:n}}function ky(e){var n=e.match(st);return n?n[1].split(Dt):[]}function Ml(e,n,a){n=Nn(n,e);for(var u=-1,f=n.length,m=!1;++u<f;){var x=Qr(n[u]);if(!(m=e!=null&&a(e,x)))break;e=e[x]}return m||++u!=f?m:(f=e==null?0:e.length,!!f&&mo(f)&&un(x,f)&&(Pe(e)||Yn(e)))}function Uy(e){var n=e.length,a=new e.constructor(n);return n&&typeof e[0]=="string"&&Fe.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function ql(e){return typeof e.constructor=="function"&&!Qi(e)?mi(Vs(e)):{}}function My(e,n,a){var u=e.constructor;switch(n){case Ie:return Ga(e);case H:case U:return new u(+e);case qe:return by(e,a);case Xe:case ke:case Ge:case yt:case xt:case Rt:case vt:case Ht:case ur:return bl(e,a);case oe:return new u;case ie:case Qe:return new u(e);case it:return Ey(e);case $e:return new u;case Ke:return Iy(e)}}function qy(e,n){var a=n.length;if(!a)return e;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),e.replace(It,`{
/* [wrapped with `+n+`] */
`)}function $y(e){return Pe(e)||Yn(e)||!!(Vu&&e&&e[Vu])}function un(e,n){var a=typeof e;return n=n??ne,!!n&&(a=="number"||a!="symbol"&&ia.test(e))&&e>-1&&e%1==0&&e<n}function er(e,n,a){if(!gt(a))return!1;var u=typeof n;return(u=="number"?fr(a)&&un(n,a.length):u=="string"&&n in a)?zr(a[n],e):!1}function rc(e,n){if(Pe(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||br(e)?!0:At.test(e)||!lt.test(e)||n!=null&&e in rt(n)}function zy(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function nc(e){var n=uo(e),a=d[n];if(typeof a!="function"||!(n in je.prototype))return!1;if(e===a)return!0;var u=Za(a);return!!u&&e===u[0]}function By(e){return!!$u&&$u in e}var Ky=qs?ln:wc;function Qi(e){var n=e&&e.constructor,a=typeof n=="function"&&n.prototype||gi;return e===a}function $l(e){return e===e&&!gt(e)}function zl(e,n){return function(a){return a==null?!1:a[e]===n&&(n!==r||e in rt(a))}}function Vy(e){var n=yo(e,function(u){return a.size===g&&a.clear(),u}),a=n.cache;return n}function Hy(e,n){var a=e[1],u=n[1],f=a|u,m=f<(K|q|A),x=u==A&&a==B||u==A&&a==M&&e[7].length<=n[8]||u==(A|M)&&n[7].length<=n[8]&&a==B;if(!(m||x))return e;u&K&&(e[2]=n[2],f|=a&K?0:$);var N=n[3];if(N){var k=e[3];e[3]=k?Il(k,N,n[4]):N,e[4]=k?xn(e[3],v):n[4]}return N=n[5],N&&(k=e[5],e[5]=k?Sl(k,N,n[6]):N,e[6]=k?xn(e[5],v):n[6]),N=n[7],N&&(e[7]=N),u&A&&(e[8]=e[8]==null?n[8]:Gt(e[8],n[8])),e[9]==null&&(e[9]=n[9]),e[0]=n[0],e[1]=f,e}function Wy(e){var n=[];if(e!=null)for(var a in rt(e))n.push(a);return n}function Fy(e){return zs.call(e)}function Bl(e,n,a){return n=$t(n===r?e.length-1:n,0),function(){for(var u=arguments,f=-1,m=$t(u.length-n,0),x=V(m);++f<m;)x[f]=u[n+f];f=-1;for(var N=V(n+1);++f<n;)N[f]=u[f];return N[n]=a(x),zt(e,this,N)}}function Kl(e,n){return n.length<2?e:Wn(e,Ar(n,0,-1))}function Gy(e,n){for(var a=e.length,u=Gt(n.length,a),f=hr(e);u--;){var m=n[u];e[u]=un(m,a)?f[m]:r}return e}function ic(e,n){if(!(n==="constructor"&&typeof e[n]=="function")&&n!="__proto__")return e[n]}var Vl=Wl(pl),Xi=ug||function(e,n){return Ue.setTimeout(e,n)},sc=Wl(vy);function Hl(e,n,a){var u=n+"";return sc(e,qy(u,Yy(ky(u),a)))}function Wl(e){var n=0,a=0;return function(){var u=pg(),f=fe-(u-a);if(a=u,f>0){if(++n>=F)return arguments[0]}else n=0;return e.apply(r,arguments)}}function ho(e,n){var a=-1,u=e.length,f=u-1;for(n=n===r?u:n;++a<n;){var m=za(a,f),x=e[m];e[m]=e[a],e[a]=x}return e.length=n,e}var Fl=Vy(function(e){var n=[];return e.charCodeAt(0)===46&&n.push(""),e.replace(Lt,function(a,u,f,m){n.push(f?m.replace(Xo,"$1"):u||a)}),n});function Qr(e){if(typeof e=="string"||br(e))return e;var n=e+"";return n=="0"&&1/e==-le?"-0":n}function Gn(e){if(e!=null){try{return $s.call(e)}catch{}try{return e+""}catch{}}return""}function Yy(e,n){return Cr(cr,function(a){var u="_."+a[0];n&a[1]&&!Ds(e,u)&&e.push(u)}),e.sort()}function Gl(e){if(e instanceof je)return e.clone();var n=new Tr(e.__wrapped__,e.__chain__);return n.__actions__=hr(e.__actions__),n.__index__=e.__index__,n.__values__=e.__values__,n}function Jy(e,n,a){(a?er(e,n,a):n===r)?n=1:n=$t(Te(n),0);var u=e==null?0:e.length;if(!u||n<1)return[];for(var f=0,m=0,x=V(Fs(u/n));f<u;)x[m++]=Ar(e,f,f+=n);return x}function Qy(e){for(var n=-1,a=e==null?0:e.length,u=0,f=[];++n<a;){var m=e[n];m&&(f[u++]=m)}return f}function Xy(){var e=arguments.length;if(!e)return[];for(var n=V(e-1),a=arguments[0],u=e;u--;)n[u-1]=arguments[u];return Sn(Pe(a)?hr(a):[a],Wt(n,1))}var Zy=Ae(function(e,n){return Ct(e)?Wi(e,Wt(n,1,Ct,!0)):[]}),ev=Ae(function(e,n){var a=Lr(n);return Ct(a)&&(a=r),Ct(e)?Wi(e,Wt(n,1,Ct,!0),we(a,2)):[]}),tv=Ae(function(e,n){var a=Lr(n);return Ct(a)&&(a=r),Ct(e)?Wi(e,Wt(n,1,Ct,!0),r,a):[]});function rv(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:Te(n),Ar(e,n<0?0:n,u)):[]}function nv(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:Te(n),n=u-n,Ar(e,0,n<0?0:n)):[]}function iv(e,n){return e&&e.length?no(e,we(n,3),!0,!0):[]}function sv(e,n){return e&&e.length?no(e,we(n,3),!0):[]}function ov(e,n,a,u){var f=e==null?0:e.length;return f?(a&&typeof a!="number"&&er(e,n,a)&&(a=0,u=f),Xg(e,n,a,u)):[]}function Yl(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:Te(a);return f<0&&(f=$t(u+f,0)),ks(e,we(n,3),f)}function Jl(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return a!==r&&(f=Te(a),f=a<0?$t(u+f,0):Gt(f,u-1)),ks(e,we(n,3),f,!0)}function Ql(e){var n=e==null?0:e.length;return n?Wt(e,1):[]}function av(e){var n=e==null?0:e.length;return n?Wt(e,le):[]}function cv(e,n){var a=e==null?0:e.length;return a?(n=n===r?1:Te(n),Wt(e,n)):[]}function uv(e){for(var n=-1,a=e==null?0:e.length,u={};++n<a;){var f=e[n];u[f[0]]=f[1]}return u}function Xl(e){return e&&e.length?e[0]:r}function lv(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var f=a==null?0:Te(a);return f<0&&(f=$t(u+f,0)),hi(e,n,f)}function hv(e){var n=e==null?0:e.length;return n?Ar(e,0,-1):[]}var fv=Ae(function(e){var n=ht(e,Wa);return n.length&&n[0]===e[0]?ka(n):[]}),pv=Ae(function(e){var n=Lr(e),a=ht(e,Wa);return n===Lr(a)?n=r:a.pop(),a.length&&a[0]===e[0]?ka(a,we(n,2)):[]}),dv=Ae(function(e){var n=Lr(e),a=ht(e,Wa);return n=typeof n=="function"?n:r,n&&a.pop(),a.length&&a[0]===e[0]?ka(a,r,n):[]});function gv(e,n){return e==null?"":hg.call(e,n)}function Lr(e){var n=e==null?0:e.length;return n?e[n-1]:r}function yv(e,n,a){var u=e==null?0:e.length;if(!u)return-1;var f=u;return a!==r&&(f=Te(a),f=f<0?$t(u+f,0):Gt(f,u-1)),n===n?Yd(e,n,f):ks(e,Au,f,!0)}function vv(e,n){return e&&e.length?ul(e,Te(n)):r}var mv=Ae(Zl);function Zl(e,n){return e&&e.length&&n&&n.length?$a(e,n):e}function _v(e,n,a){return e&&e.length&&n&&n.length?$a(e,n,we(a,2)):e}function wv(e,n,a){return e&&e.length&&n&&n.length?$a(e,n,r,a):e}var bv=cn(function(e,n){var a=e==null?0:e.length,u=Aa(e,n);return fl(e,ht(n,function(f){return un(f,a)?+f:f}).sort(El)),u});function Ev(e,n){var a=[];if(!(e&&e.length))return a;var u=-1,f=[],m=e.length;for(n=we(n,3);++u<m;){var x=e[u];n(x,u,e)&&(a.push(x),f.push(u))}return fl(e,f),a}function oc(e){return e==null?e:gg.call(e)}function Iv(e,n,a){var u=e==null?0:e.length;return u?(a&&typeof a!="number"&&er(e,n,a)?(n=0,a=u):(n=n==null?0:Te(n),a=a===r?u:Te(a)),Ar(e,n,a)):[]}function Sv(e,n){return ro(e,n)}function xv(e,n,a){return Ka(e,n,we(a,2))}function Pv(e,n){var a=e==null?0:e.length;if(a){var u=ro(e,n);if(u<a&&zr(e[u],n))return u}return-1}function Ov(e,n){return ro(e,n,!0)}function Cv(e,n,a){return Ka(e,n,we(a,2),!0)}function Nv(e,n){var a=e==null?0:e.length;if(a){var u=ro(e,n,!0)-1;if(zr(e[u],n))return u}return-1}function Tv(e){return e&&e.length?dl(e):[]}function Rv(e,n){return e&&e.length?dl(e,we(n,2)):[]}function Av(e){var n=e==null?0:e.length;return n?Ar(e,1,n):[]}function Lv(e,n,a){return e&&e.length?(n=a||n===r?1:Te(n),Ar(e,0,n<0?0:n)):[]}function jv(e,n,a){var u=e==null?0:e.length;return u?(n=a||n===r?1:Te(n),n=u-n,Ar(e,n<0?0:n,u)):[]}function Dv(e,n){return e&&e.length?no(e,we(n,3),!1,!0):[]}function kv(e,n){return e&&e.length?no(e,we(n,3)):[]}var Uv=Ae(function(e){return Cn(Wt(e,1,Ct,!0))}),Mv=Ae(function(e){var n=Lr(e);return Ct(n)&&(n=r),Cn(Wt(e,1,Ct,!0),we(n,2))}),qv=Ae(function(e){var n=Lr(e);return n=typeof n=="function"?n:r,Cn(Wt(e,1,Ct,!0),r,n)});function $v(e){return e&&e.length?Cn(e):[]}function zv(e,n){return e&&e.length?Cn(e,we(n,2)):[]}function Bv(e,n){return n=typeof n=="function"?n:r,e&&e.length?Cn(e,r,n):[]}function ac(e){if(!(e&&e.length))return[];var n=0;return e=In(e,function(a){if(Ct(a))return n=$t(a.length,n),!0}),Sa(n,function(a){return ht(e,ba(a))})}function eh(e,n){if(!(e&&e.length))return[];var a=ac(e);return n==null?a:ht(a,function(u){return zt(n,r,u)})}var Kv=Ae(function(e,n){return Ct(e)?Wi(e,n):[]}),Vv=Ae(function(e){return Ha(In(e,Ct))}),Hv=Ae(function(e){var n=Lr(e);return Ct(n)&&(n=r),Ha(In(e,Ct),we(n,2))}),Wv=Ae(function(e){var n=Lr(e);return n=typeof n=="function"?n:r,Ha(In(e,Ct),r,n)}),Fv=Ae(ac);function Gv(e,n){return ml(e||[],n||[],Hi)}function Yv(e,n){return ml(e||[],n||[],Yi)}var Jv=Ae(function(e){var n=e.length,a=n>1?e[n-1]:r;return a=typeof a=="function"?(e.pop(),a):r,eh(e,a)});function th(e){var n=d(e);return n.__chain__=!0,n}function Qv(e,n){return n(e),e}function fo(e,n){return n(e)}var Xv=cn(function(e){var n=e.length,a=n?e[0]:0,u=this.__wrapped__,f=function(m){return Aa(m,e)};return n>1||this.__actions__.length||!(u instanceof je)||!un(a)?this.thru(f):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:fo,args:[f],thisArg:r}),new Tr(u,this.__chain__).thru(function(m){return n&&!m.length&&m.push(r),m}))});function Zv(){return th(this)}function em(){return new Tr(this.value(),this.__chain__)}function tm(){this.__values__===r&&(this.__values__=gh(this.value()));var e=this.__index__>=this.__values__.length,n=e?r:this.__values__[this.__index__++];return{done:e,value:n}}function rm(){return this}function nm(e){for(var n,a=this;a instanceof Qs;){var u=Gl(a);u.__index__=0,u.__values__=r,n?f.__wrapped__=u:n=u;var f=u;a=a.__wrapped__}return f.__wrapped__=e,n}function im(){var e=this.__wrapped__;if(e instanceof je){var n=e;return this.__actions__.length&&(n=new je(this)),n=n.reverse(),n.__actions__.push({func:fo,args:[oc],thisArg:r}),new Tr(n,this.__chain__)}return this.thru(oc)}function sm(){return vl(this.__wrapped__,this.__actions__)}var om=io(function(e,n,a){Fe.call(e,a)?++e[a]:on(e,a,1)});function am(e,n,a){var u=Pe(e)?Tu:Qg;return a&&er(e,n,a)&&(n=r),u(e,we(n,3))}function cm(e,n){var a=Pe(e)?In:el;return a(e,we(n,3))}var um=Cl(Yl),lm=Cl(Jl);function hm(e,n){return Wt(po(e,n),1)}function fm(e,n){return Wt(po(e,n),le)}function pm(e,n,a){return a=a===r?1:Te(a),Wt(po(e,n),a)}function rh(e,n){var a=Pe(e)?Cr:On;return a(e,we(n,3))}function nh(e,n){var a=Pe(e)?Ad:Zu;return a(e,we(n,3))}var dm=io(function(e,n,a){Fe.call(e,a)?e[a].push(n):on(e,a,[n])});function gm(e,n,a,u){e=fr(e)?e:Ii(e),a=a&&!u?Te(a):0;var f=e.length;return a<0&&(a=$t(f+a,0)),_o(e)?a<=f&&e.indexOf(n,a)>-1:!!f&&hi(e,n,a)>-1}var ym=Ae(function(e,n,a){var u=-1,f=typeof n=="function",m=fr(e)?V(e.length):[];return On(e,function(x){m[++u]=f?zt(n,x,a):Fi(x,n,a)}),m}),vm=io(function(e,n,a){on(e,a,n)});function po(e,n){var a=Pe(e)?ht:ol;return a(e,we(n,3))}function mm(e,n,a,u){return e==null?[]:(Pe(n)||(n=n==null?[]:[n]),a=u?r:a,Pe(a)||(a=a==null?[]:[a]),ll(e,n,a))}var _m=io(function(e,n,a){e[a?0:1].push(n)},function(){return[[],[]]});function wm(e,n,a){var u=Pe(e)?_a:ju,f=arguments.length<3;return u(e,we(n,4),a,f,On)}function bm(e,n,a){var u=Pe(e)?Ld:ju,f=arguments.length<3;return u(e,we(n,4),a,f,Zu)}function Em(e,n){var a=Pe(e)?In:el;return a(e,vo(we(n,3)))}function Im(e){var n=Pe(e)?Yu:gy;return n(e)}function Sm(e,n,a){(a?er(e,n,a):n===r)?n=1:n=Te(n);var u=Pe(e)?Wg:yy;return u(e,n)}function xm(e){var n=Pe(e)?Fg:my;return n(e)}function Pm(e){if(e==null)return 0;if(fr(e))return _o(e)?pi(e):e.length;var n=Yt(e);return n==oe||n==$e?e.size:Ma(e).length}function Om(e,n,a){var u=Pe(e)?wa:_y;return a&&er(e,n,a)&&(n=r),u(e,we(n,3))}var Cm=Ae(function(e,n){if(e==null)return[];var a=n.length;return a>1&&er(e,n[0],n[1])?n=[]:a>2&&er(n[0],n[1],n[2])&&(n=[n[0]]),ll(e,Wt(n,1),[])}),go=cg||function(){return Ue.Date.now()};function Nm(e,n){if(typeof n!="function")throw new Nr(h);return e=Te(e),function(){if(--e<1)return n.apply(this,arguments)}}function ih(e,n,a){return n=a?r:n,n=e&&n==null?e.length:n,an(e,A,r,r,r,r,n)}function sh(e,n){var a;if(typeof n!="function")throw new Nr(h);return e=Te(e),function(){return--e>0&&(a=n.apply(this,arguments)),e<=1&&(n=r),a}}var cc=Ae(function(e,n,a){var u=K;if(a.length){var f=xn(a,bi(cc));u|=C}return an(e,u,n,a,f)}),oh=Ae(function(e,n,a){var u=K|q;if(a.length){var f=xn(a,bi(oh));u|=C}return an(n,u,e,a,f)});function ah(e,n,a){n=a?r:n;var u=an(e,B,r,r,r,r,r,n);return u.placeholder=ah.placeholder,u}function ch(e,n,a){n=a?r:n;var u=an(e,S,r,r,r,r,r,n);return u.placeholder=ch.placeholder,u}function uh(e,n,a){var u,f,m,x,N,k,Y=0,J=!1,re=!1,pe=!0;if(typeof e!="function")throw new Nr(h);n=jr(n)||0,gt(a)&&(J=!!a.leading,re="maxWait"in a,m=re?$t(jr(a.maxWait)||0,n):m,pe="trailing"in a?!!a.trailing:pe);function ye(Nt){var Br=u,fn=f;return u=f=r,Y=Nt,x=e.apply(fn,Br),x}function be(Nt){return Y=Nt,N=Xi(Le,n),J?ye(Nt):x}function Re(Nt){var Br=Nt-k,fn=Nt-Y,Ch=n-Br;return re?Gt(Ch,m-fn):Ch}function Ee(Nt){var Br=Nt-k,fn=Nt-Y;return k===r||Br>=n||Br<0||re&&fn>=m}function Le(){var Nt=go();if(Ee(Nt))return Me(Nt);N=Xi(Le,Re(Nt))}function Me(Nt){return N=r,pe&&u?ye(Nt):(u=f=r,x)}function Er(){N!==r&&_l(N),Y=0,u=k=f=N=r}function tr(){return N===r?x:Me(go())}function Ir(){var Nt=go(),Br=Ee(Nt);if(u=arguments,f=this,k=Nt,Br){if(N===r)return be(k);if(re)return _l(N),N=Xi(Le,n),ye(k)}return N===r&&(N=Xi(Le,n)),x}return Ir.cancel=Er,Ir.flush=tr,Ir}var Tm=Ae(function(e,n){return Xu(e,1,n)}),Rm=Ae(function(e,n,a){return Xu(e,jr(n)||0,a)});function Am(e){return an(e,ae)}function yo(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new Nr(h);var a=function(){var u=arguments,f=n?n.apply(this,u):u[0],m=a.cache;if(m.has(f))return m.get(f);var x=e.apply(this,u);return a.cache=m.set(f,x)||m,x};return a.cache=new(yo.Cache||sn),a}yo.Cache=sn;function vo(e){if(typeof e!="function")throw new Nr(h);return function(){var n=arguments;switch(n.length){case 0:return!e.call(this);case 1:return!e.call(this,n[0]);case 2:return!e.call(this,n[0],n[1]);case 3:return!e.call(this,n[0],n[1],n[2])}return!e.apply(this,n)}}function Lm(e){return sh(2,e)}var jm=wy(function(e,n){n=n.length==1&&Pe(n[0])?ht(n[0],_r(we())):ht(Wt(n,1),_r(we()));var a=n.length;return Ae(function(u){for(var f=-1,m=Gt(u.length,a);++f<m;)u[f]=n[f].call(this,u[f]);return zt(e,this,u)})}),uc=Ae(function(e,n){var a=xn(n,bi(uc));return an(e,C,r,n,a)}),lh=Ae(function(e,n){var a=xn(n,bi(lh));return an(e,I,r,n,a)}),Dm=cn(function(e,n){return an(e,M,r,r,r,n)});function km(e,n){if(typeof e!="function")throw new Nr(h);return n=n===r?n:Te(n),Ae(e,n)}function Um(e,n){if(typeof e!="function")throw new Nr(h);return n=n==null?0:$t(Te(n),0),Ae(function(a){var u=a[n],f=Tn(a,0,n);return u&&Sn(f,u),zt(e,this,f)})}function Mm(e,n,a){var u=!0,f=!0;if(typeof e!="function")throw new Nr(h);return gt(a)&&(u="leading"in a?!!a.leading:u,f="trailing"in a?!!a.trailing:f),uh(e,n,{leading:u,maxWait:n,trailing:f})}function qm(e){return ih(e,1)}function $m(e,n){return uc(Fa(n),e)}function zm(){if(!arguments.length)return[];var e=arguments[0];return Pe(e)?e:[e]}function Bm(e){return Rr(e,R)}function Km(e,n){return n=typeof n=="function"?n:r,Rr(e,R,n)}function Vm(e){return Rr(e,b|R)}function Hm(e,n){return n=typeof n=="function"?n:r,Rr(e,b|R,n)}function Wm(e,n){return n==null||Qu(e,n,Bt(n))}function zr(e,n){return e===n||e!==e&&n!==n}var Fm=co(Da),Gm=co(function(e,n){return e>=n}),Yn=nl(function(){return arguments}())?nl:function(e){return St(e)&&Fe.call(e,"callee")&&!Ku.call(e,"callee")},Pe=V.isArray,Ym=Xt?_r(Xt):ny;function fr(e){return e!=null&&mo(e.length)&&!ln(e)}function Ct(e){return St(e)&&fr(e)}function Jm(e){return e===!0||e===!1||St(e)&&Zt(e)==H}var Rn=lg||wc,Qm=Mr?_r(Mr):iy;function Xm(e){return St(e)&&e.nodeType===1&&!Zi(e)}function Zm(e){if(e==null)return!0;if(fr(e)&&(Pe(e)||typeof e=="string"||typeof e.splice=="function"||Rn(e)||Ei(e)||Yn(e)))return!e.length;var n=Yt(e);if(n==oe||n==$e)return!e.size;if(Qi(e))return!Ma(e).length;for(var a in e)if(Fe.call(e,a))return!1;return!0}function e_(e,n){return Gi(e,n)}function t_(e,n,a){a=typeof a=="function"?a:r;var u=a?a(e,n):r;return u===r?Gi(e,n,r,a):!!u}function lc(e){if(!St(e))return!1;var n=Zt(e);return n==w||n==l||typeof e.message=="string"&&typeof e.name=="string"&&!Zi(e)}function r_(e){return typeof e=="number"&&Hu(e)}function ln(e){if(!gt(e))return!1;var n=Zt(e);return n==z||n==te||n==W||n==Je}function hh(e){return typeof e=="number"&&e==Te(e)}function mo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ne}function gt(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}function St(e){return e!=null&&typeof e=="object"}var fh=Or?_r(Or):oy;function n_(e,n){return e===n||Ua(e,n,ec(n))}function i_(e,n,a){return a=typeof a=="function"?a:r,Ua(e,n,ec(n),a)}function s_(e){return ph(e)&&e!=+e}function o_(e){if(Ky(e))throw new Se(c);return il(e)}function a_(e){return e===null}function c_(e){return e==null}function ph(e){return typeof e=="number"||St(e)&&Zt(e)==ie}function Zi(e){if(!St(e)||Zt(e)!=Ne)return!1;var n=Vs(e);if(n===null)return!0;var a=Fe.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&$s.call(a)==ig}var hc=Gr?_r(Gr):ay;function u_(e){return hh(e)&&e>=-ne&&e<=ne}var dh=Mi?_r(Mi):cy;function _o(e){return typeof e=="string"||!Pe(e)&&St(e)&&Zt(e)==Qe}function br(e){return typeof e=="symbol"||St(e)&&Zt(e)==Ke}var Ei=zn?_r(zn):uy;function l_(e){return e===r}function h_(e){return St(e)&&Yt(e)==Oe}function f_(e){return St(e)&&Zt(e)==me}var p_=co(qa),d_=co(function(e,n){return e<=n});function gh(e){if(!e)return[];if(fr(e))return _o(e)?qr(e):hr(e);if($i&&e[$i])return Wd(e[$i]());var n=Yt(e),a=n==oe?Pa:n==$e?Us:Ii;return a(e)}function hn(e){if(!e)return e===0?e:0;if(e=jr(e),e===le||e===-le){var n=e<0?-1:1;return n*Q}return e===e?e:0}function Te(e){var n=hn(e),a=n%1;return n===n?a?n-a:n:0}function yh(e){return e?Hn(Te(e),0,se):0}function jr(e){if(typeof e=="number")return e;if(br(e))return ee;if(gt(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=gt(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Du(e);var a=ta.test(e);return a||na.test(e)?Ce(e.slice(2),a?2:8):ea.test(e)?ee:+e}function vh(e){return Jr(e,pr(e))}function g_(e){return e?Hn(Te(e),-ne,ne):e===0?e:0}function He(e){return e==null?"":wr(e)}var y_=_i(function(e,n){if(Qi(n)||fr(n)){Jr(n,Bt(n),e);return}for(var a in n)Fe.call(n,a)&&Hi(e,a,n[a])}),mh=_i(function(e,n){Jr(n,pr(n),e)}),wo=_i(function(e,n,a,u){Jr(n,pr(n),e,u)}),v_=_i(function(e,n,a,u){Jr(n,Bt(n),e,u)}),m_=cn(Aa);function __(e,n){var a=mi(e);return n==null?a:Ju(a,n)}var w_=Ae(function(e,n){e=rt(e);var a=-1,u=n.length,f=u>2?n[2]:r;for(f&&er(n[0],n[1],f)&&(u=1);++a<u;)for(var m=n[a],x=pr(m),N=-1,k=x.length;++N<k;){var Y=x[N],J=e[Y];(J===r||zr(J,gi[Y])&&!Fe.call(e,Y))&&(e[Y]=m[Y])}return e}),b_=Ae(function(e){return e.push(r,Dl),zt(_h,r,e)});function E_(e,n){return Ru(e,we(n,3),Yr)}function I_(e,n){return Ru(e,we(n,3),ja)}function S_(e,n){return e==null?e:La(e,we(n,3),pr)}function x_(e,n){return e==null?e:tl(e,we(n,3),pr)}function P_(e,n){return e&&Yr(e,we(n,3))}function O_(e,n){return e&&ja(e,we(n,3))}function C_(e){return e==null?[]:eo(e,Bt(e))}function N_(e){return e==null?[]:eo(e,pr(e))}function fc(e,n,a){var u=e==null?r:Wn(e,n);return u===r?a:u}function T_(e,n){return e!=null&&Ml(e,n,Zg)}function pc(e,n){return e!=null&&Ml(e,n,ey)}var R_=Tl(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),e[n]=a},gc(dr)),A_=Tl(function(e,n,a){n!=null&&typeof n.toString!="function"&&(n=zs.call(n)),Fe.call(e,n)?e[n].push(a):e[n]=[a]},we),L_=Ae(Fi);function Bt(e){return fr(e)?Gu(e):Ma(e)}function pr(e){return fr(e)?Gu(e,!0):ly(e)}function j_(e,n){var a={};return n=we(n,3),Yr(e,function(u,f,m){on(a,n(u,f,m),u)}),a}function D_(e,n){var a={};return n=we(n,3),Yr(e,function(u,f,m){on(a,f,n(u,f,m))}),a}var k_=_i(function(e,n,a){to(e,n,a)}),_h=_i(function(e,n,a,u){to(e,n,a,u)}),U_=cn(function(e,n){var a={};if(e==null)return a;var u=!1;n=ht(n,function(m){return m=Nn(m,e),u||(u=m.length>1),m}),Jr(e,Xa(e),a),u&&(a=Rr(a,b|P|R,Ry));for(var f=n.length;f--;)Va(a,n[f]);return a});function M_(e,n){return wh(e,vo(we(n)))}var q_=cn(function(e,n){return e==null?{}:fy(e,n)});function wh(e,n){if(e==null)return{};var a=ht(Xa(e),function(u){return[u]});return n=we(n),hl(e,a,function(u,f){return n(u,f[0])})}function $_(e,n,a){n=Nn(n,e);var u=-1,f=n.length;for(f||(f=1,e=r);++u<f;){var m=e==null?r:e[Qr(n[u])];m===r&&(u=f,m=a),e=ln(m)?m.call(e):m}return e}function z_(e,n,a){return e==null?e:Yi(e,n,a)}function B_(e,n,a,u){return u=typeof u=="function"?u:r,e==null?e:Yi(e,n,a,u)}var bh=Ll(Bt),Eh=Ll(pr);function K_(e,n,a){var u=Pe(e),f=u||Rn(e)||Ei(e);if(n=we(n,4),a==null){var m=e&&e.constructor;f?a=u?new m:[]:gt(e)?a=ln(m)?mi(Vs(e)):{}:a={}}return(f?Cr:Yr)(e,function(x,N,k){return n(a,x,N,k)}),a}function V_(e,n){return e==null?!0:Va(e,n)}function H_(e,n,a){return e==null?e:yl(e,n,Fa(a))}function W_(e,n,a,u){return u=typeof u=="function"?u:r,e==null?e:yl(e,n,Fa(a),u)}function Ii(e){return e==null?[]:xa(e,Bt(e))}function F_(e){return e==null?[]:xa(e,pr(e))}function G_(e,n,a){return a===r&&(a=n,n=r),a!==r&&(a=jr(a),a=a===a?a:0),n!==r&&(n=jr(n),n=n===n?n:0),Hn(jr(e),n,a)}function Y_(e,n,a){return n=hn(n),a===r?(a=n,n=0):a=hn(a),e=jr(e),ty(e,n,a)}function J_(e,n,a){if(a&&typeof a!="boolean"&&er(e,n,a)&&(n=a=r),a===r&&(typeof n=="boolean"?(a=n,n=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&n===r?(e=0,n=1):(e=hn(e),n===r?(n=e,e=0):n=hn(n)),e>n){var u=e;e=n,n=u}if(a||e%1||n%1){var f=Wu();return Gt(e+f*(n-e+et("1e-"+((f+"").length-1))),n)}return za(e,n)}var Q_=wi(function(e,n,a){return n=n.toLowerCase(),e+(a?Ih(n):n)});function Ih(e){return dc(He(e).toLowerCase())}function Sh(e){return e=He(e),e&&e.replace(tn,zd).replace(ya,"")}function X_(e,n,a){e=He(e),n=wr(n);var u=e.length;a=a===r?u:Hn(Te(a),0,u);var f=a;return a-=n.length,a>=0&&e.slice(a,f)==n}function Z_(e){return e=He(e),e&&ut.test(e)?e.replace(kn,Bd):e}function ew(e){return e=He(e),e&&jt.test(e)?e.replace(bt,"\\$&"):e}var tw=wi(function(e,n,a){return e+(a?"-":"")+n.toLowerCase()}),rw=wi(function(e,n,a){return e+(a?" ":"")+n.toLowerCase()}),nw=Ol("toLowerCase");function iw(e,n,a){e=He(e),n=Te(n);var u=n?pi(e):0;if(!n||u>=n)return e;var f=(n-u)/2;return ao(Gs(f),a)+e+ao(Fs(f),a)}function sw(e,n,a){e=He(e),n=Te(n);var u=n?pi(e):0;return n&&u<n?e+ao(n-u,a):e}function ow(e,n,a){e=He(e),n=Te(n);var u=n?pi(e):0;return n&&u<n?ao(n-u,a)+e:e}function aw(e,n,a){return a||n==null?n=0:n&&(n=+n),dg(He(e).replace(Et,""),n||0)}function cw(e,n,a){return(a?er(e,n,a):n===r)?n=1:n=Te(n),Ba(He(e),n)}function uw(){var e=arguments,n=He(e[0]);return e.length<3?n:n.replace(e[1],e[2])}var lw=wi(function(e,n,a){return e+(a?"_":"")+n.toLowerCase()});function hw(e,n,a){return a&&typeof a!="number"&&er(e,n,a)&&(n=a=r),a=a===r?se:a>>>0,a?(e=He(e),e&&(typeof n=="string"||n!=null&&!hc(n))&&(n=wr(n),!n&&fi(e))?Tn(qr(e),0,a):e.split(n,a)):[]}var fw=wi(function(e,n,a){return e+(a?" ":"")+dc(n)});function pw(e,n,a){return e=He(e),a=a==null?0:Hn(Te(a),0,e.length),n=wr(n),e.slice(a,a+n.length)==n}function dw(e,n,a){var u=d.templateSettings;a&&er(e,n,a)&&(n=r),e=He(e),n=wo({},n,u,jl);var f=wo({},n.imports,u.imports,jl),m=Bt(f),x=xa(f,m),N,k,Y=0,J=n.interpolate||ii,re="__p += '",pe=Oa((n.escape||ii).source+"|"+J.source+"|"+(J===dt?Zo:ii).source+"|"+(n.evaluate||ii).source+"|$","g"),ye="//# sourceURL="+(Fe.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++va+"]")+`
`;e.replace(pe,function(Ee,Le,Me,Er,tr,Ir){return Me||(Me=Er),re+=e.slice(Y,Ir).replace(sa,Kd),Le&&(N=!0,re+=`' +
__e(`+Le+`) +
'`),tr&&(k=!0,re+=`';
`+tr+`;
__p += '`),Me&&(re+=`' +
((__t = (`+Me+`)) == null ? '' : __t) +
'`),Y=Ir+Ee.length,Ee}),re+=`';
`;var be=Fe.call(n,"variable")&&n.variable;if(!be)re=`with (obj) {
`+re+`
}
`;else if(Qo.test(be))throw new Se(p);re=(k?re.replace(Wr,""):re).replace(Qt,"$1").replace(en,"$1;"),re="function("+(be||"obj")+`) {
`+(be?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(k?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+re+`return __p
}`;var Re=Ph(function(){return Ve(m,ye+"return "+re).apply(r,x)});if(Re.source=re,lc(Re))throw Re;return Re}function gw(e){return He(e).toLowerCase()}function yw(e){return He(e).toUpperCase()}function vw(e,n,a){if(e=He(e),e&&(a||n===r))return Du(e);if(!e||!(n=wr(n)))return e;var u=qr(e),f=qr(n),m=ku(u,f),x=Uu(u,f)+1;return Tn(u,m,x).join("")}function mw(e,n,a){if(e=He(e),e&&(a||n===r))return e.slice(0,qu(e)+1);if(!e||!(n=wr(n)))return e;var u=qr(e),f=Uu(u,qr(n))+1;return Tn(u,0,f).join("")}function _w(e,n,a){if(e=He(e),e&&(a||n===r))return e.replace(Et,"");if(!e||!(n=wr(n)))return e;var u=qr(e),f=ku(u,qr(n));return Tn(u,f).join("")}function ww(e,n){var a=Z,u=he;if(gt(n)){var f="separator"in n?n.separator:f;a="length"in n?Te(n.length):a,u="omission"in n?wr(n.omission):u}e=He(e);var m=e.length;if(fi(e)){var x=qr(e);m=x.length}if(a>=m)return e;var N=a-pi(u);if(N<1)return u;var k=x?Tn(x,0,N).join(""):e.slice(0,N);if(f===r)return k+u;if(x&&(N+=k.length-N),hc(f)){if(e.slice(N).search(f)){var Y,J=k;for(f.global||(f=Oa(f.source,He(Pr.exec(f))+"g")),f.lastIndex=0;Y=f.exec(J);)var re=Y.index;k=k.slice(0,re===r?N:re)}}else if(e.indexOf(wr(f),N)!=N){var pe=k.lastIndexOf(f);pe>-1&&(k=k.slice(0,pe))}return k+u}function bw(e){return e=He(e),e&&mt.test(e)?e.replace(bn,Jd):e}var Ew=wi(function(e,n,a){return e+(a?" ":"")+n.toUpperCase()}),dc=Ol("toUpperCase");function xh(e,n,a){return e=He(e),n=a?r:n,n===r?Hd(e)?Zd(e):kd(e):e.match(n)||[]}var Ph=Ae(function(e,n){try{return zt(e,r,n)}catch(a){return lc(a)?a:new Se(a)}}),Iw=cn(function(e,n){return Cr(n,function(a){a=Qr(a),on(e,a,cc(e[a],e))}),e});function Sw(e){var n=e==null?0:e.length,a=we();return e=n?ht(e,function(u){if(typeof u[1]!="function")throw new Nr(h);return[a(u[0]),u[1]]}):[],Ae(function(u){for(var f=-1;++f<n;){var m=e[f];if(zt(m[0],this,u))return zt(m[1],this,u)}})}function xw(e){return Jg(Rr(e,b))}function gc(e){return function(){return e}}function Pw(e,n){return e==null||e!==e?n:e}var Ow=Nl(),Cw=Nl(!0);function dr(e){return e}function yc(e){return sl(typeof e=="function"?e:Rr(e,b))}function Nw(e){return al(Rr(e,b))}function Tw(e,n){return cl(e,Rr(n,b))}var Rw=Ae(function(e,n){return function(a){return Fi(a,e,n)}}),Aw=Ae(function(e,n){return function(a){return Fi(e,a,n)}});function vc(e,n,a){var u=Bt(n),f=eo(n,u);a==null&&!(gt(n)&&(f.length||!u.length))&&(a=n,n=e,e=this,f=eo(n,Bt(n)));var m=!(gt(a)&&"chain"in a)||!!a.chain,x=ln(e);return Cr(f,function(N){var k=n[N];e[N]=k,x&&(e.prototype[N]=function(){var Y=this.__chain__;if(m||Y){var J=e(this.__wrapped__),re=J.__actions__=hr(this.__actions__);return re.push({func:k,args:arguments,thisArg:e}),J.__chain__=Y,J}return k.apply(e,Sn([this.value()],arguments))})}),e}function Lw(){return Ue._===this&&(Ue._=sg),this}function mc(){}function jw(e){return e=Te(e),Ae(function(n){return ul(n,e)})}var Dw=Ya(ht),kw=Ya(Tu),Uw=Ya(wa);function Oh(e){return rc(e)?ba(Qr(e)):py(e)}function Mw(e){return function(n){return e==null?r:Wn(e,n)}}var qw=Rl(),$w=Rl(!0);function _c(){return[]}function wc(){return!1}function zw(){return{}}function Bw(){return""}function Kw(){return!0}function Vw(e,n){if(e=Te(e),e<1||e>ne)return[];var a=se,u=Gt(e,se);n=we(n),e-=se;for(var f=Sa(u,n);++a<e;)n(a);return f}function Hw(e){return Pe(e)?ht(e,Qr):br(e)?[e]:hr(Fl(He(e)))}function Ww(e){var n=++ng;return He(e)+n}var Fw=oo(function(e,n){return e+n},0),Gw=Ja("ceil"),Yw=oo(function(e,n){return e/n},1),Jw=Ja("floor");function Qw(e){return e&&e.length?Zs(e,dr,Da):r}function Xw(e,n){return e&&e.length?Zs(e,we(n,2),Da):r}function Zw(e){return Lu(e,dr)}function eb(e,n){return Lu(e,we(n,2))}function tb(e){return e&&e.length?Zs(e,dr,qa):r}function rb(e,n){return e&&e.length?Zs(e,we(n,2),qa):r}var nb=oo(function(e,n){return e*n},1),ib=Ja("round"),sb=oo(function(e,n){return e-n},0);function ob(e){return e&&e.length?Ia(e,dr):0}function ab(e,n){return e&&e.length?Ia(e,we(n,2)):0}return d.after=Nm,d.ary=ih,d.assign=y_,d.assignIn=mh,d.assignInWith=wo,d.assignWith=v_,d.at=m_,d.before=sh,d.bind=cc,d.bindAll=Iw,d.bindKey=oh,d.castArray=zm,d.chain=th,d.chunk=Jy,d.compact=Qy,d.concat=Xy,d.cond=Sw,d.conforms=xw,d.constant=gc,d.countBy=om,d.create=__,d.curry=ah,d.curryRight=ch,d.debounce=uh,d.defaults=w_,d.defaultsDeep=b_,d.defer=Tm,d.delay=Rm,d.difference=Zy,d.differenceBy=ev,d.differenceWith=tv,d.drop=rv,d.dropRight=nv,d.dropRightWhile=iv,d.dropWhile=sv,d.fill=ov,d.filter=cm,d.flatMap=hm,d.flatMapDeep=fm,d.flatMapDepth=pm,d.flatten=Ql,d.flattenDeep=av,d.flattenDepth=cv,d.flip=Am,d.flow=Ow,d.flowRight=Cw,d.fromPairs=uv,d.functions=C_,d.functionsIn=N_,d.groupBy=dm,d.initial=hv,d.intersection=fv,d.intersectionBy=pv,d.intersectionWith=dv,d.invert=R_,d.invertBy=A_,d.invokeMap=ym,d.iteratee=yc,d.keyBy=vm,d.keys=Bt,d.keysIn=pr,d.map=po,d.mapKeys=j_,d.mapValues=D_,d.matches=Nw,d.matchesProperty=Tw,d.memoize=yo,d.merge=k_,d.mergeWith=_h,d.method=Rw,d.methodOf=Aw,d.mixin=vc,d.negate=vo,d.nthArg=jw,d.omit=U_,d.omitBy=M_,d.once=Lm,d.orderBy=mm,d.over=Dw,d.overArgs=jm,d.overEvery=kw,d.overSome=Uw,d.partial=uc,d.partialRight=lh,d.partition=_m,d.pick=q_,d.pickBy=wh,d.property=Oh,d.propertyOf=Mw,d.pull=mv,d.pullAll=Zl,d.pullAllBy=_v,d.pullAllWith=wv,d.pullAt=bv,d.range=qw,d.rangeRight=$w,d.rearg=Dm,d.reject=Em,d.remove=Ev,d.rest=km,d.reverse=oc,d.sampleSize=Sm,d.set=z_,d.setWith=B_,d.shuffle=xm,d.slice=Iv,d.sortBy=Cm,d.sortedUniq=Tv,d.sortedUniqBy=Rv,d.split=hw,d.spread=Um,d.tail=Av,d.take=Lv,d.takeRight=jv,d.takeRightWhile=Dv,d.takeWhile=kv,d.tap=Qv,d.throttle=Mm,d.thru=fo,d.toArray=gh,d.toPairs=bh,d.toPairsIn=Eh,d.toPath=Hw,d.toPlainObject=vh,d.transform=K_,d.unary=qm,d.union=Uv,d.unionBy=Mv,d.unionWith=qv,d.uniq=$v,d.uniqBy=zv,d.uniqWith=Bv,d.unset=V_,d.unzip=ac,d.unzipWith=eh,d.update=H_,d.updateWith=W_,d.values=Ii,d.valuesIn=F_,d.without=Kv,d.words=xh,d.wrap=$m,d.xor=Vv,d.xorBy=Hv,d.xorWith=Wv,d.zip=Fv,d.zipObject=Gv,d.zipObjectDeep=Yv,d.zipWith=Jv,d.entries=bh,d.entriesIn=Eh,d.extend=mh,d.extendWith=wo,vc(d,d),d.add=Fw,d.attempt=Ph,d.camelCase=Q_,d.capitalize=Ih,d.ceil=Gw,d.clamp=G_,d.clone=Bm,d.cloneDeep=Vm,d.cloneDeepWith=Hm,d.cloneWith=Km,d.conformsTo=Wm,d.deburr=Sh,d.defaultTo=Pw,d.divide=Yw,d.endsWith=X_,d.eq=zr,d.escape=Z_,d.escapeRegExp=ew,d.every=am,d.find=um,d.findIndex=Yl,d.findKey=E_,d.findLast=lm,d.findLastIndex=Jl,d.findLastKey=I_,d.floor=Jw,d.forEach=rh,d.forEachRight=nh,d.forIn=S_,d.forInRight=x_,d.forOwn=P_,d.forOwnRight=O_,d.get=fc,d.gt=Fm,d.gte=Gm,d.has=T_,d.hasIn=pc,d.head=Xl,d.identity=dr,d.includes=gm,d.indexOf=lv,d.inRange=Y_,d.invoke=L_,d.isArguments=Yn,d.isArray=Pe,d.isArrayBuffer=Ym,d.isArrayLike=fr,d.isArrayLikeObject=Ct,d.isBoolean=Jm,d.isBuffer=Rn,d.isDate=Qm,d.isElement=Xm,d.isEmpty=Zm,d.isEqual=e_,d.isEqualWith=t_,d.isError=lc,d.isFinite=r_,d.isFunction=ln,d.isInteger=hh,d.isLength=mo,d.isMap=fh,d.isMatch=n_,d.isMatchWith=i_,d.isNaN=s_,d.isNative=o_,d.isNil=c_,d.isNull=a_,d.isNumber=ph,d.isObject=gt,d.isObjectLike=St,d.isPlainObject=Zi,d.isRegExp=hc,d.isSafeInteger=u_,d.isSet=dh,d.isString=_o,d.isSymbol=br,d.isTypedArray=Ei,d.isUndefined=l_,d.isWeakMap=h_,d.isWeakSet=f_,d.join=gv,d.kebabCase=tw,d.last=Lr,d.lastIndexOf=yv,d.lowerCase=rw,d.lowerFirst=nw,d.lt=p_,d.lte=d_,d.max=Qw,d.maxBy=Xw,d.mean=Zw,d.meanBy=eb,d.min=tb,d.minBy=rb,d.stubArray=_c,d.stubFalse=wc,d.stubObject=zw,d.stubString=Bw,d.stubTrue=Kw,d.multiply=nb,d.nth=vv,d.noConflict=Lw,d.noop=mc,d.now=go,d.pad=iw,d.padEnd=sw,d.padStart=ow,d.parseInt=aw,d.random=J_,d.reduce=wm,d.reduceRight=bm,d.repeat=cw,d.replace=uw,d.result=$_,d.round=ib,d.runInContext=j,d.sample=Im,d.size=Pm,d.snakeCase=lw,d.some=Om,d.sortedIndex=Sv,d.sortedIndexBy=xv,d.sortedIndexOf=Pv,d.sortedLastIndex=Ov,d.sortedLastIndexBy=Cv,d.sortedLastIndexOf=Nv,d.startCase=fw,d.startsWith=pw,d.subtract=sb,d.sum=ob,d.sumBy=ab,d.template=dw,d.times=Vw,d.toFinite=hn,d.toInteger=Te,d.toLength=yh,d.toLower=gw,d.toNumber=jr,d.toSafeInteger=g_,d.toString=He,d.toUpper=yw,d.trim=vw,d.trimEnd=mw,d.trimStart=_w,d.truncate=ww,d.unescape=bw,d.uniqueId=Ww,d.upperCase=Ew,d.upperFirst=dc,d.each=rh,d.eachRight=nh,d.first=Xl,vc(d,function(){var e={};return Yr(d,function(n,a){Fe.call(d.prototype,a)||(e[a]=n)}),e}(),{chain:!1}),d.VERSION=s,Cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Cr(["drop","take"],function(e,n){je.prototype[e]=function(a){a=a===r?1:$t(Te(a),0);var u=this.__filtered__&&!n?new je(this):this.clone();return u.__filtered__?u.__takeCount__=Gt(a,u.__takeCount__):u.__views__.push({size:Gt(a,se),type:e+(u.__dir__<0?"Right":"")}),u},je.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Cr(["filter","map","takeWhile"],function(e,n){var a=n+1,u=a==_||a==ce;je.prototype[e]=function(f){var m=this.clone();return m.__iteratees__.push({iteratee:we(f,3),type:a}),m.__filtered__=m.__filtered__||u,m}}),Cr(["head","last"],function(e,n){var a="take"+(n?"Right":"");je.prototype[e]=function(){return this[a](1).value()[0]}}),Cr(["initial","tail"],function(e,n){var a="drop"+(n?"":"Right");je.prototype[e]=function(){return this.__filtered__?new je(this):this[a](1)}}),je.prototype.compact=function(){return this.filter(dr)},je.prototype.find=function(e){return this.filter(e).head()},je.prototype.findLast=function(e){return this.reverse().find(e)},je.prototype.invokeMap=Ae(function(e,n){return typeof e=="function"?new je(this):this.map(function(a){return Fi(a,e,n)})}),je.prototype.reject=function(e){return this.filter(vo(we(e)))},je.prototype.slice=function(e,n){e=Te(e);var a=this;return a.__filtered__&&(e>0||n<0)?new je(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),n!==r&&(n=Te(n),a=n<0?a.dropRight(-n):a.take(n-e)),a)},je.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},je.prototype.toArray=function(){return this.take(se)},Yr(je.prototype,function(e,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),f=d[u?"take"+(n=="last"?"Right":""):n],m=u||/^find/.test(n);f&&(d.prototype[n]=function(){var x=this.__wrapped__,N=u?[1]:arguments,k=x instanceof je,Y=N[0],J=k||Pe(x),re=function(Le){var Me=f.apply(d,Sn([Le],N));return u&&pe?Me[0]:Me};J&&a&&typeof Y=="function"&&Y.length!=1&&(k=J=!1);var pe=this.__chain__,ye=!!this.__actions__.length,be=m&&!pe,Re=k&&!ye;if(!m&&J){x=Re?x:new je(this);var Ee=e.apply(x,N);return Ee.__actions__.push({func:fo,args:[re],thisArg:r}),new Tr(Ee,pe)}return be&&Re?e.apply(this,N):(Ee=this.thru(re),be?u?Ee.value()[0]:Ee.value():Ee)})}),Cr(["pop","push","shift","sort","splice","unshift"],function(e){var n=Ms[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var m=this.value();return n.apply(Pe(m)?m:[],f)}return this[a](function(x){return n.apply(Pe(x)?x:[],f)})}}),Yr(je.prototype,function(e,n){var a=d[n];if(a){var u=a.name+"";Fe.call(vi,u)||(vi[u]=[]),vi[u].push({name:n,func:a})}}),vi[so(r,q).name]=[{name:"wrapper",func:r}],je.prototype.clone=bg,je.prototype.reverse=Eg,je.prototype.value=Ig,d.prototype.at=Xv,d.prototype.chain=Zv,d.prototype.commit=em,d.prototype.next=tm,d.prototype.plant=nm,d.prototype.reverse=im,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=sm,d.prototype.first=d.prototype.head,$i&&(d.prototype[$i]=rm),d},di=eg();Ot?((Ot.exports=di)._=di,tt._=di):Ue._=di}).call(is)})(uu,uu.exports);var eP=Object.defineProperty,tP=Object.defineProperties,rP=Object.getOwnPropertyDescriptors,pp=Object.getOwnPropertySymbols,nP=Object.prototype.hasOwnProperty,iP=Object.prototype.propertyIsEnumerable,dp=(i,t,r)=>t in i?eP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Ro=(i,t)=>{for(var r in t||(t={}))nP.call(t,r)&&dp(i,r,t[r]);if(pp)for(var r of pp(t))iP.call(t,r)&&dp(i,r,t[r]);return i},sP=(i,t)=>tP(i,rP(t));function jn(i,t,r){var s;const o=Zb(i);return((s=t.rpcMap)==null?void 0:s[o.reference])||`${Zx}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function ni(i){return i.includes(":")?i.split(":")[1]:i}function Nd(i){return i.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function oP(i,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(i));if(!r.length)return[];const s=[];return r.forEach(o=>{const c=t.namespaces[o].accounts;s.push(...c)}),s}function gp(i={},t={}){const r=yp(i),s=yp(t);return uu.exports.merge(r,s)}function yp(i){var t,r,s,o;const c={};if(!ls(i))return c;for(const[h,p]of Object.entries(i)){const y=_u(h)?[h]:p.chains,g=p.methods||[],v=p.events||[],b=p.rpcMap||{},P=ss(h);c[P]=sP(Ro(Ro({},c[P]),p),{chains:Uc(y,(t=c[P])==null?void 0:t.chains),methods:Uc(g,(r=c[P])==null?void 0:r.methods),events:Uc(v,(s=c[P])==null?void 0:s.events),rpcMap:Ro(Ro({},b),(o=c[P])==null?void 0:o.rpcMap)})}return c}function aP(i){return i.includes(":")?i.split(":")[2]:i}function cP(i){const t={};for(const[r,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],h=s.accounts||[],p=_u(r)?[r]:s.chains?s.chains:Nd(s.accounts);t[r]={chains:p,methods:o,events:c,accounts:h}}return t}function Yc(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const Td={},pt=i=>Td[i],Jc=(i,t)=>{Td[i]=t};class uP{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=ni(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class lP{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||jn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=parseInt(ni(r));t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class hP{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=ni(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class fP{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=ni(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class pP{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),o=ni(r);t[o]=this.createHttpProvider(o,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class dP{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=ni(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class gP{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const o=ni(r);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new _n(new Dn(s,pt("disableProviderPing")))}}class yP{constructor(t){this.name="near",this.namespace=t.namespace,this.events=pt("events"),this.client=pt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||jn(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace);return typeof s>"u"?void 0:new _n(new Dn(s,pt("disableProviderPing")))}}var vP=Object.defineProperty,mP=Object.defineProperties,_P=Object.getOwnPropertyDescriptors,vp=Object.getOwnPropertySymbols,wP=Object.prototype.hasOwnProperty,bP=Object.prototype.propertyIsEnumerable,mp=(i,t,r)=>t in i?vP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,Ao=(i,t)=>{for(var r in t||(t={}))wP.call(t,r)&&mp(i,r,t[r]);if(vp)for(var r of vp(t))bP.call(t,r)&&mp(i,r,t[r]);return i},Qc=(i,t)=>mP(i,_P(t));class Cu{constructor(t){this.events=new fu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:De.pino(De.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||hp})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Cu(t);return await r.initialize(),r}async request(t,r,s){const[o,c]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Ao({},t),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(t,r,s,o){const c=new Date().getTime();this.request(t,s,o).then(h=>r(null,Wo(c,h))).catch(h=>r(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:ft("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const h=cP(c.namespaces);this.namespaces=gp(this.namespaces,h),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==Od)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Zr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Wx.init({logger:this.providerOpts.logger||hp,relayUrl:this.providerOpts.relayUrl||Jx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ss(r)))];Jc("client",this.client),Jc("events",this.events),Jc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=oP(r,this.session),o=Nd(s),c=gp(this.namespaces,this.optionalNamespaces),h=Qc(Ao({},c[r]),{accounts:s,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new lP({namespace:h});break;case"solana":this.rpcProviders[r]=new hP({namespace:h});break;case"cosmos":this.rpcProviders[r]=new fP({namespace:h});break;case"polkadot":this.rpcProviders[r]=new uP({namespace:h});break;case"cip34":this.rpcProviders[r]=new pP({namespace:h});break;case"elrond":this.rpcProviders[r]=new dP({namespace:h});break;case"multiversx":this.rpcProviders[r]=new gP({namespace:h});break;case"near":this.rpcProviders[r]=new yP({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const o=s.data;o&&Zr(o)&&this.events.emit("accountsChanged",o.map(aP))}else if(s.name==="chainChanged"){const o=r.chainId,c=r.event.data,h=ss(o),p=Yc(o)!==Yc(c)?`${h}:${Yc(c)}`:o;this.onChainChanged(p)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:o}=r,c=(s=this.client)==null?void 0:s.session.get(t);this.session=Qc(Ao({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Qc(Ao({},ft("USER_DISCONNECTED")),{data:t.topic}))}),this.on(wn.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(h=>ss(h)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const o=ss(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(t);o&&(r||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${fp}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${fp}/${t}`)}}const EP=Cu,IP="wc",SP="ethereum_provider",xP=`${IP}@2:${SP}:`,PP="https://rpc.walletconnect.com/v1/",lu=["eth_sendTransaction","personal_sign"],OP=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],hu=["chainChanged","accountsChanged"],CP=["chainChanged","accountsChanged","message","disconnect","connect"];var NP=Object.defineProperty,TP=Object.defineProperties,RP=Object.getOwnPropertyDescriptors,_p=Object.getOwnPropertySymbols,AP=Object.prototype.hasOwnProperty,LP=Object.prototype.propertyIsEnumerable,wp=(i,t,r)=>t in i?NP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,as=(i,t)=>{for(var r in t||(t={}))AP.call(t,r)&&wp(i,r,t[r]);if(_p)for(var r of _p(t))LP.call(t,r)&&wp(i,r,t[r]);return i},bp=(i,t)=>TP(i,RP(t));function zo(i){return Number(i[0].split(":")[1])}function Xc(i){return`0x${i.toString(16)}`}function jP(i){const{chains:t,optionalChains:r,methods:s,optionalMethods:o,events:c,optionalEvents:h,rpcMap:p}=i;if(!Zr(t))throw new Error("Invalid chains");const y={chains:t,methods:s||lu,events:c||hu,rpcMap:as({},t.length?{[zo(t)]:p[zo(t)]}:{})},g=c==null?void 0:c.filter(R=>!hu.includes(R)),v=s==null?void 0:s.filter(R=>!lu.includes(R));if(!r&&!h&&!o&&!(g!=null&&g.length)&&!(v!=null&&v.length))return{required:t.length?y:void 0};const b=(g==null?void 0:g.length)&&(v==null?void 0:v.length)||!r,P={chains:[...new Set(b?y.chains.concat(r||[]):r)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:OP))],events:[...new Set(y.events.concat(h!=null&&h.length?h:CP))],rpcMap:p};return{required:t.length?y:void 0,optional:r.length?P:void 0}}class Nu{constructor(){this.events=new kr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=xP,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Nu;return await r.initialize(t),r}async request(t,r){return await this.signer.request(t,this.formatChainId(this.chainId),r)}sendAsync(t,r,s){this.signer.sendAsync(t,r,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=jP(this.rpc);try{const o=await new Promise(async(h,p)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(bp(as({namespaces:as({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(g=>{h(g)}).catch(g=>{p(new Error(g.message))})});if(!o)return;const c=e0(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:Xc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Xc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",bp(as({},ft("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Xc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,o]=t.split(":");return{chainId:`${r}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const o=(r=t==null?void 0:t.chains)!=null?r:[],c=(s=t==null?void 0:t.optionalChains)!=null?s:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=o.length?(t==null?void 0:t.methods)||lu:[],y=o.length?(t==null?void 0:t.events)||hu:[],g=(t==null?void 0:t.optionalMethods)||[],v=(t==null?void 0:t.optionalEvents)||[],b=(t==null?void 0:t.rpcMap)||this.buildRpcMap(h,t.projectId),P=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(R=>this.formatChainId(R)),optionalChains:c.map(R=>this.formatChainId(R)),methods:p,events:y,optionalMethods:g,optionalEvents:v,rpcMap:b,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:P,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?zo(this.rpc.chains):zo(this.rpc.optionalChains),this.signer=await EP.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await _b(()=>import("./index-fRo6L3lD-UWPKFCW8.js"),__vite__mapDeps([0,1])).then(o=>o.i);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(as({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:o}=t;r&&Zr(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&Zr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${PP}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const kP=Nu;export{kP as EthereumProvider,CP as OPTIONAL_EVENTS,OP as OPTIONAL_METHODS,hu as REQUIRED_EVENTS,lu as REQUIRED_METHODS,Nu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-fRo6L3lD-UWPKFCW8.js","assets/vendor-AsFy8gcr.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}